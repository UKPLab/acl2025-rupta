/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/requests/__init__.py:109: RequestsDependencyWarning: urllib3 (2.2.1) or chardet (None)/charset_normalizer (2.1.1) doesn't match a supported version!
  warnings.warn(
`low_cpu_mem_usage` was None, now set to True since model is quantized.
`low_cpu_mem_usage` was None, now set to True since model is quantized.
Found max lenth: 512
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map: 100%|██████████| 1984/1984 [00:00<00:00, 45693.90 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 48848.54 examples/s]
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Parameter 'function'=<bound method DPOTrainer.tokenize_row of <trl.trainer.dpo_trainer.DPOTrainer object at 0x7f213cbb6cd0>> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
trainable params: 122683392 || all params: 616369152 || trainables%: 19.90420701651208
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map:   2%|▏         | 47/1984 [00:00<00:04, 436.02 examples/s]Map:   5%|▌         | 105/1984 [00:00<00:03, 515.26 examples/s]Map:   9%|▉         | 186/1984 [00:00<00:03, 521.35 examples/s]Map:  13%|█▎        | 267/1984 [00:00<00:03, 525.28 examples/s]Map:  17%|█▋        | 339/1984 [00:00<00:03, 504.83 examples/s]Map:  20%|██        | 402/1984 [00:00<00:02, 534.53 examples/s]Map:  24%|██▍       | 480/1984 [00:00<00:02, 525.36 examples/s]Map:  28%|██▊       | 559/1984 [00:01<00:02, 523.84 examples/s]Map:  32%|███▏      | 636/1984 [00:01<00:02, 517.02 examples/s]Map:  36%|███▌      | 705/1984 [00:01<00:02, 496.05 examples/s]Map:  38%|███▊      | 757/1984 [00:01<00:02, 500.99 examples/s]Map:  41%|████      | 809/1984 [00:01<00:02, 504.58 examples/s]Map:  44%|████▍     | 878/1984 [00:01<00:02, 484.45 examples/s]Map:  47%|████▋     | 932/1984 [00:01<00:02, 494.86 examples/s]Map:  50%|████▉     | 986/1984 [00:01<00:01, 505.61 examples/s]Map:  53%|█████▎    | 1058/1984 [00:02<00:02, 369.92 examples/s]Map:  56%|█████▌    | 1109/1984 [00:02<00:02, 397.31 examples/s]Map:  59%|█████▊    | 1162/1984 [00:02<00:01, 423.73 examples/s]Map:  61%|██████    | 1212/1984 [00:02<00:01, 439.27 examples/s]Map:  64%|██████▍   | 1267/1984 [00:02<00:01, 467.16 examples/s]Map:  66%|██████▋   | 1319/1984 [00:02<00:01, 479.38 examples/s]Map:  70%|███████   | 1396/1984 [00:02<00:01, 487.49 examples/s]Map:  73%|███████▎  | 1448/1984 [00:02<00:01, 494.58 examples/s]Map:  77%|███████▋  | 1527/1984 [00:03<00:00, 503.06 examples/s]Map:  80%|███████▉  | 1578/1984 [00:03<00:00, 500.51 examples/s]Map:  82%|████████▏ | 1630/1984 [00:03<00:00, 503.05 examples/s]Map:  85%|████████▌ | 1688/1984 [00:03<00:00, 521.77 examples/s]Map:  88%|████████▊ | 1744/1984 [00:03<00:00, 530.33 examples/s]Map:  92%|█████████▏| 1817/1984 [00:03<00:00, 509.88 examples/s]Map:  94%|█████████▍| 1870/1984 [00:03<00:00, 512.82 examples/s]Map:  97%|█████████▋| 1923/1984 [00:03<00:00, 511.78 examples/s]Map: 100%|█████████▉| 1978/1984 [00:04<00:00, 518.91 examples/s]Map: 100%|██████████| 1984/1984 [00:04<00:00, 473.56 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map:  18%|█▊        | 46/249 [00:00<00:00, 449.95 examples/s]Map:  39%|███▊      | 96/249 [00:00<00:00, 475.97 examples/s]Map:  58%|█████▊    | 145/249 [00:00<00:00, 477.98 examples/s]Map:  80%|███████▉  | 199/249 [00:00<00:00, 497.87 examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 454.95 examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 462.99 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/requests/__init__.py:109: RequestsDependencyWarning: urllib3 (2.2.1) or chardet (None)/charset_normalizer (2.1.1) doesn't match a supported version!
  warnings.warn(
wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240524_010057-ecbxj4ao
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dpo_google--flan-t5-large--hf-_None_lr-0.0002_ep-20_bz-8-acc-4_lora-r-128-ap-256
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/ecbxj4ao
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
  0%|          | 0/1240 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/1240 [00:09<3:15:12,  9.45s/it]  0%|          | 2/1240 [00:17<3:03:48,  8.91s/it]  0%|          | 3/1240 [00:26<3:03:20,  8.89s/it]  0%|          | 4/1240 [00:35<3:02:30,  8.86s/it]  0%|          | 5/1240 [00:44<2:59:50,  8.74s/it]  0%|          | 6/1240 [00:52<2:58:00,  8.66s/it]  1%|          | 7/1240 [01:04<3:21:00,  9.78s/it]  1%|          | 8/1240 [01:13<3:11:45,  9.34s/it]  1%|          | 9/1240 [01:21<3:06:46,  9.10s/it]  1%|          | 10/1240 [01:29<2:56:04,  8.59s/it]                                                     1%|          | 10/1240 [01:29<2:56:04,  8.59s/it]  1%|          | 11/1240 [01:36<2:49:39,  8.28s/it]  1%|          | 12/1240 [01:45<2:52:54,  8.45s/it]  1%|          | 13/1240 [01:53<2:51:18,  8.38s/it]  1%|          | 14/1240 [02:02<2:50:48,  8.36s/it]  1%|          | 15/1240 [02:10<2:52:45,  8.46s/it]  1%|▏         | 16/1240 [02:18<2:45:35,  8.12s/it]  1%|▏         | 17/1240 [02:26<2:48:11,  8.25s/it]  1%|▏         | 18/1240 [02:35<2:48:47,  8.29s/it]  2%|▏         | 19/1240 [02:44<2:53:31,  8.53s/it]  2%|▏         | 20/1240 [02:53<2:56:05,  8.66s/it]                                                     2%|▏         | 20/1240 [02:53<2:56:05,  8.66s/it]  2%|▏         | 21/1240 [03:01<2:56:56,  8.71s/it]  2%|▏         | 22/1240 [03:09<2:50:55,  8.42s/it]  2%|▏         | 23/1240 [03:18<2:50:32,  8.41s/it]  2%|▏         | 24/1240 [03:25<2:43:55,  8.09s/it]  2%|▏         | 25/1240 [03:34<2:48:23,  8.32s/it]  2%|▏         | 26/1240 [03:42<2:49:10,  8.36s/it]  2%|▏         | 27/1240 [03:50<2:45:51,  8.20s/it]  2%|▏         | 28/1240 [03:59<2:49:53,  8.41s/it]  2%|▏         | 29/1240 [04:07<2:45:40,  8.21s/it]  2%|▏         | 30/1240 [04:14<2:42:48,  8.07s/it]                                                     2%|▏         | 30/1240 [04:14<2:42:48,  8.07s/it]  2%|▎         | 31/1240 [04:23<2:44:25,  8.16s/it]  3%|▎         | 32/1240 [04:32<2:49:26,  8.42s/it]  3%|▎         | 33/1240 [04:40<2:46:58,  8.30s/it]  3%|▎         | 34/1240 [04:48<2:45:26,  8.23s/it]  3%|▎         | 35/1240 [04:57<2:48:56,  8.41s/it]  3%|▎         | 36/1240 [05:06<2:50:49,  8.51s/it]  3%|▎         | 37/1240 [05:14<2:50:36,  8.51s/it]  3%|▎         | 38/1240 [05:22<2:47:11,  8.35s/it]  3%|▎         | 39/1240 [05:30<2:44:49,  8.23s/it]  3%|▎         | 40/1240 [05:38<2:40:26,  8.02s/it]                                                     3%|▎         | 40/1240 [05:38<2:40:26,  8.02s/it]  3%|▎         | 41/1240 [05:45<2:39:28,  7.98s/it]  3%|▎         | 42/1240 [05:54<2:40:25,  8.03s/it]  3%|▎         | 43/1240 [06:03<2:46:10,  8.33s/it]  4%|▎         | 44/1240 [06:11<2:44:29,  8.25s/it]  4%|▎         | 45/1240 [06:19<2:44:36,  8.26s/it]  4%|▎         | 46/1240 [06:28<2:47:46,  8.43s/it]  4%|▍         | 47/1240 [06:36<2:48:52,  8.49s/it]  4%|▍         | 48/1240 [06:45<2:51:08,  8.61s/it]  4%|▍         | 49/1240 [06:54<2:52:24,  8.69s/it]  4%|▍         | 50/1240 [07:03<2:52:50,  8.71s/it]                                                     4%|▍         | 50/1240 [07:03<2:52:50,  8.71s/it]  4%|▍         | 51/1240 [07:12<2:54:12,  8.79s/it]  4%|▍         | 52/1240 [07:21<2:53:15,  8.75s/it]  4%|▍         | 53/1240 [07:30<2:54:40,  8.83s/it]  4%|▍         | 54/1240 [07:38<2:54:30,  8.83s/it]  4%|▍         | 55/1240 [07:47<2:55:26,  8.88s/it]  5%|▍         | 56/1240 [07:55<2:48:42,  8.55s/it]  5%|▍         | 57/1240 [08:03<2:45:30,  8.39s/it]  5%|▍         | 58/1240 [08:12<2:46:33,  8.45s/it]  5%|▍         | 59/1240 [08:20<2:46:23,  8.45s/it]  5%|▍         | 60/1240 [08:28<2:42:17,  8.25s/it]                                                     5%|▍         | 60/1240 [08:28<2:42:17,  8.25s/it]  5%|▍         | 61/1240 [08:36<2:41:11,  8.20s/it]  5%|▌         | 62/1240 [08:45<2:44:19,  8.37s/it]  5%|▌         | 63/1240 [08:54<2:45:49,  8.45s/it]  5%|▌         | 64/1240 [09:02<2:46:10,  8.48s/it]  5%|▌         | 65/1240 [09:11<2:47:09,  8.54s/it]  5%|▌         | 66/1240 [09:19<2:47:06,  8.54s/it]  5%|▌         | 67/1240 [09:28<2:45:33,  8.47s/it]  5%|▌         | 68/1240 [09:36<2:45:53,  8.49s/it]  6%|▌         | 69/1240 [09:45<2:45:48,  8.50s/it]  6%|▌         | 70/1240 [09:53<2:43:48,  8.40s/it]                                                     6%|▌         | 70/1240 [09:53<2:43:48,  8.40s/it]  6%|▌         | 71/1240 [10:01<2:42:04,  8.32s/it]  6%|▌         | 72/1240 [10:10<2:44:25,  8.45s/it]  6%|▌         | 73/1240 [10:17<2:39:51,  8.22s/it]  6%|▌         | 74/1240 [10:26<2:43:50,  8.43s/it]  6%|▌         | 75/1240 [10:34<2:41:46,  8.33s/it]  6%|▌         | 76/1240 [10:43<2:42:27,  8.37s/it]  6%|▌         | 77/1240 [10:51<2:42:13,  8.37s/it]  6%|▋         | 78/1240 [11:00<2:44:45,  8.51s/it]  6%|▋         | 79/1240 [11:09<2:44:44,  8.51s/it]  6%|▋         | 80/1240 [11:17<2:41:11,  8.34s/it]                                                     6%|▋         | 80/1240 [11:17<2:41:11,  8.34s/it]  7%|▋         | 81/1240 [11:25<2:42:12,  8.40s/it]  7%|▋         | 82/1240 [11:34<2:42:49,  8.44s/it]  7%|▋         | 83/1240 [11:42<2:40:51,  8.34s/it]  7%|▋         | 84/1240 [11:50<2:38:46,  8.24s/it]  7%|▋         | 85/1240 [11:58<2:40:24,  8.33s/it]  7%|▋         | 86/1240 [12:07<2:41:01,  8.37s/it]  7%|▋         | 87/1240 [12:15<2:39:08,  8.28s/it]  7%|▋         | 88/1240 [12:23<2:41:00,  8.39s/it]  7%|▋         | 89/1240 [12:32<2:43:23,  8.52s/it]  7%|▋         | 90/1240 [12:40<2:41:21,  8.42s/it]                                                     7%|▋         | 90/1240 [12:40<2:41:21,  8.42s/it]  7%|▋         | 91/1240 [12:49<2:42:13,  8.47s/it]  7%|▋         | 92/1240 [12:58<2:45:15,  8.64s/it]  8%|▊         | 93/1240 [13:06<2:42:40,  8.51s/it]  8%|▊         | 94/1240 [13:15<2:43:44,  8.57s/it]  8%|▊         | 95/1240 [13:24<2:45:59,  8.70s/it]  8%|▊         | 96/1240 [13:33<2:47:43,  8.80s/it]  8%|▊         | 97/1240 [13:42<2:46:42,  8.75s/it]  8%|▊         | 98/1240 [13:50<2:45:46,  8.71s/it]  8%|▊         | 99/1240 [14:04<3:14:02, 10.20s/it]  8%|▊         | 100/1240 [14:13<3:05:38,  9.77s/it]                                                      8%|▊         | 100/1240 [14:13<3:05:38,  9.77s/it]  8%|▊         | 101/1240 [14:22<3:01:06,  9.54s/it]  8%|▊         | 102/1240 [14:30<2:54:04,  9.18s/it]  8%|▊         | 103/1240 [14:39<2:49:57,  8.97s/it]  8%|▊         | 104/1240 [14:46<2:44:12,  8.67s/it]  8%|▊         | 105/1240 [14:55<2:43:37,  8.65s/it]  9%|▊         | 106/1240 [15:04<2:42:52,  8.62s/it]  9%|▊         | 107/1240 [15:12<2:39:16,  8.43s/it]  9%|▊         | 108/1240 [15:20<2:41:21,  8.55s/it]  9%|▉         | 109/1240 [15:29<2:39:35,  8.47s/it]  9%|▉         | 110/1240 [15:38<2:41:28,  8.57s/it]                                                      9%|▉         | 110/1240 [15:38<2:41:28,  8.57s/it]  9%|▉         | 111/1240 [15:46<2:40:14,  8.52s/it]  9%|▉         | 112/1240 [15:54<2:37:08,  8.36s/it]  9%|▉         | 113/1240 [16:11<3:26:09, 10.98s/it]  9%|▉         | 114/1240 [16:20<3:12:40, 10.27s/it]  9%|▉         | 115/1240 [16:28<3:00:46,  9.64s/it]  9%|▉         | 116/1240 [16:37<2:56:55,  9.44s/it]  9%|▉         | 117/1240 [16:45<2:51:20,  9.15s/it] 10%|▉         | 118/1240 [16:54<2:48:17,  9.00s/it] 10%|▉         | 119/1240 [17:03<2:48:10,  9.00s/it] 10%|▉         | 120/1240 [17:11<2:41:35,  8.66s/it]                                                     10%|▉         | 120/1240 [17:11<2:41:35,  8.66s/it] 10%|▉         | 121/1240 [17:20<2:42:40,  8.72s/it] 10%|▉         | 122/1240 [17:28<2:41:18,  8.66s/it] 10%|▉         | 123/1240 [17:37<2:40:57,  8.65s/it] 10%|█         | 124/1240 [17:45<2:36:49,  8.43s/it] 10%|█         | 125/1240 [17:53<2:35:52,  8.39s/it] 10%|█         | 126/1240 [18:02<2:38:31,  8.54s/it] 10%|█         | 127/1240 [18:11<2:40:58,  8.68s/it] 10%|█         | 128/1240 [18:19<2:38:39,  8.56s/it] 10%|█         | 129/1240 [18:28<2:38:09,  8.54s/it] 10%|█         | 130/1240 [18:36<2:36:58,  8.49s/it]                                                     10%|█         | 130/1240 [18:36<2:36:58,  8.49s/it] 11%|█         | 131/1240 [18:45<2:38:39,  8.58s/it] 11%|█         | 132/1240 [18:53<2:34:46,  8.38s/it] 11%|█         | 133/1240 [19:02<2:38:03,  8.57s/it] 11%|█         | 134/1240 [19:10<2:36:01,  8.46s/it] 11%|█         | 135/1240 [19:19<2:38:53,  8.63s/it] 11%|█         | 136/1240 [19:27<2:33:46,  8.36s/it] 11%|█         | 137/1240 [19:35<2:34:10,  8.39s/it] 11%|█         | 138/1240 [19:44<2:37:42,  8.59s/it] 11%|█         | 139/1240 [19:53<2:36:06,  8.51s/it] 11%|█▏        | 140/1240 [20:01<2:34:05,  8.40s/it]                                                     11%|█▏        | 140/1240 [20:01<2:34:05,  8.40s/it] 11%|█▏        | 141/1240 [20:09<2:35:21,  8.48s/it] 11%|█▏        | 142/1240 [20:18<2:35:00,  8.47s/it] 12%|█▏        | 143/1240 [20:27<2:38:15,  8.66s/it] 12%|█▏        | 144/1240 [20:35<2:34:24,  8.45s/it] 12%|█▏        | 145/1240 [20:43<2:31:52,  8.32s/it] 12%|█▏        | 146/1240 [20:52<2:35:33,  8.53s/it] 12%|█▏        | 147/1240 [21:00<2:35:31,  8.54s/it] 12%|█▏        | 148/1240 [21:09<2:36:12,  8.58s/it] 12%|█▏        | 149/1240 [21:17<2:33:04,  8.42s/it] 12%|█▏        | 150/1240 [21:26<2:36:09,  8.60s/it]                                                     12%|█▏        | 150/1240 [21:26<2:36:09,  8.60s/it] 12%|█▏        | 151/1240 [21:34<2:33:35,  8.46s/it] 12%|█▏        | 152/1240 [21:43<2:33:14,  8.45s/it] 12%|█▏        | 153/1240 [21:51<2:33:22,  8.47s/it] 12%|█▏        | 154/1240 [22:00<2:34:23,  8.53s/it] 12%|█▎        | 155/1240 [22:08<2:33:57,  8.51s/it] 13%|█▎        | 156/1240 [22:16<2:30:41,  8.34s/it] 13%|█▎        | 157/1240 [22:24<2:27:10,  8.15s/it] 13%|█▎        | 158/1240 [22:33<2:31:33,  8.40s/it] 13%|█▎        | 159/1240 [22:42<2:34:46,  8.59s/it] 13%|█▎        | 160/1240 [22:51<2:35:30,  8.64s/it]                                                     13%|█▎        | 160/1240 [22:51<2:35:30,  8.64s/it] 13%|█▎        | 161/1240 [23:00<2:36:21,  8.69s/it] 13%|█▎        | 162/1240 [23:08<2:32:08,  8.47s/it] 13%|█▎        | 163/1240 [23:16<2:31:08,  8.42s/it] 13%|█▎        | 164/1240 [23:25<2:32:23,  8.50s/it] 13%|█▎        | 165/1240 [23:32<2:28:23,  8.28s/it] 13%|█▎        | 166/1240 [23:41<2:32:12,  8.50s/it] 13%|█▎        | 167/1240 [23:50<2:32:23,  8.52s/it] 14%|█▎        | 168/1240 [23:58<2:28:10,  8.29s/it] 14%|█▎        | 169/1240 [24:06<2:28:51,  8.34s/it] 14%|█▎        | 170/1240 [24:15<2:29:59,  8.41s/it]                                                     14%|█▎        | 170/1240 [24:15<2:29:59,  8.41s/it] 14%|█▍        | 171/1240 [24:23<2:31:22,  8.50s/it] 14%|█▍        | 172/1240 [24:31<2:25:28,  8.17s/it] 14%|█▍        | 173/1240 [24:39<2:25:12,  8.17s/it] 14%|█▍        | 174/1240 [24:48<2:27:28,  8.30s/it] 14%|█▍        | 175/1240 [24:56<2:28:41,  8.38s/it] 14%|█▍        | 176/1240 [25:05<2:33:31,  8.66s/it] 14%|█▍        | 177/1240 [25:15<2:35:15,  8.76s/it] 14%|█▍        | 178/1240 [25:23<2:35:16,  8.77s/it] 14%|█▍        | 179/1240 [25:31<2:30:01,  8.48s/it] 15%|█▍        | 180/1240 [25:39<2:26:20,  8.28s/it]                                                     15%|█▍        | 180/1240 [25:39<2:26:20,  8.28s/it] 15%|█▍        | 181/1240 [25:48<2:29:20,  8.46s/it] 15%|█▍        | 182/1240 [25:57<2:32:05,  8.63s/it] 15%|█▍        | 183/1240 [26:05<2:27:12,  8.36s/it] 15%|█▍        | 184/1240 [26:13<2:29:55,  8.52s/it] 15%|█▍        | 185/1240 [26:22<2:29:45,  8.52s/it] 15%|█▌        | 186/1240 [26:30<2:29:05,  8.49s/it] 15%|█▌        | 187/1240 [26:39<2:31:30,  8.63s/it] 15%|█▌        | 188/1240 [26:48<2:32:46,  8.71s/it] 15%|█▌        | 189/1240 [26:57<2:32:24,  8.70s/it] 15%|█▌        | 190/1240 [27:06<2:33:10,  8.75s/it]                                                     15%|█▌        | 190/1240 [27:06<2:33:10,  8.75s/it] 15%|█▌        | 191/1240 [27:13<2:27:34,  8.44s/it] 15%|█▌        | 192/1240 [27:21<2:21:56,  8.13s/it] 16%|█▌        | 193/1240 [27:29<2:23:47,  8.24s/it] 16%|█▌        | 194/1240 [27:37<2:19:52,  8.02s/it] 16%|█▌        | 195/1240 [27:46<2:24:07,  8.27s/it] 16%|█▌        | 196/1240 [27:55<2:27:33,  8.48s/it] 16%|█▌        | 197/1240 [28:04<2:30:02,  8.63s/it] 16%|█▌        | 198/1240 [28:12<2:27:34,  8.50s/it] 16%|█▌        | 199/1240 [28:20<2:23:30,  8.27s/it] 16%|█▌        | 200/1240 [28:27<2:18:47,  8.01s/it]                                                     16%|█▌        | 200/1240 [28:27<2:18:47,  8.01s/it]{'loss': 0.8385, 'grad_norm': 1.8266445398330688, 'learning_rate': 3.2258064516129034e-05, 'rewards/chosen': -0.7038128972053528, 'rewards/rejected': -0.515990674495697, 'rewards/accuracies': 0.3968749940395355, 'rewards/margins': -0.18782222270965576, 'logps/rejected': -230.5207061767578, 'logps/chosen': -291.9516906738281, 'logits/rejected': 7.2270941734313965, 'logits/chosen': 11.97341537475586, 'epoch': 0.16}
{'loss': 0.7413, 'grad_norm': 1.7639133930206299, 'learning_rate': 6.451612903225807e-05, 'rewards/chosen': -0.6438080668449402, 'rewards/rejected': -0.6697372794151306, 'rewards/accuracies': 0.534375011920929, 'rewards/margins': 0.025929218158125877, 'logps/rejected': -207.5123748779297, 'logps/chosen': -268.5062561035156, 'logits/rejected': 4.924818515777588, 'logits/chosen': 9.902181625366211, 'epoch': 0.32}
{'loss': 0.5643, 'grad_norm': 1.3361880779266357, 'learning_rate': 9.677419354838711e-05, 'rewards/chosen': -0.9039865732192993, 'rewards/rejected': -1.6100482940673828, 'rewards/accuracies': 0.675000011920929, 'rewards/margins': 0.7060617208480835, 'logps/rejected': -239.88833618164062, 'logps/chosen': -290.8209533691406, 'logits/rejected': 2.485487699508667, 'logits/chosen': 7.297269344329834, 'epoch': 0.48}
{'loss': 0.4119, 'grad_norm': 2.4121267795562744, 'learning_rate': 0.00012903225806451613, 'rewards/chosen': -2.6824257373809814, 'rewards/rejected': -5.657724380493164, 'rewards/accuracies': 0.78125, 'rewards/margins': 2.975299119949341, 'logps/rejected': -275.10772705078125, 'logps/chosen': -302.2141418457031, 'logits/rejected': -2.590273857116699, 'logits/chosen': 4.187658786773682, 'epoch': 0.65}
{'loss': 0.3629, 'grad_norm': 2.290418863296509, 'learning_rate': 0.00016129032258064516, 'rewards/chosen': -4.2182817459106445, 'rewards/rejected': -8.682374954223633, 'rewards/accuracies': 0.831250011920929, 'rewards/margins': 4.464092254638672, 'logps/rejected': -300.29034423828125, 'logps/chosen': -321.7355041503906, 'logits/rejected': -3.0675456523895264, 'logits/chosen': 4.7078351974487305, 'epoch': 0.81}
{'loss': 0.3263, 'grad_norm': 1.721988320350647, 'learning_rate': 0.00019354838709677422, 'rewards/chosen': -4.653139114379883, 'rewards/rejected': -10.379507064819336, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 5.726366996765137, 'logps/rejected': -337.302734375, 'logps/chosen': -334.46270751953125, 'logits/rejected': -4.1292548179626465, 'logits/chosen': 2.3958492279052734, 'epoch': 0.97}
{'loss': 0.2493, 'grad_norm': 2.136141061782837, 'learning_rate': 0.00019997724155059837, 'rewards/chosen': -3.5043139457702637, 'rewards/rejected': -9.226396560668945, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 5.722081661224365, 'logps/rejected': -313.0497131347656, 'logps/chosen': -314.56988525390625, 'logits/rejected': -1.7350826263427734, 'logits/chosen': 4.942326068878174, 'epoch': 1.13}
{'loss': 0.2368, 'grad_norm': 1.0747044086456299, 'learning_rate': 0.00019988480310346605, 'rewards/chosen': -3.7253901958465576, 'rewards/rejected': -7.615427494049072, 'rewards/accuracies': 0.8843749761581421, 'rewards/margins': 3.8900368213653564, 'logps/rejected': -291.0509338378906, 'logps/chosen': -310.3872375488281, 'logits/rejected': 0.9492154121398926, 'logits/chosen': 5.95820951461792, 'epoch': 1.29}
{'loss': 0.1722, 'grad_norm': 1.0414113998413086, 'learning_rate': 0.00019972132794589517, 'rewards/chosen': -8.319316864013672, 'rewards/rejected': -16.19710350036621, 'rewards/accuracies': 0.925000011920929, 'rewards/margins': 7.8777875900268555, 'logps/rejected': -384.6415100097656, 'logps/chosen': -364.60693359375, 'logits/rejected': -3.6330132484436035, 'logits/chosen': 2.344611644744873, 'epoch': 1.45}
{'loss': 0.2079, 'grad_norm': 1.9910876750946045, 'learning_rate': 0.00019948693233918952, 'rewards/chosen': -9.156881332397461, 'rewards/rejected': -17.720535278320312, 'rewards/accuracies': 0.9125000238418579, 'rewards/margins': 8.563653945922852, 'logps/rejected': -399.2386474609375, 'logps/chosen': -377.7863464355469, 'logits/rejected': -5.41347074508667, 'logits/chosen': 1.7135244607925415, 'epoch': 1.61}
{'loss': 0.1819, 'grad_norm': 1.216267704963684, 'learning_rate': 0.00019918178298230954, 'rewards/chosen': -8.213780403137207, 'rewards/rejected': -16.438018798828125, 'rewards/accuracies': 0.9125000238418579, 'rewards/margins': 8.224238395690918, 'logps/rejected': -387.236328125, 'logps/chosen': -359.1799621582031, 'logits/rejected': -5.058671474456787, 'logits/chosen': 1.5388948917388916, 'epoch': 1.77}
{'loss': 0.1835, 'grad_norm': 0.9921222925186157, 'learning_rate': 0.00019880609689331834, 'rewards/chosen': -9.40832805633545, 'rewards/rejected': -18.746328353881836, 'rewards/accuracies': 0.9156249761581421, 'rewards/margins': 9.338001251220703, 'logps/rejected': -397.6610107421875, 'logps/chosen': -365.8697509765625, 'logits/rejected': -6.230196952819824, 'logits/chosen': 1.1876760721206665, 'epoch': 1.94}
{'loss': 0.1382, 'grad_norm': 1.571093201637268, 'learning_rate': 0.00019836014125504145, 'rewards/chosen': -7.660738468170166, 'rewards/rejected': -14.752558708190918, 'rewards/accuracies': 0.934374988079071, 'rewards/margins': 7.091822147369385, 'logps/rejected': -363.90399169921875, 'logps/chosen': -350.93243408203125, 'logits/rejected': -3.3949387073516846, 'logits/chosen': 3.5040619373321533, 'epoch': 2.1}
{'loss': 0.1141, 'grad_norm': 2.0057010650634766, 'learning_rate': 0.00019784423322505, 'rewards/chosen': -12.0452880859375, 'rewards/rejected': -24.35338020324707, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 12.30809211730957, 'logps/rejected': -466.21136474609375, 'logps/chosen': -400.0814514160156, 'logits/rejected': -7.686314582824707, 'logits/chosen': -0.03404197841882706, 'epoch': 2.26}
{'loss': 0.1816, 'grad_norm': 2.3541412353515625, 'learning_rate': 0.00019725873971010257, 'rewards/chosen': -8.430913925170898, 'rewards/rejected': -15.998754501342773, 'rewards/accuracies': 0.925000011920929, 'rewards/margins': 7.567840576171875, 'logps/rejected': -384.033447265625, 'logps/chosen': -366.86767578125, 'logits/rejected': -2.7338714599609375, 'logits/chosen': 3.804332733154297, 'epoch': 2.42}
{'loss': 0.136, 'grad_norm': 1.2961499691009521, 'learning_rate': 0.0001966040771052061, 'rewards/chosen': -7.6650071144104, 'rewards/rejected': -16.293413162231445, 'rewards/accuracies': 0.9375, 'rewards/margins': 8.62840747833252, 'logps/rejected': -382.21929931640625, 'logps/chosen': -346.46905517578125, 'logits/rejected': -1.6695225238800049, 'logits/chosen': 5.520663261413574, 'epoch': 2.58}
{'loss': 0.1084, 'grad_norm': 1.2002328634262085, 'learning_rate': 0.00019588071099748157, 'rewards/chosen': -10.942752838134766, 'rewards/rejected': -26.95980453491211, 'rewards/accuracies': 0.9468749761581421, 'rewards/margins': 16.017053604125977, 'logps/rejected': -502.3675842285156, 'logps/chosen': -403.34820556640625, 'logits/rejected': -6.1636481285095215, 'logits/chosen': 2.1063313484191895, 'epoch': 2.74}
{'loss': 0.0913, 'grad_norm': 0.897899329662323, 'learning_rate': 0.0001950891558350446, 'rewards/chosen': -12.628114700317383, 'rewards/rejected': -27.556787490844727, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 14.928674697875977, 'logps/rejected': -479.16552734375, 'logps/chosen': -390.82440185546875, 'logits/rejected': -6.101650714874268, 'logits/chosen': 2.3134450912475586, 'epoch': 2.9}
{'loss': 0.1354, 'grad_norm': 3.080408811569214, 'learning_rate': 0.00019422997456113695, 'rewards/chosen': -21.709054946899414, 'rewards/rejected': -40.64834976196289, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 18.939294815063477, 'logps/rejected': -628.0723876953125, 'logps/chosen': -509.00128173828125, 'logits/rejected': -6.9014105796813965, 'logits/chosen': 0.7744086384773254, 'epoch': 3.06}
{'loss': 0.1655, 'grad_norm': 0.8404285907745361, 'learning_rate': 0.00019330377821376917, 'rewards/chosen': -21.89361000061035, 'rewards/rejected': -41.7125244140625, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 19.818918228149414, 'logps/rejected': -632.5390625, 'logps/chosen': -490.2815856933594, 'logits/rejected': -9.475263595581055, 'logits/chosen': -1.6916052103042603, 'epoch': 3.23}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:11,  5.42it/s][A
  5%|▍         | 3/63 [00:00<00:17,  3.50it/s][A
  6%|▋         | 4/63 [00:01<00:19,  2.95it/s][A
  8%|▊         | 5/63 [00:01<00:21,  2.66it/s][A
 10%|▉         | 6/63 [00:02<00:23,  2.45it/s][A
 11%|█         | 7/63 [00:02<00:24,  2.32it/s][A
 13%|█▎        | 8/63 [00:03<00:23,  2.29it/s][A
 14%|█▍        | 9/63 [00:03<00:22,  2.39it/s][A
 16%|█▌        | 10/63 [00:03<00:22,  2.31it/s][A
 17%|█▋        | 11/63 [00:04<00:22,  2.26it/s][A
 19%|█▉        | 12/63 [00:04<00:22,  2.27it/s][A
 21%|██        | 13/63 [00:05<00:21,  2.37it/s][A
 22%|██▏       | 14/63 [00:05<00:21,  2.29it/s][A
 24%|██▍       | 15/63 [00:06<00:21,  2.27it/s][A
 25%|██▌       | 16/63 [00:06<00:20,  2.26it/s][A
 27%|██▋       | 17/63 [00:06<00:19,  2.38it/s][A
 29%|██▊       | 18/63 [00:07<00:18,  2.46it/s][A
 30%|███       | 19/63 [00:07<00:17,  2.52it/s][A
 32%|███▏      | 20/63 [00:08<00:17,  2.44it/s][A
 33%|███▎      | 21/63 [00:08<00:16,  2.51it/s][A
 35%|███▍      | 22/63 [00:08<00:17,  2.37it/s][A
 37%|███▋      | 23/63 [00:09<00:17,  2.29it/s][A
 38%|███▊      | 24/63 [00:09<00:17,  2.23it/s][A
 40%|███▉      | 25/63 [00:10<00:17,  2.21it/s][A
 41%|████▏     | 26/63 [00:10<00:17,  2.17it/s][A
 43%|████▎     | 27/63 [00:11<00:16,  2.15it/s][A
 44%|████▍     | 28/63 [00:11<00:16,  2.13it/s][A
 46%|████▌     | 29/63 [00:12<00:15,  2.27it/s][A
 48%|████▊     | 30/63 [00:12<00:13,  2.38it/s][A
 49%|████▉     | 31/63 [00:12<00:13,  2.46it/s][A
 51%|█████     | 32/63 [00:13<00:12,  2.52it/s][A
 52%|█████▏    | 33/63 [00:13<00:11,  2.55it/s][A
 54%|█████▍    | 34/63 [00:14<00:11,  2.45it/s][A
 56%|█████▌    | 35/63 [00:14<00:11,  2.45it/s][A
 57%|█████▋    | 36/63 [00:14<00:10,  2.51it/s][A
 59%|█████▊    | 37/63 [00:15<00:10,  2.56it/s][A
 60%|██████    | 38/63 [00:15<00:09,  2.58it/s][A
 62%|██████▏   | 39/63 [00:16<00:09,  2.42it/s][A
 63%|██████▎   | 40/63 [00:16<00:09,  2.32it/s][A
 65%|██████▌   | 41/63 [00:16<00:09,  2.42it/s][A
 67%|██████▋   | 42/63 [00:17<00:08,  2.46it/s][A
 68%|██████▊   | 43/63 [00:17<00:07,  2.52it/s][A
 70%|██████▉   | 44/63 [00:18<00:07,  2.57it/s][A
 71%|███████▏  | 45/63 [00:18<00:06,  2.60it/s][A
 73%|███████▎  | 46/63 [00:18<00:06,  2.63it/s][A
 75%|███████▍  | 47/63 [00:19<00:06,  2.65it/s][A
 76%|███████▌  | 48/63 [00:19<00:05,  2.65it/s][A
 78%|███████▊  | 49/63 [00:19<00:05,  2.66it/s][A
 79%|███████▉  | 50/63 [00:20<00:05,  2.47it/s][A
 81%|████████  | 51/63 [00:20<00:04,  2.49it/s][A
 83%|████████▎ | 52/63 [00:21<00:04,  2.37it/s][A
 84%|████████▍ | 53/63 [00:21<00:04,  2.45it/s][A
 86%|████████▌ | 54/63 [00:22<00:03,  2.51it/s][A
 87%|████████▋ | 55/63 [00:22<00:03,  2.56it/s][A
 89%|████████▉ | 56/63 [00:22<00:02,  2.60it/s][A
 90%|█████████ | 57/63 [00:23<00:02,  2.62it/s][A
 92%|█████████▏| 58/63 [00:23<00:01,  2.56it/s][A
 94%|█████████▎| 59/63 [00:23<00:01,  2.60it/s][A
 95%|█████████▌| 60/63 [00:24<00:01,  2.62it/s][A
 97%|█████████▋| 61/63 [00:24<00:00,  2.64it/s][A
 98%|█████████▊| 62/63 [00:25<00:00,  2.65it/s][A
100%|██████████| 63/63 [00:25<00:00,  2.67it/s][A                                                    
                                               [A 16%|█▌        | 200/1240 [28:53<2:18:47,  8.01s/it]
100%|██████████| 63/63 [00:25<00:00,  2.67it/s][A
                                               [A 16%|█▌        | 201/1240 [29:15<5:46:36, 20.02s/it] 16%|█▋        | 202/1240 [29:23<4:42:14, 16.31s/it] 16%|█▋        | 203/1240 [29:31<4:01:14, 13.96s/it] 16%|█▋        | 204/1240 [29:39<3:30:59, 12.22s/it] 17%|█▋        | 205/1240 [29:48<3:12:12, 11.14s/it] 17%|█▋        | 206/1240 [29:56<2:56:40, 10.25s/it] 17%|█▋        | 207/1240 [30:05<2:48:02,  9.76s/it] 17%|█▋        | 208/1240 [30:13<2:42:13,  9.43s/it] 17%|█▋        | 209/1240 [30:22<2:37:42,  9.18s/it] 17%|█▋        | 210/1240 [30:31<2:35:29,  9.06s/it]                                                     17%|█▋        | 210/1240 [30:31<2:35:29,  9.06s/it] 17%|█▋        | 211/1240 [30:39<2:29:50,  8.74s/it] 17%|█▋        | 212/1240 [30:47<2:29:03,  8.70s/it] 17%|█▋        | 213/1240 [30:56<2:27:53,  8.64s/it] 17%|█▋        | 214/1240 [31:05<2:29:12,  8.73s/it] 17%|█▋        | 215/1240 [31:17<2:47:56,  9.83s/it] 17%|█▋        | 216/1240 [31:26<2:43:42,  9.59s/it] 18%|█▊        | 217/1240 [31:35<2:41:22,  9.46s/it] 18%|█▊        | 218/1240 [31:44<2:36:45,  9.20s/it] 18%|█▊        | 219/1240 [31:52<2:29:53,  8.81s/it] 18%|█▊        | 220/1240 [32:00<2:26:26,  8.61s/it]                                                     18%|█▊        | 220/1240 [32:00<2:26:26,  8.61s/it] 18%|█▊        | 221/1240 [32:09<2:25:57,  8.59s/it] 18%|█▊        | 222/1240 [32:17<2:24:10,  8.50s/it] 18%|█▊        | 223/1240 [32:25<2:22:36,  8.41s/it] 18%|█▊        | 224/1240 [32:34<2:24:43,  8.55s/it] 18%|█▊        | 225/1240 [32:43<2:24:22,  8.53s/it] 18%|█▊        | 226/1240 [32:51<2:25:06,  8.59s/it] 18%|█▊        | 227/1240 [33:00<2:26:22,  8.67s/it] 18%|█▊        | 228/1240 [33:08<2:23:45,  8.52s/it] 18%|█▊        | 229/1240 [33:16<2:20:40,  8.35s/it] 19%|█▊        | 230/1240 [33:24<2:19:54,  8.31s/it]                                                     19%|█▊        | 230/1240 [33:24<2:19:54,  8.31s/it] 19%|█▊        | 231/1240 [33:33<2:23:23,  8.53s/it] 19%|█▊        | 232/1240 [33:42<2:22:09,  8.46s/it] 19%|█▉        | 233/1240 [33:50<2:22:04,  8.46s/it] 19%|█▉        | 234/1240 [33:59<2:23:00,  8.53s/it] 19%|█▉        | 235/1240 [34:07<2:22:20,  8.50s/it] 19%|█▉        | 236/1240 [34:16<2:21:11,  8.44s/it] 19%|█▉        | 237/1240 [34:24<2:18:55,  8.31s/it] 19%|█▉        | 238/1240 [34:33<2:21:51,  8.49s/it] 19%|█▉        | 239/1240 [34:41<2:22:46,  8.56s/it] 19%|█▉        | 240/1240 [34:49<2:19:58,  8.40s/it]                                                     19%|█▉        | 240/1240 [34:49<2:19:58,  8.40s/it] 19%|█▉        | 241/1240 [34:58<2:20:55,  8.46s/it] 20%|█▉        | 242/1240 [35:07<2:21:49,  8.53s/it] 20%|█▉        | 243/1240 [35:15<2:18:52,  8.36s/it] 20%|█▉        | 244/1240 [35:22<2:13:41,  8.05s/it] 20%|█▉        | 245/1240 [35:31<2:17:57,  8.32s/it] 20%|█▉        | 246/1240 [35:39<2:16:54,  8.26s/it] 20%|█▉        | 247/1240 [35:48<2:18:28,  8.37s/it] 20%|██        | 248/1240 [35:56<2:19:41,  8.45s/it] 20%|██        | 249/1240 [36:05<2:21:40,  8.58s/it] 20%|██        | 250/1240 [36:13<2:19:09,  8.43s/it]                                                     20%|██        | 250/1240 [36:13<2:19:09,  8.43s/it] 20%|██        | 251/1240 [36:22<2:21:38,  8.59s/it] 20%|██        | 252/1240 [36:31<2:22:29,  8.65s/it] 20%|██        | 253/1240 [36:40<2:22:02,  8.63s/it] 20%|██        | 254/1240 [36:48<2:21:38,  8.62s/it] 21%|██        | 255/1240 [36:56<2:20:10,  8.54s/it] 21%|██        | 256/1240 [37:05<2:19:11,  8.49s/it] 21%|██        | 257/1240 [37:14<2:20:31,  8.58s/it] 21%|██        | 258/1240 [37:23<2:22:23,  8.70s/it] 21%|██        | 259/1240 [37:31<2:22:18,  8.70s/it] 21%|██        | 260/1240 [37:40<2:21:27,  8.66s/it]                                                     21%|██        | 260/1240 [37:40<2:21:27,  8.66s/it] 21%|██        | 261/1240 [37:48<2:20:46,  8.63s/it] 21%|██        | 262/1240 [37:57<2:22:12,  8.72s/it] 21%|██        | 263/1240 [38:05<2:17:55,  8.47s/it] 21%|██▏       | 264/1240 [38:14<2:16:36,  8.40s/it] 21%|██▏       | 265/1240 [38:22<2:16:40,  8.41s/it] 21%|██▏       | 266/1240 [38:31<2:18:19,  8.52s/it] 22%|██▏       | 267/1240 [38:39<2:17:30,  8.48s/it] 22%|██▏       | 268/1240 [38:47<2:16:25,  8.42s/it] 22%|██▏       | 269/1240 [38:56<2:15:53,  8.40s/it] 22%|██▏       | 270/1240 [39:03<2:12:41,  8.21s/it]                                                     22%|██▏       | 270/1240 [39:04<2:12:41,  8.21s/it] 22%|██▏       | 271/1240 [39:11<2:10:22,  8.07s/it] 22%|██▏       | 272/1240 [39:20<2:12:10,  8.19s/it] 22%|██▏       | 273/1240 [39:27<2:09:43,  8.05s/it] 22%|██▏       | 274/1240 [39:36<2:09:51,  8.07s/it] 22%|██▏       | 275/1240 [39:44<2:11:05,  8.15s/it] 22%|██▏       | 276/1240 [39:52<2:09:27,  8.06s/it] 22%|██▏       | 277/1240 [40:01<2:12:54,  8.28s/it] 22%|██▏       | 278/1240 [40:09<2:13:31,  8.33s/it] 22%|██▎       | 279/1240 [40:18<2:16:04,  8.50s/it] 23%|██▎       | 280/1240 [40:25<2:11:08,  8.20s/it]                                                     23%|██▎       | 280/1240 [40:25<2:11:08,  8.20s/it] 23%|██▎       | 281/1240 [40:34<2:14:56,  8.44s/it] 23%|██▎       | 282/1240 [40:43<2:13:36,  8.37s/it] 23%|██▎       | 283/1240 [40:50<2:10:16,  8.17s/it] 23%|██▎       | 284/1240 [41:00<2:15:32,  8.51s/it] 23%|██▎       | 285/1240 [41:08<2:16:07,  8.55s/it] 23%|██▎       | 286/1240 [41:16<2:12:36,  8.34s/it] 23%|██▎       | 287/1240 [41:25<2:15:45,  8.55s/it] 23%|██▎       | 288/1240 [41:34<2:17:52,  8.69s/it] 23%|██▎       | 289/1240 [41:43<2:16:58,  8.64s/it] 23%|██▎       | 290/1240 [41:51<2:14:14,  8.48s/it]                                                     23%|██▎       | 290/1240 [41:51<2:14:14,  8.48s/it] 23%|██▎       | 291/1240 [41:59<2:12:15,  8.36s/it] 24%|██▎       | 292/1240 [42:07<2:12:09,  8.36s/it] 24%|██▎       | 293/1240 [42:16<2:12:07,  8.37s/it] 24%|██▎       | 294/1240 [42:25<2:15:18,  8.58s/it] 24%|██▍       | 295/1240 [42:32<2:11:16,  8.33s/it] 24%|██▍       | 296/1240 [42:41<2:12:07,  8.40s/it] 24%|██▍       | 297/1240 [42:49<2:11:20,  8.36s/it] 24%|██▍       | 298/1240 [42:58<2:12:16,  8.42s/it] 24%|██▍       | 299/1240 [43:06<2:10:19,  8.31s/it] 24%|██▍       | 300/1240 [43:15<2:14:21,  8.58s/it]                                                     24%|██▍       | 300/1240 [43:15<2:14:21,  8.58s/it] 24%|██▍       | 301/1240 [43:23<2:10:00,  8.31s/it] 24%|██▍       | 302/1240 [43:31<2:10:32,  8.35s/it] 24%|██▍       | 303/1240 [43:40<2:13:24,  8.54s/it] 25%|██▍       | 304/1240 [43:49<2:14:58,  8.65s/it] 25%|██▍       | 305/1240 [43:58<2:15:17,  8.68s/it] 25%|██▍       | 306/1240 [44:06<2:14:06,  8.62s/it] 25%|██▍       | 307/1240 [44:20<2:36:19, 10.05s/it] 25%|██▍       | 308/1240 [44:28<2:28:21,  9.55s/it] 25%|██▍       | 309/1240 [44:37<2:25:10,  9.36s/it] 25%|██▌       | 310/1240 [44:46<2:21:25,  9.12s/it]                                                     25%|██▌       | 310/1240 [44:46<2:21:25,  9.12s/it] 25%|██▌       | 311/1240 [44:54<2:20:18,  9.06s/it] 25%|██▌       | 312/1240 [45:03<2:18:46,  8.97s/it] 25%|██▌       | 313/1240 [45:12<2:16:34,  8.84s/it] 25%|██▌       | 314/1240 [45:21<2:15:54,  8.81s/it] 25%|██▌       | 315/1240 [45:28<2:11:42,  8.54s/it] 25%|██▌       | 316/1240 [45:37<2:11:35,  8.55s/it] 26%|██▌       | 317/1240 [45:46<2:12:09,  8.59s/it] 26%|██▌       | 318/1240 [45:54<2:09:34,  8.43s/it] 26%|██▌       | 319/1240 [46:02<2:09:12,  8.42s/it] 26%|██▌       | 320/1240 [46:10<2:08:31,  8.38s/it]                                                     26%|██▌       | 320/1240 [46:10<2:08:31,  8.38s/it] 26%|██▌       | 321/1240 [46:19<2:09:20,  8.44s/it] 26%|██▌       | 322/1240 [46:28<2:12:08,  8.64s/it] 26%|██▌       | 323/1240 [46:37<2:13:27,  8.73s/it] 26%|██▌       | 324/1240 [46:45<2:11:09,  8.59s/it] 26%|██▌       | 325/1240 [46:54<2:09:37,  8.50s/it] 26%|██▋       | 326/1240 [47:02<2:07:24,  8.36s/it] 26%|██▋       | 327/1240 [47:11<2:09:30,  8.51s/it] 26%|██▋       | 328/1240 [47:18<2:06:18,  8.31s/it] 27%|██▋       | 329/1240 [47:27<2:09:26,  8.53s/it] 27%|██▋       | 330/1240 [47:35<2:07:09,  8.38s/it]                                                     27%|██▋       | 330/1240 [47:35<2:07:09,  8.38s/it] 27%|██▋       | 331/1240 [47:44<2:06:07,  8.33s/it] 27%|██▋       | 332/1240 [47:52<2:06:56,  8.39s/it] 27%|██▋       | 333/1240 [48:01<2:07:37,  8.44s/it] 27%|██▋       | 334/1240 [48:09<2:04:57,  8.27s/it] 27%|██▋       | 335/1240 [48:16<2:02:53,  8.15s/it] 27%|██▋       | 336/1240 [48:24<2:00:03,  7.97s/it] 27%|██▋       | 337/1240 [48:33<2:03:47,  8.23s/it] 27%|██▋       | 338/1240 [48:41<2:05:08,  8.32s/it] 27%|██▋       | 339/1240 [48:50<2:05:48,  8.38s/it] 27%|██▋       | 340/1240 [48:58<2:06:17,  8.42s/it]                                                     27%|██▋       | 340/1240 [48:58<2:06:17,  8.42s/it] 28%|██▊       | 341/1240 [49:07<2:07:32,  8.51s/it] 28%|██▊       | 342/1240 [49:16<2:09:32,  8.66s/it] 28%|██▊       | 343/1240 [49:24<2:07:28,  8.53s/it] 28%|██▊       | 344/1240 [49:33<2:09:28,  8.67s/it] 28%|██▊       | 345/1240 [49:42<2:08:28,  8.61s/it] 28%|██▊       | 346/1240 [49:51<2:10:11,  8.74s/it] 28%|██▊       | 347/1240 [50:00<2:10:54,  8.80s/it] 28%|██▊       | 348/1240 [50:08<2:07:45,  8.59s/it] 28%|██▊       | 349/1240 [50:16<2:07:06,  8.56s/it] 28%|██▊       | 350/1240 [50:25<2:06:27,  8.53s/it]                                                     28%|██▊       | 350/1240 [50:25<2:06:27,  8.53s/it] 28%|██▊       | 351/1240 [50:33<2:06:27,  8.53s/it] 28%|██▊       | 352/1240 [50:41<2:03:07,  8.32s/it] 28%|██▊       | 353/1240 [50:49<2:00:45,  8.17s/it] 29%|██▊       | 354/1240 [50:58<2:04:32,  8.43s/it] 29%|██▊       | 355/1240 [51:06<2:03:10,  8.35s/it] 29%|██▊       | 356/1240 [51:15<2:03:52,  8.41s/it] 29%|██▉       | 357/1240 [51:24<2:06:27,  8.59s/it] 29%|██▉       | 358/1240 [51:32<2:05:55,  8.57s/it] 29%|██▉       | 359/1240 [51:41<2:07:40,  8.70s/it] 29%|██▉       | 360/1240 [51:49<2:04:15,  8.47s/it]                                                     29%|██▉       | 360/1240 [51:49<2:04:15,  8.47s/it] 29%|██▉       | 361/1240 [51:58<2:04:24,  8.49s/it] 29%|██▉       | 362/1240 [52:06<2:03:50,  8.46s/it] 29%|██▉       | 363/1240 [52:14<2:02:12,  8.36s/it] 29%|██▉       | 364/1240 [52:22<2:01:12,  8.30s/it] 29%|██▉       | 365/1240 [52:31<2:02:38,  8.41s/it] 30%|██▉       | 366/1240 [52:40<2:03:54,  8.51s/it] 30%|██▉       | 367/1240 [52:49<2:04:27,  8.55s/it] 30%|██▉       | 368/1240 [52:57<2:05:55,  8.66s/it] 30%|██▉       | 369/1240 [53:06<2:05:12,  8.63s/it] 30%|██▉       | 370/1240 [53:14<2:03:34,  8.52s/it]                                                     30%|██▉       | 370/1240 [53:14<2:03:34,  8.52s/it] 30%|██▉       | 371/1240 [53:23<2:04:24,  8.59s/it] 30%|███       | 372/1240 [53:32<2:04:43,  8.62s/it] 30%|███       | 373/1240 [53:40<2:03:04,  8.52s/it] 30%|███       | 374/1240 [53:48<2:01:42,  8.43s/it] 30%|███       | 375/1240 [53:57<2:03:21,  8.56s/it] 30%|███       | 376/1240 [54:06<2:03:12,  8.56s/it] 30%|███       | 377/1240 [54:14<2:02:49,  8.54s/it] 30%|███       | 378/1240 [54:23<2:03:21,  8.59s/it] 31%|███       | 379/1240 [54:31<2:00:22,  8.39s/it] 31%|███       | 380/1240 [54:39<1:59:46,  8.36s/it]                                                     31%|███       | 380/1240 [54:39<1:59:46,  8.36s/it] 31%|███       | 381/1240 [54:47<1:58:54,  8.31s/it] 31%|███       | 382/1240 [54:56<1:59:01,  8.32s/it] 31%|███       | 383/1240 [55:03<1:56:14,  8.14s/it] 31%|███       | 384/1240 [55:12<1:58:26,  8.30s/it] 31%|███       | 385/1240 [55:20<1:58:41,  8.33s/it] 31%|███       | 386/1240 [55:28<1:55:48,  8.14s/it] 31%|███       | 387/1240 [55:36<1:55:45,  8.14s/it] 31%|███▏      | 388/1240 [55:45<1:56:40,  8.22s/it] 31%|███▏      | 389/1240 [55:53<1:59:15,  8.41s/it] 31%|███▏      | 390/1240 [56:01<1:57:12,  8.27s/it]                                                     31%|███▏      | 390/1240 [56:01<1:57:12,  8.27s/it] 32%|███▏      | 391/1240 [56:09<1:53:02,  7.99s/it] 32%|███▏      | 392/1240 [56:17<1:54:19,  8.09s/it] 32%|███▏      | 393/1240 [56:26<1:55:44,  8.20s/it] 32%|███▏      | 394/1240 [56:34<1:54:57,  8.15s/it] 32%|███▏      | 395/1240 [56:42<1:55:59,  8.24s/it] 32%|███▏      | 396/1240 [56:50<1:55:10,  8.19s/it] 32%|███▏      | 397/1240 [57:04<2:19:30,  9.93s/it] 32%|███▏      | 398/1240 [57:12<2:11:35,  9.38s/it] 32%|███▏      | 399/1240 [57:20<2:05:59,  8.99s/it] 32%|███▏      | 400/1240 [57:29<2:03:36,  8.83s/it]                                                     32%|███▏      | 400/1240 [57:29<2:03:36,  8.83s/it]{'eval_loss': 0.38234445452690125, 'eval_runtime': 25.9571, 'eval_samples_per_second': 9.593, 'eval_steps_per_second': 2.427, 'eval_rewards/chosen': -17.55447006225586, 'eval_rewards/rejected': -28.993553161621094, 'eval_rewards/accuracies': 0.8055555820465088, 'eval_rewards/margins': 11.439083099365234, 'eval_logps/rejected': -535.0709228515625, 'eval_logps/chosen': -518.3172607421875, 'eval_logits/rejected': -15.633034706115723, 'eval_logits/chosen': -7.60260009765625, 'epoch': 3.23}
{'loss': 0.0997, 'grad_norm': 0.5700787901878357, 'learning_rate': 0.00019231122549115854, 'rewards/chosen': -11.497681617736816, 'rewards/rejected': -22.021793365478516, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 10.5241117477417, 'logps/rejected': -435.4384765625, 'logps/chosen': -385.40081787109375, 'logits/rejected': -1.366500735282898, 'logits/chosen': 5.028443813323975, 'epoch': 3.39}
{'loss': 0.0988, 'grad_norm': 1.453459620475769, 'learning_rate': 0.00019125302228327194, 'rewards/chosen': -14.50446605682373, 'rewards/rejected': -25.794754028320312, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 11.290287971496582, 'logps/rejected': -483.05609130859375, 'logps/chosen': -431.48321533203125, 'logits/rejected': -1.8461393117904663, 'logits/chosen': 3.4690513610839844, 'epoch': 3.55}
{'loss': 0.0727, 'grad_norm': 0.21781602501869202, 'learning_rate': 0.0001901299211698064, 'rewards/chosen': -13.301785469055176, 'rewards/rejected': -26.258129119873047, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 12.956342697143555, 'logps/rejected': -472.5775451660156, 'logps/chosen': -407.89862060546875, 'logits/rejected': -3.7025890350341797, 'logits/chosen': 3.4618568420410156, 'epoch': 3.71}
{'loss': 0.0991, 'grad_norm': 2.0671210289001465, 'learning_rate': 0.00018894272088496486, 'rewards/chosen': -15.074819564819336, 'rewards/rejected': -30.069137573242188, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 14.994318008422852, 'logps/rejected': -528.0079345703125, 'logps/chosen': -436.74237060546875, 'logits/rejected': -5.3600897789001465, 'logits/chosen': 2.7669570446014404, 'epoch': 3.87}
{'loss': 0.1185, 'grad_norm': 1.853721261024475, 'learning_rate': 0.00018769226574940725, 'rewards/chosen': -16.75575065612793, 'rewards/rejected': -29.56661033630371, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 12.810861587524414, 'logps/rejected': -512.9085693359375, 'logps/chosen': -443.8990783691406, 'logits/rejected': -6.783185005187988, 'logits/chosen': 0.36101263761520386, 'epoch': 4.03}
{'loss': 0.0983, 'grad_norm': 0.6708369255065918, 'learning_rate': 0.00018637944506978094, 'rewards/chosen': -16.02663803100586, 'rewards/rejected': -27.360671997070312, 'rewards/accuracies': 0.953125, 'rewards/margins': 11.33403205871582, 'logps/rejected': -492.160400390625, 'logps/chosen': -438.0408630371094, 'logits/rejected': -3.85504150390625, 'logits/chosen': 3.237351655960083, 'epoch': 4.19}
{'loss': 0.0913, 'grad_norm': 0.992551326751709, 'learning_rate': 0.00018500519250625832, 'rewards/chosen': -13.271960258483887, 'rewards/rejected': -28.252843856811523, 'rewards/accuracies': 0.96875, 'rewards/margins': 14.980883598327637, 'logps/rejected': -503.24139404296875, 'logps/chosen': -408.5951232910156, 'logits/rejected': -4.462699890136719, 'logits/chosen': 3.6618568897247314, 'epoch': 4.35}
{'loss': 0.0816, 'grad_norm': 0.9596034288406372, 'learning_rate': 0.00018357048540853005, 'rewards/chosen': -12.369050025939941, 'rewards/rejected': -28.653100967407227, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 16.2840518951416, 'logps/rejected': -514.3565673828125, 'logps/chosen': -414.1253356933594, 'logits/rejected': -5.486886024475098, 'logits/chosen': 2.8253495693206787, 'epoch': 4.52}
{'loss': 0.0777, 'grad_norm': 1.5447107553482056, 'learning_rate': 0.00018207634412072764, 'rewards/chosen': -14.223304748535156, 'rewards/rejected': -29.2342529296875, 'rewards/accuracies': 0.96875, 'rewards/margins': 15.010948181152344, 'logps/rejected': -501.6802673339844, 'logps/chosen': -409.7898864746094, 'logits/rejected': -4.5027642250061035, 'logits/chosen': 2.845364809036255, 'epoch': 4.68}
{'loss': 0.0943, 'grad_norm': 0.17320303618907928, 'learning_rate': 0.00018052383125576833, 'rewards/chosen': -15.169492721557617, 'rewards/rejected': -29.34867286682129, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 14.179182052612305, 'logps/rejected': -515.9950561523438, 'logps/chosen': -435.23553466796875, 'logits/rejected': -4.497859477996826, 'logits/chosen': 2.878347396850586, 'epoch': 4.84}
{'loss': 0.0678, 'grad_norm': 0.3165196180343628, 'learning_rate': 0.00017891405093963938, 'rewards/chosen': -12.696718215942383, 'rewards/rejected': -23.94089698791504, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 11.24417781829834, 'logps/rejected': -454.0594787597656, 'logps/chosen': -401.57281494140625, 'logits/rejected': -1.2071311473846436, 'logits/chosen': 5.945213317871094, 'epoch': 5.0}
{'loss': 0.0751, 'grad_norm': 0.5408920049667358, 'learning_rate': 0.0001772481480261587, 'rewards/chosen': -17.734230041503906, 'rewards/rejected': -32.37303161621094, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 14.638798713684082, 'logps/rejected': -541.60302734375, 'logps/chosen': -460.4234313964844, 'logits/rejected': -4.526125907897949, 'logits/chosen': 3.3409194946289062, 'epoch': 5.16}
{'loss': 0.0849, 'grad_norm': 0.7498894929885864, 'learning_rate': 0.00017552730728277052, 'rewards/chosen': -21.644733428955078, 'rewards/rejected': -37.866798400878906, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 16.22205924987793, 'logps/rejected': -587.7236938476562, 'logps/chosen': -491.30987548828125, 'logits/rejected': -4.946957588195801, 'logits/chosen': 2.628681182861328, 'epoch': 5.32}
{'loss': 0.0508, 'grad_norm': 1.90732741355896, 'learning_rate': 0.00017375275254795472, 'rewards/chosen': -19.928852081298828, 'rewards/rejected': -35.59702682495117, 'rewards/accuracies': 0.984375, 'rewards/margins': 15.668176651000977, 'logps/rejected': -580.3587646484375, 'logps/chosen': -476.5947265625, 'logits/rejected': -2.7238945960998535, 'logits/chosen': 3.234973907470703, 'epoch': 5.48}
{'loss': 0.0493, 'grad_norm': 0.894252598285675, 'learning_rate': 0.0001719257458608498, 'rewards/chosen': -18.51212501525879, 'rewards/rejected': -37.53959274291992, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 19.0274715423584, 'logps/rejected': -599.1204223632812, 'logps/chosen': -472.00872802734375, 'logits/rejected': -2.0882534980773926, 'logits/chosen': 5.393105983734131, 'epoch': 5.65}
{'loss': 0.0686, 'grad_norm': 2.68717360496521, 'learning_rate': 0.0001700475865637077, 'rewards/chosen': -17.417348861694336, 'rewards/rejected': -33.861488342285156, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 16.444137573242188, 'logps/rejected': -553.6470336914062, 'logps/chosen': -449.9571228027344, 'logits/rejected': -0.9488212466239929, 'logits/chosen': 6.1977219581604, 'epoch': 5.81}
{'loss': 0.055, 'grad_norm': 1.5938349962234497, 'learning_rate': 0.00016811961037781935, 'rewards/chosen': -23.883047103881836, 'rewards/rejected': -41.10112762451172, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 17.218080520629883, 'logps/rejected': -628.4114990234375, 'logps/chosen': -506.5999450683594, 'logits/rejected': -4.870831489562988, 'logits/chosen': 2.3617286682128906, 'epoch': 5.97}
{'loss': 0.0754, 'grad_norm': 2.8214914798736572, 'learning_rate': 0.00016614318845356802, 'rewards/chosen': -28.353633880615234, 'rewards/rejected': -51.851097106933594, 'rewards/accuracies': 0.96875, 'rewards/margins': 23.497467041015625, 'logps/rejected': -746.9857177734375, 'logps/chosen': -573.20654296875, 'logits/rejected': -6.6489081382751465, 'logits/chosen': 2.3747928142547607, 'epoch': 6.13}
{'loss': 0.0572, 'grad_norm': 0.010561482049524784, 'learning_rate': 0.00016411972639528553, 'rewards/chosen': -26.806625366210938, 'rewards/rejected': -49.83728790283203, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 23.03066062927246, 'logps/rejected': -715.3238525390625, 'logps/chosen': -540.5076904296875, 'logits/rejected': -7.745537757873535, 'logits/chosen': 0.9515959024429321, 'epoch': 6.29}
{'loss': 0.0799, 'grad_norm': 0.7864291667938232, 'learning_rate': 0.00016205066326160607, 'rewards/chosen': -21.427282333374023, 'rewards/rejected': -38.771141052246094, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 17.34385871887207, 'logps/rejected': -603.9884643554688, 'logps/chosen': -491.46923828125, 'logits/rejected': -3.8536505699157715, 'logits/chosen': 4.473942756652832, 'epoch': 6.45}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:11,  5.39it/s][A
  5%|▍         | 3/63 [00:00<00:17,  3.49it/s][A
  6%|▋         | 4/63 [00:01<00:20,  2.95it/s][A
  8%|▊         | 5/63 [00:01<00:21,  2.66it/s][A
 10%|▉         | 6/63 [00:02<00:23,  2.45it/s][A
 11%|█         | 7/63 [00:02<00:24,  2.32it/s][A
 13%|█▎        | 8/63 [00:03<00:23,  2.29it/s][A
 14%|█▍        | 9/63 [00:03<00:22,  2.41it/s][A
 16%|█▌        | 10/63 [00:03<00:22,  2.32it/s][A
 17%|█▋        | 11/63 [00:04<00:22,  2.27it/s][A
 19%|█▉        | 12/63 [00:04<00:22,  2.27it/s][A
 21%|██        | 13/63 [00:05<00:20,  2.40it/s][A
 22%|██▏       | 14/63 [00:05<00:21,  2.31it/s][A
 24%|██▍       | 15/63 [00:06<00:21,  2.29it/s][A
 25%|██▌       | 16/63 [00:06<00:20,  2.27it/s][A
 27%|██▋       | 17/63 [00:06<00:19,  2.40it/s][A
 29%|██▊       | 18/63 [00:07<00:18,  2.50it/s][A
 30%|███       | 19/63 [00:07<00:17,  2.56it/s][A
 32%|███▏      | 20/63 [00:08<00:17,  2.47it/s][A
 33%|███▎      | 21/63 [00:08<00:16,  2.54it/s][A
 35%|███▍      | 22/63 [00:08<00:17,  2.39it/s][A
 37%|███▋      | 23/63 [00:09<00:17,  2.30it/s][A
 38%|███▊      | 24/63 [00:09<00:17,  2.26it/s][A
 40%|███▉      | 25/63 [00:10<00:17,  2.23it/s][A
 41%|████▏     | 26/63 [00:10<00:16,  2.19it/s][A
 43%|████▎     | 27/63 [00:11<00:16,  2.16it/s][A
 44%|████▍     | 28/63 [00:11<00:16,  2.13it/s][A
 46%|████▌     | 29/63 [00:12<00:14,  2.28it/s][A
 48%|████▊     | 30/63 [00:12<00:13,  2.40it/s][A
 49%|████▉     | 31/63 [00:12<00:12,  2.49it/s][A
 51%|█████     | 32/63 [00:13<00:12,  2.55it/s][A
 52%|█████▏    | 33/63 [00:13<00:11,  2.60it/s][A
 54%|█████▍    | 34/63 [00:14<00:11,  2.48it/s][A
 56%|█████▌    | 35/63 [00:14<00:11,  2.47it/s][A
 57%|█████▋    | 36/63 [00:14<00:10,  2.54it/s][A
 59%|█████▊    | 37/63 [00:15<00:09,  2.61it/s][A
 60%|██████    | 38/63 [00:15<00:09,  2.62it/s][A
 62%|██████▏   | 39/63 [00:16<00:09,  2.44it/s][A
 63%|██████▎   | 40/63 [00:16<00:09,  2.33it/s][A
 65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s][A
 67%|██████▋   | 42/63 [00:17<00:08,  2.48it/s][A
 68%|██████▊   | 43/63 [00:17<00:07,  2.54it/s][A
 70%|██████▉   | 44/63 [00:17<00:07,  2.60it/s][A
 71%|███████▏  | 45/63 [00:18<00:06,  2.64it/s][A
 73%|███████▎  | 46/63 [00:18<00:06,  2.67it/s][A
 75%|███████▍  | 47/63 [00:19<00:05,  2.69it/s][A
 76%|███████▌  | 48/63 [00:19<00:05,  2.69it/s][A
 78%|███████▊  | 49/63 [00:19<00:05,  2.70it/s][A
 79%|███████▉  | 50/63 [00:20<00:05,  2.49it/s][A
 81%|████████  | 51/63 [00:20<00:04,  2.53it/s][A
 83%|████████▎ | 52/63 [00:21<00:04,  2.39it/s][A
 84%|████████▍ | 53/63 [00:21<00:04,  2.49it/s][A
 86%|████████▌ | 54/63 [00:21<00:03,  2.55it/s][A
 87%|████████▋ | 55/63 [00:22<00:03,  2.61it/s][A
 89%|████████▉ | 56/63 [00:22<00:02,  2.64it/s][A
 90%|█████████ | 57/63 [00:23<00:02,  2.59it/s][A
 92%|█████████▏| 58/63 [00:23<00:01,  2.54it/s][A
 94%|█████████▎| 59/63 [00:23<00:01,  2.60it/s][A
 95%|█████████▌| 60/63 [00:24<00:01,  2.64it/s][A
 97%|█████████▋| 61/63 [00:24<00:00,  2.66it/s][A
 98%|█████████▊| 62/63 [00:24<00:00,  2.69it/s][A
100%|██████████| 63/63 [00:25<00:00,  2.72it/s][A                                                    
                                               [A 32%|███▏      | 400/1240 [57:54<2:03:36,  8.83s/it]
100%|██████████| 63/63 [00:25<00:00,  2.72it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
 32%|███▏      | 401/1240 [58:07<4:05:35, 17.56s/it] 32%|███▏      | 402/1240 [58:15<3:27:51, 14.88s/it] 32%|███▎      | 403/1240 [58:24<3:01:09, 12.99s/it] 33%|███▎      | 404/1240 [58:32<2:41:23, 11.58s/it] 33%|███▎      | 405/1240 [58:41<2:29:13, 10.72s/it] 33%|███▎      | 406/1240 [58:50<2:21:52, 10.21s/it] 33%|███▎      | 407/1240 [58:59<2:15:15,  9.74s/it] 33%|███▎      | 408/1240 [59:07<2:10:02,  9.38s/it] 33%|███▎      | 409/1240 [59:16<2:08:30,  9.28s/it] 33%|███▎      | 410/1240 [59:24<2:04:43,  9.02s/it]                                                     33%|███▎      | 410/1240 [59:25<2:04:43,  9.02s/it] 33%|███▎      | 411/1240 [59:33<2:03:46,  8.96s/it] 33%|███▎      | 412/1240 [59:42<2:02:16,  8.86s/it] 33%|███▎      | 413/1240 [59:51<2:02:18,  8.87s/it] 33%|███▎      | 414/1240 [1:00:00<2:02:26,  8.89s/it] 33%|███▎      | 415/1240 [1:00:09<2:01:49,  8.86s/it] 34%|███▎      | 416/1240 [1:00:17<2:00:29,  8.77s/it] 34%|███▎      | 417/1240 [1:00:26<2:01:07,  8.83s/it] 34%|███▎      | 418/1240 [1:00:35<1:59:40,  8.74s/it] 34%|███▍      | 419/1240 [1:00:43<1:56:02,  8.48s/it] 34%|███▍      | 420/1240 [1:00:51<1:56:41,  8.54s/it]                                                       34%|███▍      | 420/1240 [1:00:51<1:56:41,  8.54s/it] 34%|███▍      | 421/1240 [1:01:00<1:57:25,  8.60s/it] 34%|███▍      | 422/1240 [1:01:08<1:53:40,  8.34s/it] 34%|███▍      | 423/1240 [1:01:16<1:55:09,  8.46s/it] 34%|███▍      | 424/1240 [1:01:25<1:56:04,  8.54s/it] 34%|███▍      | 425/1240 [1:01:45<2:40:31, 11.82s/it] 34%|███▍      | 426/1240 [1:01:53<2:27:39, 10.88s/it] 34%|███▍      | 427/1240 [1:02:06<2:35:26, 11.47s/it] 35%|███▍      | 428/1240 [1:02:15<2:25:04, 10.72s/it] 35%|███▍      | 429/1240 [1:02:24<2:16:13, 10.08s/it] 35%|███▍      | 430/1240 [1:02:32<2:08:00,  9.48s/it]                                                       35%|███▍      | 430/1240 [1:02:32<2:08:00,  9.48s/it] 35%|███▍      | 431/1240 [1:02:40<2:01:48,  9.03s/it] 35%|███▍      | 432/1240 [1:02:48<1:59:58,  8.91s/it] 35%|███▍      | 433/1240 [1:02:57<1:59:09,  8.86s/it] 35%|███▌      | 434/1240 [1:03:05<1:56:37,  8.68s/it] 35%|███▌      | 435/1240 [1:03:14<1:55:05,  8.58s/it] 35%|███▌      | 436/1240 [1:03:22<1:55:25,  8.61s/it] 35%|███▌      | 437/1240 [1:03:31<1:55:47,  8.65s/it] 35%|███▌      | 438/1240 [1:03:40<1:54:25,  8.56s/it] 35%|███▌      | 439/1240 [1:03:48<1:55:29,  8.65s/it] 35%|███▌      | 440/1240 [1:03:57<1:56:41,  8.75s/it]                                                       35%|███▌      | 440/1240 [1:03:57<1:56:41,  8.75s/it] 36%|███▌      | 441/1240 [1:04:06<1:56:33,  8.75s/it] 36%|███▌      | 442/1240 [1:04:15<1:55:20,  8.67s/it] 36%|███▌      | 443/1240 [1:04:24<1:56:28,  8.77s/it] 36%|███▌      | 444/1240 [1:04:32<1:54:16,  8.61s/it] 36%|███▌      | 445/1240 [1:04:40<1:51:40,  8.43s/it] 36%|███▌      | 446/1240 [1:04:48<1:52:20,  8.49s/it] 36%|███▌      | 447/1240 [1:04:56<1:49:14,  8.27s/it] 36%|███▌      | 448/1240 [1:05:05<1:51:50,  8.47s/it] 36%|███▌      | 449/1240 [1:05:13<1:50:39,  8.39s/it] 36%|███▋      | 450/1240 [1:05:22<1:49:31,  8.32s/it]                                                       36%|███▋      | 450/1240 [1:05:22<1:49:31,  8.32s/it] 36%|███▋      | 451/1240 [1:05:30<1:48:25,  8.24s/it] 36%|███▋      | 452/1240 [1:05:37<1:46:17,  8.09s/it] 37%|███▋      | 453/1240 [1:05:46<1:49:43,  8.36s/it] 37%|███▋      | 454/1240 [1:05:55<1:52:03,  8.55s/it] 37%|███▋      | 455/1240 [1:06:04<1:52:11,  8.57s/it] 37%|███▋      | 456/1240 [1:06:13<1:52:04,  8.58s/it] 37%|███▋      | 457/1240 [1:06:20<1:48:10,  8.29s/it] 37%|███▋      | 458/1240 [1:06:29<1:48:43,  8.34s/it] 37%|███▋      | 459/1240 [1:06:37<1:48:11,  8.31s/it] 37%|███▋      | 460/1240 [1:06:46<1:50:03,  8.47s/it]                                                       37%|███▋      | 460/1240 [1:06:46<1:50:03,  8.47s/it] 37%|███▋      | 461/1240 [1:06:55<1:52:11,  8.64s/it] 37%|███▋      | 462/1240 [1:07:03<1:50:52,  8.55s/it] 37%|███▋      | 463/1240 [1:07:11<1:49:10,  8.43s/it] 37%|███▋      | 464/1240 [1:07:19<1:47:02,  8.28s/it] 38%|███▊      | 465/1240 [1:07:27<1:45:31,  8.17s/it] 38%|███▊      | 466/1240 [1:07:34<1:42:24,  7.94s/it] 38%|███▊      | 467/1240 [1:07:43<1:46:17,  8.25s/it] 38%|███▊      | 468/1240 [1:07:50<1:41:18,  7.87s/it] 38%|███▊      | 469/1240 [1:07:59<1:44:04,  8.10s/it] 38%|███▊      | 470/1240 [1:08:07<1:45:09,  8.19s/it]                                                       38%|███▊      | 470/1240 [1:08:07<1:45:09,  8.19s/it] 38%|███▊      | 471/1240 [1:08:16<1:46:06,  8.28s/it] 38%|███▊      | 472/1240 [1:08:24<1:46:03,  8.29s/it] 38%|███▊      | 473/1240 [1:08:33<1:46:26,  8.33s/it] 38%|███▊      | 474/1240 [1:08:41<1:46:28,  8.34s/it] 38%|███▊      | 475/1240 [1:08:49<1:44:43,  8.21s/it] 38%|███▊      | 476/1240 [1:08:57<1:43:32,  8.13s/it] 38%|███▊      | 477/1240 [1:09:05<1:43:17,  8.12s/it] 39%|███▊      | 478/1240 [1:09:13<1:42:33,  8.08s/it] 39%|███▊      | 479/1240 [1:09:21<1:43:44,  8.18s/it] 39%|███▊      | 480/1240 [1:09:30<1:43:22,  8.16s/it]                                                       39%|███▊      | 480/1240 [1:09:30<1:43:22,  8.16s/it] 39%|███▉      | 481/1240 [1:09:38<1:43:53,  8.21s/it] 39%|███▉      | 482/1240 [1:09:46<1:45:08,  8.32s/it] 39%|███▉      | 483/1240 [1:09:55<1:46:45,  8.46s/it] 39%|███▉      | 484/1240 [1:10:04<1:48:40,  8.62s/it] 39%|███▉      | 485/1240 [1:10:13<1:48:46,  8.64s/it] 39%|███▉      | 486/1240 [1:10:22<1:48:45,  8.65s/it] 39%|███▉      | 487/1240 [1:10:30<1:48:49,  8.67s/it] 39%|███▉      | 488/1240 [1:10:39<1:47:32,  8.58s/it] 39%|███▉      | 489/1240 [1:10:47<1:45:37,  8.44s/it] 40%|███▉      | 490/1240 [1:10:55<1:43:55,  8.31s/it]                                                       40%|███▉      | 490/1240 [1:10:55<1:43:55,  8.31s/it] 40%|███▉      | 491/1240 [1:11:03<1:42:35,  8.22s/it] 40%|███▉      | 492/1240 [1:11:11<1:43:31,  8.30s/it] 40%|███▉      | 493/1240 [1:11:20<1:45:18,  8.46s/it] 40%|███▉      | 494/1240 [1:11:29<1:46:44,  8.58s/it] 40%|███▉      | 495/1240 [1:11:38<1:48:22,  8.73s/it] 40%|████      | 496/1240 [1:11:47<1:49:12,  8.81s/it] 40%|████      | 497/1240 [1:11:56<1:48:12,  8.74s/it] 40%|████      | 498/1240 [1:12:04<1:46:01,  8.57s/it] 40%|████      | 499/1240 [1:12:12<1:46:10,  8.60s/it] 40%|████      | 500/1240 [1:12:21<1:45:42,  8.57s/it]                                                       40%|████      | 500/1240 [1:12:21<1:45:42,  8.57s/it] 40%|████      | 501/1240 [1:12:29<1:42:25,  8.32s/it] 40%|████      | 502/1240 [1:12:37<1:42:38,  8.34s/it] 41%|████      | 503/1240 [1:12:45<1:40:59,  8.22s/it] 41%|████      | 504/1240 [1:12:53<1:41:35,  8.28s/it] 41%|████      | 505/1240 [1:13:02<1:43:23,  8.44s/it] 41%|████      | 506/1240 [1:13:10<1:42:05,  8.35s/it] 41%|████      | 507/1240 [1:13:19<1:42:25,  8.38s/it] 41%|████      | 508/1240 [1:13:33<2:01:54,  9.99s/it] 41%|████      | 509/1240 [1:13:40<1:52:11,  9.21s/it] 41%|████      | 510/1240 [1:13:49<1:51:16,  9.15s/it]                                                       41%|████      | 510/1240 [1:13:54<1:51:16,  9.15s/it] 41%|████      | 511/1240 [1:14:02<2:06:54, 10.45s/it] 41%|████▏     | 512/1240 [1:14:10<1:55:31,  9.52s/it] 41%|████▏     | 513/1240 [1:14:18<1:50:23,  9.11s/it] 41%|████▏     | 514/1240 [1:14:26<1:47:42,  8.90s/it] 42%|████▏     | 515/1240 [1:14:35<1:46:58,  8.85s/it] 42%|████▏     | 516/1240 [1:14:43<1:44:06,  8.63s/it] 42%|████▏     | 517/1240 [1:14:52<1:45:24,  8.75s/it] 42%|████▏     | 518/1240 [1:15:01<1:45:59,  8.81s/it] 42%|████▏     | 519/1240 [1:15:09<1:43:45,  8.63s/it] 42%|████▏     | 520/1240 [1:15:18<1:43:21,  8.61s/it]                                                       42%|████▏     | 520/1240 [1:15:18<1:43:21,  8.61s/it] 42%|████▏     | 521/1240 [1:15:27<1:43:19,  8.62s/it] 42%|████▏     | 522/1240 [1:15:35<1:42:36,  8.57s/it] 42%|████▏     | 523/1240 [1:15:44<1:43:27,  8.66s/it] 42%|████▏     | 524/1240 [1:15:52<1:41:38,  8.52s/it] 42%|████▏     | 525/1240 [1:16:01<1:41:13,  8.49s/it] 42%|████▏     | 526/1240 [1:16:09<1:41:30,  8.53s/it] 42%|████▎     | 527/1240 [1:16:18<1:42:11,  8.60s/it] 43%|████▎     | 528/1240 [1:16:26<1:41:30,  8.55s/it] 43%|████▎     | 529/1240 [1:16:35<1:41:29,  8.57s/it] 43%|████▎     | 530/1240 [1:16:44<1:41:09,  8.55s/it]                                                       43%|████▎     | 530/1240 [1:16:44<1:41:09,  8.55s/it] 43%|████▎     | 531/1240 [1:16:52<1:40:39,  8.52s/it] 43%|████▎     | 532/1240 [1:17:01<1:42:15,  8.67s/it] 43%|████▎     | 533/1240 [1:17:10<1:41:42,  8.63s/it] 43%|████▎     | 534/1240 [1:17:18<1:41:48,  8.65s/it] 43%|████▎     | 535/1240 [1:17:26<1:38:13,  8.36s/it] 43%|████▎     | 536/1240 [1:17:35<1:40:18,  8.55s/it] 43%|████▎     | 537/1240 [1:17:43<1:39:50,  8.52s/it] 43%|████▎     | 538/1240 [1:17:51<1:37:17,  8.32s/it] 43%|████▎     | 539/1240 [1:17:59<1:35:46,  8.20s/it] 44%|████▎     | 540/1240 [1:18:07<1:35:24,  8.18s/it]                                                       44%|████▎     | 540/1240 [1:18:07<1:35:24,  8.18s/it] 44%|████▎     | 541/1240 [1:18:16<1:37:31,  8.37s/it] 44%|████▎     | 542/1240 [1:18:25<1:39:36,  8.56s/it] 44%|████▍     | 543/1240 [1:18:34<1:39:08,  8.53s/it] 44%|████▍     | 544/1240 [1:18:43<1:40:40,  8.68s/it] 44%|████▍     | 545/1240 [1:18:51<1:39:02,  8.55s/it] 44%|████▍     | 546/1240 [1:19:05<1:58:25, 10.24s/it] 44%|████▍     | 547/1240 [1:19:14<1:52:55,  9.78s/it] 44%|████▍     | 548/1240 [1:19:23<1:49:45,  9.52s/it] 44%|████▍     | 549/1240 [1:19:30<1:43:43,  9.01s/it] 44%|████▍     | 550/1240 [1:19:39<1:43:10,  8.97s/it]                                                       44%|████▍     | 550/1240 [1:19:39<1:43:10,  8.97s/it] 44%|████▍     | 551/1240 [1:19:48<1:41:56,  8.88s/it] 45%|████▍     | 552/1240 [1:19:57<1:41:08,  8.82s/it] 45%|████▍     | 553/1240 [1:20:04<1:37:37,  8.53s/it] 45%|████▍     | 554/1240 [1:20:13<1:38:54,  8.65s/it] 45%|████▍     | 555/1240 [1:20:22<1:37:11,  8.51s/it] 45%|████▍     | 556/1240 [1:20:30<1:37:56,  8.59s/it] 45%|████▍     | 557/1240 [1:20:39<1:38:43,  8.67s/it] 45%|████▌     | 558/1240 [1:20:48<1:38:00,  8.62s/it] 45%|████▌     | 559/1240 [1:20:56<1:37:51,  8.62s/it] 45%|████▌     | 560/1240 [1:21:05<1:38:38,  8.70s/it]                                                       45%|████▌     | 560/1240 [1:21:05<1:38:38,  8.70s/it] 45%|████▌     | 561/1240 [1:21:13<1:35:20,  8.42s/it] 45%|████▌     | 562/1240 [1:21:22<1:37:08,  8.60s/it] 45%|████▌     | 563/1240 [1:21:31<1:36:37,  8.56s/it] 45%|████▌     | 564/1240 [1:21:39<1:37:45,  8.68s/it] 46%|████▌     | 565/1240 [1:21:48<1:37:33,  8.67s/it] 46%|████▌     | 566/1240 [1:21:55<1:32:37,  8.25s/it] 46%|████▌     | 567/1240 [1:22:04<1:32:08,  8.21s/it] 46%|████▌     | 568/1240 [1:22:12<1:32:07,  8.23s/it] 46%|████▌     | 569/1240 [1:22:20<1:32:08,  8.24s/it] 46%|████▌     | 570/1240 [1:22:29<1:33:51,  8.41s/it]                                                       46%|████▌     | 570/1240 [1:22:29<1:33:51,  8.41s/it] 46%|████▌     | 571/1240 [1:22:37<1:32:19,  8.28s/it] 46%|████▌     | 572/1240 [1:22:46<1:33:32,  8.40s/it] 46%|████▌     | 573/1240 [1:22:54<1:34:38,  8.51s/it] 46%|████▋     | 574/1240 [1:23:02<1:32:59,  8.38s/it] 46%|████▋     | 575/1240 [1:23:11<1:33:43,  8.46s/it] 46%|████▋     | 576/1240 [1:23:20<1:35:27,  8.63s/it] 47%|████▋     | 577/1240 [1:23:28<1:31:55,  8.32s/it] 47%|████▋     | 578/1240 [1:23:36<1:32:45,  8.41s/it] 47%|████▋     | 579/1240 [1:23:45<1:33:32,  8.49s/it] 47%|████▋     | 580/1240 [1:23:54<1:34:32,  8.60s/it]                                                       47%|████▋     | 580/1240 [1:23:54<1:34:32,  8.60s/it] 47%|████▋     | 581/1240 [1:24:03<1:35:17,  8.68s/it] 47%|████▋     | 582/1240 [1:24:11<1:35:13,  8.68s/it] 47%|████▋     | 583/1240 [1:24:20<1:33:45,  8.56s/it] 47%|████▋     | 584/1240 [1:24:28<1:32:48,  8.49s/it] 47%|████▋     | 585/1240 [1:24:37<1:33:34,  8.57s/it] 47%|████▋     | 586/1240 [1:24:44<1:30:55,  8.34s/it] 47%|████▋     | 587/1240 [1:24:53<1:30:09,  8.28s/it] 47%|████▋     | 588/1240 [1:25:01<1:31:18,  8.40s/it] 48%|████▊     | 589/1240 [1:25:10<1:30:34,  8.35s/it] 48%|████▊     | 590/1240 [1:25:17<1:28:06,  8.13s/it]                                                       48%|████▊     | 590/1240 [1:25:17<1:28:06,  8.13s/it] 48%|████▊     | 591/1240 [1:25:25<1:27:19,  8.07s/it] 48%|████▊     | 592/1240 [1:25:34<1:30:20,  8.36s/it] 48%|████▊     | 593/1240 [1:25:43<1:30:33,  8.40s/it] 48%|████▊     | 594/1240 [1:25:52<1:32:09,  8.56s/it] 48%|████▊     | 595/1240 [1:26:00<1:30:04,  8.38s/it] 48%|████▊     | 596/1240 [1:26:08<1:30:20,  8.42s/it] 48%|████▊     | 597/1240 [1:26:17<1:31:59,  8.58s/it] 48%|████▊     | 598/1240 [1:26:26<1:33:08,  8.71s/it] 48%|████▊     | 599/1240 [1:26:34<1:32:16,  8.64s/it] 48%|████▊     | 600/1240 [1:26:43<1:31:48,  8.61s/it]                                                       48%|████▊     | 600/1240 [1:26:43<1:31:48,  8.61s/it]{'eval_loss': 0.3062698245048523, 'eval_runtime': 25.73, 'eval_samples_per_second': 9.677, 'eval_steps_per_second': 2.449, 'eval_rewards/chosen': -19.32184410095215, 'eval_rewards/rejected': -30.05760955810547, 'eval_rewards/accuracies': 0.829365074634552, 'eval_rewards/margins': 10.73576545715332, 'eval_logps/rejected': -545.7114868164062, 'eval_logps/chosen': -535.9910278320312, 'eval_logits/rejected': -13.730335235595703, 'eval_logits/chosen': -5.213461875915527, 'epoch': 6.45}
{'loss': 0.0902, 'grad_norm': 3.492547035217285, 'learning_rate': 0.00015993747054202683, 'rewards/chosen': -16.55170249938965, 'rewards/rejected': -29.721288681030273, 'rewards/accuracies': 0.953125, 'rewards/margins': 13.169589042663574, 'logps/rejected': -518.9639892578125, 'logps/chosen': -445.681640625, 'logits/rejected': 0.6542392373085022, 'logits/chosen': 7.381915092468262, 'epoch': 6.61}
{'loss': 0.0834, 'grad_norm': 0.6207852959632874, 'learning_rate': 0.00015778165111040513, 'rewards/chosen': -16.09585189819336, 'rewards/rejected': -27.081329345703125, 'rewards/accuracies': 0.96875, 'rewards/margins': 10.98547649383545, 'logps/rejected': -490.9060974121094, 'logps/chosen': -444.6636657714844, 'logits/rejected': 2.835963726043701, 'logits/chosen': 9.389549255371094, 'epoch': 6.77}
{'loss': 0.0454, 'grad_norm': 0.6203614473342896, 'learning_rate': 0.00015558473815613475, 'rewards/chosen': -21.260433197021484, 'rewards/rejected': -40.431705474853516, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 19.1712703704834, 'logps/rejected': -631.1585693359375, 'logps/chosen': -489.1151428222656, 'logits/rejected': -2.4165384769439697, 'logits/chosen': 4.889745235443115, 'epoch': 6.94}
{'loss': 0.045, 'grad_norm': 4.4426960945129395, 'learning_rate': 0.00015334829409376273, 'rewards/chosen': -34.061134338378906, 'rewards/rejected': -68.36486053466797, 'rewards/accuracies': 0.984375, 'rewards/margins': 34.303733825683594, 'logps/rejected': -889.6409912109375, 'logps/chosen': -612.2035522460938, 'logits/rejected': -7.697442054748535, 'logits/chosen': 2.3340647220611572, 'epoch': 7.1}
{'loss': 0.0904, 'grad_norm': 3.0192859172821045, 'learning_rate': 0.0001510739094518212, 'rewards/chosen': -50.07707595825195, 'rewards/rejected': -81.23674774169922, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 31.1596736907959, 'logps/rejected': -1023.2374267578125, 'logps/chosen': -770.6741333007812, 'logits/rejected': -12.91515064239502, 'logits/chosen': -4.654986381530762, 'epoch': 7.26}
{'loss': 0.1158, 'grad_norm': 2.6349289417266846, 'learning_rate': 0.00014876320174166542, 'rewards/chosen': -29.03110122680664, 'rewards/rejected': -51.808250427246094, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 22.777156829833984, 'logps/rejected': -736.7886352539062, 'logps/chosen': -578.501953125, 'logits/rejected': -6.639196872711182, 'logits/chosen': 1.9442493915557861, 'epoch': 7.42}
{'loss': 0.0795, 'grad_norm': 0.8027675151824951, 'learning_rate': 0.00014641781430712168, 'rewards/chosen': -15.938562393188477, 'rewards/rejected': -27.962377548217773, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 12.023816108703613, 'logps/rejected': -501.7562561035156, 'logps/chosen': -425.4851989746094, 'logits/rejected': -0.5702944993972778, 'logits/chosen': 5.740652084350586, 'epoch': 7.58}
{'loss': 0.0505, 'grad_norm': 1.6683201789855957, 'learning_rate': 0.00014403941515576344, 'rewards/chosen': -14.090718269348145, 'rewards/rejected': -25.424108505249023, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 11.333391189575195, 'logps/rejected': -476.2520446777344, 'logps/chosen': -419.79962158203125, 'logits/rejected': 1.7438942193984985, 'logits/chosen': 7.758938789367676, 'epoch': 7.74}
{'loss': 0.0311, 'grad_norm': 0.20271919667720795, 'learning_rate': 0.0001416296957726472, 'rewards/chosen': -22.963396072387695, 'rewards/rejected': -43.46791076660156, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 20.504512786865234, 'logps/rejected': -668.1673583984375, 'logps/chosen': -523.253662109375, 'logits/rejected': -3.1599624156951904, 'logits/chosen': 4.559206485748291, 'epoch': 7.9}
{'loss': 0.0663, 'grad_norm': 0.06327313929796219, 'learning_rate': 0.0001391903699173514, 'rewards/chosen': -31.491891860961914, 'rewards/rejected': -59.958641052246094, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 28.466760635375977, 'logps/rejected': -815.33984375, 'logps/chosen': -593.565185546875, 'logits/rejected': -7.284291744232178, 'logits/chosen': 2.0892815589904785, 'epoch': 8.06}
{'loss': 0.0735, 'grad_norm': 1.9163858890533447, 'learning_rate': 0.00013672317240517388, 'rewards/chosen': -26.359477996826172, 'rewards/rejected': -45.9727668762207, 'rewards/accuracies': 0.96875, 'rewards/margins': 19.61328887939453, 'logps/rejected': -676.0631713867188, 'logps/chosen': -538.40869140625, 'logits/rejected': -5.835034370422363, 'logits/chosen': 1.6834760904312134, 'epoch': 8.23}
{'loss': 0.0769, 'grad_norm': 1.0777733325958252, 'learning_rate': 0.00013422985787335493, 'rewards/chosen': -18.158952713012695, 'rewards/rejected': -32.4624137878418, 'rewards/accuracies': 0.96875, 'rewards/margins': 14.30346393585205, 'logps/rejected': -537.41455078125, 'logps/chosen': -448.348876953125, 'logits/rejected': -0.8018396496772766, 'logits/chosen': 6.561347007751465, 'epoch': 8.39}
{'loss': 0.0476, 'grad_norm': 0.4908495545387268, 'learning_rate': 0.0001317121995332033, 'rewards/chosen': -16.341297149658203, 'rewards/rejected': -30.418405532836914, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 14.077105522155762, 'logps/rejected': -525.7830810546875, 'logps/chosen': -447.5694885253906, 'logits/rejected': 0.7278879284858704, 'logits/chosen': 8.178315162658691, 'epoch': 8.55}
{'loss': 0.0566, 'grad_norm': 3.7853188514709473, 'learning_rate': 0.0001291719879090123, 'rewards/chosen': -20.687763214111328, 'rewards/rejected': -41.76923751831055, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 21.081472396850586, 'logps/rejected': -640.5643310546875, 'logps/chosen': -498.116943359375, 'logits/rejected': -4.195136547088623, 'logits/chosen': 4.065972328186035, 'epoch': 8.71}
{'loss': 0.0638, 'grad_norm': 0.1574450135231018, 'learning_rate': 0.00012661102956466343, 'rewards/chosen': -25.264446258544922, 'rewards/rejected': -45.865264892578125, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 20.60081672668457, 'logps/rejected': -677.2613525390625, 'logps/chosen': -525.6614990234375, 'logits/rejected': -3.1335458755493164, 'logits/chosen': 4.452399730682373, 'epoch': 8.87}
{'loss': 0.0516, 'grad_norm': 1.0848947763442993, 'learning_rate': 0.0001240311458188229, 'rewards/chosen': -27.300308227539062, 'rewards/rejected': -47.23069381713867, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 19.93038558959961, 'logps/rejected': -690.0225830078125, 'logps/chosen': -552.664794921875, 'logits/rejected': -4.736832618713379, 'logits/chosen': 2.971317768096924, 'epoch': 9.03}
{'loss': 0.0471, 'grad_norm': 1.0104379653930664, 'learning_rate': 0.00012143417144964424, 'rewards/chosen': -26.347278594970703, 'rewards/rejected': -48.780521392822266, 'rewards/accuracies': 0.96875, 'rewards/margins': 22.433242797851562, 'logps/rejected': -700.0782470703125, 'logps/chosen': -539.1514282226562, 'logits/rejected': -3.834367275238037, 'logits/chosen': 4.616677284240723, 'epoch': 9.19}
{'loss': 0.0421, 'grad_norm': 1.7419604063034058, 'learning_rate': 0.00011882195338989959, 'rewards/chosen': -31.449453353881836, 'rewards/rejected': -54.259071350097656, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 22.809619903564453, 'logps/rejected': -749.1848754882812, 'logps/chosen': -580.9117431640625, 'logits/rejected': -5.211843013763428, 'logits/chosen': 2.6258952617645264, 'epoch': 9.35}
{'loss': 0.0953, 'grad_norm': 2.405381441116333, 'learning_rate': 0.00011619634941346586, 'rewards/chosen': -26.091121673583984, 'rewards/rejected': -44.604461669921875, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 18.51333999633789, 'logps/rejected': -682.69482421875, 'logps/chosen': -552.7052001953125, 'logits/rejected': -2.863041400909424, 'logits/chosen': 3.6512064933776855, 'epoch': 9.52}
{'loss': 0.0516, 'grad_norm': 0.33641567826271057, 'learning_rate': 0.00011355922681410153, 'rewards/chosen': -21.65542984008789, 'rewards/rejected': -35.55379867553711, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 13.898368835449219, 'logps/rejected': -583.5745849609375, 'logps/chosen': -504.6004943847656, 'logits/rejected': 2.667686939239502, 'logits/chosen': 7.8891730308532715, 'epoch': 9.68}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:10,  5.85it/s][A
  5%|▍         | 3/63 [00:00<00:16,  3.59it/s][A
  6%|▋         | 4/63 [00:01<00:19,  2.99it/s][A
  8%|▊         | 5/63 [00:01<00:21,  2.67it/s][A
 10%|▉         | 6/63 [00:02<00:23,  2.45it/s][A
 11%|█         | 7/63 [00:02<00:24,  2.32it/s][A
 13%|█▎        | 8/63 [00:03<00:24,  2.29it/s][A
 14%|█▍        | 9/63 [00:03<00:22,  2.45it/s][A
 16%|█▌        | 10/63 [00:03<00:22,  2.34it/s][A
 17%|█▋        | 11/63 [00:04<00:22,  2.28it/s][A
 19%|█▉        | 12/63 [00:04<00:22,  2.28it/s][A
 21%|██        | 13/63 [00:05<00:20,  2.43it/s][A
 22%|██▏       | 14/63 [00:05<00:21,  2.32it/s][A
 24%|██▍       | 15/63 [00:06<00:20,  2.29it/s][A
 25%|██▌       | 16/63 [00:06<00:20,  2.27it/s][A
 27%|██▋       | 17/63 [00:06<00:18,  2.43it/s][A
 29%|██▊       | 18/63 [00:07<00:17,  2.55it/s][A
 30%|███       | 19/63 [00:07<00:16,  2.65it/s][A
 32%|███▏      | 20/63 [00:07<00:17,  2.52it/s][A
 33%|███▎      | 21/63 [00:08<00:16,  2.58it/s][A
 35%|███▍      | 22/63 [00:08<00:16,  2.41it/s][A
 37%|███▋      | 23/63 [00:09<00:17,  2.31it/s][A
 38%|███▊      | 24/63 [00:09<00:17,  2.27it/s][A
 40%|███▉      | 25/63 [00:10<00:17,  2.23it/s][A
 41%|████▏     | 26/63 [00:10<00:16,  2.19it/s][A
 43%|████▎     | 27/63 [00:11<00:16,  2.16it/s][A
 44%|████▍     | 28/63 [00:11<00:16,  2.13it/s][A
 46%|████▌     | 29/63 [00:12<00:14,  2.31it/s][A
 48%|████▊     | 30/63 [00:12<00:13,  2.46it/s][A
 49%|████▉     | 31/63 [00:12<00:12,  2.58it/s][A
 51%|█████     | 32/63 [00:13<00:11,  2.67it/s][A
 52%|█████▏    | 33/63 [00:13<00:11,  2.73it/s][A
 54%|█████▍    | 34/63 [00:13<00:11,  2.56it/s][A
 56%|█████▌    | 35/63 [00:14<00:11,  2.52it/s][A
 57%|█████▋    | 36/63 [00:14<00:10,  2.62it/s][A
 59%|█████▊    | 37/63 [00:14<00:09,  2.70it/s][A
 60%|██████    | 38/63 [00:15<00:09,  2.69it/s][A
 62%|██████▏   | 39/63 [00:15<00:09,  2.48it/s][A
 63%|██████▎   | 40/63 [00:16<00:09,  2.35it/s][A
 65%|██████▌   | 41/63 [00:16<00:08,  2.46it/s][A
 67%|██████▋   | 42/63 [00:17<00:08,  2.50it/s][A
 68%|██████▊   | 43/63 [00:17<00:07,  2.60it/s][A
 70%|██████▉   | 44/63 [00:17<00:07,  2.68it/s][A
 71%|███████▏  | 45/63 [00:18<00:06,  2.74it/s][A
 73%|███████▎  | 46/63 [00:18<00:06,  2.78it/s][A
 75%|███████▍  | 47/63 [00:18<00:05,  2.81it/s][A
 76%|███████▌  | 48/63 [00:19<00:05,  2.81it/s][A
 78%|███████▊  | 49/63 [00:19<00:04,  2.83it/s][A
 79%|███████▉  | 50/63 [00:19<00:05,  2.57it/s][A
 81%|████████  | 51/63 [00:20<00:04,  2.58it/s][A
 83%|████████▎ | 52/63 [00:20<00:04,  2.42it/s][A
 84%|████████▍ | 53/63 [00:21<00:03,  2.54it/s][A
 86%|████████▌ | 54/63 [00:21<00:03,  2.64it/s][A
 87%|████████▋ | 55/63 [00:21<00:03,  2.62it/s][A
 89%|████████▉ | 56/63 [00:22<00:02,  2.69it/s][A
 90%|█████████ | 57/63 [00:22<00:02,  2.73it/s][A
 92%|█████████▏| 58/63 [00:22<00:01,  2.63it/s][A
 94%|█████████▎| 59/63 [00:23<00:01,  2.70it/s][A
 95%|█████████▌| 60/63 [00:23<00:01,  2.75it/s][A
 97%|█████████▋| 61/63 [00:24<00:00,  2.79it/s][A
 98%|█████████▊| 62/63 [00:24<00:00,  2.83it/s][A
100%|██████████| 63/63 [00:24<00:00,  2.86it/s][A                                                      
                                               [A 48%|████▊     | 600/1240 [1:27:08<1:31:48,  8.61s/it]
100%|██████████| 63/63 [00:24<00:00,  2.86it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
 48%|████▊     | 601/1240 [1:27:21<3:05:20, 17.40s/it] 49%|████▊     | 602/1240 [1:27:29<2:36:30, 14.72s/it] 49%|████▊     | 603/1240 [1:27:37<2:14:30, 12.67s/it] 49%|████▊     | 604/1240 [1:27:46<2:01:04, 11.42s/it] 49%|████▉     | 605/1240 [1:27:55<1:52:22, 10.62s/it] 49%|████▉     | 606/1240 [1:28:03<1:44:38,  9.90s/it] 49%|████▉     | 607/1240 [1:28:12<1:40:51,  9.56s/it] 49%|████▉     | 608/1240 [1:28:20<1:37:05,  9.22s/it] 49%|████▉     | 609/1240 [1:28:27<1:31:26,  8.70s/it] 49%|████▉     | 610/1240 [1:28:36<1:32:16,  8.79s/it]                                                       49%|████▉     | 610/1240 [1:28:36<1:32:16,  8.79s/it] 49%|████▉     | 611/1240 [1:28:45<1:30:13,  8.61s/it] 49%|████▉     | 612/1240 [1:28:53<1:28:56,  8.50s/it] 49%|████▉     | 613/1240 [1:29:02<1:29:56,  8.61s/it] 50%|████▉     | 614/1240 [1:29:10<1:29:49,  8.61s/it] 50%|████▉     | 615/1240 [1:29:19<1:30:09,  8.66s/it] 50%|████▉     | 616/1240 [1:29:28<1:29:45,  8.63s/it] 50%|████▉     | 617/1240 [1:29:36<1:28:53,  8.56s/it] 50%|████▉     | 618/1240 [1:29:45<1:30:06,  8.69s/it] 50%|████▉     | 619/1240 [1:29:54<1:30:10,  8.71s/it] 50%|█████     | 620/1240 [1:30:02<1:29:08,  8.63s/it]                                                       50%|█████     | 620/1240 [1:30:02<1:29:08,  8.63s/it] 50%|█████     | 621/1240 [1:30:11<1:29:56,  8.72s/it] 50%|█████     | 622/1240 [1:30:20<1:30:40,  8.80s/it] 50%|█████     | 623/1240 [1:30:29<1:31:00,  8.85s/it] 50%|█████     | 624/1240 [1:30:38<1:30:18,  8.80s/it] 50%|█████     | 625/1240 [1:30:46<1:28:20,  8.62s/it] 50%|█████     | 626/1240 [1:30:55<1:28:38,  8.66s/it] 51%|█████     | 627/1240 [1:31:03<1:28:38,  8.68s/it] 51%|█████     | 628/1240 [1:31:11<1:25:25,  8.38s/it] 51%|█████     | 629/1240 [1:31:20<1:27:22,  8.58s/it] 51%|█████     | 630/1240 [1:31:29<1:28:19,  8.69s/it]                                                       51%|█████     | 630/1240 [1:31:29<1:28:19,  8.69s/it] 51%|█████     | 631/1240 [1:31:37<1:24:35,  8.33s/it] 51%|█████     | 632/1240 [1:31:45<1:25:41,  8.46s/it] 51%|█████     | 633/1240 [1:31:58<1:38:21,  9.72s/it] 51%|█████     | 634/1240 [1:32:07<1:34:54,  9.40s/it] 51%|█████     | 635/1240 [1:32:16<1:33:37,  9.28s/it] 51%|█████▏    | 636/1240 [1:32:24<1:29:20,  8.87s/it] 51%|█████▏    | 637/1240 [1:32:31<1:23:21,  8.29s/it] 51%|█████▏    | 638/1240 [1:32:39<1:24:57,  8.47s/it] 52%|█████▏    | 639/1240 [1:32:48<1:25:03,  8.49s/it] 52%|█████▏    | 640/1240 [1:32:57<1:25:02,  8.50s/it]                                                       52%|█████▏    | 640/1240 [1:32:57<1:25:02,  8.50s/it] 52%|█████▏    | 641/1240 [1:33:05<1:25:00,  8.51s/it] 52%|█████▏    | 642/1240 [1:33:14<1:25:29,  8.58s/it] 52%|█████▏    | 643/1240 [1:33:22<1:22:49,  8.32s/it] 52%|█████▏    | 644/1240 [1:33:30<1:22:17,  8.28s/it] 52%|█████▏    | 645/1240 [1:33:38<1:22:41,  8.34s/it] 52%|█████▏    | 646/1240 [1:33:47<1:23:05,  8.39s/it] 52%|█████▏    | 647/1240 [1:33:54<1:20:50,  8.18s/it] 52%|█████▏    | 648/1240 [1:34:03<1:22:03,  8.32s/it] 52%|█████▏    | 649/1240 [1:34:12<1:23:29,  8.48s/it] 52%|█████▏    | 650/1240 [1:34:26<1:39:31, 10.12s/it]                                                       52%|█████▏    | 650/1240 [1:34:26<1:39:31, 10.12s/it] 52%|█████▎    | 651/1240 [1:34:34<1:32:03,  9.38s/it] 53%|█████▎    | 652/1240 [1:34:42<1:29:37,  9.15s/it] 53%|█████▎    | 653/1240 [1:34:51<1:28:24,  9.04s/it] 53%|█████▎    | 654/1240 [1:34:58<1:23:57,  8.60s/it] 53%|█████▎    | 655/1240 [1:35:07<1:22:41,  8.48s/it] 53%|█████▎    | 656/1240 [1:35:14<1:20:26,  8.26s/it] 53%|█████▎    | 657/1240 [1:35:23<1:21:35,  8.40s/it] 53%|█████▎    | 658/1240 [1:35:32<1:22:31,  8.51s/it] 53%|█████▎    | 659/1240 [1:35:40<1:22:29,  8.52s/it] 53%|█████▎    | 660/1240 [1:35:49<1:22:55,  8.58s/it]                                                       53%|█████▎    | 660/1240 [1:35:49<1:22:55,  8.58s/it] 53%|█████▎    | 661/1240 [1:35:58<1:23:59,  8.70s/it] 53%|█████▎    | 662/1240 [1:36:07<1:24:41,  8.79s/it] 53%|█████▎    | 663/1240 [1:36:16<1:24:59,  8.84s/it] 54%|█████▎    | 664/1240 [1:36:24<1:21:35,  8.50s/it] 54%|█████▎    | 665/1240 [1:36:32<1:20:05,  8.36s/it] 54%|█████▎    | 666/1240 [1:36:40<1:19:39,  8.33s/it] 54%|█████▍    | 667/1240 [1:36:49<1:21:26,  8.53s/it] 54%|█████▍    | 668/1240 [1:36:56<1:15:17,  7.90s/it] 54%|█████▍    | 669/1240 [1:37:03<1:13:42,  7.75s/it] 54%|█████▍    | 670/1240 [1:37:10<1:12:06,  7.59s/it]                                                       54%|█████▍    | 670/1240 [1:37:10<1:12:06,  7.59s/it] 54%|█████▍    | 671/1240 [1:37:19<1:15:59,  8.01s/it] 54%|█████▍    | 672/1240 [1:37:28<1:17:17,  8.16s/it] 54%|█████▍    | 673/1240 [1:37:36<1:18:26,  8.30s/it] 54%|█████▍    | 674/1240 [1:37:45<1:18:49,  8.36s/it] 54%|█████▍    | 675/1240 [1:37:53<1:19:16,  8.42s/it] 55%|█████▍    | 676/1240 [1:38:02<1:19:50,  8.49s/it] 55%|█████▍    | 677/1240 [1:38:11<1:20:10,  8.54s/it] 55%|█████▍    | 678/1240 [1:38:19<1:20:28,  8.59s/it] 55%|█████▍    | 679/1240 [1:38:28<1:19:42,  8.52s/it] 55%|█████▍    | 680/1240 [1:38:36<1:19:29,  8.52s/it]                                                       55%|█████▍    | 680/1240 [1:38:36<1:19:29,  8.52s/it] 55%|█████▍    | 681/1240 [1:38:45<1:18:52,  8.47s/it] 55%|█████▌    | 682/1240 [1:38:53<1:19:45,  8.58s/it] 55%|█████▌    | 683/1240 [1:39:02<1:20:45,  8.70s/it] 55%|█████▌    | 684/1240 [1:39:11<1:19:43,  8.60s/it] 55%|█████▌    | 685/1240 [1:39:19<1:17:59,  8.43s/it] 55%|█████▌    | 686/1240 [1:39:27<1:17:52,  8.43s/it] 55%|█████▌    | 687/1240 [1:39:36<1:18:23,  8.51s/it] 55%|█████▌    | 688/1240 [1:39:45<1:19:33,  8.65s/it] 56%|█████▌    | 689/1240 [1:39:53<1:16:58,  8.38s/it] 56%|█████▌    | 690/1240 [1:40:01<1:18:06,  8.52s/it]                                                       56%|█████▌    | 690/1240 [1:40:02<1:18:06,  8.52s/it] 56%|█████▌    | 691/1240 [1:40:10<1:18:05,  8.53s/it] 56%|█████▌    | 692/1240 [1:40:19<1:18:39,  8.61s/it] 56%|█████▌    | 693/1240 [1:40:27<1:17:56,  8.55s/it] 56%|█████▌    | 694/1240 [1:40:36<1:18:03,  8.58s/it] 56%|█████▌    | 695/1240 [1:40:44<1:17:10,  8.50s/it] 56%|█████▌    | 696/1240 [1:40:53<1:16:31,  8.44s/it] 56%|█████▌    | 697/1240 [1:41:01<1:16:36,  8.47s/it] 56%|█████▋    | 698/1240 [1:41:09<1:14:05,  8.20s/it] 56%|█████▋    | 699/1240 [1:41:17<1:14:48,  8.30s/it] 56%|█████▋    | 700/1240 [1:41:25<1:14:10,  8.24s/it]                                                       56%|█████▋    | 700/1240 [1:41:25<1:14:10,  8.24s/it] 57%|█████▋    | 701/1240 [1:41:34<1:14:56,  8.34s/it] 57%|█████▋    | 702/1240 [1:41:43<1:16:19,  8.51s/it] 57%|█████▋    | 703/1240 [1:41:51<1:16:39,  8.56s/it] 57%|█████▋    | 704/1240 [1:42:00<1:17:36,  8.69s/it] 57%|█████▋    | 705/1240 [1:42:09<1:15:56,  8.52s/it] 57%|█████▋    | 706/1240 [1:42:17<1:15:32,  8.49s/it] 57%|█████▋    | 707/1240 [1:42:25<1:15:17,  8.48s/it] 57%|█████▋    | 708/1240 [1:42:34<1:14:41,  8.42s/it] 57%|█████▋    | 709/1240 [1:42:42<1:14:25,  8.41s/it] 57%|█████▋    | 710/1240 [1:42:51<1:14:57,  8.49s/it]                                                       57%|█████▋    | 710/1240 [1:42:51<1:14:57,  8.49s/it] 57%|█████▋    | 711/1240 [1:42:59<1:13:59,  8.39s/it] 57%|█████▋    | 712/1240 [1:43:07<1:14:18,  8.44s/it] 57%|█████▊    | 713/1240 [1:43:15<1:12:18,  8.23s/it] 58%|█████▊    | 714/1240 [1:43:23<1:12:14,  8.24s/it] 58%|█████▊    | 715/1240 [1:43:32<1:13:14,  8.37s/it] 58%|█████▊    | 716/1240 [1:43:41<1:13:12,  8.38s/it] 58%|█████▊    | 717/1240 [1:43:49<1:11:56,  8.25s/it] 58%|█████▊    | 718/1240 [1:43:58<1:13:44,  8.48s/it] 58%|█████▊    | 719/1240 [1:44:06<1:13:38,  8.48s/it] 58%|█████▊    | 720/1240 [1:44:14<1:13:18,  8.46s/it]                                                       58%|█████▊    | 720/1240 [1:44:14<1:13:18,  8.46s/it] 58%|█████▊    | 721/1240 [1:44:23<1:13:43,  8.52s/it] 58%|█████▊    | 722/1240 [1:44:31<1:12:19,  8.38s/it] 58%|█████▊    | 723/1240 [1:44:39<1:11:51,  8.34s/it] 58%|█████▊    | 724/1240 [1:44:48<1:11:37,  8.33s/it] 58%|█████▊    | 725/1240 [1:44:56<1:12:23,  8.43s/it] 59%|█████▊    | 726/1240 [1:45:05<1:12:11,  8.43s/it] 59%|█████▊    | 727/1240 [1:45:14<1:13:25,  8.59s/it] 59%|█████▊    | 728/1240 [1:45:22<1:12:17,  8.47s/it] 59%|█████▉    | 729/1240 [1:45:31<1:12:42,  8.54s/it] 59%|█████▉    | 730/1240 [1:45:39<1:11:54,  8.46s/it]                                                       59%|█████▉    | 730/1240 [1:45:39<1:11:54,  8.46s/it] 59%|█████▉    | 731/1240 [1:45:47<1:10:46,  8.34s/it] 59%|█████▉    | 732/1240 [1:45:56<1:11:41,  8.47s/it] 59%|█████▉    | 733/1240 [1:46:04<1:11:33,  8.47s/it] 59%|█████▉    | 734/1240 [1:46:13<1:11:04,  8.43s/it] 59%|█████▉    | 735/1240 [1:46:20<1:09:35,  8.27s/it] 59%|█████▉    | 736/1240 [1:46:29<1:09:10,  8.23s/it] 59%|█████▉    | 737/1240 [1:46:37<1:10:16,  8.38s/it] 60%|█████▉    | 738/1240 [1:46:46<1:11:02,  8.49s/it] 60%|█████▉    | 739/1240 [1:46:54<1:10:22,  8.43s/it] 60%|█████▉    | 740/1240 [1:47:04<1:14:09,  8.90s/it]                                                       60%|█████▉    | 740/1240 [1:47:04<1:14:09,  8.90s/it] 60%|█████▉    | 741/1240 [1:47:12<1:10:25,  8.47s/it] 60%|█████▉    | 742/1240 [1:47:18<1:05:50,  7.93s/it] 60%|█████▉    | 743/1240 [1:47:27<1:07:49,  8.19s/it] 60%|██████    | 744/1240 [1:47:36<1:07:56,  8.22s/it] 60%|██████    | 745/1240 [1:47:44<1:08:39,  8.32s/it] 60%|██████    | 746/1240 [1:47:52<1:08:27,  8.31s/it] 60%|██████    | 747/1240 [1:48:01<1:08:47,  8.37s/it] 60%|██████    | 748/1240 [1:48:10<1:10:04,  8.55s/it] 60%|██████    | 749/1240 [1:48:19<1:10:41,  8.64s/it] 60%|██████    | 750/1240 [1:48:27<1:09:05,  8.46s/it]                                                       60%|██████    | 750/1240 [1:48:27<1:09:05,  8.46s/it] 61%|██████    | 751/1240 [1:48:36<1:10:16,  8.62s/it] 61%|██████    | 752/1240 [1:48:45<1:11:03,  8.74s/it] 61%|██████    | 753/1240 [1:48:53<1:08:51,  8.48s/it] 61%|██████    | 754/1240 [1:49:01<1:08:48,  8.50s/it] 61%|██████    | 755/1240 [1:49:09<1:07:01,  8.29s/it] 61%|██████    | 756/1240 [1:49:18<1:07:48,  8.41s/it] 61%|██████    | 757/1240 [1:49:27<1:08:43,  8.54s/it] 61%|██████    | 758/1240 [1:49:35<1:08:33,  8.53s/it] 61%|██████    | 759/1240 [1:49:43<1:08:00,  8.48s/it] 61%|██████▏   | 760/1240 [1:49:52<1:07:05,  8.39s/it]                                                       61%|██████▏   | 760/1240 [1:49:52<1:07:05,  8.39s/it] 61%|██████▏   | 761/1240 [1:50:00<1:06:52,  8.38s/it] 61%|██████▏   | 762/1240 [1:50:09<1:07:39,  8.49s/it] 62%|██████▏   | 763/1240 [1:50:17<1:07:17,  8.46s/it] 62%|██████▏   | 764/1240 [1:50:25<1:06:55,  8.44s/it] 62%|██████▏   | 765/1240 [1:50:34<1:08:05,  8.60s/it] 62%|██████▏   | 766/1240 [1:50:43<1:08:13,  8.64s/it] 62%|██████▏   | 767/1240 [1:50:51<1:07:11,  8.52s/it] 62%|██████▏   | 768/1240 [1:51:06<1:20:29, 10.23s/it] 62%|██████▏   | 769/1240 [1:51:14<1:15:13,  9.58s/it] 62%|██████▏   | 770/1240 [1:51:23<1:13:39,  9.40s/it]                                                       62%|██████▏   | 770/1240 [1:51:23<1:13:39,  9.40s/it] 62%|██████▏   | 771/1240 [1:51:31<1:11:49,  9.19s/it] 62%|██████▏   | 772/1240 [1:51:40<1:10:41,  9.06s/it] 62%|██████▏   | 773/1240 [1:51:48<1:07:03,  8.62s/it] 62%|██████▏   | 774/1240 [1:51:56<1:06:06,  8.51s/it] 62%|██████▎   | 775/1240 [1:52:05<1:05:57,  8.51s/it] 63%|██████▎   | 776/1240 [1:52:13<1:05:54,  8.52s/it] 63%|██████▎   | 777/1240 [1:52:21<1:05:00,  8.42s/it] 63%|██████▎   | 778/1240 [1:52:29<1:02:44,  8.15s/it] 63%|██████▎   | 779/1240 [1:52:38<1:04:31,  8.40s/it] 63%|██████▎   | 780/1240 [1:52:46<1:03:59,  8.35s/it]                                                       63%|██████▎   | 780/1240 [1:52:46<1:03:59,  8.35s/it] 63%|██████▎   | 781/1240 [1:52:54<1:03:11,  8.26s/it] 63%|██████▎   | 782/1240 [1:53:02<1:03:13,  8.28s/it] 63%|██████▎   | 783/1240 [1:53:10<1:02:40,  8.23s/it] 63%|██████▎   | 784/1240 [1:53:19<1:03:29,  8.35s/it] 63%|██████▎   | 785/1240 [1:53:28<1:04:04,  8.45s/it] 63%|██████▎   | 786/1240 [1:53:35<1:01:50,  8.17s/it] 63%|██████▎   | 787/1240 [1:53:44<1:02:05,  8.22s/it] 64%|██████▎   | 788/1240 [1:53:51<1:00:36,  8.04s/it] 64%|██████▎   | 789/1240 [1:53:59<59:26,  7.91s/it]   64%|██████▎   | 790/1240 [1:54:07<1:00:09,  8.02s/it]                                                       64%|██████▎   | 790/1240 [1:54:07<1:00:09,  8.02s/it] 64%|██████▍   | 791/1240 [1:54:15<1:00:40,  8.11s/it] 64%|██████▍   | 792/1240 [1:54:24<1:01:57,  8.30s/it] 64%|██████▍   | 793/1240 [1:54:33<1:02:20,  8.37s/it] 64%|██████▍   | 794/1240 [1:54:41<1:00:57,  8.20s/it] 64%|██████▍   | 795/1240 [1:54:49<1:02:13,  8.39s/it] 64%|██████▍   | 796/1240 [1:54:58<1:02:54,  8.50s/it] 64%|██████▍   | 797/1240 [1:55:07<1:03:07,  8.55s/it] 64%|██████▍   | 798/1240 [1:55:15<1:03:00,  8.55s/it] 64%|██████▍   | 799/1240 [1:55:23<1:01:47,  8.41s/it] 65%|██████▍   | 800/1240 [1:55:32<1:01:53,  8.44s/it]                                                       65%|██████▍   | 800/1240 [1:55:32<1:01:53,  8.44s/it]{'eval_loss': 0.35811346769332886, 'eval_runtime': 25.1935, 'eval_samples_per_second': 9.883, 'eval_steps_per_second': 2.501, 'eval_rewards/chosen': -23.849515914916992, 'eval_rewards/rejected': -32.06606674194336, 'eval_rewards/accuracies': 0.8134920597076416, 'eval_rewards/margins': 8.216551780700684, 'eval_logps/rejected': -565.796142578125, 'eval_logps/chosen': -581.2677612304688, 'eval_logits/rejected': -11.765772819519043, 'eval_logits/chosen': -5.497910022735596, 'epoch': 9.68}
{'loss': 0.0697, 'grad_norm': 0.1607668250799179, 'learning_rate': 0.0001109124610774527, 'rewards/chosen': -20.957738876342773, 'rewards/rejected': -33.818359375, 'rewards/accuracies': 0.96875, 'rewards/margins': 12.860620498657227, 'logps/rejected': -559.3380737304688, 'logps/chosen': -481.7229919433594, 'logits/rejected': 0.9044420123100281, 'logits/chosen': 7.006532192230225, 'epoch': 9.84}
{'loss': 0.0702, 'grad_norm': 0.09453790634870529, 'learning_rate': 0.00010825793454723325, 'rewards/chosen': -20.518474578857422, 'rewards/rejected': -34.53511047363281, 'rewards/accuracies': 0.96875, 'rewards/margins': 14.016636848449707, 'logps/rejected': -557.0874633789062, 'logps/chosen': -481.75164794921875, 'logits/rejected': 3.097949504852295, 'logits/chosen': 9.141162872314453, 'epoch': 10.0}
{'loss': 0.0572, 'grad_norm': 1.344229817390442, 'learning_rate': 0.00010559753508652759, 'rewards/chosen': -22.693695068359375, 'rewards/rejected': -39.088226318359375, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 16.394527435302734, 'logps/rejected': -613.2249755859375, 'logps/chosen': -505.4767150878906, 'logits/rejected': 1.8320980072021484, 'logits/chosen': 8.246820449829102, 'epoch': 10.16}
{'loss': 0.0374, 'grad_norm': 0.3854982852935791, 'learning_rate': 0.00010293315473516833, 'rewards/chosen': -21.056175231933594, 'rewards/rejected': -37.03678512573242, 'rewards/accuracies': 0.984375, 'rewards/margins': 15.980610847473145, 'logps/rejected': -579.21728515625, 'logps/chosen': -480.8169860839844, 'logits/rejected': 0.08359880745410919, 'logits/chosen': 6.88516902923584, 'epoch': 10.32}
{'loss': 0.0717, 'grad_norm': 0.005847372580319643, 'learning_rate': 0.00010026668836414324, 'rewards/chosen': -24.180740356445312, 'rewards/rejected': -41.792152404785156, 'rewards/accuracies': 0.96875, 'rewards/margins': 17.61141586303711, 'logps/rejected': -644.6121826171875, 'logps/chosen': -530.3994140625, 'logits/rejected': -2.1387476921081543, 'logits/chosen': 4.612944602966309, 'epoch': 10.48}
{'loss': 0.0601, 'grad_norm': 0.7495850324630737, 'learning_rate': 9.760003232798878e-05, 'rewards/chosen': -24.46250343322754, 'rewards/rejected': -42.515037536621094, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 18.052532196044922, 'logps/rejected': -633.89404296875, 'logps/chosen': -510.22784423828125, 'logits/rejected': -1.0355571508407593, 'logits/chosen': 5.86968994140625, 'epoch': 10.65}
{'loss': 0.0254, 'grad_norm': 0.5627719759941101, 'learning_rate': 9.493508311612874e-05, 'rewards/chosen': -23.10109519958496, 'rewards/rejected': -41.358726501464844, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 18.257631301879883, 'logps/rejected': -632.8331298828125, 'logps/chosen': -513.509521484375, 'logits/rejected': -2.0238089561462402, 'logits/chosen': 5.0130510330200195, 'epoch': 10.81}
{'loss': 0.0547, 'grad_norm': 2.360365390777588, 'learning_rate': 9.227373600411669e-05, 'rewards/chosen': -24.931001663208008, 'rewards/rejected': -43.63412857055664, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 18.703126907348633, 'logps/rejected': -661.4210205078125, 'logps/chosen': -532.565673828125, 'logits/rejected': 0.07291936874389648, 'logits/chosen': 7.088438987731934, 'epoch': 10.97}
{'loss': 0.0505, 'grad_norm': 2.1254477500915527, 'learning_rate': 8.961788370574184e-05, 'rewards/chosen': -29.48427963256836, 'rewards/rejected': -48.76974868774414, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 19.285465240478516, 'logps/rejected': -708.6282958984375, 'logps/chosen': -573.2150268554688, 'logits/rejected': -0.059035610407590866, 'logits/chosen': 5.79821252822876, 'epoch': 11.13}
{'loss': 0.0339, 'grad_norm': 1.1768343448638916, 'learning_rate': 8.696941502695699e-05, 'rewards/chosen': -33.02846145629883, 'rewards/rejected': -54.05223846435547, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 21.02378273010254, 'logps/rejected': -765.4716796875, 'logps/chosen': -614.3074340820312, 'logits/rejected': -2.6750411987304688, 'logits/chosen': 4.037046432495117, 'epoch': 11.29}
{'loss': 0.0678, 'grad_norm': 0.9070394039154053, 'learning_rate': 8.43302135225852e-05, 'rewards/chosen': -35.6393928527832, 'rewards/rejected': -57.229164123535156, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 21.589771270751953, 'logps/rejected': -800.4617919921875, 'logps/chosen': -644.7235107421875, 'logits/rejected': -3.058537006378174, 'logits/chosen': 3.1139183044433594, 'epoch': 11.45}
{'loss': 0.0303, 'grad_norm': 0.17836210131645203, 'learning_rate': 8.170215615676144e-05, 'rewards/chosen': -30.703678131103516, 'rewards/rejected': -53.352210998535156, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 22.64853286743164, 'logps/rejected': -751.9346313476562, 'logps/chosen': -596.2297973632812, 'logits/rejected': -3.4948909282684326, 'logits/chosen': 4.5645246505737305, 'epoch': 11.61}
{'loss': 0.0359, 'grad_norm': 0.11402206122875214, 'learning_rate': 7.908711196806131e-05, 'rewards/chosen': -28.1212215423584, 'rewards/rejected': -47.832435607910156, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 19.71121597290039, 'logps/rejected': -695.6348876953125, 'logps/chosen': -549.8638916015625, 'logits/rejected': 0.13682785630226135, 'logits/chosen': 6.7879533767700195, 'epoch': 11.77}
{'loss': 0.0511, 'grad_norm': 1.0509613752365112, 'learning_rate': 7.648694074026615e-05, 'rewards/chosen': -25.704998016357422, 'rewards/rejected': -45.1023063659668, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 19.397302627563477, 'logps/rejected': -673.4549560546875, 'logps/chosen': -531.95458984375, 'logits/rejected': -1.0606974363327026, 'logits/chosen': 5.693835258483887, 'epoch': 11.94}
{'loss': 0.0615, 'grad_norm': 0.9165154695510864, 'learning_rate': 7.390349167971025e-05, 'rewards/chosen': -28.041894912719727, 'rewards/rejected': -52.23927688598633, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 24.197383880615234, 'logps/rejected': -723.61962890625, 'logps/chosen': -546.2099609375, 'logits/rejected': -2.8438587188720703, 'logits/chosen': 4.233526706695557, 'epoch': 12.1}
{'loss': 0.066, 'grad_norm': 0.2199283391237259, 'learning_rate': 7.133860210015049e-05, 'rewards/chosen': -27.243133544921875, 'rewards/rejected': -49.96009063720703, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 22.716957092285156, 'logps/rejected': -739.2334594726562, 'logps/chosen': -567.2960205078125, 'logits/rejected': -0.5627380609512329, 'logits/chosen': 6.433039665222168, 'epoch': 12.26}
{'loss': 0.0353, 'grad_norm': 1.1440831422805786, 'learning_rate': 6.879409611609393e-05, 'rewards/chosen': -24.355789184570312, 'rewards/rejected': -45.366668701171875, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 21.010879516601562, 'logps/rejected': -681.0941162109375, 'logps/chosen': -531.47216796875, 'logits/rejected': 1.5241032838821411, 'logits/chosen': 7.803997039794922, 'epoch': 12.42}
{'loss': 0.0616, 'grad_norm': 4.081747055053711, 'learning_rate': 6.627178334551228e-05, 'rewards/chosen': -24.7028751373291, 'rewards/rejected': -42.80873489379883, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 18.10586166381836, 'logps/rejected': -631.6709594726562, 'logps/chosen': -517.7276000976562, 'logits/rejected': 0.6297705769538879, 'logits/chosen': 7.445218086242676, 'epoch': 12.58}
{'loss': 0.0387, 'grad_norm': 1.2138255834579468, 'learning_rate': 6.377345762286633e-05, 'rewards/chosen': -21.73686981201172, 'rewards/rejected': -36.46218490600586, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 14.725314140319824, 'logps/rejected': -575.127685546875, 'logps/chosen': -483.1062927246094, 'logits/rejected': 1.165435791015625, 'logits/chosen': 7.374510288238525, 'epoch': 12.74}
{'loss': 0.0357, 'grad_norm': 0.24503527581691742, 'learning_rate': 6.130089572335535e-05, 'rewards/chosen': -22.734514236450195, 'rewards/rejected': -37.57093048095703, 'rewards/accuracies': 0.984375, 'rewards/margins': 14.836413383483887, 'logps/rejected': -600.592529296875, 'logps/chosen': -513.319091796875, 'logits/rejected': 1.9932796955108643, 'logits/chosen': 8.275609970092773, 'epoch': 12.9}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:10,  5.84it/s][A
  5%|▍         | 3/63 [00:00<00:16,  3.59it/s][A
  6%|▋         | 4/63 [00:01<00:19,  2.99it/s][A
  8%|▊         | 5/63 [00:01<00:21,  2.68it/s][A
 10%|▉         | 6/63 [00:02<00:23,  2.46it/s][A
 11%|█         | 7/63 [00:02<00:24,  2.32it/s][A
 13%|█▎        | 8/63 [00:03<00:23,  2.29it/s][A
 14%|█▍        | 9/63 [00:03<00:22,  2.45it/s][A
 16%|█▌        | 10/63 [00:03<00:22,  2.34it/s][A
 17%|█▋        | 11/63 [00:04<00:22,  2.28it/s][A
 19%|█▉        | 12/63 [00:04<00:22,  2.28it/s][A
 21%|██        | 13/63 [00:05<00:20,  2.43it/s][A
 22%|██▏       | 14/63 [00:05<00:21,  2.32it/s][A
 24%|██▍       | 15/63 [00:06<00:20,  2.29it/s][A
 25%|██▌       | 16/63 [00:06<00:20,  2.27it/s][A
 27%|██▋       | 17/63 [00:06<00:18,  2.43it/s][A
 29%|██▊       | 18/63 [00:07<00:17,  2.55it/s][A
 30%|███       | 19/63 [00:07<00:16,  2.64it/s][A
 32%|███▏      | 20/63 [00:07<00:17,  2.51it/s][A
 33%|███▎      | 21/63 [00:08<00:16,  2.57it/s][A
 35%|███▍      | 22/63 [00:08<00:16,  2.41it/s][A
 37%|███▋      | 23/63 [00:09<00:17,  2.31it/s][A
 38%|███▊      | 24/63 [00:09<00:17,  2.27it/s][A
 40%|███▉      | 25/63 [00:10<00:17,  2.23it/s][A
 41%|████▏     | 26/63 [00:10<00:16,  2.19it/s][A
 43%|████▎     | 27/63 [00:11<00:16,  2.16it/s][A
 44%|████▍     | 28/63 [00:11<00:16,  2.13it/s][A
 46%|████▌     | 29/63 [00:12<00:14,  2.31it/s][A
 48%|████▊     | 30/63 [00:12<00:13,  2.45it/s][A
 49%|████▉     | 31/63 [00:12<00:12,  2.57it/s][A
 51%|█████     | 32/63 [00:13<00:11,  2.65it/s][A
 52%|█████▏    | 33/63 [00:13<00:11,  2.70it/s][A
 54%|█████▍    | 34/63 [00:13<00:11,  2.55it/s][A
 56%|█████▌    | 35/63 [00:14<00:11,  2.51it/s][A
 57%|█████▋    | 36/63 [00:14<00:10,  2.61it/s][A
 59%|█████▊    | 37/63 [00:14<00:09,  2.69it/s][A
 60%|██████    | 38/63 [00:15<00:09,  2.68it/s][A
 62%|██████▏   | 39/63 [00:15<00:09,  2.47it/s][A
 63%|██████▎   | 40/63 [00:16<00:09,  2.33it/s][A
 65%|██████▌   | 41/63 [00:16<00:09,  2.44it/s][A
 67%|██████▋   | 42/63 [00:17<00:08,  2.48it/s][A
 68%|██████▊   | 43/63 [00:17<00:07,  2.58it/s][A
 70%|██████▉   | 44/63 [00:17<00:07,  2.66it/s][A
 71%|███████▏  | 45/63 [00:18<00:06,  2.72it/s][A
 73%|███████▎  | 46/63 [00:18<00:06,  2.76it/s][A
 75%|███████▍  | 47/63 [00:18<00:05,  2.79it/s][A
 76%|███████▌  | 48/63 [00:19<00:05,  2.79it/s][A
 78%|███████▊  | 49/63 [00:19<00:04,  2.81it/s][A
 79%|███████▉  | 50/63 [00:19<00:05,  2.56it/s][A
 81%|████████  | 51/63 [00:20<00:04,  2.57it/s][A
 83%|████████▎ | 52/63 [00:20<00:04,  2.41it/s][A
 84%|████████▍ | 53/63 [00:21<00:03,  2.54it/s][A
 86%|████████▌ | 54/63 [00:21<00:03,  2.62it/s][A
 87%|████████▋ | 55/63 [00:21<00:02,  2.69it/s][A
 89%|████████▉ | 56/63 [00:22<00:02,  2.74it/s][A
 90%|█████████ | 57/63 [00:22<00:02,  2.78it/s][A
 92%|█████████▏| 58/63 [00:22<00:01,  2.66it/s][A
 94%|█████████▎| 59/63 [00:23<00:01,  2.72it/s][A
 95%|█████████▌| 60/63 [00:23<00:01,  2.76it/s][A
 97%|█████████▋| 61/63 [00:24<00:00,  2.79it/s][A
 98%|█████████▊| 62/63 [00:24<00:00,  2.82it/s][A
100%|██████████| 63/63 [00:24<00:00,  2.85it/s][A                                                      
                                               [A 65%|██████▍   | 800/1240 [1:55:57<1:01:53,  8.44s/it]
100%|██████████| 63/63 [00:24<00:00,  2.85it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
 65%|██████▍   | 801/1240 [1:56:10<2:07:31, 17.43s/it] 65%|██████▍   | 802/1240 [1:56:19<1:47:06, 14.67s/it] 65%|██████▍   | 803/1240 [1:56:27<1:33:41, 12.86s/it] 65%|██████▍   | 804/1240 [1:56:36<1:24:23, 11.61s/it] 65%|██████▍   | 805/1240 [1:56:44<1:17:22, 10.67s/it] 65%|██████▌   | 806/1240 [1:56:52<1:10:37,  9.76s/it] 65%|██████▌   | 807/1240 [1:56:59<1:04:54,  8.99s/it] 65%|██████▌   | 808/1240 [1:57:08<1:03:10,  8.77s/it] 65%|██████▌   | 809/1240 [1:57:17<1:03:29,  8.84s/it] 65%|██████▌   | 810/1240 [1:57:25<1:01:48,  8.62s/it]                                                       65%|██████▌   | 810/1240 [1:57:25<1:01:48,  8.62s/it] 65%|██████▌   | 811/1240 [1:57:33<1:01:41,  8.63s/it] 65%|██████▌   | 812/1240 [1:57:42<1:01:15,  8.59s/it] 66%|██████▌   | 813/1240 [1:57:50<1:01:13,  8.60s/it] 66%|██████▌   | 814/1240 [1:57:59<1:00:46,  8.56s/it] 66%|██████▌   | 815/1240 [1:58:07<1:00:26,  8.53s/it] 66%|██████▌   | 816/1240 [1:58:15<59:22,  8.40s/it]   66%|██████▌   | 817/1240 [1:58:24<58:54,  8.36s/it] 66%|██████▌   | 818/1240 [1:58:32<57:54,  8.23s/it] 66%|██████▌   | 819/1240 [1:58:40<58:46,  8.38s/it] 66%|██████▌   | 820/1240 [1:58:49<58:56,  8.42s/it]                                                     66%|██████▌   | 820/1240 [1:58:49<58:56,  8.42s/it] 66%|██████▌   | 821/1240 [1:58:57<59:04,  8.46s/it] 66%|██████▋   | 822/1240 [1:59:06<59:26,  8.53s/it] 66%|██████▋   | 823/1240 [1:59:15<1:00:12,  8.66s/it] 66%|██████▋   | 824/1240 [1:59:23<58:30,  8.44s/it]   67%|██████▋   | 825/1240 [1:59:31<57:05,  8.25s/it] 67%|██████▋   | 826/1240 [1:59:39<56:28,  8.18s/it] 67%|██████▋   | 827/1240 [1:59:47<56:30,  8.21s/it] 67%|██████▋   | 828/1240 [1:59:55<56:06,  8.17s/it] 67%|██████▋   | 829/1240 [2:00:04<57:38,  8.42s/it] 67%|██████▋   | 830/1240 [2:00:12<56:32,  8.28s/it]                                                     67%|██████▋   | 830/1240 [2:00:12<56:32,  8.28s/it] 67%|██████▋   | 831/1240 [2:00:21<57:53,  8.49s/it] 67%|██████▋   | 832/1240 [2:00:30<58:05,  8.54s/it] 67%|██████▋   | 833/1240 [2:00:38<57:11,  8.43s/it] 67%|██████▋   | 834/1240 [2:00:47<57:50,  8.55s/it] 67%|██████▋   | 835/1240 [2:00:56<58:36,  8.68s/it] 67%|██████▋   | 836/1240 [2:01:05<59:04,  8.77s/it] 68%|██████▊   | 837/1240 [2:01:13<57:39,  8.58s/it] 68%|██████▊   | 838/1240 [2:01:22<57:53,  8.64s/it] 68%|██████▊   | 839/1240 [2:01:30<57:24,  8.59s/it] 68%|██████▊   | 840/1240 [2:01:39<58:03,  8.71s/it]                                                     68%|██████▊   | 840/1240 [2:01:39<58:03,  8.71s/it] 68%|██████▊   | 841/1240 [2:01:48<57:34,  8.66s/it] 68%|██████▊   | 842/1240 [2:01:56<57:27,  8.66s/it] 68%|██████▊   | 843/1240 [2:02:05<56:46,  8.58s/it] 68%|██████▊   | 844/1240 [2:02:14<57:26,  8.70s/it] 68%|██████▊   | 845/1240 [2:02:22<56:20,  8.56s/it] 68%|██████▊   | 846/1240 [2:02:31<56:19,  8.58s/it] 68%|██████▊   | 847/1240 [2:02:40<56:59,  8.70s/it] 68%|██████▊   | 848/1240 [2:02:48<56:33,  8.66s/it] 68%|██████▊   | 849/1240 [2:02:57<56:43,  8.70s/it] 69%|██████▊   | 850/1240 [2:03:06<56:31,  8.70s/it]                                                     69%|██████▊   | 850/1240 [2:03:06<56:31,  8.70s/it] 69%|██████▊   | 851/1240 [2:03:14<55:40,  8.59s/it] 69%|██████▊   | 852/1240 [2:03:22<54:46,  8.47s/it] 69%|██████▉   | 853/1240 [2:03:30<52:33,  8.15s/it] 69%|██████▉   | 854/1240 [2:03:38<52:27,  8.15s/it] 69%|██████▉   | 855/1240 [2:03:45<51:25,  8.02s/it] 69%|██████▉   | 856/1240 [2:03:54<53:04,  8.29s/it] 69%|██████▉   | 857/1240 [2:04:03<52:55,  8.29s/it] 69%|██████▉   | 858/1240 [2:04:10<51:08,  8.03s/it] 69%|██████▉   | 859/1240 [2:04:19<51:49,  8.16s/it] 69%|██████▉   | 860/1240 [2:04:27<52:54,  8.35s/it]                                                     69%|██████▉   | 860/1240 [2:04:27<52:54,  8.35s/it] 69%|██████▉   | 861/1240 [2:04:35<52:06,  8.25s/it] 70%|██████▉   | 862/1240 [2:04:43<51:17,  8.14s/it] 70%|██████▉   | 863/1240 [2:04:52<51:45,  8.24s/it] 70%|██████▉   | 864/1240 [2:05:00<52:12,  8.33s/it] 70%|██████▉   | 865/1240 [2:05:09<52:13,  8.36s/it] 70%|██████▉   | 866/1240 [2:05:17<51:53,  8.32s/it] 70%|██████▉   | 867/1240 [2:05:25<51:36,  8.30s/it] 70%|███████   | 868/1240 [2:05:33<49:47,  8.03s/it] 70%|███████   | 869/1240 [2:05:41<50:15,  8.13s/it] 70%|███████   | 870/1240 [2:05:49<50:36,  8.21s/it]                                                     70%|███████   | 870/1240 [2:05:49<50:36,  8.21s/it] 70%|███████   | 871/1240 [2:05:57<50:26,  8.20s/it] 70%|███████   | 872/1240 [2:06:06<50:49,  8.29s/it] 70%|███████   | 873/1240 [2:06:14<50:55,  8.33s/it] 70%|███████   | 874/1240 [2:06:23<51:00,  8.36s/it] 71%|███████   | 875/1240 [2:06:31<51:02,  8.39s/it] 71%|███████   | 876/1240 [2:06:40<51:05,  8.42s/it] 71%|███████   | 877/1240 [2:06:48<51:10,  8.46s/it] 71%|███████   | 878/1240 [2:06:56<49:20,  8.18s/it] 71%|███████   | 879/1240 [2:07:05<50:21,  8.37s/it] 71%|███████   | 880/1240 [2:07:14<51:21,  8.56s/it]                                                     71%|███████   | 880/1240 [2:07:19<51:21,  8.56s/it] 71%|███████   | 881/1240 [2:07:28<1:01:05, 10.21s/it] 71%|███████   | 882/1240 [2:07:36<58:01,  9.73s/it]   71%|███████   | 883/1240 [2:07:45<55:35,  9.34s/it] 71%|███████▏  | 884/1240 [2:07:53<53:36,  9.04s/it] 71%|███████▏  | 885/1240 [2:08:07<1:01:39, 10.42s/it] 71%|███████▏  | 886/1240 [2:08:14<55:50,  9.46s/it]   72%|███████▏  | 887/1240 [2:08:23<54:33,  9.27s/it] 72%|███████▏  | 888/1240 [2:08:31<53:08,  9.06s/it] 72%|███████▏  | 889/1240 [2:08:40<51:43,  8.84s/it] 72%|███████▏  | 890/1240 [2:08:48<51:26,  8.82s/it]                                                     72%|███████▏  | 890/1240 [2:08:48<51:26,  8.82s/it] 72%|███████▏  | 891/1240 [2:08:56<48:53,  8.41s/it] 72%|███████▏  | 892/1240 [2:09:04<48:14,  8.32s/it] 72%|███████▏  | 893/1240 [2:09:13<48:59,  8.47s/it] 72%|███████▏  | 894/1240 [2:09:21<48:27,  8.40s/it] 72%|███████▏  | 895/1240 [2:09:30<48:49,  8.49s/it] 72%|███████▏  | 896/1240 [2:09:37<46:18,  8.08s/it] 72%|███████▏  | 897/1240 [2:09:45<46:00,  8.05s/it] 72%|███████▏  | 898/1240 [2:09:54<47:03,  8.26s/it] 72%|███████▎  | 899/1240 [2:10:01<46:08,  8.12s/it] 73%|███████▎  | 900/1240 [2:10:10<46:50,  8.27s/it]                                                     73%|███████▎  | 900/1240 [2:10:10<46:50,  8.27s/it] 73%|███████▎  | 901/1240 [2:10:19<47:31,  8.41s/it] 73%|███████▎  | 902/1240 [2:10:27<47:33,  8.44s/it] 73%|███████▎  | 903/1240 [2:10:36<47:34,  8.47s/it] 73%|███████▎  | 904/1240 [2:10:45<48:18,  8.63s/it] 73%|███████▎  | 905/1240 [2:10:53<46:44,  8.37s/it] 73%|███████▎  | 906/1240 [2:11:01<47:09,  8.47s/it] 73%|███████▎  | 907/1240 [2:11:09<46:07,  8.31s/it] 73%|███████▎  | 908/1240 [2:11:17<45:02,  8.14s/it] 73%|███████▎  | 909/1240 [2:11:25<45:15,  8.20s/it] 73%|███████▎  | 910/1240 [2:11:34<45:13,  8.22s/it]                                                     73%|███████▎  | 910/1240 [2:11:34<45:13,  8.22s/it] 73%|███████▎  | 911/1240 [2:11:42<45:25,  8.28s/it] 74%|███████▎  | 912/1240 [2:11:51<45:53,  8.39s/it] 74%|███████▎  | 913/1240 [2:11:59<45:44,  8.39s/it] 74%|███████▎  | 914/1240 [2:12:07<45:37,  8.40s/it] 74%|███████▍  | 915/1240 [2:12:16<45:59,  8.49s/it] 74%|███████▍  | 916/1240 [2:12:24<45:16,  8.38s/it] 74%|███████▍  | 917/1240 [2:12:33<45:20,  8.42s/it] 74%|███████▍  | 918/1240 [2:12:41<44:44,  8.34s/it] 74%|███████▍  | 919/1240 [2:12:50<45:44,  8.55s/it] 74%|███████▍  | 920/1240 [2:12:58<44:43,  8.39s/it]                                                     74%|███████▍  | 920/1240 [2:12:58<44:43,  8.39s/it] 74%|███████▍  | 921/1240 [2:13:05<43:04,  8.10s/it] 74%|███████▍  | 922/1240 [2:13:14<44:01,  8.31s/it] 74%|███████▍  | 923/1240 [2:13:23<44:28,  8.42s/it] 75%|███████▍  | 924/1240 [2:13:31<43:47,  8.31s/it] 75%|███████▍  | 925/1240 [2:13:39<43:45,  8.34s/it] 75%|███████▍  | 926/1240 [2:13:48<43:57,  8.40s/it] 75%|███████▍  | 927/1240 [2:13:56<42:54,  8.22s/it] 75%|███████▍  | 928/1240 [2:14:05<43:58,  8.46s/it] 75%|███████▍  | 929/1240 [2:14:14<44:38,  8.61s/it] 75%|███████▌  | 930/1240 [2:14:22<44:36,  8.63s/it]                                                     75%|███████▌  | 930/1240 [2:14:22<44:36,  8.63s/it] 75%|███████▌  | 931/1240 [2:14:31<44:56,  8.73s/it] 75%|███████▌  | 932/1240 [2:14:40<45:05,  8.79s/it] 75%|███████▌  | 933/1240 [2:14:49<44:57,  8.79s/it] 75%|███████▌  | 934/1240 [2:14:57<43:34,  8.54s/it] 75%|███████▌  | 935/1240 [2:15:06<43:49,  8.62s/it] 75%|███████▌  | 936/1240 [2:15:14<43:29,  8.58s/it] 76%|███████▌  | 937/1240 [2:15:23<43:30,  8.62s/it] 76%|███████▌  | 938/1240 [2:15:32<43:25,  8.63s/it] 76%|███████▌  | 939/1240 [2:15:40<42:34,  8.49s/it] 76%|███████▌  | 940/1240 [2:15:49<42:55,  8.59s/it]                                                     76%|███████▌  | 940/1240 [2:15:49<42:55,  8.59s/it] 76%|███████▌  | 941/1240 [2:15:56<41:21,  8.30s/it] 76%|███████▌  | 942/1240 [2:16:04<40:39,  8.19s/it] 76%|███████▌  | 943/1240 [2:16:12<39:56,  8.07s/it] 76%|███████▌  | 944/1240 [2:16:21<41:09,  8.34s/it] 76%|███████▌  | 945/1240 [2:16:29<40:50,  8.31s/it] 76%|███████▋  | 946/1240 [2:16:38<40:57,  8.36s/it] 76%|███████▋  | 947/1240 [2:16:47<41:45,  8.55s/it] 76%|███████▋  | 948/1240 [2:16:55<41:31,  8.53s/it] 77%|███████▋  | 949/1240 [2:17:03<41:01,  8.46s/it] 77%|███████▋  | 950/1240 [2:17:12<41:01,  8.49s/it]                                                     77%|███████▋  | 950/1240 [2:17:12<41:01,  8.49s/it] 77%|███████▋  | 951/1240 [2:17:21<42:13,  8.77s/it] 77%|███████▋  | 952/1240 [2:17:30<42:29,  8.85s/it] 77%|███████▋  | 953/1240 [2:17:38<40:52,  8.55s/it] 77%|███████▋  | 954/1240 [2:17:47<40:51,  8.57s/it] 77%|███████▋  | 955/1240 [2:17:55<40:35,  8.55s/it] 77%|███████▋  | 956/1240 [2:18:04<40:43,  8.60s/it] 77%|███████▋  | 957/1240 [2:18:13<41:02,  8.70s/it] 77%|███████▋  | 958/1240 [2:18:22<40:51,  8.69s/it] 77%|███████▋  | 959/1240 [2:18:30<39:56,  8.53s/it] 77%|███████▋  | 960/1240 [2:18:38<39:49,  8.53s/it]                                                     77%|███████▋  | 960/1240 [2:18:38<39:49,  8.53s/it] 78%|███████▊  | 961/1240 [2:18:46<37:37,  8.09s/it] 78%|███████▊  | 962/1240 [2:18:54<38:44,  8.36s/it] 78%|███████▊  | 963/1240 [2:19:03<38:28,  8.34s/it] 78%|███████▊  | 964/1240 [2:19:11<38:29,  8.37s/it] 78%|███████▊  | 965/1240 [2:19:20<38:30,  8.40s/it] 78%|███████▊  | 966/1240 [2:19:28<38:19,  8.39s/it] 78%|███████▊  | 967/1240 [2:19:37<38:30,  8.46s/it] 78%|███████▊  | 968/1240 [2:19:45<38:46,  8.55s/it] 78%|███████▊  | 969/1240 [2:19:53<37:54,  8.39s/it] 78%|███████▊  | 970/1240 [2:20:02<37:28,  8.33s/it]                                                     78%|███████▊  | 970/1240 [2:20:02<37:28,  8.33s/it] 78%|███████▊  | 971/1240 [2:20:10<36:56,  8.24s/it] 78%|███████▊  | 972/1240 [2:20:17<36:11,  8.10s/it] 78%|███████▊  | 973/1240 [2:20:25<35:39,  8.01s/it] 79%|███████▊  | 974/1240 [2:20:33<35:45,  8.06s/it] 79%|███████▊  | 975/1240 [2:20:41<35:29,  8.04s/it] 79%|███████▊  | 976/1240 [2:20:50<35:35,  8.09s/it] 79%|███████▉  | 977/1240 [2:20:58<36:10,  8.25s/it] 79%|███████▉  | 978/1240 [2:21:07<36:12,  8.29s/it] 79%|███████▉  | 979/1240 [2:21:15<36:17,  8.34s/it] 79%|███████▉  | 980/1240 [2:21:23<35:05,  8.10s/it]                                                     79%|███████▉  | 980/1240 [2:21:23<35:05,  8.10s/it] 79%|███████▉  | 981/1240 [2:21:32<36:07,  8.37s/it] 79%|███████▉  | 982/1240 [2:21:40<36:34,  8.51s/it] 79%|███████▉  | 983/1240 [2:21:49<37:04,  8.65s/it] 79%|███████▉  | 984/1240 [2:21:58<37:06,  8.70s/it] 79%|███████▉  | 985/1240 [2:22:06<36:12,  8.52s/it] 80%|███████▉  | 986/1240 [2:22:14<35:05,  8.29s/it] 80%|███████▉  | 987/1240 [2:22:23<35:05,  8.32s/it] 80%|███████▉  | 988/1240 [2:22:31<35:12,  8.38s/it] 80%|███████▉  | 989/1240 [2:22:39<34:13,  8.18s/it] 80%|███████▉  | 990/1240 [2:22:47<34:39,  8.32s/it]                                                     80%|███████▉  | 990/1240 [2:22:47<34:39,  8.32s/it] 80%|███████▉  | 991/1240 [2:22:55<33:47,  8.14s/it] 80%|████████  | 992/1240 [2:23:04<34:01,  8.23s/it] 80%|████████  | 993/1240 [2:23:13<34:48,  8.45s/it] 80%|████████  | 994/1240 [2:23:20<34:03,  8.31s/it] 80%|████████  | 995/1240 [2:23:29<34:45,  8.51s/it] 80%|████████  | 996/1240 [2:23:38<34:56,  8.59s/it] 80%|████████  | 997/1240 [2:23:46<33:55,  8.38s/it] 80%|████████  | 998/1240 [2:23:55<33:57,  8.42s/it] 81%|████████  | 999/1240 [2:24:03<33:07,  8.25s/it] 81%|████████  | 1000/1240 [2:24:11<33:15,  8.31s/it]                                                      81%|████████  | 1000/1240 [2:24:11<33:15,  8.31s/it]{'eval_loss': 0.36401650309562683, 'eval_runtime': 25.2209, 'eval_samples_per_second': 9.873, 'eval_steps_per_second': 2.498, 'eval_rewards/chosen': -27.322513580322266, 'eval_rewards/rejected': -37.64385986328125, 'eval_rewards/accuracies': 0.817460298538208, 'eval_rewards/margins': 10.321348190307617, 'eval_logps/rejected': -621.5740356445312, 'eval_logps/chosen': -615.9976806640625, 'eval_logits/rejected': -13.116739273071289, 'eval_logits/chosen': -6.322916030883789, 'epoch': 12.9}
{'loss': 0.0334, 'grad_norm': 0.053987666964530945, 'learning_rate': 5.885585609929891e-05, 'rewards/chosen': -24.582399368286133, 'rewards/rejected': -40.0849723815918, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 15.50257396697998, 'logps/rejected': -604.7723388671875, 'logps/chosen': -503.86602783203125, 'logits/rejected': 0.1496942937374115, 'logits/chosen': 6.50872278213501, 'epoch': 13.06}
{'loss': 0.026, 'grad_norm': 0.11903229355812073, 'learning_rate': 5.644007762954926e-05, 'rewards/chosen': -25.05738067626953, 'rewards/rejected': -41.96217346191406, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 16.9047908782959, 'logps/rejected': -630.840087890625, 'logps/chosen': -524.4234619140625, 'logits/rejected': -0.8432585597038269, 'logits/chosen': 5.90420389175415, 'epoch': 13.23}
{'loss': 0.0502, 'grad_norm': 0.03333865478634834, 'learning_rate': 5.405527838282458e-05, 'rewards/chosen': -25.976512908935547, 'rewards/rejected': -44.73058319091797, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 18.754066467285156, 'logps/rejected': -651.6878051757812, 'logps/chosen': -533.2088623046875, 'logits/rejected': -1.5142756700515747, 'logits/chosen': 5.179579257965088, 'epoch': 13.39}
{'loss': 0.0803, 'grad_norm': 0.05814724415540695, 'learning_rate': 5.170315439584212e-05, 'rewards/chosen': -25.418962478637695, 'rewards/rejected': -42.200286865234375, 'rewards/accuracies': 0.96875, 'rewards/margins': 16.781328201293945, 'logps/rejected': -644.5174560546875, 'logps/chosen': -541.4200439453125, 'logits/rejected': 1.5244274139404297, 'logits/chosen': 7.263513088226318, 'epoch': 13.55}
{'loss': 0.0555, 'grad_norm': 1.1580896377563477, 'learning_rate': 4.9385378467119524e-05, 'rewards/chosen': -22.35894775390625, 'rewards/rejected': -39.12477493286133, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 16.765827178955078, 'logps/rejected': -644.1132202148438, 'logps/chosen': -525.9065551757812, 'logits/rejected': 0.6686630845069885, 'logits/chosen': 7.532066345214844, 'epoch': 13.71}
{'loss': 0.0721, 'grad_norm': 0.7742200493812561, 'learning_rate': 4.710359896730379e-05, 'rewards/chosen': -20.87116241455078, 'rewards/rejected': -36.6258659362793, 'rewards/accuracies': 0.96875, 'rewards/margins': 15.754707336425781, 'logps/rejected': -581.2542724609375, 'logps/chosen': -475.80694580078125, 'logits/rejected': -0.09356975555419922, 'logits/chosen': 6.472953796386719, 'epoch': 13.87}
{'loss': 0.0299, 'grad_norm': 0.7870330214500427, 'learning_rate': 4.485943866687217e-05, 'rewards/chosen': -18.890766143798828, 'rewards/rejected': -33.9146614074707, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 15.023897171020508, 'logps/rejected': -560.2327880859375, 'logps/chosen': -467.9940490722656, 'logits/rejected': -0.12795677781105042, 'logits/chosen': 6.940469264984131, 'epoch': 14.03}
{'loss': 0.0665, 'grad_norm': 1.5772202014923096, 'learning_rate': 4.265449358204035e-05, 'rewards/chosen': -20.128721237182617, 'rewards/rejected': -35.59992980957031, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 15.471206665039062, 'logps/rejected': -561.1829833984375, 'logps/chosen': -475.56005859375, 'logits/rejected': 0.9584413766860962, 'logits/chosen': 8.183341979980469, 'epoch': 14.19}
{'loss': 0.0416, 'grad_norm': 0.4191756844520569, 'learning_rate': 4.049033183969697e-05, 'rewards/chosen': -20.347122192382812, 'rewards/rejected': -35.55893325805664, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 15.211810111999512, 'logps/rejected': -587.32958984375, 'logps/chosen': -491.60662841796875, 'logits/rejected': 0.6691431999206543, 'logits/chosen': 7.121752738952637, 'epoch': 14.35}
{'loss': 0.0543, 'grad_norm': 0.21321791410446167, 'learning_rate': 3.836849256217355e-05, 'rewards/chosen': -20.445537567138672, 'rewards/rejected': -35.20270919799805, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 14.757169723510742, 'logps/rejected': -566.1927490234375, 'logps/chosen': -470.3067932128906, 'logits/rejected': 0.5629674196243286, 'logits/chosen': 6.513112545013428, 'epoch': 14.52}
{'loss': 0.0505, 'grad_norm': 2.096622943878174, 'learning_rate': 3.629048477264152e-05, 'rewards/chosen': -21.294992446899414, 'rewards/rejected': -38.30805587768555, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 17.013063430786133, 'logps/rejected': -597.046142578125, 'logps/chosen': -490.54669189453125, 'logits/rejected': 0.14113371074199677, 'logits/chosen': 6.9919633865356445, 'epoch': 14.68}
{'loss': 0.0602, 'grad_norm': 0.7304234504699707, 'learning_rate': 3.4257786321915506e-05, 'rewards/chosen': -21.827978134155273, 'rewards/rejected': -38.68465805053711, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 16.856679916381836, 'logps/rejected': -612.054931640625, 'logps/chosen': -495.2108459472656, 'logits/rejected': 0.6163054704666138, 'logits/chosen': 7.031887054443359, 'epoch': 14.84}
{'loss': 0.0327, 'grad_norm': 0.8152167201042175, 'learning_rate': 3.227184283742591e-05, 'rewards/chosen': -23.80375862121582, 'rewards/rejected': -41.553733825683594, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 17.74997901916504, 'logps/rejected': -637.0596923828125, 'logps/chosen': -523.5979614257812, 'logits/rejected': -1.213590383529663, 'logits/chosen': 5.853410720825195, 'epoch': 15.0}
{'loss': 0.0268, 'grad_norm': 0.1620454043149948, 'learning_rate': 3.0334066695108564e-05, 'rewards/chosen': -26.298198699951172, 'rewards/rejected': -44.78211975097656, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 18.483924865722656, 'logps/rejected': -656.5323486328125, 'logps/chosen': -538.0481567382812, 'logits/rejected': -0.5206478238105774, 'logits/chosen': 5.706634998321533, 'epoch': 15.16}
{'loss': 0.0457, 'grad_norm': 0.6790526509284973, 'learning_rate': 2.8445836014942074e-05, 'rewards/chosen': -26.568073272705078, 'rewards/rejected': -47.07135772705078, 'rewards/accuracies': 0.984375, 'rewards/margins': 20.50328826904297, 'logps/rejected': -694.9813842773438, 'logps/chosen': -545.0946655273438, 'logits/rejected': -2.6320691108703613, 'logits/chosen': 4.985241889953613, 'epoch': 15.32}
{'loss': 0.1003, 'grad_norm': 2.5080513954162598, 'learning_rate': 2.6608493680847758e-05, 'rewards/chosen': -26.87428855895996, 'rewards/rejected': -46.20600509643555, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 19.331722259521484, 'logps/rejected': -699.934326171875, 'logps/chosen': -568.0753784179688, 'logits/rejected': -1.4701647758483887, 'logits/chosen': 4.7874250411987305, 'epoch': 15.48}
{'loss': 0.0353, 'grad_norm': 0.9927492737770081, 'learning_rate': 2.482334638564877e-05, 'rewards/chosen': -26.88736915588379, 'rewards/rejected': -46.72423553466797, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 19.836870193481445, 'logps/rejected': -679.2327880859375, 'logps/chosen': -540.12109375, 'logits/rejected': -2.6351373195648193, 'logits/chosen': 4.073655605316162, 'epoch': 15.65}
{'loss': 0.0582, 'grad_norm': 1.3324698209762573, 'learning_rate': 2.3091663701768162e-05, 'rewards/chosen': -26.101001739501953, 'rewards/rejected': -46.364078521728516, 'rewards/accuracies': 0.96875, 'rewards/margins': 20.263078689575195, 'logps/rejected': -669.4969482421875, 'logps/chosen': -522.4747924804688, 'logits/rejected': -3.5100326538085938, 'logits/chosen': 4.145695686340332, 'epoch': 15.81}
{'loss': 0.0256, 'grad_norm': 1.0964006185531616, 'learning_rate': 2.141467717832616e-05, 'rewards/chosen': -24.776458740234375, 'rewards/rejected': -43.954200744628906, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 19.1777400970459, 'logps/rejected': -666.3192138671875, 'logps/chosen': -529.4495849609375, 'logits/rejected': 0.1701962947845459, 'logits/chosen': 7.208707332611084, 'epoch': 15.97}
{'loss': 0.0514, 'grad_norm': 0.4547235369682312, 'learning_rate': 1.9793579465279242e-05, 'rewards/chosen': -24.774883270263672, 'rewards/rejected': -43.07791519165039, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 18.303030014038086, 'logps/rejected': -657.4619750976562, 'logps/chosen': -529.8177490234375, 'logits/rejected': -1.4688103199005127, 'logits/chosen': 5.501675605773926, 'epoch': 16.13}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:10,  5.85it/s][A
  5%|▍         | 3/63 [00:00<00:16,  3.59it/s][A
  6%|▋         | 4/63 [00:01<00:19,  2.99it/s][A
  8%|▊         | 5/63 [00:01<00:21,  2.68it/s][A
 10%|▉         | 6/63 [00:02<00:23,  2.45it/s][A
 11%|█         | 7/63 [00:02<00:24,  2.32it/s][A
 13%|█▎        | 8/63 [00:03<00:23,  2.29it/s][A
 14%|█▍        | 9/63 [00:03<00:22,  2.44it/s][A
 16%|█▌        | 10/63 [00:03<00:22,  2.34it/s][A
 17%|█▋        | 11/63 [00:04<00:22,  2.28it/s][A
 19%|█▉        | 12/63 [00:04<00:22,  2.27it/s][A
 21%|██        | 13/63 [00:05<00:20,  2.42it/s][A
 22%|██▏       | 14/63 [00:05<00:21,  2.32it/s][A
 24%|██▍       | 15/63 [00:06<00:20,  2.29it/s][A
 25%|██▌       | 16/63 [00:06<00:20,  2.27it/s][A
 27%|██▋       | 17/63 [00:06<00:18,  2.43it/s][A
 29%|██▊       | 18/63 [00:07<00:17,  2.55it/s][A
 30%|███       | 19/63 [00:07<00:16,  2.64it/s][A
 32%|███▏      | 20/63 [00:07<00:17,  2.51it/s][A
 33%|███▎      | 21/63 [00:08<00:16,  2.57it/s][A
 35%|███▍      | 22/63 [00:08<00:17,  2.41it/s][A
 37%|███▋      | 23/63 [00:09<00:17,  2.31it/s][A
 38%|███▊      | 24/63 [00:09<00:17,  2.26it/s][A
 40%|███▉      | 25/63 [00:10<00:17,  2.23it/s][A
 41%|████▏     | 26/63 [00:10<00:16,  2.19it/s][A
 43%|████▎     | 27/63 [00:11<00:16,  2.16it/s][A
 44%|████▍     | 28/63 [00:11<00:16,  2.13it/s][A
 46%|████▌     | 29/63 [00:12<00:14,  2.31it/s][A
 48%|████▊     | 30/63 [00:12<00:13,  2.45it/s][A
 49%|████▉     | 31/63 [00:12<00:12,  2.57it/s][A
 51%|█████     | 32/63 [00:13<00:11,  2.65it/s][A
 52%|█████▏    | 33/63 [00:13<00:11,  2.71it/s][A
 54%|█████▍    | 34/63 [00:13<00:11,  2.55it/s][A
 56%|█████▌    | 35/63 [00:14<00:11,  2.52it/s][A
 57%|█████▋    | 36/63 [00:14<00:10,  2.61it/s][A
 59%|█████▊    | 37/63 [00:14<00:09,  2.69it/s][A
 60%|██████    | 38/63 [00:15<00:09,  2.68it/s][A
 62%|██████▏   | 39/63 [00:15<00:09,  2.48it/s][A
 63%|██████▎   | 40/63 [00:16<00:09,  2.35it/s][A
 65%|██████▌   | 41/63 [00:16<00:08,  2.46it/s][A
 67%|██████▋   | 42/63 [00:17<00:08,  2.49it/s][A
 68%|██████▊   | 43/63 [00:17<00:07,  2.59it/s][A
 70%|██████▉   | 44/63 [00:17<00:07,  2.67it/s][A
 71%|███████▏  | 45/63 [00:18<00:06,  2.72it/s][A
 73%|███████▎  | 46/63 [00:18<00:06,  2.76it/s][A
 75%|███████▍  | 47/63 [00:18<00:05,  2.79it/s][A
 76%|███████▌  | 48/63 [00:19<00:05,  2.79it/s][A
 78%|███████▊  | 49/63 [00:19<00:04,  2.81it/s][A
 79%|███████▉  | 50/63 [00:19<00:05,  2.56it/s][A
 81%|████████  | 51/63 [00:20<00:04,  2.57it/s][A
 83%|████████▎ | 52/63 [00:20<00:04,  2.41it/s][A
 84%|████████▍ | 53/63 [00:21<00:03,  2.53it/s][A
 86%|████████▌ | 54/63 [00:21<00:03,  2.62it/s][A
 87%|████████▋ | 55/63 [00:21<00:02,  2.69it/s][A
 89%|████████▉ | 56/63 [00:22<00:02,  2.74it/s][A
 90%|█████████ | 57/63 [00:22<00:02,  2.77it/s][A
 92%|█████████▏| 58/63 [00:22<00:01,  2.65it/s][A
 94%|█████████▎| 59/63 [00:23<00:01,  2.72it/s][A
 95%|█████████▌| 60/63 [00:23<00:01,  2.77it/s][A
 97%|█████████▋| 61/63 [00:24<00:00,  2.79it/s][A
 98%|█████████▊| 62/63 [00:24<00:00,  2.82it/s][A
100%|██████████| 63/63 [00:24<00:00,  2.85it/s][A                                                     
                                               [A 81%|████████  | 1000/1240 [2:24:36<33:15,  8.31s/it]
100%|██████████| 63/63 [00:24<00:00,  2.85it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
 81%|████████  | 1001/1240 [2:24:49<1:08:01, 17.08s/it] 81%|████████  | 1002/1240 [2:25:02<1:03:45, 16.07s/it] 81%|████████  | 1003/1240 [2:25:11<54:19, 13.75s/it]   81%|████████  | 1004/1240 [2:25:19<47:33, 12.09s/it] 81%|████████  | 1005/1240 [2:25:27<43:22, 11.08s/it] 81%|████████  | 1006/1240 [2:25:35<39:14, 10.06s/it] 81%|████████  | 1007/1240 [2:25:43<36:20,  9.36s/it] 81%|████████▏ | 1008/1240 [2:25:51<34:35,  8.95s/it] 81%|████████▏ | 1009/1240 [2:25:59<33:33,  8.71s/it] 81%|████████▏ | 1010/1240 [2:26:07<33:01,  8.61s/it]                                                      81%|████████▏ | 1010/1240 [2:26:07<33:01,  8.61s/it] 82%|████████▏ | 1011/1240 [2:26:16<32:49,  8.60s/it] 82%|████████▏ | 1012/1240 [2:26:24<32:30,  8.55s/it] 82%|████████▏ | 1013/1240 [2:26:33<32:52,  8.69s/it] 82%|████████▏ | 1014/1240 [2:26:42<32:16,  8.57s/it] 82%|████████▏ | 1015/1240 [2:26:49<31:03,  8.28s/it] 82%|████████▏ | 1016/1240 [2:26:57<30:33,  8.19s/it] 82%|████████▏ | 1017/1240 [2:27:06<30:49,  8.29s/it] 82%|████████▏ | 1018/1240 [2:27:15<31:04,  8.40s/it] 82%|████████▏ | 1019/1240 [2:27:23<30:44,  8.35s/it] 82%|████████▏ | 1020/1240 [2:27:30<29:29,  8.04s/it]                                                      82%|████████▏ | 1020/1240 [2:27:30<29:29,  8.04s/it] 82%|████████▏ | 1021/1240 [2:27:39<29:57,  8.21s/it] 82%|████████▏ | 1022/1240 [2:27:47<30:06,  8.29s/it] 82%|████████▎ | 1023/1240 [2:27:56<30:45,  8.50s/it] 83%|████████▎ | 1024/1240 [2:28:05<31:02,  8.62s/it] 83%|████████▎ | 1025/1240 [2:28:13<30:34,  8.53s/it] 83%|████████▎ | 1026/1240 [2:28:22<30:32,  8.56s/it] 83%|████████▎ | 1027/1240 [2:28:30<30:13,  8.51s/it] 83%|████████▎ | 1028/1240 [2:28:39<30:19,  8.58s/it] 83%|████████▎ | 1029/1240 [2:28:48<30:37,  8.71s/it] 83%|████████▎ | 1030/1240 [2:28:57<30:31,  8.72s/it]                                                      83%|████████▎ | 1030/1240 [2:28:57<30:31,  8.72s/it] 83%|████████▎ | 1031/1240 [2:29:06<30:24,  8.73s/it] 83%|████████▎ | 1032/1240 [2:29:13<28:55,  8.34s/it] 83%|████████▎ | 1033/1240 [2:29:22<28:59,  8.40s/it] 83%|████████▎ | 1034/1240 [2:29:30<29:01,  8.45s/it] 83%|████████▎ | 1035/1240 [2:29:39<29:06,  8.52s/it] 84%|████████▎ | 1036/1240 [2:29:47<28:10,  8.29s/it] 84%|████████▎ | 1037/1240 [2:29:55<28:25,  8.40s/it] 84%|████████▎ | 1038/1240 [2:30:04<28:37,  8.50s/it] 84%|████████▍ | 1039/1240 [2:30:13<28:57,  8.65s/it] 84%|████████▍ | 1040/1240 [2:30:22<28:55,  8.68s/it]                                                      84%|████████▍ | 1040/1240 [2:30:22<28:55,  8.68s/it] 84%|████████▍ | 1041/1240 [2:30:30<28:17,  8.53s/it] 84%|████████▍ | 1042/1240 [2:30:39<28:10,  8.54s/it] 84%|████████▍ | 1043/1240 [2:30:47<28:14,  8.60s/it] 84%|████████▍ | 1044/1240 [2:30:56<28:05,  8.60s/it] 84%|████████▍ | 1045/1240 [2:31:05<28:03,  8.63s/it] 84%|████████▍ | 1046/1240 [2:31:12<27:08,  8.40s/it] 84%|████████▍ | 1047/1240 [2:31:20<26:07,  8.12s/it] 85%|████████▍ | 1048/1240 [2:31:28<26:08,  8.17s/it] 85%|████████▍ | 1049/1240 [2:31:37<26:20,  8.27s/it] 85%|████████▍ | 1050/1240 [2:31:45<26:37,  8.41s/it]                                                      85%|████████▍ | 1050/1240 [2:31:45<26:37,  8.41s/it] 85%|████████▍ | 1051/1240 [2:31:54<26:13,  8.32s/it] 85%|████████▍ | 1052/1240 [2:32:03<26:44,  8.54s/it] 85%|████████▍ | 1053/1240 [2:32:11<26:48,  8.60s/it] 85%|████████▌ | 1054/1240 [2:32:20<27:01,  8.72s/it] 85%|████████▌ | 1055/1240 [2:32:33<30:20,  9.84s/it] 85%|████████▌ | 1056/1240 [2:32:42<29:27,  9.60s/it] 85%|████████▌ | 1057/1240 [2:32:50<27:47,  9.11s/it] 85%|████████▌ | 1058/1240 [2:32:59<27:19,  9.01s/it] 85%|████████▌ | 1059/1240 [2:33:07<27:04,  8.97s/it] 85%|████████▌ | 1060/1240 [2:33:16<26:56,  8.98s/it]                                                      85%|████████▌ | 1060/1240 [2:33:16<26:56,  8.98s/it] 86%|████████▌ | 1061/1240 [2:33:25<26:41,  8.95s/it] 86%|████████▌ | 1062/1240 [2:33:34<26:01,  8.77s/it] 86%|████████▌ | 1063/1240 [2:33:43<26:04,  8.84s/it] 86%|████████▌ | 1064/1240 [2:33:52<25:58,  8.86s/it] 86%|████████▌ | 1065/1240 [2:34:01<25:56,  8.90s/it] 86%|████████▌ | 1066/1240 [2:34:09<25:17,  8.72s/it] 86%|████████▌ | 1067/1240 [2:34:17<24:58,  8.66s/it] 86%|████████▌ | 1068/1240 [2:34:25<23:55,  8.35s/it] 86%|████████▌ | 1069/1240 [2:34:34<24:08,  8.47s/it] 86%|████████▋ | 1070/1240 [2:34:43<24:17,  8.57s/it]                                                      86%|████████▋ | 1070/1240 [2:34:43<24:17,  8.57s/it] 86%|████████▋ | 1071/1240 [2:34:50<23:33,  8.37s/it] 86%|████████▋ | 1072/1240 [2:34:59<23:19,  8.33s/it] 87%|████████▋ | 1073/1240 [2:35:06<22:25,  8.05s/it] 87%|████████▋ | 1074/1240 [2:35:14<22:21,  8.08s/it] 87%|████████▋ | 1075/1240 [2:35:23<22:33,  8.20s/it] 87%|████████▋ | 1076/1240 [2:35:31<22:49,  8.35s/it] 87%|████████▋ | 1077/1240 [2:35:40<23:00,  8.47s/it] 87%|████████▋ | 1078/1240 [2:35:48<22:35,  8.37s/it] 87%|████████▋ | 1079/1240 [2:35:57<22:37,  8.43s/it] 87%|████████▋ | 1080/1240 [2:36:05<22:04,  8.28s/it]                                                      87%|████████▋ | 1080/1240 [2:36:05<22:04,  8.28s/it] 87%|████████▋ | 1081/1240 [2:36:13<21:40,  8.18s/it] 87%|████████▋ | 1082/1240 [2:36:21<21:42,  8.24s/it] 87%|████████▋ | 1083/1240 [2:36:30<21:46,  8.32s/it] 87%|████████▋ | 1084/1240 [2:36:38<21:39,  8.33s/it] 88%|████████▊ | 1085/1240 [2:36:46<20:57,  8.12s/it] 88%|████████▊ | 1086/1240 [2:36:54<21:05,  8.22s/it] 88%|████████▊ | 1087/1240 [2:37:02<20:51,  8.18s/it] 88%|████████▊ | 1088/1240 [2:37:11<21:06,  8.33s/it] 88%|████████▊ | 1089/1240 [2:37:19<21:00,  8.35s/it] 88%|████████▊ | 1090/1240 [2:37:28<21:10,  8.47s/it]                                                      88%|████████▊ | 1090/1240 [2:37:28<21:10,  8.47s/it] 88%|████████▊ | 1091/1240 [2:37:36<20:53,  8.41s/it] 88%|████████▊ | 1092/1240 [2:37:45<20:55,  8.48s/it] 88%|████████▊ | 1093/1240 [2:37:54<20:50,  8.51s/it] 88%|████████▊ | 1094/1240 [2:38:02<20:56,  8.61s/it] 88%|████████▊ | 1095/1240 [2:38:11<21:04,  8.72s/it] 88%|████████▊ | 1096/1240 [2:38:20<21:04,  8.78s/it] 88%|████████▊ | 1097/1240 [2:38:29<20:43,  8.69s/it] 89%|████████▊ | 1098/1240 [2:38:37<20:07,  8.50s/it] 89%|████████▊ | 1099/1240 [2:38:46<20:17,  8.63s/it] 89%|████████▊ | 1100/1240 [2:38:54<19:55,  8.54s/it]                                                      89%|████████▊ | 1100/1240 [2:38:54<19:55,  8.54s/it] 89%|████████▉ | 1101/1240 [2:39:02<19:37,  8.47s/it] 89%|████████▉ | 1102/1240 [2:39:10<19:13,  8.36s/it] 89%|████████▉ | 1103/1240 [2:39:19<18:58,  8.31s/it] 89%|████████▉ | 1104/1240 [2:39:28<19:14,  8.49s/it] 89%|████████▉ | 1105/1240 [2:39:35<18:37,  8.28s/it] 89%|████████▉ | 1106/1240 [2:39:44<18:58,  8.50s/it] 89%|████████▉ | 1107/1240 [2:39:52<18:25,  8.31s/it] 89%|████████▉ | 1108/1240 [2:40:01<18:31,  8.42s/it] 89%|████████▉ | 1109/1240 [2:40:09<17:52,  8.19s/it] 90%|████████▉ | 1110/1240 [2:40:17<17:57,  8.29s/it]                                                      90%|████████▉ | 1110/1240 [2:40:17<17:57,  8.29s/it] 90%|████████▉ | 1111/1240 [2:40:26<17:56,  8.35s/it] 90%|████████▉ | 1112/1240 [2:40:33<17:23,  8.15s/it] 90%|████████▉ | 1113/1240 [2:40:42<17:19,  8.19s/it] 90%|████████▉ | 1114/1240 [2:40:50<17:29,  8.33s/it] 90%|████████▉ | 1115/1240 [2:41:04<20:36,  9.89s/it] 90%|█████████ | 1116/1240 [2:41:12<19:26,  9.41s/it] 90%|█████████ | 1117/1240 [2:41:21<18:54,  9.23s/it] 90%|█████████ | 1118/1240 [2:41:30<18:35,  9.14s/it] 90%|█████████ | 1119/1240 [2:41:38<17:42,  8.78s/it] 90%|█████████ | 1120/1240 [2:41:47<17:36,  8.81s/it]                                                      90%|█████████ | 1120/1240 [2:41:47<17:36,  8.81s/it] 90%|█████████ | 1121/1240 [2:41:54<16:45,  8.45s/it] 90%|█████████ | 1122/1240 [2:42:03<16:54,  8.60s/it] 91%|█████████ | 1123/1240 [2:42:11<16:16,  8.35s/it] 91%|█████████ | 1124/1240 [2:42:19<15:50,  8.20s/it] 91%|█████████ | 1125/1240 [2:42:27<15:50,  8.26s/it] 91%|█████████ | 1126/1240 [2:42:36<15:57,  8.40s/it] 91%|█████████ | 1127/1240 [2:42:44<15:45,  8.37s/it] 91%|█████████ | 1128/1240 [2:42:53<15:52,  8.50s/it] 91%|█████████ | 1129/1240 [2:43:01<15:41,  8.48s/it] 91%|█████████ | 1130/1240 [2:43:09<15:17,  8.34s/it]                                                      91%|█████████ | 1130/1240 [2:43:09<15:17,  8.34s/it] 91%|█████████ | 1131/1240 [2:43:18<15:05,  8.30s/it] 91%|█████████▏| 1132/1240 [2:43:26<14:51,  8.25s/it] 91%|█████████▏| 1133/1240 [2:43:34<14:53,  8.35s/it] 91%|█████████▏| 1134/1240 [2:43:42<14:14,  8.06s/it] 92%|█████████▏| 1135/1240 [2:43:50<14:09,  8.09s/it] 92%|█████████▏| 1136/1240 [2:43:59<14:27,  8.34s/it] 92%|█████████▏| 1137/1240 [2:44:07<14:05,  8.21s/it] 92%|█████████▏| 1138/1240 [2:44:15<13:47,  8.11s/it] 92%|█████████▏| 1139/1240 [2:44:23<13:50,  8.22s/it] 92%|█████████▏| 1140/1240 [2:44:32<14:01,  8.41s/it]                                                      92%|█████████▏| 1140/1240 [2:44:32<14:01,  8.41s/it] 92%|█████████▏| 1141/1240 [2:44:39<13:21,  8.09s/it] 92%|█████████▏| 1142/1240 [2:44:48<13:31,  8.28s/it] 92%|█████████▏| 1143/1240 [2:44:57<13:44,  8.50s/it] 92%|█████████▏| 1144/1240 [2:45:04<12:58,  8.11s/it] 92%|█████████▏| 1145/1240 [2:45:12<12:49,  8.11s/it] 92%|█████████▏| 1146/1240 [2:45:21<13:04,  8.34s/it] 92%|█████████▎| 1147/1240 [2:45:30<12:58,  8.38s/it] 93%|█████████▎| 1148/1240 [2:45:39<13:06,  8.55s/it] 93%|█████████▎| 1149/1240 [2:45:47<12:55,  8.53s/it] 93%|█████████▎| 1150/1240 [2:45:55<12:29,  8.33s/it]                                                      93%|█████████▎| 1150/1240 [2:45:55<12:29,  8.33s/it] 93%|█████████▎| 1151/1240 [2:46:03<12:25,  8.37s/it] 93%|█████████▎| 1152/1240 [2:46:12<12:10,  8.31s/it] 93%|█████████▎| 1153/1240 [2:46:20<11:57,  8.25s/it] 93%|█████████▎| 1154/1240 [2:46:28<11:42,  8.16s/it] 93%|█████████▎| 1155/1240 [2:46:36<11:31,  8.14s/it] 93%|█████████▎| 1156/1240 [2:46:44<11:23,  8.13s/it] 93%|█████████▎| 1157/1240 [2:46:53<11:27,  8.28s/it] 93%|█████████▎| 1158/1240 [2:47:01<11:28,  8.40s/it] 93%|█████████▎| 1159/1240 [2:47:10<11:26,  8.48s/it] 94%|█████████▎| 1160/1240 [2:47:18<11:22,  8.53s/it]                                                      94%|█████████▎| 1160/1240 [2:47:18<11:22,  8.53s/it] 94%|█████████▎| 1161/1240 [2:47:27<11:16,  8.57s/it] 94%|█████████▎| 1162/1240 [2:47:43<14:01, 10.79s/it] 94%|█████████▍| 1163/1240 [2:47:52<13:10, 10.26s/it] 94%|█████████▍| 1164/1240 [2:48:01<12:28,  9.84s/it] 94%|█████████▍| 1165/1240 [2:48:09<11:31,  9.23s/it] 94%|█████████▍| 1166/1240 [2:48:18<11:12,  9.08s/it] 94%|█████████▍| 1167/1240 [2:48:26<10:38,  8.74s/it] 94%|█████████▍| 1168/1240 [2:48:34<10:13,  8.52s/it] 94%|█████████▍| 1169/1240 [2:48:42<10:04,  8.51s/it] 94%|█████████▍| 1170/1240 [2:48:51<10:02,  8.61s/it]                                                      94%|█████████▍| 1170/1240 [2:48:51<10:02,  8.61s/it] 94%|█████████▍| 1171/1240 [2:48:59<09:47,  8.51s/it] 95%|█████████▍| 1172/1240 [2:49:08<09:43,  8.58s/it] 95%|█████████▍| 1173/1240 [2:49:16<09:33,  8.55s/it] 95%|█████████▍| 1174/1240 [2:49:25<09:16,  8.44s/it] 95%|█████████▍| 1175/1240 [2:49:33<09:08,  8.45s/it] 95%|█████████▍| 1176/1240 [2:49:42<09:09,  8.58s/it] 95%|█████████▍| 1177/1240 [2:49:51<09:04,  8.64s/it] 95%|█████████▌| 1178/1240 [2:50:00<09:00,  8.72s/it] 95%|█████████▌| 1179/1240 [2:50:09<08:56,  8.80s/it] 95%|█████████▌| 1180/1240 [2:50:17<08:50,  8.84s/it]                                                      95%|█████████▌| 1180/1240 [2:50:17<08:50,  8.84s/it] 95%|█████████▌| 1181/1240 [2:50:25<08:21,  8.49s/it] 95%|█████████▌| 1182/1240 [2:50:34<08:22,  8.66s/it] 95%|█████████▌| 1183/1240 [2:50:42<08:02,  8.46s/it] 95%|█████████▌| 1184/1240 [2:50:51<08:02,  8.61s/it] 96%|█████████▌| 1185/1240 [2:50:59<07:42,  8.40s/it] 96%|█████████▌| 1186/1240 [2:51:07<07:28,  8.31s/it] 96%|█████████▌| 1187/1240 [2:51:16<07:30,  8.49s/it] 96%|█████████▌| 1188/1240 [2:51:25<07:29,  8.65s/it] 96%|█████████▌| 1189/1240 [2:51:34<07:23,  8.69s/it] 96%|█████████▌| 1190/1240 [2:51:43<07:18,  8.78s/it]                                                      96%|█████████▌| 1190/1240 [2:51:43<07:18,  8.78s/it] 96%|█████████▌| 1191/1240 [2:51:50<06:48,  8.34s/it] 96%|█████████▌| 1192/1240 [2:52:04<08:02, 10.04s/it] 96%|█████████▌| 1193/1240 [2:52:13<07:29,  9.55s/it] 96%|█████████▋| 1194/1240 [2:52:21<06:56,  9.06s/it] 96%|█████████▋| 1195/1240 [2:52:28<06:32,  8.72s/it] 96%|█████████▋| 1196/1240 [2:52:36<06:09,  8.40s/it] 97%|█████████▋| 1197/1240 [2:52:45<06:08,  8.58s/it] 97%|█████████▋| 1198/1240 [2:52:54<06:04,  8.67s/it] 97%|█████████▋| 1199/1240 [2:53:02<05:50,  8.54s/it] 97%|█████████▋| 1200/1240 [2:53:11<05:38,  8.46s/it]                                                      97%|█████████▋| 1200/1240 [2:53:11<05:38,  8.46s/it]{'eval_loss': 0.3854941427707672, 'eval_runtime': 25.2201, 'eval_samples_per_second': 9.873, 'eval_steps_per_second': 2.498, 'eval_rewards/chosen': -30.460613250732422, 'eval_rewards/rejected': -43.44547653198242, 'eval_rewards/accuracies': 0.817460298538208, 'eval_rewards/margins': 12.984859466552734, 'eval_logps/rejected': -679.5901489257812, 'eval_logps/chosen': -647.3787231445312, 'eval_logits/rejected': -14.896931648254395, 'eval_logits/chosen': -7.438243865966797, 'epoch': 16.13}
{'loss': 0.0203, 'grad_norm': 0.0031706755980849266, 'learning_rate': 1.8229523465223785e-05, 'rewards/chosen': -24.14689826965332, 'rewards/rejected': -42.31330490112305, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 18.166404724121094, 'logps/rejected': -637.2448120117188, 'logps/chosen': -512.20263671875, 'logits/rejected': -0.7448905110359192, 'logits/chosen': 5.281518459320068, 'epoch': 16.29}
{'loss': 0.0527, 'grad_norm': 0.12324533611536026, 'learning_rate': 1.672362151346738e-05, 'rewards/chosen': -26.296401977539062, 'rewards/rejected': -45.3029899597168, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 19.006589889526367, 'logps/rejected': -668.8782348632812, 'logps/chosen': -536.9127197265625, 'logits/rejected': -1.6858609914779663, 'logits/chosen': 4.879332065582275, 'epoch': 16.45}
{'loss': 0.0359, 'grad_norm': 0.00320302858017385, 'learning_rate': 1.5276944586951203e-05, 'rewards/chosen': -28.874340057373047, 'rewards/rejected': -50.59059143066406, 'rewards/accuracies': 0.984375, 'rewards/margins': 21.716251373291016, 'logps/rejected': -732.1134643554688, 'logps/chosen': -576.3626708984375, 'logits/rejected': -2.313464641571045, 'logits/chosen': 4.795702934265137, 'epoch': 16.61}
{'loss': 0.0661, 'grad_norm': 0.8305876851081848, 'learning_rate': 1.3890521542585722e-05, 'rewards/chosen': -27.197494506835938, 'rewards/rejected': -47.61813735961914, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 20.420639038085938, 'logps/rejected': -693.2655029296875, 'logps/chosen': -555.38427734375, 'logits/rejected': -1.9669926166534424, 'logits/chosen': 5.487430572509766, 'epoch': 16.77}
{'loss': 0.0331, 'grad_norm': 0.6263542175292969, 'learning_rate': 1.2565338385541792e-05, 'rewards/chosen': -25.790735244750977, 'rewards/rejected': -45.36847686767578, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 19.577739715576172, 'logps/rejected': -669.6068725585938, 'logps/chosen': -534.1070556640625, 'logits/rejected': -0.6435641050338745, 'logits/chosen': 6.317205429077148, 'epoch': 16.94}
{'loss': 0.0551, 'grad_norm': 1.2782710790634155, 'learning_rate': 1.130233756801714e-05, 'rewards/chosen': -25.18434715270996, 'rewards/rejected': -44.358158111572266, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 19.173810958862305, 'logps/rejected': -666.3357543945312, 'logps/chosen': -538.5331420898438, 'logits/rejected': 0.9855791330337524, 'logits/chosen': 7.376808166503906, 'epoch': 17.1}
{'loss': 0.0233, 'grad_norm': 0.7185819149017334, 'learning_rate': 1.0102417318977253e-05, 'rewards/chosen': -24.965206146240234, 'rewards/rejected': -45.98534393310547, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 21.020137786865234, 'logps/rejected': -686.6560668945312, 'logps/chosen': -528.822021484375, 'logits/rejected': 0.9084335565567017, 'logits/chosen': 8.329963684082031, 'epoch': 17.26}
{'loss': 0.0392, 'grad_norm': 0.013260944746434689, 'learning_rate': 8.96643100534711e-06, 'rewards/chosen': -25.923681259155273, 'rewards/rejected': -44.631500244140625, 'rewards/accuracies': 0.984375, 'rewards/margins': 18.707815170288086, 'logps/rejected': -658.181884765625, 'logps/chosen': -530.7698974609375, 'logits/rejected': -1.776775598526001, 'logits/chosen': 5.22568941116333, 'epoch': 17.42}
{'loss': 0.0178, 'grad_norm': 0.11034844070672989, 'learning_rate': 7.895186525108411e-06, 'rewards/chosen': -25.765111923217773, 'rewards/rejected': -44.95467758178711, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 19.18956756591797, 'logps/rejected': -658.0128173828125, 'logps/chosen': -527.853515625, 'logits/rejected': -1.4092079401016235, 'logits/chosen': 5.5691633224487305, 'epoch': 17.58}
{'loss': 0.0414, 'grad_norm': 0.7103340029716492, 'learning_rate': 6.889445732733324e-06, 'rewards/chosen': -26.904617309570312, 'rewards/rejected': -44.98784255981445, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 18.08323097229004, 'logps/rejected': -676.6290283203125, 'logps/chosen': -549.85302734375, 'logits/rejected': 1.2626233100891113, 'logits/chosen': 6.888890266418457, 'epoch': 17.74}
{'loss': 0.0449, 'grad_norm': 0.5584892630577087, 'learning_rate': 5.9499238973641735e-06, 'rewards/chosen': -25.71503257751465, 'rewards/rejected': -44.264678955078125, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 18.549652099609375, 'logps/rejected': -659.9237060546875, 'logps/chosen': -536.7838745117188, 'logits/rejected': -2.144402503967285, 'logits/chosen': 4.21384334564209, 'epoch': 17.9}
{'loss': 0.041, 'grad_norm': 1.7134792804718018, 'learning_rate': 5.0772891941236245e-06, 'rewards/chosen': -26.382831573486328, 'rewards/rejected': -46.90077590942383, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 20.51795196533203, 'logps/rejected': -698.3592529296875, 'logps/chosen': -556.62890625, 'logits/rejected': -2.220043897628784, 'logits/chosen': 4.680758476257324, 'epoch': 18.06}
{'loss': 0.0753, 'grad_norm': 0.4195418357849121, 'learning_rate': 4.272162228917809e-06, 'rewards/chosen': -26.327564239501953, 'rewards/rejected': -45.32537841796875, 'rewards/accuracies': 0.96875, 'rewards/margins': 18.997817993164062, 'logps/rejected': -656.6041259765625, 'logps/chosen': -525.0614013671875, 'logits/rejected': -1.001911997795105, 'logits/chosen': 5.7090044021606445, 'epoch': 18.23}
{'loss': 0.0316, 'grad_norm': 0.959153413772583, 'learning_rate': 3.5351155970696604e-06, 'rewards/chosen': -25.7590389251709, 'rewards/rejected': -45.006072998046875, 'rewards/accuracies': 0.984375, 'rewards/margins': 19.247028350830078, 'logps/rejected': -659.39453125, 'logps/chosen': -524.3194580078125, 'logits/rejected': -1.755251169204712, 'logits/chosen': 5.060983180999756, 'epoch': 18.39}
{'loss': 0.045, 'grad_norm': 0.04619275778532028, 'learning_rate': 2.8666734760970928e-06, 'rewards/chosen': -26.335397720336914, 'rewards/rejected': -46.31227493286133, 'rewards/accuracies': 0.984375, 'rewards/margins': 19.97688102722168, 'logps/rejected': -680.1692504882812, 'logps/chosen': -545.2799072265625, 'logits/rejected': -1.702419638633728, 'logits/chosen': 5.227581024169922, 'epoch': 18.55}
{'loss': 0.0588, 'grad_norm': 0.6884106397628784, 'learning_rate': 2.2673112529249753e-06, 'rewards/chosen': -25.78818702697754, 'rewards/rejected': -43.58867645263672, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 17.80048942565918, 'logps/rejected': -659.7755126953125, 'logps/chosen': -534.32421875, 'logits/rejected': -0.184278205037117, 'logits/chosen': 5.5108113288879395, 'epoch': 18.71}
{'loss': 0.0473, 'grad_norm': 0.9252565503120422, 'learning_rate': 1.7374551857965882e-06, 'rewards/chosen': -25.38581085205078, 'rewards/rejected': -45.39682388305664, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 20.011011123657227, 'logps/rejected': -676.25732421875, 'logps/chosen': -537.3101806640625, 'logits/rejected': -1.3527166843414307, 'logits/chosen': 5.521178245544434, 'epoch': 18.87}
{'loss': 0.0435, 'grad_norm': 0.968565046787262, 'learning_rate': 1.2774821011243832e-06, 'rewards/chosen': -26.629592895507812, 'rewards/rejected': -45.91869354248047, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 19.289104461669922, 'logps/rejected': -688.7579345703125, 'logps/chosen': -556.16064453125, 'logits/rejected': 0.9320158958435059, 'logits/chosen': 7.01648473739624, 'epoch': 19.03}
{'loss': 0.0447, 'grad_norm': 2.9514622688293457, 'learning_rate': 8.87719125496278e-07, 'rewards/chosen': -26.546112060546875, 'rewards/rejected': -45.89451217651367, 'rewards/accuracies': 0.984375, 'rewards/margins': 19.348403930664062, 'logps/rejected': -679.9346923828125, 'logps/chosen': -550.4248657226562, 'logits/rejected': 0.8006094694137573, 'logits/chosen': 6.687628746032715, 'epoch': 19.19}
{'loss': 0.0209, 'grad_norm': 0.6497416496276855, 'learning_rate': 5.684434530277005e-07, 'rewards/chosen': -25.207874298095703, 'rewards/rejected': -43.53658676147461, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 18.328710556030273, 'logps/rejected': -643.52978515625, 'logps/chosen': -516.1068115234375, 'logits/rejected': -1.1074254512786865, 'logits/chosen': 6.023555755615234, 'epoch': 19.35}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:10,  5.82it/s][A
  5%|▍         | 3/63 [00:00<00:16,  3.58it/s][A
  6%|▋         | 4/63 [00:01<00:19,  2.98it/s][A
  8%|▊         | 5/63 [00:01<00:21,  2.67it/s][A
 10%|▉         | 6/63 [00:02<00:23,  2.45it/s][A
 11%|█         | 7/63 [00:02<00:24,  2.32it/s][A
 13%|█▎        | 8/63 [00:03<00:23,  2.29it/s][A
 14%|█▍        | 9/63 [00:03<00:22,  2.40it/s][A
 16%|█▌        | 10/63 [00:03<00:22,  2.31it/s][A
 17%|█▋        | 11/63 [00:04<00:22,  2.26it/s][A
 19%|█▉        | 12/63 [00:04<00:22,  2.26it/s][A
 21%|██        | 13/63 [00:05<00:20,  2.41it/s][A
 22%|██▏       | 14/63 [00:05<00:21,  2.31it/s][A
 24%|██▍       | 15/63 [00:06<00:20,  2.29it/s][A
 25%|██▌       | 16/63 [00:06<00:20,  2.27it/s][A
 27%|██▋       | 17/63 [00:06<00:18,  2.42it/s][A
 29%|██▊       | 18/63 [00:07<00:17,  2.54it/s][A
 30%|███       | 19/63 [00:07<00:16,  2.63it/s][A
 32%|███▏      | 20/63 [00:08<00:17,  2.51it/s][A
 33%|███▎      | 21/63 [00:08<00:16,  2.57it/s][A
 35%|███▍      | 22/63 [00:08<00:17,  2.41it/s][A
 37%|███▋      | 23/63 [00:09<00:17,  2.31it/s][A
 38%|███▊      | 24/63 [00:09<00:17,  2.26it/s][A
 40%|███▉      | 25/63 [00:10<00:17,  2.23it/s][A
 41%|████▏     | 26/63 [00:10<00:16,  2.19it/s][A
 43%|████▎     | 27/63 [00:11<00:16,  2.16it/s][A
 44%|████▍     | 28/63 [00:11<00:16,  2.13it/s][A
 46%|████▌     | 29/63 [00:12<00:14,  2.31it/s][A
 48%|████▊     | 30/63 [00:12<00:13,  2.45it/s][A
 49%|████▉     | 31/63 [00:12<00:12,  2.56it/s][A
 51%|█████     | 32/63 [00:13<00:11,  2.65it/s][A
 52%|█████▏    | 33/63 [00:13<00:11,  2.71it/s][A
 54%|█████▍    | 34/63 [00:13<00:11,  2.55it/s][A
 56%|█████▌    | 35/63 [00:14<00:11,  2.52it/s][A
 57%|█████▋    | 36/63 [00:14<00:10,  2.61it/s][A
 59%|█████▊    | 37/63 [00:14<00:09,  2.69it/s][A
 60%|██████    | 38/63 [00:15<00:09,  2.68it/s][A
 62%|██████▏   | 39/63 [00:15<00:09,  2.47it/s][A
 63%|██████▎   | 40/63 [00:16<00:09,  2.35it/s][A
 65%|██████▌   | 41/63 [00:16<00:08,  2.46it/s][A
 67%|██████▋   | 42/63 [00:17<00:08,  2.49it/s][A
 68%|██████▊   | 43/63 [00:17<00:07,  2.59it/s][A
 70%|██████▉   | 44/63 [00:17<00:07,  2.67it/s][A
 71%|███████▏  | 45/63 [00:18<00:06,  2.73it/s][A
 73%|███████▎  | 46/63 [00:18<00:06,  2.77it/s][A
 75%|███████▍  | 47/63 [00:18<00:05,  2.80it/s][A
 76%|███████▌  | 48/63 [00:19<00:05,  2.79it/s][A
 78%|███████▊  | 49/63 [00:19<00:04,  2.82it/s][A
 79%|███████▉  | 50/63 [00:19<00:05,  2.56it/s][A
 81%|████████  | 51/63 [00:20<00:04,  2.57it/s][A
 83%|████████▎ | 52/63 [00:20<00:04,  2.41it/s][A
 84%|████████▍ | 53/63 [00:21<00:03,  2.53it/s][A
 86%|████████▌ | 54/63 [00:21<00:03,  2.63it/s][A
 87%|████████▋ | 55/63 [00:21<00:02,  2.69it/s][A
 89%|████████▉ | 56/63 [00:22<00:02,  2.75it/s][A
 90%|█████████ | 57/63 [00:22<00:02,  2.78it/s][A
 92%|█████████▏| 58/63 [00:23<00:01,  2.66it/s][A
 94%|█████████▎| 59/63 [00:23<00:01,  2.72it/s][A
 95%|█████████▌| 60/63 [00:23<00:01,  2.76it/s][A
 97%|█████████▋| 61/63 [00:24<00:00,  2.79it/s][A
 98%|█████████▊| 62/63 [00:24<00:00,  2.82it/s][A
100%|██████████| 63/63 [00:24<00:00,  2.85it/s][A                                                     
                                               [A 97%|█████████▋| 1200/1240 [2:53:36<05:38,  8.46s/it]
100%|██████████| 63/63 [00:24<00:00,  2.85it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
 97%|█████████▋| 1201/1240 [2:53:49<11:17, 17.37s/it] 97%|█████████▋| 1202/1240 [2:53:57<09:19, 14.73s/it] 97%|█████████▋| 1203/1240 [2:54:05<07:42, 12.51s/it] 97%|█████████▋| 1204/1240 [2:54:14<06:51, 11.44s/it] 97%|█████████▋| 1205/1240 [2:54:22<06:09, 10.57s/it] 97%|█████████▋| 1206/1240 [2:54:31<05:43, 10.09s/it] 97%|█████████▋| 1207/1240 [2:54:40<05:22,  9.76s/it] 97%|█████████▋| 1208/1240 [2:54:48<04:59,  9.37s/it] 98%|█████████▊| 1209/1240 [2:54:57<04:45,  9.22s/it] 98%|█████████▊| 1210/1240 [2:55:05<04:26,  8.87s/it]                                                      98%|█████████▊| 1210/1240 [2:55:05<04:26,  8.87s/it] 98%|█████████▊| 1211/1240 [2:55:14<04:17,  8.89s/it] 98%|█████████▊| 1212/1240 [2:55:23<04:08,  8.88s/it] 98%|█████████▊| 1213/1240 [2:55:32<04:00,  8.91s/it] 98%|█████████▊| 1214/1240 [2:55:41<03:47,  8.74s/it] 98%|█████████▊| 1215/1240 [2:55:49<03:33,  8.53s/it] 98%|█████████▊| 1216/1240 [2:55:57<03:23,  8.48s/it] 98%|█████████▊| 1217/1240 [2:56:05<03:10,  8.30s/it] 98%|█████████▊| 1218/1240 [2:56:13<03:02,  8.31s/it] 98%|█████████▊| 1219/1240 [2:56:22<02:57,  8.44s/it] 98%|█████████▊| 1220/1240 [2:56:29<02:43,  8.16s/it]                                                      98%|█████████▊| 1220/1240 [2:56:29<02:43,  8.16s/it] 98%|█████████▊| 1221/1240 [2:56:38<02:36,  8.22s/it] 99%|█████████▊| 1222/1240 [2:56:46<02:27,  8.17s/it] 99%|█████████▊| 1223/1240 [2:56:54<02:21,  8.31s/it] 99%|█████████▊| 1224/1240 [2:57:03<02:13,  8.32s/it] 99%|█████████▉| 1225/1240 [2:57:11<02:04,  8.33s/it] 99%|█████████▉| 1226/1240 [2:57:20<01:58,  8.48s/it] 99%|█████████▉| 1227/1240 [2:57:29<01:52,  8.63s/it] 99%|█████████▉| 1228/1240 [2:57:37<01:42,  8.52s/it] 99%|█████████▉| 1229/1240 [2:57:46<01:34,  8.58s/it] 99%|█████████▉| 1230/1240 [2:57:54<01:22,  8.28s/it]                                                      99%|█████████▉| 1230/1240 [2:57:59<01:22,  8.28s/it] 99%|█████████▉| 1231/1240 [2:58:08<01:31, 10.15s/it] 99%|█████████▉| 1232/1240 [2:58:16<01:15,  9.48s/it] 99%|█████████▉| 1233/1240 [2:58:25<01:04,  9.22s/it]100%|█████████▉| 1234/1240 [2:58:34<00:54,  9.15s/it]100%|█████████▉| 1235/1240 [2:58:42<00:44,  8.91s/it]100%|█████████▉| 1236/1240 [2:58:50<00:34,  8.72s/it]100%|█████████▉| 1237/1240 [2:58:59<00:25,  8.66s/it]100%|█████████▉| 1238/1240 [2:59:07<00:17,  8.62s/it]100%|█████████▉| 1239/1240 [2:59:16<00:08,  8.62s/it]100%|██████████| 1240/1240 [2:59:23<00:00,  8.20s/it]                                                     100%|██████████| 1240/1240 [2:59:23<00:00,  8.20s/it]                                                     100%|██████████| 1240/1240 [2:59:25<00:00,  8.20s/it]100%|██████████| 1240/1240 [2:59:25<00:00,  8.68s/it]
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_google--flan-t5-large--hf-_Original_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 0.40568089485168457, 'eval_runtime': 25.2324, 'eval_samples_per_second': 9.868, 'eval_steps_per_second': 2.497, 'eval_rewards/chosen': -31.110782623291016, 'eval_rewards/rejected': -44.08430099487305, 'eval_rewards/accuracies': 0.8134920597076416, 'eval_rewards/margins': 12.973519325256348, 'eval_logps/rejected': -685.9783935546875, 'eval_logps/chosen': -653.88037109375, 'eval_logits/rejected': -14.734962463378906, 'eval_logits/chosen': -7.433224678039551, 'epoch': 19.35}
{'loss': 0.044, 'grad_norm': 1.4221951961517334, 'learning_rate': 3.198821482248593e-07, 'rewards/chosen': -25.092937469482422, 'rewards/rejected': -44.64043426513672, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 19.54749298095703, 'logps/rejected': -676.1212158203125, 'logps/chosen': -537.3775634765625, 'logits/rejected': -0.3545660972595215, 'logits/chosen': 6.534432888031006, 'epoch': 19.52}
{'loss': 0.0748, 'grad_norm': 0.9118994474411011, 'learning_rate': 1.4221198449960727e-07, 'rewards/chosen': -25.63753890991211, 'rewards/rejected': -43.71643829345703, 'rewards/accuracies': 0.96875, 'rewards/margins': 18.078899383544922, 'logps/rejected': -647.52685546875, 'logps/chosen': -524.1959838867188, 'logits/rejected': -1.105089783668518, 'logits/chosen': 5.491285800933838, 'epoch': 19.68}
{'loss': 0.0384, 'grad_norm': 0.6487678289413452, 'learning_rate': 3.555931845053984e-08, 'rewards/chosen': -25.9024658203125, 'rewards/rejected': -45.46229553222656, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 19.559831619262695, 'logps/rejected': -684.0654296875, 'logps/chosen': -553.449462890625, 'logits/rejected': -3.047311305999756, 'logits/chosen': 3.9942450523376465, 'epoch': 19.84}
{'loss': 0.0322, 'grad_norm': 0.6358293294906616, 'learning_rate': 0.0, 'rewards/chosen': -26.927576065063477, 'rewards/rejected': -46.45574951171875, 'rewards/accuracies': 0.984375, 'rewards/margins': 19.528173446655273, 'logps/rejected': -678.9532470703125, 'logps/chosen': -540.971923828125, 'logits/rejected': -1.9374316930770874, 'logits/chosen': 4.407662868499756, 'epoch': 20.0}
{'train_runtime': 10785.649, 'train_samples_per_second': 3.679, 'train_steps_per_second': 0.115, 'train_loss': 0.09262568949451369, 'epoch': 20.0}
wandb: - 468.492 MB of 468.492 MB uploadedwandb: \ 468.492 MB of 468.521 MB uploadedwandb: | 468.521 MB of 468.521 MB uploadedwandb: 
wandb: Run history:
wandb:       eval/logits/chosen ▁█▇▅▁▁
wandb:     eval/logits/rejected ▁▄█▆▂▃
wandb:        eval/logps/chosen █▇▅▃▁▁
wandb:      eval/logps/rejected ██▇▄▁▁
wandb:                eval/loss ▆▁▅▅▇█
wandb:  eval/rewards/accuracies ▁█▃▄▄▃
wandb:      eval/rewards/chosen █▇▅▃▁▁
wandb:     eval/rewards/margins ▆▅▁▄██
wandb:    eval/rewards/rejected ██▇▄▁▁
wandb:             eval/runtime █▆▁▁▁▁
wandb:  eval/samples_per_second ▁▃████
wandb:    eval/steps_per_second ▁▃████
wandb:              train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:        train/global_step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:          train/grad_norm ▄▅▅▅▄▃▇▁▂▄▂▃▆▂▇▄▅█▃▂▂▂▃▁▁▃▁▂▂▂▂▃▁▂▁▂▃▃▂▂
wandb:      train/learning_rate ▂▆███████▇▇▇▇▇▆▆▆▆▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:      train/logits/chosen █▅▅▄▄▅▃▄▄▄▄▅▄▇▁▆▄▅▅▆▆▅▅▆▆▆▅▆▆▆▅▅▅▆▅▅▅▅▅▅
wandb:    train/logits/rejected █▅▅▄▄▅▃▄▄▄▄▅▃▆▁▆▃▄▄▆▆▅▅▆▅▆▅▅▆▆▅▄▅▅▅▅▅▅▅▅
wandb:       train/logps/chosen ███▇▇▇▅▆▆▆▆▅▄▆▁▆▄▅▄▅▅▅▃▄▄▅▄▅▅▅▄▅▅▄▅▄▅▄▅▄
wandb:     train/logps/rejected ██▇▇▇▇▄▆▆▆▅▅▃▆▁▆▄▄▄▅▅▄▃▄▄▅▄▅▅▅▄▄▄▄▄▄▄▄▄▄
wandb:               train/loss █▄▃▃▂▂▂▁▂▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: train/rewards/accuracies ▁▆▆▇▇▇██████████████████████████████████
wandb:     train/rewards/chosen ███▇▇▇▅▆▆▆▆▅▄▆▁▆▄▅▄▅▅▅▃▄▄▅▄▅▅▅▄▄▅▄▄▄▄▅▅▄
wandb:    train/rewards/margins ▁▂▂▃▃▃▅▄▄▄▄▅▆▃█▄▅▆▆▄▅▅▆▅▆▄▅▅▄▅▆▆▅▅▅▅▅▆▅▅
wandb:   train/rewards/rejected ██▇▇▇▇▅▆▆▆▅▅▄▆▁▆▄▄▄▅▅▄▃▄▄▅▄▅▅▅▄▄▄▄▄▄▄▄▄▄
wandb: 
wandb: Run summary:
wandb:       eval/logits/chosen -7.43322
wandb:     eval/logits/rejected -14.73496
wandb:        eval/logps/chosen -653.88037
wandb:      eval/logps/rejected -685.97839
wandb:                eval/loss 0.40568
wandb:  eval/rewards/accuracies 0.81349
wandb:      eval/rewards/chosen -31.11078
wandb:     eval/rewards/margins 12.97352
wandb:    eval/rewards/rejected -44.0843
wandb:             eval/runtime 25.2324
wandb:  eval/samples_per_second 9.868
wandb:    eval/steps_per_second 2.497
wandb:               total_flos 0.0
wandb:              train/epoch 20.0
wandb:        train/global_step 1240
wandb:          train/grad_norm 0.63583
wandb:      train/learning_rate 0.0
wandb:      train/logits/chosen 4.40766
wandb:    train/logits/rejected -1.93743
wandb:       train/logps/chosen -540.97192
wandb:     train/logps/rejected -678.95325
wandb:               train/loss 0.0322
wandb: train/rewards/accuracies 0.98438
wandb:     train/rewards/chosen -26.92758
wandb:    train/rewards/margins 19.52817
wandb:   train/rewards/rejected -46.45575
wandb:               train_loss 0.09263
wandb:            train_runtime 10785.649
wandb: train_samples_per_second 3.679
wandb:   train_steps_per_second 0.115
wandb: 
wandb: 🚀 View run dpo_google--flan-t5-large--hf-_None_lr-0.0002_ep-20_bz-8-acc-4_lora-r-128-ap-256 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/ecbxj4ao
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240524_010057-ecbxj4ao/logs
