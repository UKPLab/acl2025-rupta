`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:20<00:20, 20.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:31<00:00, 14.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:31<00:00, 15.72s/it]
`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:15<00:15, 15.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 10.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 11.47s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Found max lenth: 4096
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map:  50%|█████     | 1000/1984 [00:00<00:00, 1602.79 examples/s]Map: 100%|██████████| 1984/1984 [00:00<00:00, 2854.18 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 13365.18 examples/s]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Parameter 'function'=<bound method DPOTrainer.tokenize_row of <trl.trainer.dpo_trainer.DPOTrainer object at 0x7f1188752cd0>> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
trainable params: 50331648 || all params: 2059146240 || trainables%: 2.4442969140453084
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map:   1%|▏         | 26/1984 [00:00<00:07, 245.24 examples/s]Map:   3%|▎         | 56/1984 [00:00<00:07, 269.19 examples/s]Map:   4%|▍         | 89/1984 [00:00<00:06, 293.83 examples/s]Map:   6%|▌         | 122/1984 [00:00<00:06, 299.78 examples/s]Map:   8%|▊         | 167/1984 [00:00<00:06, 290.17 examples/s]Map:  10%|▉         | 197/1984 [00:00<00:06, 291.61 examples/s]Map:  12%|█▏        | 230/1984 [00:00<00:05, 300.15 examples/s]Map:  13%|█▎        | 261/1984 [00:00<00:05, 299.66 examples/s]Map:  15%|█▌        | 306/1984 [00:01<00:05, 293.34 examples/s]Map:  17%|█▋        | 339/1984 [00:01<00:05, 302.07 examples/s]Map:  19%|█▉        | 378/1984 [00:01<00:04, 322.51 examples/s]Map:  21%|██        | 416/1984 [00:01<00:04, 337.34 examples/s]Map:  23%|██▎       | 466/1984 [00:01<00:04, 331.99 examples/s]Map:  26%|██▌       | 516/1984 [00:01<00:04, 327.81 examples/s]Map:  28%|██▊       | 554/1984 [00:01<00:04, 336.82 examples/s]Map:  30%|██▉       | 590/1984 [00:01<00:04, 340.17 examples/s]Map:  32%|███▏      | 637/1984 [00:02<00:04, 325.78 examples/s]Map:  35%|███▍      | 686/1984 [00:02<00:04, 320.70 examples/s]Map:  37%|███▋      | 729/1984 [00:02<00:04, 299.46 examples/s]Map:  39%|███▊      | 766/1984 [00:02<00:03, 314.08 examples/s]Map:  40%|████      | 800/1984 [00:02<00:03, 314.00 examples/s]Map:  42%|████▏     | 834/1984 [00:02<00:03, 318.85 examples/s]Map:  44%|████▍     | 877/1984 [00:02<00:03, 304.72 examples/s]Map:  46%|████▌     | 909/1984 [00:02<00:03, 305.92 examples/s]Map:  48%|████▊     | 947/1984 [00:03<00:03, 322.76 examples/s]Map:  49%|████▉     | 981/1984 [00:03<00:03, 325.13 examples/s]Map:  51%|█████▏    | 1019/1984 [00:03<00:08, 120.45 examples/s]Map:  53%|█████▎    | 1056/1984 [00:03<00:06, 150.57 examples/s]Map:  55%|█████▍    | 1090/1984 [00:04<00:05, 177.92 examples/s]Map:  57%|█████▋    | 1122/1984 [00:04<00:04, 201.69 examples/s]Map:  58%|█████▊    | 1156/1984 [00:04<00:03, 227.35 examples/s]Map:  60%|█████▉    | 1187/1984 [00:04<00:03, 243.52 examples/s]Map:  61%|██████▏   | 1218/1984 [00:04<00:02, 257.39 examples/s]Map:  63%|██████▎   | 1255/1984 [00:04<00:02, 283.49 examples/s]Map:  66%|██████▌   | 1306/1984 [00:04<00:02, 300.05 examples/s]Map:  68%|██████▊   | 1341/1984 [00:04<00:02, 311.87 examples/s]Map:  70%|███████   | 1389/1984 [00:05<00:01, 312.13 examples/s]Map:  73%|███████▎  | 1440/1984 [00:05<00:01, 316.33 examples/s]Map:  74%|███████▍  | 1473/1984 [00:05<00:01, 316.13 examples/s]Map:  76%|███████▌  | 1506/1984 [00:05<00:01, 318.49 examples/s]Map:  78%|███████▊  | 1543/1984 [00:05<00:01, 327.01 examples/s]Map:  80%|████████  | 1588/1984 [00:05<00:01, 312.79 examples/s]Map:  83%|████████▎ | 1637/1984 [00:05<00:01, 313.44 examples/s]Map:  84%|████████▍ | 1673/1984 [00:05<00:00, 321.82 examples/s]Map:  86%|████████▌ | 1709/1984 [00:06<00:00, 330.08 examples/s]Map:  88%|████████▊ | 1745/1984 [00:06<00:00, 333.56 examples/s]Map:  90%|█████████ | 1790/1984 [00:06<00:00, 316.44 examples/s]Map:  93%|█████████▎| 1837/1984 [00:06<00:00, 311.00 examples/s]Map:  94%|█████████▍| 1873/1984 [00:06<00:00, 322.32 examples/s]Map:  96%|█████████▌| 1906/1984 [00:06<00:00, 322.26 examples/s]Map:  98%|█████████▊| 1944/1984 [00:06<00:00, 332.59 examples/s]Map: 100%|██████████| 1984/1984 [00:07<00:00, 130.04 examples/s]Map: 100%|██████████| 1984/1984 [00:07<00:00, 265.90 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map:  11%|█         | 28/249 [00:00<00:00, 275.92 examples/s]Map:  24%|██▍       | 60/249 [00:00<00:00, 287.05 examples/s]Map:  37%|███▋      | 92/249 [00:00<00:00, 294.04 examples/s]Map:  49%|████▉     | 122/249 [00:00<00:00, 291.54 examples/s]Map:  62%|██████▏   | 155/249 [00:00<00:00, 299.37 examples/s]Map:  76%|███████▌  | 189/249 [00:00<00:00, 307.64 examples/s]Map:  90%|████████▉ | 223/249 [00:00<00:00, 312.36 examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 257.20 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240526_204744-ui4gt5vb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dpo_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0001_ep-7_bz-8-acc-4_lora-r-32-ap-64
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/ui4gt5vb
  0%|          | 0/434 [00:00<?, ?it/s]/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
You are not running the flash-attention implementation, expect numerical differences.
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/434 [00:41<4:59:48, 41.54s/it]  0%|          | 2/434 [01:09<4:00:10, 33.36s/it]  1%|          | 3/434 [02:00<4:56:55, 41.34s/it]  1%|          | 4/434 [02:47<5:13:58, 43.81s/it]  1%|          | 5/434 [03:29<5:07:56, 43.07s/it]  1%|▏         | 6/434 [04:02<4:44:08, 39.83s/it]  2%|▏         | 7/434 [04:52<5:05:07, 42.88s/it]  2%|▏         | 8/434 [05:29<4:52:55, 41.26s/it]  2%|▏         | 9/434 [06:05<4:40:29, 39.60s/it]  2%|▏         | 10/434 [06:35<4:17:56, 36.50s/it]                                                    2%|▏         | 10/434 [06:35<4:17:56, 36.50s/it]  3%|▎         | 11/434 [07:03<3:59:09, 33.92s/it]  3%|▎         | 12/434 [07:58<4:43:29, 40.31s/it]  3%|▎         | 13/434 [08:28<4:20:18, 37.10s/it]  3%|▎         | 14/434 [09:03<4:15:16, 36.47s/it]  3%|▎         | 15/434 [09:38<4:12:03, 36.09s/it]  4%|▎         | 16/434 [10:03<3:48:14, 32.76s/it]  4%|▍         | 17/434 [10:48<4:14:07, 36.57s/it]  4%|▍         | 18/434 [11:29<4:21:20, 37.69s/it]  4%|▍         | 19/434 [12:20<4:49:25, 41.84s/it]  5%|▍         | 20/434 [13:05<4:55:35, 42.84s/it]                                                    5%|▍         | 20/434 [13:05<4:55:35, 42.84s/it]  5%|▍         | 21/434 [14:01<5:21:58, 46.78s/it]  5%|▌         | 22/434 [14:31<4:45:31, 41.58s/it]  5%|▌         | 23/434 [14:59<4:18:17, 37.71s/it]  6%|▌         | 24/434 [15:29<4:02:02, 35.42s/it]  6%|▌         | 25/434 [16:19<4:31:09, 39.78s/it]  6%|▌         | 26/434 [17:14<5:00:09, 44.14s/it]  6%|▌         | 27/434 [17:49<4:41:09, 41.45s/it]  6%|▋         | 28/434 [18:35<4:49:05, 42.72s/it]  7%|▋         | 29/434 [19:09<4:31:43, 40.25s/it]  7%|▋         | 30/434 [19:36<4:04:13, 36.27s/it]                                                    7%|▋         | 30/434 [19:36<4:04:13, 36.27s/it]  7%|▋         | 31/434 [20:19<4:16:56, 38.26s/it]  7%|▋         | 32/434 [21:04<4:30:18, 40.34s/it]  8%|▊         | 33/434 [21:43<4:27:22, 40.01s/it]  8%|▊         | 34/434 [22:16<4:12:05, 37.81s/it]  8%|▊         | 35/434 [23:06<4:35:20, 41.41s/it]  8%|▊         | 36/434 [23:51<4:42:51, 42.64s/it]  9%|▊         | 37/434 [24:33<4:40:56, 42.46s/it]  9%|▉         | 38/434 [25:15<4:38:20, 42.17s/it]  9%|▉         | 39/434 [25:56<4:36:27, 41.99s/it]  9%|▉         | 40/434 [26:22<4:03:20, 37.06s/it]                                                    9%|▉         | 40/434 [26:22<4:03:20, 37.06s/it]  9%|▉         | 41/434 [26:49<3:43:36, 34.14s/it] 10%|▉         | 42/434 [27:23<3:41:23, 33.89s/it] 10%|▉         | 43/434 [28:16<4:18:23, 39.65s/it] 10%|█         | 44/434 [28:44<3:55:07, 36.17s/it] 10%|█         | 45/434 [29:17<3:49:37, 35.42s/it] 11%|█         | 46/434 [30:03<4:08:37, 38.45s/it] 11%|█         | 47/434 [30:48<4:21:36, 40.56s/it] 11%|█         | 48/434 [31:35<4:32:02, 42.29s/it] 11%|█▏        | 49/434 [32:15<4:27:26, 41.68s/it] 12%|█▏        | 50/434 [33:03<4:38:07, 43.46s/it]                                                   12%|█▏        | 50/434 [33:03<4:38:07, 43.46s/it] 12%|█▏        | 51/434 [34:01<5:06:04, 47.95s/it] 12%|█▏        | 52/434 [34:38<4:44:55, 44.75s/it] 12%|█▏        | 53/434 [35:32<5:01:16, 47.44s/it] 12%|█▏        | 54/434 [36:08<4:37:58, 43.89s/it] 13%|█▎        | 55/434 [37:07<5:07:13, 48.64s/it] 13%|█▎        | 56/434 [37:47<4:49:01, 45.88s/it] 13%|█▎        | 57/434 [38:21<4:25:40, 42.28s/it] 13%|█▎        | 58/434 [38:58<4:15:38, 40.79s/it] 14%|█▎        | 59/434 [39:36<4:09:27, 39.91s/it] 14%|█▍        | 60/434 [40:05<3:48:49, 36.71s/it]                                                   14%|█▍        | 60/434 [40:05<3:48:49, 36.71s/it] 14%|█▍        | 61/434 [40:36<3:36:46, 34.87s/it] 14%|█▍        | 62/434 [41:15<3:44:28, 36.21s/it] 15%|█▍        | 63/434 [42:00<3:59:19, 38.70s/it] 15%|█▍        | 64/434 [42:42<4:05:44, 39.85s/it] 15%|█▍        | 65/434 [43:22<4:04:16, 39.72s/it] 15%|█▌        | 66/434 [43:54<3:49:35, 37.43s/it] 15%|█▌        | 67/434 [44:23<3:33:58, 34.98s/it] 16%|█▌        | 68/434 [44:59<3:35:55, 35.40s/it] 16%|█▌        | 69/434 [45:52<4:06:15, 40.48s/it] 16%|█▌        | 70/434 [46:29<4:00:12, 39.59s/it]                                                   16%|█▌        | 70/434 [46:29<4:00:12, 39.59s/it] 16%|█▋        | 71/434 [47:11<4:04:20, 40.39s/it] 17%|█▋        | 72/434 [47:58<4:14:39, 42.21s/it] 17%|█▋        | 73/434 [48:36<4:06:07, 40.91s/it] 17%|█▋        | 74/434 [49:16<4:05:01, 40.84s/it] 17%|█▋        | 75/434 [49:56<4:01:25, 40.35s/it] 18%|█▊        | 76/434 [50:40<4:07:24, 41.47s/it] 18%|█▊        | 77/434 [51:12<3:49:52, 38.64s/it] 18%|█▊        | 78/434 [51:59<4:04:41, 41.24s/it] 18%|█▊        | 79/434 [52:35<3:54:15, 39.59s/it] 18%|█▊        | 80/434 [53:03<3:33:54, 36.25s/it]                                                   18%|█▊        | 80/434 [53:03<3:33:54, 36.25s/it] 19%|█▊        | 81/434 [53:58<4:06:17, 41.86s/it] 19%|█▉        | 82/434 [54:41<4:06:43, 42.05s/it] 19%|█▉        | 83/434 [55:18<3:57:29, 40.60s/it] 19%|█▉        | 84/434 [55:54<3:48:25, 39.16s/it] 20%|█▉        | 85/434 [56:29<3:41:46, 38.13s/it] 20%|█▉        | 86/434 [57:12<3:48:49, 39.45s/it] 20%|██        | 87/434 [57:40<3:29:10, 36.17s/it] 20%|██        | 88/434 [58:16<3:27:13, 35.93s/it] 21%|██        | 89/434 [58:57<3:35:33, 37.49s/it] 21%|██        | 90/434 [59:28<3:23:22, 35.47s/it]                                                   21%|██        | 90/434 [59:28<3:23:22, 35.47s/it] 21%|██        | 91/434 [1:00:07<3:28:37, 36.49s/it] 21%|██        | 92/434 [1:01:00<3:56:28, 41.49s/it] 21%|██▏       | 93/434 [1:01:40<3:53:37, 41.11s/it] 22%|██▏       | 94/434 [1:02:17<3:45:45, 39.84s/it] 22%|██▏       | 95/434 [1:03:06<4:00:20, 42.54s/it] 22%|██▏       | 96/434 [1:03:57<4:13:56, 45.08s/it] 22%|██▏       | 97/434 [1:04:35<4:01:56, 43.07s/it] 23%|██▎       | 98/434 [1:05:22<4:08:17, 44.34s/it] 23%|██▎       | 99/434 [1:06:06<4:07:11, 44.27s/it] 23%|██▎       | 100/434 [1:06:53<4:10:41, 45.03s/it]                                                      23%|██▎       | 100/434 [1:06:53<4:10:41, 45.03s/it] 23%|██▎       | 101/434 [1:07:53<4:34:09, 49.40s/it] 24%|██▎       | 102/434 [1:08:31<4:14:23, 45.97s/it] 24%|██▎       | 103/434 [1:09:15<4:10:04, 45.33s/it] 24%|██▍       | 104/434 [1:09:47<3:48:24, 41.53s/it] 24%|██▍       | 105/434 [1:10:25<3:42:07, 40.51s/it] 24%|██▍       | 106/434 [1:10:59<3:29:54, 38.40s/it] 25%|██▍       | 107/434 [1:11:30<3:17:21, 36.21s/it] 25%|██▍       | 108/434 [1:12:06<3:17:11, 36.29s/it] 25%|██▌       | 109/434 [1:12:45<3:19:57, 36.91s/it] 25%|██▌       | 110/434 [1:13:44<3:55:03, 43.53s/it]                                                      25%|██▌       | 110/434 [1:13:44<3:55:03, 43.53s/it] 26%|██▌       | 111/434 [1:14:22<3:45:39, 41.92s/it] 26%|██▌       | 112/434 [1:14:52<3:25:43, 38.33s/it] 26%|██▌       | 113/434 [1:15:29<3:22:42, 37.89s/it] 26%|██▋       | 114/434 [1:16:19<3:41:01, 41.44s/it] 26%|██▋       | 115/434 [1:16:57<3:35:53, 40.61s/it] 27%|██▋       | 116/434 [1:17:55<4:03:04, 45.86s/it] 27%|██▋       | 117/434 [1:18:33<3:48:39, 43.28s/it] 27%|██▋       | 118/434 [1:19:18<3:51:29, 43.95s/it] 27%|██▋       | 119/434 [1:19:59<3:46:28, 43.14s/it] 28%|██▊       | 120/434 [1:20:30<3:25:51, 39.34s/it]                                                      28%|██▊       | 120/434 [1:20:30<3:25:51, 39.34s/it] 28%|██▊       | 121/434 [1:21:12<3:29:53, 40.23s/it] 28%|██▊       | 122/434 [1:21:51<3:27:22, 39.88s/it] 28%|██▊       | 123/434 [1:22:25<3:17:28, 38.10s/it] 29%|██▊       | 124/434 [1:22:52<2:59:46, 34.79s/it] 29%|██▉       | 125/434 [1:23:30<3:04:04, 35.74s/it] 29%|██▉       | 126/434 [1:24:10<3:09:41, 36.95s/it] 29%|██▉       | 127/434 [1:24:45<3:05:27, 36.25s/it] 29%|██▉       | 128/434 [1:25:23<3:07:44, 36.81s/it] 30%|██▉       | 129/434 [1:26:06<3:16:34, 38.67s/it] 30%|██▉       | 130/434 [1:26:45<3:17:34, 39.00s/it]                                                      30%|██▉       | 130/434 [1:26:45<3:17:34, 39.00s/it] 30%|███       | 131/434 [1:27:30<3:24:58, 40.59s/it] 30%|███       | 132/434 [1:28:01<3:09:49, 37.71s/it] 31%|███       | 133/434 [1:28:52<3:28:58, 41.66s/it] 31%|███       | 134/434 [1:29:42<3:40:55, 44.18s/it] 31%|███       | 135/434 [1:30:29<3:44:48, 45.11s/it] 31%|███▏      | 136/434 [1:31:04<3:28:34, 42.00s/it] 32%|███▏      | 137/434 [1:31:41<3:20:45, 40.56s/it] 32%|███▏      | 138/434 [1:32:27<3:27:44, 42.11s/it] 32%|███▏      | 139/434 [1:33:04<3:20:36, 40.80s/it] 32%|███▏      | 140/434 [1:33:37<3:07:29, 38.26s/it]                                                      32%|███▏      | 140/434 [1:33:37<3:07:29, 38.26s/it] 32%|███▏      | 141/434 [1:34:28<3:25:59, 42.18s/it] 33%|███▎      | 142/434 [1:35:01<3:11:59, 39.45s/it] 33%|███▎      | 143/434 [1:35:48<3:22:46, 41.81s/it] 33%|███▎      | 144/434 [1:36:27<3:17:23, 40.84s/it] 33%|███▎      | 145/434 [1:37:00<3:05:38, 38.54s/it] 34%|███▎      | 146/434 [1:37:52<3:24:27, 42.60s/it] 34%|███▍      | 147/434 [1:38:33<3:21:36, 42.15s/it] 34%|███▍      | 148/434 [1:39:11<3:14:56, 40.90s/it] 34%|███▍      | 149/434 [1:39:40<2:57:27, 37.36s/it] 35%|███▍      | 150/434 [1:40:44<3:34:12, 45.26s/it]                                                      35%|███▍      | 150/434 [1:40:44<3:34:12, 45.26s/it] 35%|███▍      | 151/434 [1:41:14<3:12:16, 40.76s/it] 35%|███▌      | 152/434 [1:41:51<3:06:09, 39.61s/it] 35%|███▌      | 153/434 [1:42:39<3:16:36, 41.98s/it] 35%|███▌      | 154/434 [1:43:17<3:10:47, 40.89s/it] 36%|███▌      | 155/434 [1:43:48<2:55:53, 37.83s/it] 36%|███▌      | 156/434 [1:44:24<2:52:21, 37.20s/it] 36%|███▌      | 157/434 [1:44:54<2:41:43, 35.03s/it] 36%|███▋      | 158/434 [1:45:34<2:48:08, 36.55s/it] 37%|███▋      | 159/434 [1:46:21<3:02:30, 39.82s/it] 37%|███▋      | 160/434 [1:46:51<2:48:27, 36.89s/it]                                                      37%|███▋      | 160/434 [1:46:51<2:48:27, 36.89s/it] 37%|███▋      | 161/434 [1:47:39<3:02:39, 40.14s/it] 37%|███▋      | 162/434 [1:48:07<2:46:15, 36.67s/it] 38%|███▊      | 163/434 [1:48:44<2:45:23, 36.62s/it] 38%|███▊      | 164/434 [1:49:27<2:53:34, 38.57s/it] 38%|███▊      | 165/434 [1:50:05<2:51:53, 38.34s/it] 38%|███▊      | 166/434 [1:50:54<3:06:08, 41.67s/it] 38%|███▊      | 167/434 [1:51:45<3:17:37, 44.41s/it] 39%|███▊      | 168/434 [1:52:23<3:07:49, 42.37s/it] 39%|███▉      | 169/434 [1:53:08<3:10:32, 43.14s/it] 39%|███▉      | 170/434 [1:53:56<3:16:39, 44.70s/it]                                                      39%|███▉      | 170/434 [1:53:56<3:16:39, 44.70s/it] 39%|███▉      | 171/434 [1:54:42<3:17:13, 44.99s/it] 40%|███▉      | 172/434 [1:55:10<2:54:14, 39.90s/it] 40%|███▉      | 173/434 [1:55:42<2:44:00, 37.70s/it] 40%|████      | 174/434 [1:56:27<2:52:10, 39.73s/it] 40%|████      | 175/434 [1:57:07<2:52:13, 39.90s/it] 41%|████      | 176/434 [1:57:53<2:59:10, 41.67s/it] 41%|████      | 177/434 [1:58:33<2:56:54, 41.30s/it] 41%|████      | 178/434 [1:59:11<2:51:29, 40.19s/it] 41%|████      | 179/434 [1:59:39<2:35:31, 36.60s/it] 41%|████▏     | 180/434 [2:00:21<2:42:02, 38.28s/it]                                                      41%|████▏     | 180/434 [2:00:21<2:42:02, 38.28s/it] 42%|████▏     | 181/434 [2:01:03<2:45:31, 39.26s/it] 42%|████▏     | 182/434 [2:01:52<2:56:59, 42.14s/it] 42%|████▏     | 183/434 [2:02:27<2:47:24, 40.02s/it] 42%|████▏     | 184/434 [2:03:21<3:04:13, 44.21s/it] 43%|████▎     | 185/434 [2:04:03<3:01:02, 43.63s/it] 43%|████▎     | 186/434 [2:04:47<3:01:01, 43.80s/it] 43%|████▎     | 187/434 [2:05:30<2:58:52, 43.45s/it] 43%|████▎     | 188/434 [2:06:09<2:53:16, 42.26s/it] 44%|████▎     | 189/434 [2:06:56<2:57:57, 43.58s/it] 44%|████▍     | 190/434 [2:07:43<3:01:49, 44.71s/it]                                                      44%|████▍     | 190/434 [2:07:43<3:01:49, 44.71s/it] 44%|████▍     | 191/434 [2:08:11<2:40:01, 39.51s/it] 44%|████▍     | 192/434 [2:08:35<2:20:39, 34.87s/it] 44%|████▍     | 193/434 [2:09:18<2:30:42, 37.52s/it] 45%|████▍     | 194/434 [2:09:47<2:19:11, 34.80s/it] 45%|████▍     | 195/434 [2:10:41<2:41:31, 40.55s/it] 45%|████▌     | 196/434 [2:11:30<2:51:09, 43.15s/it] 45%|████▌     | 197/434 [2:12:11<2:48:09, 42.57s/it] 46%|████▌     | 198/434 [2:12:48<2:40:12, 40.73s/it] 46%|████▌     | 199/434 [2:13:24<2:33:41, 39.24s/it] 46%|████▌     | 200/434 [2:13:58<2:27:47, 37.90s/it]                                                      46%|████▌     | 200/434 [2:13:58<2:27:47, 37.90s/it]{'loss': 0.5284, 'grad_norm': 2.5777876377105713, 'learning_rate': 4.545454545454546e-05, 'rewards/chosen': -0.5128155946731567, 'rewards/rejected': -1.1362392902374268, 'rewards/accuracies': 0.6937500238418579, 'rewards/margins': 0.62342369556427, 'logps/rejected': -256.4065856933594, 'logps/chosen': -148.39547729492188, 'logits/rejected': 0.10460327565670013, 'logits/chosen': 0.2903508245944977, 'epoch': 0.16}
{'loss': 0.1918, 'grad_norm': 4.337102890014648, 'learning_rate': 9.090909090909092e-05, 'rewards/chosen': -6.546198844909668, 'rewards/rejected': -12.303494453430176, 'rewards/accuracies': 0.903124988079071, 'rewards/margins': 5.75729513168335, 'logps/rejected': -353.41009521484375, 'logps/chosen': -202.3136444091797, 'logits/rejected': -0.32398876547813416, 'logits/chosen': -0.15757128596305847, 'epoch': 0.32}
{'loss': 0.1918, 'grad_norm': 5.063920021057129, 'learning_rate': 9.990699835799469e-05, 'rewards/chosen': -11.847559928894043, 'rewards/rejected': -20.463844299316406, 'rewards/accuracies': 0.8843749761581421, 'rewards/margins': 8.616284370422363, 'logps/rejected': -439.0375061035156, 'logps/chosen': -262.97259521484375, 'logits/rejected': -0.32682865858078003, 'logits/chosen': -0.22503399848937988, 'epoch': 0.48}
{'loss': 0.1303, 'grad_norm': 0.9675167202949524, 'learning_rate': 9.952977205963496e-05, 'rewards/chosen': -7.731919765472412, 'rewards/rejected': -16.719161987304688, 'rewards/accuracies': 0.9281250238418579, 'rewards/margins': 8.987241744995117, 'logps/rejected': -412.5670471191406, 'logps/chosen': -219.4865264892578, 'logits/rejected': -0.3504185080528259, 'logits/chosen': -0.20799705386161804, 'epoch': 0.65}
{'loss': 0.0569, 'grad_norm': 2.5310614109039307, 'learning_rate': 9.886469909625625e-05, 'rewards/chosen': -13.879498481750488, 'rewards/rejected': -25.337474822998047, 'rewards/accuracies': 0.96875, 'rewards/margins': 11.457977294921875, 'logps/rejected': -487.9739685058594, 'logps/chosen': -282.31829833984375, 'logits/rejected': -0.30879679322242737, 'logits/chosen': -0.19772124290466309, 'epoch': 0.81}
{'loss': 0.1317, 'grad_norm': 2.3605902194976807, 'learning_rate': 9.791564459839608e-05, 'rewards/chosen': -22.274255752563477, 'rewards/rejected': -33.42083740234375, 'rewards/accuracies': 0.9375, 'rewards/margins': 11.146584510803223, 'logps/rejected': -572.3712158203125, 'logps/chosen': -367.7293395996094, 'logits/rejected': -0.20900380611419678, 'logits/chosen': -0.1355314701795578, 'epoch': 0.97}
{'loss': 0.0529, 'grad_norm': 0.050871435552835464, 'learning_rate': 9.668812408047679e-05, 'rewards/chosen': -14.378822326660156, 'rewards/rejected': -28.22036361694336, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 13.841540336608887, 'logps/rejected': -522.3463134765625, 'logps/chosen': -287.29193115234375, 'logits/rejected': -0.20378200709819794, 'logits/chosen': -0.10827479511499405, 'epoch': 1.13}
{'loss': 0.0348, 'grad_norm': 0.8106329441070557, 'learning_rate': 9.51892713869041e-05, 'rewards/chosen': -23.515119552612305, 'rewards/rejected': -40.27016830444336, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 16.755046844482422, 'logps/rejected': -633.9443359375, 'logps/chosen': -376.6383972167969, 'logits/rejected': -0.07298244535923004, 'logits/chosen': -0.030348066240549088, 'epoch': 1.29}
{'loss': 0.1033, 'grad_norm': 0.37407222390174866, 'learning_rate': 9.342779723309745e-05, 'rewards/chosen': -30.02041244506836, 'rewards/rejected': -49.67249298095703, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 19.652074813842773, 'logps/rejected': -739.1484985351562, 'logps/chosen': -443.9230041503906, 'logits/rejected': -0.1400674730539322, 'logits/chosen': -0.04989185184240341, 'epoch': 1.45}
{'loss': 0.0631, 'grad_norm': 0.3108888864517212, 'learning_rate': 9.141393858239434e-05, 'rewards/chosen': -29.327911376953125, 'rewards/rejected': -52.57433319091797, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 23.246421813964844, 'logps/rejected': -767.52587890625, 'logps/chosen': -437.67138671875, 'logits/rejected': -0.07319528609514236, 'logits/chosen': 0.012250382453203201, 'epoch': 1.61}
{'loss': 0.0534, 'grad_norm': 16.866289138793945, 'learning_rate': 8.915939915302968e-05, 'rewards/chosen': -27.355316162109375, 'rewards/rejected': -50.368595123291016, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 23.013280868530273, 'logps/rejected': -741.3516845703125, 'logps/chosen': -415.28387451171875, 'logits/rejected': -0.1281643807888031, 'logits/chosen': -0.07340778410434723, 'epoch': 1.77}
{'loss': 0.0335, 'grad_norm': 0.2818504571914673, 'learning_rate': 8.667728140093876e-05, 'rewards/chosen': -39.05860137939453, 'rewards/rejected': -65.19406127929688, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 26.135456085205078, 'logps/rejected': -887.4423828125, 'logps/chosen': -531.404296875, 'logits/rejected': 0.02526448294520378, 'logits/chosen': 0.04277259111404419, 'epoch': 1.94}
{'loss': 0.0248, 'grad_norm': 0.013081164099276066, 'learning_rate': 8.398201037367201e-05, 'rewards/chosen': -31.861003875732422, 'rewards/rejected': -58.8183479309082, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 26.957345962524414, 'logps/rejected': -827.669921875, 'logps/chosen': -459.07391357421875, 'logits/rejected': -0.05969984456896782, 'logits/chosen': -0.008587323129177094, 'epoch': 2.1}
{'loss': 0.0221, 'grad_norm': 0.016101859509944916, 'learning_rate': 8.108924987795136e-05, 'rewards/chosen': -32.11492919921875, 'rewards/rejected': -56.24553298950195, 'rewards/accuracies': 0.96875, 'rewards/margins': 24.130603790283203, 'logps/rejected': -807.95849609375, 'logps/chosen': -463.9414978027344, 'logits/rejected': -0.05939241498708725, 'logits/chosen': 0.002993401139974594, 'epoch': 2.26}
{'loss': 0.0338, 'grad_norm': 0.05692162364721298, 'learning_rate': 7.801581144806752e-05, 'rewards/chosen': -30.261938095092773, 'rewards/rejected': -53.983253479003906, 'rewards/accuracies': 0.953125, 'rewards/margins': 23.7213134765625, 'logps/rejected': -783.2406005859375, 'logps/chosen': -446.39239501953125, 'logits/rejected': -0.013729780912399292, 'logits/chosen': 0.06671810150146484, 'epoch': 2.42}
{'loss': 0.0265, 'grad_norm': 2.5490472316741943, 'learning_rate': 7.477955664415678e-05, 'rewards/chosen': -25.058895111083984, 'rewards/rejected': -45.477455139160156, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 20.41855812072754, 'logps/rejected': -695.6368408203125, 'logps/chosen': -391.6731872558594, 'logits/rejected': -0.13075107336044312, 'logits/chosen': -0.006971507333219051, 'epoch': 2.58}
{'loss': 0.031, 'grad_norm': 0.007639766205102205, 'learning_rate': 7.139929324815965e-05, 'rewards/chosen': -32.239723205566406, 'rewards/rejected': -55.229835510253906, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 22.990110397338867, 'logps/rejected': -794.1985473632812, 'logps/chosen': -469.8426208496094, 'logits/rejected': -0.06947378814220428, 'logits/chosen': -0.004502253606915474, 'epoch': 2.74}
{'loss': 0.0202, 'grad_norm': 0.01388359721750021, 'learning_rate': 6.78946659607271e-05, 'rewards/chosen': -32.09971237182617, 'rewards/rejected': -56.53075408935547, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 24.431041717529297, 'logps/rejected': -794.106201171875, 'logps/chosen': -459.6231384277344, 'logits/rejected': -0.04634175822138786, 'logits/chosen': -0.014173844829201698, 'epoch': 2.9}
{'loss': 0.0264, 'grad_norm': 0.018483050167560577, 'learning_rate': 6.42860422342998e-05, 'rewards/chosen': -30.89041519165039, 'rewards/rejected': -55.877586364746094, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 24.987171173095703, 'logps/rejected': -793.65380859375, 'logps/chosen': -454.0826721191406, 'logits/rejected': 0.04933870583772659, 'logits/chosen': 0.11910410970449448, 'epoch': 3.06}
{'loss': 0.0262, 'grad_norm': 0.008647234179079533, 'learning_rate': 6.059439390585107e-05, 'rewards/chosen': -32.464481353759766, 'rewards/rejected': -56.375274658203125, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 23.91079330444336, 'logps/rejected': -796.9271850585938, 'logps/chosen': -465.7919921875, 'logits/rejected': -0.13914355635643005, 'logits/chosen': -0.07635465264320374, 'epoch': 3.23}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:36,  1.69it/s][A
  5%|▍         | 3/63 [00:03<01:06,  1.11s/it][A
  6%|▋         | 4/63 [00:04<01:21,  1.39s/it][A
  8%|▊         | 5/63 [00:06<01:24,  1.46s/it][A
 10%|▉         | 6/63 [00:10<02:05,  2.20s/it][A
 11%|█         | 7/63 [00:12<01:59,  2.13s/it][A
 13%|█▎        | 8/63 [00:13<01:49,  1.98s/it][A
 14%|█▍        | 9/63 [00:14<01:31,  1.69s/it][A
 16%|█▌        | 10/63 [00:16<01:31,  1.73s/it][A
 17%|█▋        | 11/63 [00:18<01:31,  1.77s/it][A
 19%|█▉        | 12/63 [00:20<01:31,  1.79s/it][A
 21%|██        | 13/63 [00:21<01:19,  1.59s/it][A
 22%|██▏       | 14/63 [00:24<01:34,  1.94s/it][A
 24%|██▍       | 15/63 [00:26<01:30,  1.89s/it][A
 25%|██▌       | 16/63 [00:27<01:28,  1.88s/it][A
 27%|██▋       | 17/63 [00:28<01:13,  1.61s/it][A
 29%|██▊       | 18/63 [00:29<01:01,  1.37s/it][A
 30%|███       | 19/63 [00:30<00:56,  1.27s/it][A
 32%|███▏      | 20/63 [00:32<01:05,  1.53s/it][A
 33%|███▎      | 21/63 [00:34<01:07,  1.61s/it][A
 35%|███▍      | 22/63 [00:37<01:17,  1.89s/it][A
 37%|███▋      | 23/63 [00:39<01:18,  1.96s/it][A
 38%|███▊      | 24/63 [00:41<01:15,  1.94s/it][A
 40%|███▉      | 25/63 [00:43<01:16,  2.00s/it][A
 41%|████▏     | 26/63 [00:46<01:26,  2.33s/it][A
 43%|████▎     | 27/63 [00:49<01:32,  2.56s/it][A
 44%|████▍     | 28/63 [00:51<01:23,  2.38s/it][A
 46%|████▌     | 29/63 [00:52<01:05,  1.92s/it][A
 48%|████▊     | 30/63 [00:53<00:53,  1.61s/it][A
 49%|████▉     | 31/63 [00:54<00:45,  1.43s/it][A
 51%|█████     | 32/63 [00:55<00:41,  1.34s/it][A
 52%|█████▏    | 33/63 [00:56<00:38,  1.27s/it][A
 54%|█████▍    | 34/63 [00:58<00:39,  1.37s/it][A
 56%|█████▌    | 35/63 [00:59<00:41,  1.49s/it][A
 57%|█████▋    | 36/63 [01:00<00:36,  1.35s/it][A
 59%|█████▊    | 37/63 [01:01<00:31,  1.22s/it][A
 60%|██████    | 38/63 [01:03<00:32,  1.31s/it][A
 62%|██████▏   | 39/63 [01:05<00:38,  1.60s/it][A
 63%|██████▎   | 40/63 [01:07<00:41,  1.80s/it][A
 65%|██████▌   | 41/63 [01:09<00:36,  1.67s/it][A
 67%|██████▋   | 42/63 [01:10<00:33,  1.60s/it][A
 68%|██████▊   | 43/63 [01:11<00:29,  1.48s/it][A
 70%|██████▉   | 44/63 [01:12<00:25,  1.32s/it][A
 71%|███████▏  | 45/63 [01:13<00:21,  1.22s/it][A
 73%|███████▎  | 46/63 [01:14<00:19,  1.17s/it][A
 75%|███████▍  | 47/63 [01:16<00:18,  1.18s/it][A
 76%|███████▌  | 48/63 [01:17<00:18,  1.24s/it][A
 78%|███████▊  | 49/63 [01:18<00:15,  1.12s/it][A
 79%|███████▉  | 50/63 [01:20<00:17,  1.35s/it][A
 81%|████████  | 51/63 [01:21<00:16,  1.33s/it][A
 83%|████████▎ | 52/63 [01:23<00:18,  1.70s/it][A
 84%|████████▍ | 53/63 [01:24<00:14,  1.44s/it][A
 86%|████████▌ | 54/63 [01:26<00:12,  1.40s/it][A
 87%|████████▋ | 55/63 [01:27<00:10,  1.34s/it][A
 89%|████████▉ | 56/63 [01:28<00:08,  1.27s/it][A
 90%|█████████ | 57/63 [01:29<00:07,  1.20s/it][A
 92%|█████████▏| 58/63 [01:30<00:06,  1.29s/it][A
 94%|█████████▎| 59/63 [01:32<00:05,  1.25s/it][A
 95%|█████████▌| 60/63 [01:32<00:03,  1.11s/it][A
 97%|█████████▋| 61/63 [01:34<00:02,  1.11s/it][A
 98%|█████████▊| 62/63 [01:35<00:01,  1.10s/it][A
100%|██████████| 63/63 [01:35<00:00,  1.14it/s][A
                                               [A                                                     
100%|██████████| 63/63 [01:35<00:00,  1.14it/s][A 46%|████▌     | 200/434 [2:15:36<2:27:47, 37.90s/it]
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0002_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 46%|████▋     | 201/434 [2:16:16<4:23:54, 67.96s/it] 47%|████▋     | 202/434 [2:16:46<3:38:21, 56.47s/it] 47%|████▋     | 203/434 [2:17:20<3:11:56, 49.86s/it] 47%|████▋     | 204/434 [2:17:59<2:57:31, 46.31s/it] 47%|████▋     | 205/434 [2:18:34<2:43:57, 42.96s/it] 47%|████▋     | 206/434 [2:19:13<2:39:27, 41.96s/it] 48%|████▊     | 207/434 [2:19:58<2:41:27, 42.68s/it] 48%|████▊     | 208/434 [2:20:35<2:35:12, 41.20s/it] 48%|████▊     | 209/434 [2:21:12<2:28:49, 39.69s/it] 48%|████▊     | 210/434 [2:21:52<2:28:38, 39.81s/it]                                                      48%|████▊     | 210/434 [2:21:52<2:28:38, 39.81s/it] 49%|████▊     | 211/434 [2:22:37<2:34:37, 41.60s/it] 49%|████▉     | 212/434 [2:23:20<2:35:05, 41.92s/it] 49%|████▉     | 213/434 [2:24:00<2:32:06, 41.30s/it] 49%|████▉     | 214/434 [2:24:48<2:39:08, 43.40s/it] 50%|████▉     | 215/434 [2:25:29<2:35:19, 42.55s/it] 50%|████▉     | 216/434 [2:26:06<2:28:18, 40.82s/it] 50%|█████     | 217/434 [2:26:59<2:41:23, 44.62s/it] 50%|█████     | 218/434 [2:27:49<2:46:48, 46.33s/it] 50%|█████     | 219/434 [2:28:23<2:32:42, 42.62s/it] 51%|█████     | 220/434 [2:28:58<2:23:54, 40.35s/it]                                                      51%|█████     | 220/434 [2:28:58<2:23:54, 40.35s/it] 51%|█████     | 221/434 [2:29:41<2:25:19, 40.93s/it] 51%|█████     | 222/434 [2:30:11<2:13:04, 37.66s/it] 51%|█████▏    | 223/434 [2:30:52<2:16:42, 38.87s/it] 52%|█████▏    | 224/434 [2:31:38<2:22:38, 40.75s/it] 52%|█████▏    | 225/434 [2:32:15<2:18:35, 39.79s/it] 52%|█████▏    | 226/434 [2:33:00<2:23:02, 41.26s/it] 52%|█████▏    | 227/434 [2:33:55<2:36:20, 45.31s/it] 53%|█████▎    | 228/434 [2:34:29<2:24:06, 41.97s/it] 53%|█████▎    | 229/434 [2:35:01<2:13:38, 39.11s/it] 53%|█████▎    | 230/434 [2:35:32<2:04:05, 36.50s/it]                                                      53%|█████▎    | 230/434 [2:35:32<2:04:05, 36.50s/it] 53%|█████▎    | 231/434 [2:36:23<2:18:09, 40.84s/it] 53%|█████▎    | 232/434 [2:36:53<2:07:00, 37.73s/it] 54%|█████▎    | 233/434 [2:37:26<2:01:06, 36.15s/it] 54%|█████▍    | 234/434 [2:38:23<2:22:13, 42.67s/it] 54%|█████▍    | 235/434 [2:39:08<2:23:01, 43.12s/it] 54%|█████▍    | 236/434 [2:39:50<2:21:49, 42.98s/it] 55%|█████▍    | 237/434 [2:40:27<2:15:10, 41.17s/it] 55%|█████▍    | 238/434 [2:41:14<2:20:13, 42.92s/it] 55%|█████▌    | 239/434 [2:42:01<2:23:03, 44.02s/it] 55%|█████▌    | 240/434 [2:42:45<2:22:24, 44.04s/it]                                                      55%|█████▌    | 240/434 [2:42:45<2:22:24, 44.04s/it] 56%|█████▌    | 241/434 [2:43:23<2:15:35, 42.15s/it] 56%|█████▌    | 242/434 [2:44:11<2:20:36, 43.94s/it] 56%|█████▌    | 243/434 [2:44:48<2:13:19, 41.88s/it] 56%|█████▌    | 244/434 [2:45:17<2:00:17, 37.98s/it] 56%|█████▋    | 245/434 [2:46:07<2:10:54, 41.56s/it] 57%|█████▋    | 246/434 [2:46:39<2:01:39, 38.83s/it] 57%|█████▋    | 247/434 [2:47:17<1:59:58, 38.50s/it] 57%|█████▋    | 248/434 [2:47:48<1:52:24, 36.26s/it] 57%|█████▋    | 249/434 [2:48:37<2:03:47, 40.15s/it] 58%|█████▊    | 250/434 [2:49:12<1:58:38, 38.68s/it]                                                      58%|█████▊    | 250/434 [2:49:12<1:58:38, 38.68s/it] 58%|█████▊    | 251/434 [2:50:00<2:05:48, 41.25s/it] 58%|█████▊    | 252/434 [2:50:46<2:09:46, 42.78s/it] 58%|█████▊    | 253/434 [2:51:26<2:06:41, 41.99s/it] 59%|█████▊    | 254/434 [2:52:13<2:10:16, 43.43s/it] 59%|█████▉    | 255/434 [2:52:49<2:02:41, 41.12s/it] 59%|█████▉    | 256/434 [2:53:34<2:05:45, 42.39s/it] 59%|█████▉    | 257/434 [2:54:11<1:59:55, 40.65s/it] 59%|█████▉    | 258/434 [2:55:06<2:12:34, 45.20s/it] 60%|█████▉    | 259/434 [2:55:56<2:15:44, 46.54s/it] 60%|█████▉    | 260/434 [2:56:39<2:11:58, 45.51s/it]                                                      60%|█████▉    | 260/434 [2:56:39<2:11:58, 45.51s/it] 60%|██████    | 261/434 [2:57:23<2:09:30, 44.92s/it] 60%|██████    | 262/434 [2:57:59<2:01:36, 42.42s/it] 61%|██████    | 263/434 [2:58:34<1:54:22, 40.13s/it] 61%|██████    | 264/434 [2:59:13<1:52:49, 39.82s/it] 61%|██████    | 265/434 [2:59:55<1:53:57, 40.46s/it] 61%|██████▏   | 266/434 [3:00:34<1:52:23, 40.14s/it] 62%|██████▏   | 267/434 [3:01:04<1:43:05, 37.04s/it] 62%|██████▏   | 268/434 [3:01:38<1:39:28, 35.95s/it] 62%|██████▏   | 269/434 [3:02:11<1:36:48, 35.20s/it] 62%|██████▏   | 270/434 [3:02:45<1:35:08, 34.81s/it]                                                      62%|██████▏   | 270/434 [3:02:45<1:35:08, 34.81s/it] 62%|██████▏   | 271/434 [3:03:21<1:35:11, 35.04s/it] 63%|██████▎   | 272/434 [3:04:09<1:45:02, 38.91s/it] 63%|██████▎   | 273/434 [3:04:40<1:38:43, 36.79s/it] 63%|██████▎   | 274/434 [3:05:12<1:33:42, 35.14s/it] 63%|██████▎   | 275/434 [3:05:52<1:37:27, 36.78s/it] 64%|██████▎   | 276/434 [3:06:32<1:38:59, 37.59s/it] 64%|██████▍   | 277/434 [3:07:13<1:40:56, 38.58s/it] 64%|██████▍   | 278/434 [3:07:47<1:37:17, 37.42s/it] 64%|██████▍   | 279/434 [3:08:29<1:40:18, 38.83s/it] 65%|██████▍   | 280/434 [3:08:57<1:30:47, 35.37s/it]                                                      65%|██████▍   | 280/434 [3:08:57<1:30:47, 35.37s/it] 65%|██████▍   | 281/434 [3:10:04<1:54:20, 44.84s/it] 65%|██████▍   | 282/434 [3:10:34<1:42:49, 40.59s/it] 65%|██████▌   | 283/434 [3:11:04<1:34:05, 37.39s/it] 65%|██████▌   | 284/434 [3:12:07<1:52:37, 45.05s/it] 66%|██████▌   | 285/434 [3:12:45<1:46:18, 42.81s/it] 66%|██████▌   | 286/434 [3:13:19<1:38:53, 40.09s/it] 66%|██████▌   | 287/434 [3:13:58<1:37:26, 39.77s/it] 66%|██████▋   | 288/434 [3:14:51<1:46:37, 43.82s/it] 67%|██████▋   | 289/434 [3:15:30<1:42:37, 42.47s/it] 67%|██████▋   | 290/434 [3:16:01<1:33:30, 38.96s/it]                                                      67%|██████▋   | 290/434 [3:16:01<1:33:30, 38.96s/it] 67%|██████▋   | 291/434 [3:16:37<1:30:37, 38.02s/it] 67%|██████▋   | 292/434 [3:17:11<1:27:20, 36.91s/it] 68%|██████▊   | 293/434 [3:17:48<1:26:40, 36.88s/it] 68%|██████▊   | 294/434 [3:18:42<1:38:12, 42.09s/it] 68%|██████▊   | 295/434 [3:19:15<1:31:02, 39.30s/it] 68%|██████▊   | 296/434 [3:20:05<1:37:32, 42.41s/it] 68%|██████▊   | 297/434 [3:20:39<1:31:29, 40.07s/it] 69%|██████▊   | 298/434 [3:21:12<1:25:41, 37.81s/it] 69%|██████▉   | 299/434 [3:21:57<1:30:25, 40.19s/it] 69%|██████▉   | 300/434 [3:22:48<1:36:46, 43.33s/it]                                                      69%|██████▉   | 300/434 [3:22:48<1:36:46, 43.33s/it] 69%|██████▉   | 301/434 [3:23:17<1:26:34, 39.06s/it] 70%|██████▉   | 302/434 [3:23:47<1:19:56, 36.34s/it] 70%|██████▉   | 303/434 [3:24:43<1:31:45, 42.03s/it] 70%|███████   | 304/434 [3:25:26<1:31:45, 42.35s/it] 70%|███████   | 305/434 [3:26:05<1:29:06, 41.45s/it] 71%|███████   | 306/434 [3:26:42<1:25:31, 40.09s/it] 71%|███████   | 307/434 [3:27:22<1:24:59, 40.15s/it] 71%|███████   | 308/434 [3:28:04<1:25:12, 40.57s/it] 71%|███████   | 309/434 [3:28:53<1:30:13, 43.31s/it] 71%|███████▏  | 310/434 [3:29:22<1:20:26, 38.92s/it]                                                      71%|███████▏  | 310/434 [3:29:22<1:20:26, 38.92s/it] 72%|███████▏  | 311/434 [3:30:04<1:21:34, 39.79s/it] 72%|███████▏  | 312/434 [3:30:43<1:20:17, 39.49s/it] 72%|███████▏  | 313/434 [3:31:16<1:15:41, 37.54s/it] 72%|███████▏  | 314/434 [3:31:59<1:18:35, 39.29s/it] 73%|███████▎  | 315/434 [3:32:46<1:22:26, 41.57s/it] 73%|███████▎  | 316/434 [3:33:23<1:19:08, 40.24s/it] 73%|███████▎  | 317/434 [3:34:05<1:19:32, 40.79s/it] 73%|███████▎  | 318/434 [3:34:55<1:24:01, 43.46s/it] 74%|███████▎  | 319/434 [3:35:49<1:29:40, 46.79s/it] 74%|███████▎  | 320/434 [3:36:28<1:24:06, 44.27s/it]                                                      74%|███████▎  | 320/434 [3:36:28<1:24:06, 44.27s/it] 74%|███████▍  | 321/434 [3:37:10<1:22:27, 43.79s/it] 74%|███████▍  | 322/434 [3:37:43<1:15:16, 40.32s/it] 74%|███████▍  | 323/434 [3:38:23<1:14:31, 40.29s/it] 75%|███████▍  | 324/434 [3:38:54<1:08:39, 37.45s/it] 75%|███████▍  | 325/434 [3:39:22<1:02:59, 34.67s/it] 75%|███████▌  | 326/434 [3:39:54<1:00:53, 33.82s/it] 75%|███████▌  | 327/434 [3:40:38<1:05:44, 36.87s/it] 76%|███████▌  | 328/434 [3:41:12<1:03:57, 36.20s/it] 76%|███████▌  | 329/434 [3:42:06<1:12:42, 41.55s/it] 76%|███████▌  | 330/434 [3:42:46<1:10:50, 40.87s/it]                                                      76%|███████▌  | 330/434 [3:42:46<1:10:50, 40.87s/it] 76%|███████▋  | 331/434 [3:43:18<1:05:37, 38.23s/it] 76%|███████▋  | 332/434 [3:43:52<1:03:01, 37.07s/it] 77%|███████▋  | 333/434 [3:44:37<1:06:08, 39.29s/it] 77%|███████▋  | 334/434 [3:45:11<1:03:11, 37.92s/it] 77%|███████▋  | 335/434 [3:45:47<1:01:39, 37.37s/it] 77%|███████▋  | 336/434 [3:46:26<1:01:42, 37.78s/it] 78%|███████▊  | 337/434 [3:46:57<57:31, 35.58s/it]   78%|███████▊  | 338/434 [3:47:39<1:00:02, 37.52s/it] 78%|███████▊  | 339/434 [3:48:10<56:22, 35.61s/it]   78%|███████▊  | 340/434 [3:48:58<1:01:29, 39.25s/it]                                                      78%|███████▊  | 340/434 [3:48:58<1:01:29, 39.25s/it] 79%|███████▊  | 341/434 [3:49:30<57:44, 37.25s/it]   79%|███████▉  | 342/434 [3:50:19<1:02:37, 40.84s/it] 79%|███████▉  | 343/434 [3:50:59<1:01:12, 40.36s/it] 79%|███████▉  | 344/434 [3:51:44<1:02:49, 41.89s/it] 79%|███████▉  | 345/434 [3:52:26<1:02:04, 41.85s/it] 80%|███████▉  | 346/434 [3:53:11<1:02:41, 42.74s/it] 80%|███████▉  | 347/434 [3:54:03<1:06:11, 45.65s/it] 80%|████████  | 348/434 [3:54:38<1:00:37, 42.30s/it] 80%|████████  | 349/434 [3:55:37<1:07:06, 47.37s/it] 81%|████████  | 350/434 [3:56:08<59:33, 42.54s/it]                                                      81%|████████  | 350/434 [3:56:08<59:33, 42.54s/it] 81%|████████  | 351/434 [3:56:52<59:33, 43.06s/it] 81%|████████  | 352/434 [3:57:31<57:06, 41.79s/it] 81%|████████▏ | 353/434 [3:58:01<51:45, 38.34s/it] 82%|████████▏ | 354/434 [3:58:42<51:52, 38.91s/it] 82%|████████▏ | 355/434 [3:59:17<49:43, 37.77s/it] 82%|████████▏ | 356/434 [3:59:56<49:49, 38.32s/it] 82%|████████▏ | 357/434 [4:00:42<52:03, 40.57s/it] 82%|████████▏ | 358/434 [4:01:30<54:02, 42.67s/it] 83%|████████▎ | 359/434 [4:02:27<58:57, 47.16s/it] 83%|████████▎ | 360/434 [4:03:06<55:07, 44.69s/it]                                                    83%|████████▎ | 360/434 [4:03:06<55:07, 44.69s/it] 83%|████████▎ | 361/434 [4:03:47<52:46, 43.38s/it] 83%|████████▎ | 362/434 [4:04:29<51:36, 43.01s/it] 84%|████████▎ | 363/434 [4:05:10<50:11, 42.42s/it] 84%|████████▍ | 364/434 [4:05:49<48:19, 41.42s/it] 84%|████████▍ | 365/434 [4:06:26<46:08, 40.12s/it] 84%|████████▍ | 366/434 [4:07:10<46:55, 41.40s/it] 85%|████████▍ | 367/434 [4:07:42<43:00, 38.51s/it] 85%|████████▍ | 368/434 [4:08:33<46:29, 42.27s/it] 85%|████████▌ | 369/434 [4:09:12<44:33, 41.13s/it] 85%|████████▌ | 370/434 [4:09:43<40:39, 38.11s/it]                                                    85%|████████▌ | 370/434 [4:09:43<40:39, 38.11s/it] 85%|████████▌ | 371/434 [4:10:27<41:54, 39.91s/it] 86%|████████▌ | 372/434 [4:11:04<40:16, 38.98s/it] 86%|████████▌ | 373/434 [4:11:36<37:29, 36.88s/it] 86%|████████▌ | 374/434 [4:12:10<36:03, 36.06s/it] 86%|████████▋ | 375/434 [4:12:56<38:19, 38.98s/it] 87%|████████▋ | 376/434 [4:13:49<41:48, 43.24s/it] 87%|████████▋ | 377/434 [4:14:30<40:39, 42.79s/it] 87%|████████▋ | 378/434 [4:15:15<40:23, 43.27s/it] 87%|████████▋ | 379/434 [4:15:48<36:54, 40.27s/it] 88%|████████▊ | 380/434 [4:16:29<36:24, 40.46s/it]                                                    88%|████████▊ | 380/434 [4:16:29<36:24, 40.46s/it] 88%|████████▊ | 381/434 [4:17:04<34:17, 38.81s/it] 88%|████████▊ | 382/434 [4:17:55<36:53, 42.57s/it] 88%|████████▊ | 383/434 [4:18:39<36:33, 43.02s/it] 88%|████████▊ | 384/434 [4:19:23<36:06, 43.34s/it] 89%|████████▊ | 385/434 [4:20:04<34:37, 42.40s/it] 89%|████████▉ | 386/434 [4:20:37<31:48, 39.75s/it] 89%|████████▉ | 387/434 [4:21:09<29:21, 37.47s/it] 89%|████████▉ | 388/434 [4:21:47<28:41, 37.41s/it] 90%|████████▉ | 389/434 [4:22:34<30:12, 40.27s/it] 90%|████████▉ | 390/434 [4:23:06<27:48, 37.91s/it]                                                    90%|████████▉ | 390/434 [4:23:06<27:48, 37.91s/it] 90%|█████████ | 391/434 [4:23:31<24:29, 34.17s/it] 90%|█████████ | 392/434 [4:24:04<23:32, 33.64s/it] 91%|█████████ | 393/434 [4:24:47<24:57, 36.52s/it] 91%|█████████ | 394/434 [4:25:33<26:12, 39.31s/it] 91%|█████████ | 395/434 [4:26:23<27:36, 42.47s/it] 91%|█████████ | 396/434 [4:26:59<25:38, 40.50s/it] 91%|█████████▏| 397/434 [4:27:32<23:43, 38.48s/it] 92%|█████████▏| 398/434 [4:28:08<22:37, 37.71s/it] 92%|█████████▏| 399/434 [4:28:42<21:15, 36.45s/it] 92%|█████████▏| 400/434 [4:29:15<20:03, 35.39s/it]                                                    92%|█████████▏| 400/434 [4:29:15<20:03, 35.39s/it]{'eval_loss': 2.465437412261963, 'eval_runtime': 97.239, 'eval_samples_per_second': 2.561, 'eval_steps_per_second': 0.648, 'eval_rewards/chosen': -66.27012634277344, 'eval_rewards/rejected': -70.2251205444336, 'eval_rewards/accuracies': 0.591269850730896, 'eval_rewards/margins': 3.9549949169158936, 'eval_logps/rejected': -1097.1441650390625, 'eval_logps/chosen': -1185.302978515625, 'eval_logits/rejected': -0.550660252571106, 'eval_logits/chosen': -0.43516334891319275, 'epoch': 3.23}
{'loss': 0.0347, 'grad_norm': 0.0028670018073171377, 'learning_rate': 5.6841175317195515e-05, 'rewards/chosen': -34.24516296386719, 'rewards/rejected': -60.10093307495117, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 25.85576820373535, 'logps/rejected': -835.4166870117188, 'logps/chosen': -482.02166748046875, 'logits/rejected': -0.12011446803808212, 'logits/chosen': -0.05586211010813713, 'epoch': 3.39}
{'loss': 0.0152, 'grad_norm': 0.0018307471182197332, 'learning_rate': 5.304819863117796e-05, 'rewards/chosen': -36.914588928222656, 'rewards/rejected': -62.978431701660156, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 26.063838958740234, 'logps/rejected': -866.8709716796875, 'logps/chosen': -515.10400390625, 'logits/rejected': 0.01180356927216053, 'logits/chosen': 0.018120432272553444, 'epoch': 3.55}
{'loss': 0.0195, 'grad_norm': 0.0007922407239675522, 'learning_rate': 4.923750706835371e-05, 'rewards/chosen': -37.936256408691406, 'rewards/rejected': -64.47109985351562, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 26.534847259521484, 'logps/rejected': -877.0383911132812, 'logps/chosen': -521.4382934570312, 'logits/rejected': -0.07423059642314911, 'logits/chosen': -0.0295635424554348, 'epoch': 3.71}
{'loss': 0.0304, 'grad_norm': 0.010205951519310474, 'learning_rate': 4.543124680085645e-05, 'rewards/chosen': -36.5124397277832, 'rewards/rejected': -63.43974685668945, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 26.927303314208984, 'logps/rejected': -888.8844604492188, 'logps/chosen': -511.85089111328125, 'logits/rejected': 0.023115023970603943, 'logits/chosen': 0.06078523397445679, 'epoch': 3.87}
{'loss': 0.0304, 'grad_norm': 0.008728986606001854, 'learning_rate': 4.16515382479539e-05, 'rewards/chosen': -37.758750915527344, 'rewards/rejected': -64.6793441772461, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 26.920597076416016, 'logps/rejected': -877.2301635742188, 'logps/chosen': -516.5272827148438, 'logits/rejected': -0.06375426799058914, 'logits/chosen': -0.03971046954393387, 'epoch': 4.03}
{'loss': 0.0304, 'grad_norm': 0.0011695970315486193, 'learning_rate': 3.792034752126851e-05, 'rewards/chosen': -38.53972625732422, 'rewards/rejected': -66.25592803955078, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 27.716201782226562, 'logps/rejected': -904.1224365234375, 'logps/chosen': -526.83740234375, 'logits/rejected': 0.03146865963935852, 'logits/chosen': 0.06754876673221588, 'epoch': 4.19}
{'loss': 0.0261, 'grad_norm': 0.0032338816672563553, 'learning_rate': 3.4259358766770766e-05, 'rewards/chosen': -36.1507453918457, 'rewards/rejected': -61.71160888671875, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 25.560867309570312, 'logps/rejected': -852.8487548828125, 'logps/chosen': -503.5939025878906, 'logits/rejected': -0.0739598423242569, 'logits/chosen': -0.03744587302207947, 'epoch': 4.35}
{'loss': 0.0217, 'grad_norm': 0.002172754844650626, 'learning_rate': 3.0689848145440866e-05, 'rewards/chosen': -36.36371612548828, 'rewards/rejected': -63.94786834716797, 'rewards/accuracies': 0.96875, 'rewards/margins': 27.584152221679688, 'logps/rejected': -887.34326171875, 'logps/chosen': -510.58734130859375, 'logits/rejected': -0.08044635504484177, 'logits/chosen': -0.04290200024843216, 'epoch': 4.52}
{'loss': 0.0239, 'grad_norm': 0.006533175706863403, 'learning_rate': 2.7232560184971434e-05, 'rewards/chosen': -38.99332046508789, 'rewards/rejected': -65.5076904296875, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 26.514373779296875, 'logps/rejected': -887.54833984375, 'logps/chosen': -529.4766845703125, 'logits/rejected': -0.002809729892760515, 'logits/chosen': 0.03136960417032242, 'epoch': 4.68}
{'loss': 0.0325, 'grad_norm': 0.0032376532908529043, 'learning_rate': 2.3907587221104177e-05, 'rewards/chosen': -38.2806396484375, 'rewards/rejected': -64.89464569091797, 'rewards/accuracies': 0.953125, 'rewards/margins': 26.614009857177734, 'logps/rejected': -883.3983154296875, 'logps/chosen': -525.3230590820312, 'logits/rejected': -0.022835304960608482, 'logits/chosen': 0.004256031010299921, 'epoch': 4.84}
{'loss': 0.0195, 'grad_norm': 0.001853857422247529, 'learning_rate': 2.0734252629237894e-05, 'rewards/chosen': -37.66779327392578, 'rewards/rejected': -66.40972900390625, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 28.741933822631836, 'logps/rejected': -906.0921630859375, 'logps/chosen': -519.786376953125, 'logits/rejected': 0.019464364275336266, 'logits/chosen': 0.04744542017579079, 'epoch': 5.0}
{'loss': 0.0326, 'grad_norm': 0.0034821322187781334, 'learning_rate': 1.7730998524917957e-05, 'rewards/chosen': -38.63972854614258, 'rewards/rejected': -67.16984558105469, 'rewards/accuracies': 0.953125, 'rewards/margins': 28.53011703491211, 'logps/rejected': -915.8356323242188, 'logps/chosen': -529.9458618164062, 'logits/rejected': 0.002776969922706485, 'logits/chosen': 0.044211942702531815, 'epoch': 5.16}
{'loss': 0.0304, 'grad_norm': 0.0034692443441599607, 'learning_rate': 1.491527858584535e-05, 'rewards/chosen': -37.53160858154297, 'rewards/rejected': -65.05049133300781, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 27.518884658813477, 'logps/rejected': -886.0172729492188, 'logps/chosen': -517.5551147460938, 'logits/rejected': -0.019998639822006226, 'logits/chosen': 0.0032031722366809845, 'epoch': 5.32}
{'loss': 0.0152, 'grad_norm': 0.005010400433093309, 'learning_rate': 1.2303456618280141e-05, 'rewards/chosen': -37.35682678222656, 'rewards/rejected': -64.70728302001953, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 27.350460052490234, 'logps/rejected': -892.5849609375, 'logps/chosen': -514.6297607421875, 'logits/rejected': -0.06790155172348022, 'logits/chosen': -0.039155274629592896, 'epoch': 5.48}
{'loss': 0.0195, 'grad_norm': 0.0012964947381988168, 'learning_rate': 9.91071145732948e-06, 'rewards/chosen': -39.36042404174805, 'rewards/rejected': -66.46947479248047, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 27.109050750732422, 'logps/rejected': -899.7888793945312, 'logps/chosen': -539.1621704101562, 'logits/rejected': 0.06980861723423004, 'logits/chosen': 0.099291130900383, 'epoch': 5.65}
{'loss': 0.0238, 'grad_norm': 0.0034726185258477926, 'learning_rate': 7.750948753800507e-06, 'rewards/chosen': -38.250125885009766, 'rewards/rejected': -65.37166595458984, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 27.12154197692871, 'logps/rejected': -882.9820556640625, 'logps/chosen': -523.98681640625, 'logits/rejected': 0.0636206567287445, 'logits/chosen': 0.08836288005113602, 'epoch': 5.81}
{'loss': 0.0282, 'grad_norm': 0.003689519362524152, 'learning_rate': 5.83672016027697e-06, 'rewards/chosen': -40.32959747314453, 'rewards/rejected': -66.32717895507812, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 25.99758529663086, 'logps/rejected': -894.6021728515625, 'logps/chosen': -542.130859375, 'logits/rejected': -0.009166931733489037, 'logits/chosen': 0.00155600905418396, 'epoch': 5.97}
{'loss': 0.0282, 'grad_norm': 0.00046179164201021194, 'learning_rate': 4.179150386076424e-06, 'rewards/chosen': -38.44580841064453, 'rewards/rejected': -65.64706420898438, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 27.201257705688477, 'logps/rejected': -911.1241455078125, 'logps/chosen': -530.861572265625, 'logits/rejected': 0.027025479823350906, 'logits/chosen': 0.0532180555164814, 'epoch': 6.13}
{'loss': 0.0152, 'grad_norm': 0.0013099744683131576, 'learning_rate': 2.787872545015069e-06, 'rewards/chosen': -38.176055908203125, 'rewards/rejected': -65.75836181640625, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 27.58230972290039, 'logps/rejected': -895.4821166992188, 'logps/chosen': -522.485595703125, 'logits/rejected': -0.029290374368429184, 'logits/chosen': 0.021022673696279526, 'epoch': 6.29}
{'loss': 0.0282, 'grad_norm': 0.014981012791395187, 'learning_rate': 1.6709721717120042e-06, 'rewards/chosen': -38.1235237121582, 'rewards/rejected': -65.38224029541016, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 27.25872230529785, 'logps/rejected': -902.17529296875, 'logps/chosen': -525.0119018554688, 'logits/rejected': -0.05643649026751518, 'logits/chosen': -0.028564924374222755, 'epoch': 6.45}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:36,  1.69it/s][A
  5%|▍         | 3/63 [00:03<01:06,  1.11s/it][A
  6%|▋         | 4/63 [00:04<01:21,  1.39s/it][A
  8%|▊         | 5/63 [00:06<01:24,  1.46s/it][A
 10%|▉         | 6/63 [00:10<02:05,  2.20s/it][A
 11%|█         | 7/63 [00:12<01:59,  2.13s/it][A
 13%|█▎        | 8/63 [00:13<01:49,  1.98s/it][A
 14%|█▍        | 9/63 [00:14<01:31,  1.69s/it][A
 16%|█▌        | 10/63 [00:16<01:31,  1.73s/it][A
 17%|█▋        | 11/63 [00:18<01:31,  1.77s/it][A
 19%|█▉        | 12/63 [00:20<01:31,  1.79s/it][A
 21%|██        | 13/63 [00:21<01:19,  1.59s/it][A
 22%|██▏       | 14/63 [00:24<01:34,  1.94s/it][A
 24%|██▍       | 15/63 [00:25<01:30,  1.88s/it][A
 25%|██▌       | 16/63 [00:27<01:28,  1.88s/it][A
 27%|██▋       | 17/63 [00:28<01:14,  1.61s/it][A
 29%|██▊       | 18/63 [00:29<01:01,  1.37s/it][A
 30%|███       | 19/63 [00:30<00:56,  1.27s/it][A
 32%|███▏      | 20/63 [00:32<01:05,  1.53s/it][A
 33%|███▎      | 21/63 [00:34<01:07,  1.61s/it][A
 35%|███▍      | 22/63 [00:37<01:17,  1.89s/it][A
 37%|███▋      | 23/63 [00:39<01:18,  1.97s/it][A
 38%|███▊      | 24/63 [00:41<01:15,  1.94s/it][A
 40%|███▉      | 25/63 [00:43<01:15,  2.00s/it][A
 41%|████▏     | 26/63 [00:46<01:26,  2.33s/it][A
 43%|████▎     | 27/63 [00:49<01:32,  2.56s/it][A
 44%|████▍     | 28/63 [00:51<01:23,  2.38s/it][A
 46%|████▌     | 29/63 [00:52<01:05,  1.92s/it][A
 48%|████▊     | 30/63 [00:53<00:53,  1.61s/it][A
 49%|████▉     | 31/63 [00:54<00:45,  1.43s/it][A
 51%|█████     | 32/63 [00:55<00:41,  1.34s/it][A
 52%|█████▏    | 33/63 [00:56<00:38,  1.27s/it][A
 54%|█████▍    | 34/63 [00:58<00:39,  1.37s/it][A
 56%|█████▌    | 35/63 [00:59<00:41,  1.49s/it][A
 57%|█████▋    | 36/63 [01:00<00:36,  1.35s/it][A
 59%|█████▊    | 37/63 [01:01<00:31,  1.22s/it][A
 60%|██████    | 38/63 [01:03<00:32,  1.31s/it][A
 62%|██████▏   | 39/63 [01:05<00:38,  1.60s/it][A
 63%|██████▎   | 40/63 [01:07<00:41,  1.80s/it][A
 65%|██████▌   | 41/63 [01:09<00:36,  1.67s/it][A
 67%|██████▋   | 42/63 [01:10<00:33,  1.60s/it][A
 68%|██████▊   | 43/63 [01:11<00:29,  1.48s/it][A
 70%|██████▉   | 44/63 [01:12<00:24,  1.32s/it][A
 71%|███████▏  | 45/63 [01:13<00:21,  1.22s/it][A
 73%|███████▎  | 46/63 [01:14<00:19,  1.17s/it][A
 75%|███████▍  | 47/63 [01:16<00:18,  1.17s/it][A
 76%|███████▌  | 48/63 [01:17<00:18,  1.24s/it][A
 78%|███████▊  | 49/63 [01:18<00:15,  1.12s/it][A
 79%|███████▉  | 50/63 [01:20<00:17,  1.34s/it][A
 81%|████████  | 51/63 [01:21<00:15,  1.33s/it][A
 83%|████████▎ | 52/63 [01:23<00:18,  1.70s/it][A
 84%|████████▍ | 53/63 [01:24<00:14,  1.44s/it][A
 86%|████████▌ | 54/63 [01:26<00:12,  1.40s/it][A
 87%|████████▋ | 55/63 [01:27<00:10,  1.33s/it][A
 89%|████████▉ | 56/63 [01:28<00:08,  1.27s/it][A
 90%|█████████ | 57/63 [01:29<00:07,  1.20s/it][A
 92%|█████████▏| 58/63 [01:30<00:06,  1.29s/it][A
 94%|█████████▎| 59/63 [01:32<00:04,  1.25s/it][A
 95%|█████████▌| 60/63 [01:32<00:03,  1.11s/it][A
 97%|█████████▋| 61/63 [01:33<00:02,  1.11s/it][A
 98%|█████████▊| 62/63 [01:35<00:01,  1.10s/it][A
100%|██████████| 63/63 [01:35<00:00,  1.15it/s][A
                                               [A                                                   
100%|██████████| 63/63 [01:35<00:00,  1.15it/s][A 92%|█████████▏| 400/434 [4:30:52<20:03, 35.39s/it]
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0002_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 92%|█████████▏| 401/434 [4:31:32<36:11, 65.82s/it] 93%|█████████▎| 402/434 [4:32:18<31:58, 59.96s/it] 93%|█████████▎| 403/434 [4:33:05<28:57, 56.04s/it] 93%|█████████▎| 404/434 [4:33:46<25:48, 51.63s/it] 93%|█████████▎| 405/434 [4:34:32<24:03, 49.76s/it] 94%|█████████▎| 406/434 [4:35:23<23:26, 50.25s/it] 94%|█████████▍| 407/434 [4:36:13<22:35, 50.19s/it] 94%|█████████▍| 408/434 [4:36:51<20:10, 46.54s/it] 94%|█████████▍| 409/434 [4:37:39<19:35, 47.03s/it] 94%|█████████▍| 410/434 [4:38:17<17:39, 44.13s/it]                                                    94%|█████████▍| 410/434 [4:38:17<17:39, 44.13s/it] 95%|█████████▍| 411/434 [4:39:03<17:13, 44.93s/it] 95%|█████████▍| 412/434 [4:39:44<16:02, 43.75s/it] 95%|█████████▌| 413/434 [4:40:32<15:41, 44.85s/it] 95%|█████████▌| 414/434 [4:41:14<14:40, 44.04s/it] 96%|█████████▌| 415/434 [4:42:03<14:26, 45.61s/it] 96%|█████████▌| 416/434 [4:42:48<13:34, 45.26s/it] 96%|█████████▌| 417/434 [4:43:35<12:58, 45.77s/it] 96%|█████████▋| 418/434 [4:44:07<11:10, 41.91s/it] 97%|█████████▋| 419/434 [4:44:39<09:40, 38.72s/it] 97%|█████████▋| 420/434 [4:45:30<09:53, 42.40s/it]                                                    97%|█████████▋| 420/434 [4:45:30<09:53, 42.40s/it] 97%|█████████▋| 421/434 [4:46:12<09:08, 42.22s/it] 97%|█████████▋| 422/434 [4:46:46<07:57, 39.80s/it] 97%|█████████▋| 423/434 [4:47:27<07:23, 40.33s/it] 98%|█████████▊| 424/434 [4:48:07<06:40, 40.02s/it] 98%|█████████▊| 425/434 [4:48:50<06:09, 41.04s/it] 98%|█████████▊| 426/434 [4:49:30<05:25, 40.71s/it] 98%|█████████▊| 427/434 [4:50:14<04:52, 41.83s/it] 99%|█████████▊| 428/434 [4:51:01<04:19, 43.25s/it] 99%|█████████▉| 429/434 [4:51:45<03:37, 43.50s/it] 99%|█████████▉| 430/434 [4:52:13<02:35, 38.92s/it]                                                    99%|█████████▉| 430/434 [4:52:13<02:35, 38.92s/it] 99%|█████████▉| 431/434 [4:52:48<01:53, 37.79s/it]100%|█████████▉| 432/434 [4:53:29<01:17, 38.74s/it]100%|█████████▉| 433/434 [4:54:19<00:42, 42.12s/it]100%|██████████| 434/434 [4:54:53<00:00, 39.65s/it]                                                   100%|██████████| 434/434 [4:54:54<00:00, 39.65s/it]100%|██████████| 434/434 [4:54:54<00:00, 40.77s/it]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0002_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 2.467790126800537, 'eval_runtime': 97.1721, 'eval_samples_per_second': 2.562, 'eval_steps_per_second': 0.648, 'eval_rewards/chosen': -72.1027603149414, 'eval_rewards/rejected': -76.57533264160156, 'eval_rewards/accuracies': 0.5833333134651184, 'eval_rewards/margins': 4.472568988800049, 'eval_logps/rejected': -1160.6463623046875, 'eval_logps/chosen': -1243.62939453125, 'eval_logits/rejected': -0.5086067318916321, 'eval_logits/chosen': -0.4080733358860016, 'epoch': 6.45}
{'loss': 0.0434, 'grad_norm': 0.015512892045080662, 'learning_rate': 8.349402317873789e-07, 'rewards/chosen': -39.445377349853516, 'rewards/rejected': -66.47289276123047, 'rewards/accuracies': 0.9375, 'rewards/margins': 27.027517318725586, 'logps/rejected': -896.5037841796875, 'logps/chosen': -538.0071411132812, 'logits/rejected': 0.07553839683532715, 'logits/chosen': 0.10463173687458038, 'epoch': 6.61}
{'loss': 0.0217, 'grad_norm': 0.017645783722400665, 'learning_rate': 2.846353990398065e-07, 'rewards/chosen': -39.88805389404297, 'rewards/rejected': -66.48987579345703, 'rewards/accuracies': 0.96875, 'rewards/margins': 26.601818084716797, 'logps/rejected': -896.27783203125, 'logps/chosen': -540.64794921875, 'logits/rejected': 0.06954969465732574, 'logits/chosen': 0.07940473407506943, 'epoch': 6.77}
{'loss': 0.0239, 'grad_norm': 0.0006190236308611929, 'learning_rate': 2.3255818832423894e-08, 'rewards/chosen': -39.96552276611328, 'rewards/rejected': -66.75038146972656, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 26.78484535217285, 'logps/rejected': -904.322265625, 'logps/chosen': -543.7607421875, 'logits/rejected': -0.005802658386528492, 'logits/chosen': 0.01170496828854084, 'epoch': 6.94}
{'train_runtime': 17716.0233, 'train_samples_per_second': 0.784, 'train_steps_per_second': 0.024, 'train_loss': 0.05492745616262959, 'epoch': 7.0}
wandb: - 0.371 MB of 0.371 MB uploadedwandb: \ 0.371 MB of 0.395 MB uploadedwandb: | 0.395 MB of 0.395 MB uploadedwandb: 
wandb: Run history:
wandb:       eval/logits/chosen ▁█
wandb:     eval/logits/rejected ▁█
wandb:        eval/logps/chosen █▁
wandb:      eval/logps/rejected █▁
wandb:                eval/loss ▁█
wandb:  eval/rewards/accuracies █▁
wandb:      eval/rewards/chosen █▁
wandb:     eval/rewards/margins ▁█
wandb:    eval/rewards/rejected █▁
wandb:             eval/runtime █▁
wandb:  eval/samples_per_second ▁█
wandb:    eval/steps_per_second ▁▁
wandb:              train/epoch ▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:        train/global_step ▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇▇███
wandb:          train/grad_norm ▂▃▃▁▂▂▁▁▁▁█▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      train/learning_rate ▄▇███████▇▇▇▇▆▆▆▆▆▅▅▅▄▄▄▄▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁
wandb:      train/logits/chosen █▂▁▁▁▂▃▄▃▄▃▅▄▅▄▄▄▆▃▃▄▄▅▄▅▄▄▄▅▅▄▄▅▅▄▅▄▄▅▄
wandb:    train/logits/rejected █▁▁▁▂▃▃▅▄▅▄▇▅▆▄▅▆▇▄▅▇▅▇▅▇▅▆▆▇▆▆▅▇▇▆▇▆▆█▆
wandb:       train/logps/chosen █▇▆▇▆▄▆▄▃▃▃▁▂▃▄▂▂▃▂▂▂▁▂▁▁▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:     train/logps/rejected █▇▆▆▆▅▅▄▃▃▃▁▂▂▃▂▂▂▂▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               train/loss █▃▃▃▂▃▂▁▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: train/rewards/accuracies ▁▆▆▇█▇▇█▇████▇█▇███▇██▇▇▇██▇█▇▇███████▇█
wandb:     train/rewards/chosen █▇▆▇▆▄▆▄▃▃▃▁▂▃▄▂▂▃▂▂▂▁▂▁▁▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:    train/rewards/margins ▁▂▃▃▄▄▄▅▆▇▇▇█▇▆▇▇▇▇▇▇▇███▇▇▇██████▇█████
wandb:   train/rewards/rejected █▇▆▆▅▅▅▄▃▃▃▁▂▂▃▂▂▂▂▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:       eval/logits/chosen -0.40807
wandb:     eval/logits/rejected -0.50861
wandb:        eval/logps/chosen -1243.62939
wandb:      eval/logps/rejected -1160.64636
wandb:                eval/loss 2.46779
wandb:  eval/rewards/accuracies 0.58333
wandb:      eval/rewards/chosen -72.10276
wandb:     eval/rewards/margins 4.47257
wandb:    eval/rewards/rejected -76.57533
wandb:             eval/runtime 97.1721
wandb:  eval/samples_per_second 2.562
wandb:    eval/steps_per_second 0.648
wandb:               total_flos 0.0
wandb:              train/epoch 7.0
wandb:        train/global_step 434
wandb:          train/grad_norm 0.00062
wandb:      train/learning_rate 0.0
wandb:      train/logits/chosen 0.0117
wandb:    train/logits/rejected -0.0058
wandb:       train/logps/chosen -543.76074
wandb:     train/logps/rejected -904.32227
wandb:               train/loss 0.0239
wandb: train/rewards/accuracies 0.96562
wandb:     train/rewards/chosen -39.96552
wandb:    train/rewards/margins 26.78485
wandb:   train/rewards/rejected -66.75038
wandb:               train_loss 0.05493
wandb:            train_runtime 17716.0233
wandb: train_samples_per_second 0.784
wandb:   train_steps_per_second 0.024
wandb: 
wandb: 🚀 View run dpo_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0001_ep-7_bz-8-acc-4_lora-r-32-ap-64 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/ui4gt5vb
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240526_204744-ui4gt5vb/logs
