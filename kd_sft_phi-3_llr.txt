`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:23<00:00, 11.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:23<00:00, 11.65s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Found max lenth: 4096
trainable params: 50331648 || all params: 2059471872 || trainables%: 2.4439104356944577
Map:   0%|          | 0/1938 [00:00<?, ? examples/s]Map:  52%|█████▏    | 1000/1938 [00:01<00:01, 743.61 examples/s]Map: 100%|██████████| 1938/1938 [00:02<00:00, 874.35 examples/s]Map: 100%|██████████| 1938/1938 [00:02<00:00, 847.04 examples/s]
Map:   0%|          | 0/243 [00:00<?, ? examples/s]Map: 100%|██████████| 243/243 [00:00<00:00, 965.59 examples/s]Map: 100%|██████████| 243/243 [00:00<00:00, 953.21 examples/s]
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240525_135003-1w3w1on4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-9e-05_ep-7_bz-4-acc-4_lora-r-32-ap-64
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/1w3w1on4
  0%|          | 0/847 [00:00<?, ?it/s]/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
You are not running the flash-attention implementation, expect numerical differences.
  0%|          | 1/847 [00:12<3:02:52, 12.97s/it]  0%|          | 2/847 [00:23<2:41:08, 11.44s/it]  0%|          | 3/847 [00:33<2:32:00, 10.81s/it]  0%|          | 4/847 [00:43<2:25:41, 10.37s/it]  1%|          | 5/847 [00:52<2:20:58, 10.05s/it]  1%|          | 6/847 [01:04<2:31:16, 10.79s/it]  1%|          | 7/847 [01:17<2:40:28, 11.46s/it]  1%|          | 8/847 [01:28<2:35:43, 11.14s/it]  1%|          | 9/847 [01:36<2:24:56, 10.38s/it]  1%|          | 10/847 [01:49<2:34:34, 11.08s/it]                                                    1%|          | 10/847 [01:49<2:34:34, 11.08s/it]  1%|▏         | 11/847 [02:00<2:34:05, 11.06s/it]  1%|▏         | 12/847 [02:15<2:50:29, 12.25s/it]  2%|▏         | 13/847 [02:28<2:55:36, 12.63s/it]  2%|▏         | 14/847 [02:40<2:50:31, 12.28s/it]  2%|▏         | 15/847 [02:52<2:49:23, 12.22s/it]  2%|▏         | 16/847 [03:12<3:22:59, 14.66s/it]  2%|▏         | 17/847 [03:22<3:00:32, 13.05s/it]  2%|▏         | 18/847 [03:32<2:48:55, 12.23s/it]  2%|▏         | 19/847 [03:42<2:41:27, 11.70s/it]  2%|▏         | 20/847 [03:55<2:45:14, 11.99s/it]                                                    2%|▏         | 20/847 [03:55<2:45:14, 11.99s/it]  2%|▏         | 21/847 [04:03<2:27:47, 10.74s/it]  3%|▎         | 22/847 [04:18<2:45:30, 12.04s/it]  3%|▎         | 23/847 [04:25<2:22:53, 10.40s/it]  3%|▎         | 24/847 [04:35<2:22:33, 10.39s/it]  3%|▎         | 25/847 [04:49<2:38:58, 11.60s/it]  3%|▎         | 26/847 [04:58<2:28:40, 10.86s/it]  3%|▎         | 27/847 [05:09<2:26:25, 10.71s/it]  3%|▎         | 28/847 [05:18<2:19:53, 10.25s/it]  3%|▎         | 29/847 [05:29<2:23:35, 10.53s/it]  4%|▎         | 30/847 [05:39<2:20:48, 10.34s/it]                                                    4%|▎         | 30/847 [05:39<2:20:48, 10.34s/it]  4%|▎         | 31/847 [05:49<2:20:46, 10.35s/it]  4%|▍         | 32/847 [06:03<2:31:49, 11.18s/it]  4%|▍         | 33/847 [06:13<2:26:43, 10.82s/it]  4%|▍         | 34/847 [06:26<2:36:59, 11.59s/it]  4%|▍         | 35/847 [06:34<2:21:55, 10.49s/it]  4%|▍         | 36/847 [06:43<2:18:11, 10.22s/it]  4%|▍         | 37/847 [06:55<2:23:20, 10.62s/it]  4%|▍         | 38/847 [07:09<2:36:45, 11.63s/it]  5%|▍         | 39/847 [07:22<2:40:31, 11.92s/it]  5%|▍         | 40/847 [07:36<2:50:23, 12.67s/it]                                                    5%|▍         | 40/847 [07:36<2:50:23, 12.67s/it]  5%|▍         | 41/847 [07:49<2:50:11, 12.67s/it]  5%|▍         | 42/847 [07:57<2:31:33, 11.30s/it]  5%|▌         | 43/847 [08:05<2:19:57, 10.44s/it]  5%|▌         | 44/847 [08:19<2:33:02, 11.43s/it]  5%|▌         | 45/847 [08:31<2:34:47, 11.58s/it]  5%|▌         | 46/847 [08:45<2:44:14, 12.30s/it]  6%|▌         | 47/847 [08:57<2:42:24, 12.18s/it]  6%|▌         | 48/847 [09:07<2:34:18, 11.59s/it]  6%|▌         | 49/847 [09:23<2:52:28, 12.97s/it]  6%|▌         | 50/847 [09:37<2:53:53, 13.09s/it]                                                    6%|▌         | 50/847 [09:37<2:53:53, 13.09s/it]  6%|▌         | 51/847 [09:50<2:53:21, 13.07s/it]  6%|▌         | 52/847 [10:00<2:42:34, 12.27s/it]  6%|▋         | 53/847 [10:13<2:43:52, 12.38s/it]  6%|▋         | 54/847 [10:25<2:44:06, 12.42s/it]  6%|▋         | 55/847 [10:38<2:45:43, 12.56s/it]  7%|▋         | 56/847 [10:50<2:41:47, 12.27s/it]  7%|▋         | 57/847 [11:02<2:43:21, 12.41s/it]  7%|▋         | 58/847 [11:14<2:40:57, 12.24s/it]  7%|▋         | 59/847 [11:30<2:56:44, 13.46s/it]  7%|▋         | 60/847 [11:42<2:50:17, 12.98s/it]                                                    7%|▋         | 60/847 [11:42<2:50:17, 12.98s/it]  7%|▋         | 61/847 [11:54<2:44:30, 12.56s/it]  7%|▋         | 62/847 [12:03<2:30:08, 11.48s/it]  7%|▋         | 63/847 [12:14<2:28:35, 11.37s/it]  8%|▊         | 64/847 [12:23<2:18:50, 10.64s/it]  8%|▊         | 65/847 [12:35<2:23:53, 11.04s/it]  8%|▊         | 66/847 [12:46<2:24:01, 11.06s/it]  8%|▊         | 67/847 [12:59<2:31:06, 11.62s/it]  8%|▊         | 68/847 [13:10<2:29:26, 11.51s/it]  8%|▊         | 69/847 [13:20<2:22:59, 11.03s/it]  8%|▊         | 70/847 [13:31<2:24:11, 11.13s/it]                                                    8%|▊         | 70/847 [13:31<2:24:11, 11.13s/it]  8%|▊         | 71/847 [13:46<2:38:47, 12.28s/it]  9%|▊         | 72/847 [13:54<2:22:03, 11.00s/it]  9%|▊         | 73/847 [14:04<2:16:49, 10.61s/it]  9%|▊         | 74/847 [14:13<2:09:19, 10.04s/it]  9%|▉         | 75/847 [14:24<2:14:58, 10.49s/it]  9%|▉         | 76/847 [14:36<2:18:48, 10.80s/it]  9%|▉         | 77/847 [14:52<2:37:21, 12.26s/it]  9%|▉         | 78/847 [15:00<2:23:34, 11.20s/it]  9%|▉         | 79/847 [15:13<2:28:46, 11.62s/it]  9%|▉         | 80/847 [15:27<2:39:06, 12.45s/it]                                                    9%|▉         | 80/847 [15:27<2:39:06, 12.45s/it] 10%|▉         | 81/847 [15:40<2:39:16, 12.48s/it] 10%|▉         | 82/847 [15:55<2:49:37, 13.30s/it] 10%|▉         | 83/847 [16:07<2:44:38, 12.93s/it] 10%|▉         | 84/847 [16:21<2:48:21, 13.24s/it] 10%|█         | 85/847 [16:30<2:31:15, 11.91s/it] 10%|█         | 86/847 [16:45<2:42:58, 12.85s/it] 10%|█         | 87/847 [16:55<2:32:53, 12.07s/it] 10%|█         | 88/847 [17:04<2:21:15, 11.17s/it] 11%|█         | 89/847 [17:15<2:19:21, 11.03s/it] 11%|█         | 90/847 [17:31<2:39:29, 12.64s/it]                                                   11%|█         | 90/847 [17:31<2:39:29, 12.64s/it] 11%|█         | 91/847 [17:44<2:39:03, 12.62s/it] 11%|█         | 92/847 [17:53<2:23:50, 11.43s/it] 11%|█         | 93/847 [18:05<2:28:51, 11.85s/it] 11%|█         | 94/847 [18:17<2:29:02, 11.88s/it] 11%|█         | 95/847 [18:31<2:33:46, 12.27s/it] 11%|█▏        | 96/847 [18:41<2:26:45, 11.72s/it] 11%|█▏        | 97/847 [18:53<2:26:22, 11.71s/it] 12%|█▏        | 98/847 [19:05<2:29:43, 11.99s/it] 12%|█▏        | 99/847 [19:16<2:22:48, 11.46s/it] 12%|█▏        | 100/847 [19:26<2:17:37, 11.05s/it]                                                    12%|█▏        | 100/847 [19:26<2:17:37, 11.05s/it] 12%|█▏        | 101/847 [19:38<2:23:57, 11.58s/it] 12%|█▏        | 102/847 [19:48<2:17:02, 11.04s/it] 12%|█▏        | 103/847 [19:59<2:16:30, 11.01s/it] 12%|█▏        | 104/847 [20:12<2:21:39, 11.44s/it] 12%|█▏        | 105/847 [20:22<2:17:49, 11.14s/it] 13%|█▎        | 106/847 [20:35<2:22:34, 11.54s/it] 13%|█▎        | 107/847 [20:46<2:22:37, 11.56s/it] 13%|█▎        | 108/847 [21:02<2:37:22, 12.78s/it] 13%|█▎        | 109/847 [21:16<2:42:50, 13.24s/it] 13%|█▎        | 110/847 [21:31<2:47:16, 13.62s/it]                                                    13%|█▎        | 110/847 [21:31<2:47:16, 13.62s/it] 13%|█▎        | 111/847 [21:45<2:51:13, 13.96s/it] 13%|█▎        | 112/847 [21:54<2:31:04, 12.33s/it] 13%|█▎        | 113/847 [22:05<2:26:26, 11.97s/it] 13%|█▎        | 114/847 [22:21<2:41:16, 13.20s/it] 14%|█▎        | 115/847 [22:32<2:32:58, 12.54s/it] 14%|█▎        | 116/847 [22:44<2:32:21, 12.51s/it] 14%|█▍        | 117/847 [22:53<2:16:26, 11.21s/it] 14%|█▍        | 118/847 [23:02<2:09:15, 10.64s/it] 14%|█▍        | 119/847 [23:11<2:02:12, 10.07s/it] 14%|█▍        | 120/847 [23:25<2:15:56, 11.22s/it]                                                    14%|█▍        | 120/847 [23:25<2:15:56, 11.22s/it] 14%|█▍        | 121/847 [23:34<2:10:30, 10.79s/it]{'loss': 1.4203, 'grad_norm': 0.47009310126304626, 'learning_rate': 2.0930232558139536e-05, 'epoch': 0.08}
{'loss': 1.2552, 'grad_norm': 0.2437329739332199, 'learning_rate': 4.186046511627907e-05, 'epoch': 0.16}
{'loss': 1.1436, 'grad_norm': 0.26093316078186035, 'learning_rate': 6.27906976744186e-05, 'epoch': 0.25}
{'loss': 1.1443, 'grad_norm': 0.16701805591583252, 'learning_rate': 8.372093023255814e-05, 'epoch': 0.33}
{'loss': 1.105, 'grad_norm': 0.18944868445396423, 'learning_rate': 8.998316786639417e-05, 'epoch': 0.41}
{'loss': 1.1069, 'grad_norm': 0.17086000740528107, 'learning_rate': 8.9900755074764e-05, 'epoch': 0.49}
{'loss': 1.1256, 'grad_norm': 0.6461840867996216, 'learning_rate': 8.974979566481681e-05, 'epoch': 0.58}
{'loss': 1.093, 'grad_norm': 0.15713806450366974, 'learning_rate': 8.953052009497224e-05, 'epoch': 0.66}
{'loss': 1.116, 'grad_norm': 0.18654170632362366, 'learning_rate': 8.924326311681225e-05, 'epoch': 0.74}
{'loss': 1.1218, 'grad_norm': 0.17651300132274628, 'learning_rate': 8.888846326404095e-05, 'epoch': 0.82}
{'loss': 1.0825, 'grad_norm': 0.16573908925056458, 'learning_rate': 8.846666218300807e-05, 'epoch': 0.91}
{'loss': 1.0385, 'grad_norm': 0.16679485142230988, 'learning_rate': 8.797850380581811e-05, 'epoch': 0.99}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A 14%|█▍        | 121/847 [24:25<2:10:30, 10.79s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 14%|█▍        | 122/847 [24:34<5:08:53, 25.56s/it] 15%|█▍        | 123/847 [24:50<4:31:22, 22.49s/it] 15%|█▍        | 124/847 [24:59<3:43:40, 18.56s/it] 15%|█▍        | 125/847 [25:10<3:14:31, 16.17s/it] 15%|█▍        | 126/847 [25:23<3:03:26, 15.27s/it] 15%|█▍        | 127/847 [25:36<2:54:59, 14.58s/it] 15%|█▌        | 128/847 [25:50<2:51:24, 14.30s/it] 15%|█▌        | 129/847 [26:00<2:38:47, 13.27s/it] 15%|█▌        | 130/847 [26:13<2:36:40, 13.11s/it]                                                    15%|█▌        | 130/847 [26:13<2:36:40, 13.11s/it] 15%|█▌        | 131/847 [26:26<2:36:20, 13.10s/it] 16%|█▌        | 132/847 [26:38<2:32:55, 12.83s/it] 16%|█▌        | 133/847 [26:49<2:25:04, 12.19s/it] 16%|█▌        | 134/847 [26:58<2:13:17, 11.22s/it] 16%|█▌        | 135/847 [27:14<2:28:28, 12.51s/it] 16%|█▌        | 136/847 [27:25<2:25:12, 12.25s/it] 16%|█▌        | 137/847 [27:37<2:24:30, 12.21s/it] 16%|█▋        | 138/847 [27:50<2:24:15, 12.21s/it] 16%|█▋        | 139/847 [28:00<2:17:36, 11.66s/it] 17%|█▋        | 140/847 [28:12<2:20:05, 11.89s/it]                                                    17%|█▋        | 140/847 [28:12<2:20:05, 11.89s/it] 17%|█▋        | 141/847 [28:22<2:11:39, 11.19s/it] 17%|█▋        | 142/847 [28:31<2:05:25, 10.67s/it] 17%|█▋        | 143/847 [28:43<2:09:55, 11.07s/it] 17%|█▋        | 144/847 [28:51<1:58:29, 10.11s/it] 17%|█▋        | 145/847 [29:04<2:08:16, 10.96s/it] 17%|█▋        | 146/847 [29:13<2:01:10, 10.37s/it] 17%|█▋        | 147/847 [29:24<2:03:45, 10.61s/it] 17%|█▋        | 148/847 [29:36<2:08:05, 11.00s/it] 18%|█▊        | 149/847 [29:49<2:14:46, 11.59s/it] 18%|█▊        | 150/847 [29:59<2:07:23, 10.97s/it]                                                    18%|█▊        | 150/847 [29:59<2:07:23, 10.97s/it] 18%|█▊        | 151/847 [30:09<2:06:07, 10.87s/it] 18%|█▊        | 152/847 [30:27<2:27:49, 12.76s/it] 18%|█▊        | 153/847 [30:40<2:30:08, 12.98s/it] 18%|█▊        | 154/847 [30:53<2:28:26, 12.85s/it] 18%|█▊        | 155/847 [31:05<2:27:31, 12.79s/it] 18%|█▊        | 156/847 [31:17<2:21:57, 12.33s/it] 19%|█▊        | 157/847 [31:28<2:17:50, 11.99s/it] 19%|█▊        | 158/847 [31:43<2:27:28, 12.84s/it] 19%|█▉        | 159/847 [31:52<2:15:32, 11.82s/it] 19%|█▉        | 160/847 [32:00<2:03:35, 10.79s/it]                                                    19%|█▉        | 160/847 [32:00<2:03:35, 10.79s/it] 19%|█▉        | 161/847 [32:11<2:03:59, 10.84s/it] 19%|█▉        | 162/847 [32:23<2:07:28, 11.17s/it] 19%|█▉        | 163/847 [32:42<2:32:15, 13.36s/it] 19%|█▉        | 164/847 [32:52<2:21:52, 12.46s/it] 19%|█▉        | 165/847 [33:05<2:23:41, 12.64s/it] 20%|█▉        | 166/847 [33:21<2:34:20, 13.60s/it] 20%|█▉        | 167/847 [33:30<2:20:00, 12.35s/it] 20%|█▉        | 168/847 [33:40<2:10:45, 11.55s/it] 20%|█▉        | 169/847 [33:51<2:06:55, 11.23s/it] 20%|██        | 170/847 [34:11<2:36:04, 13.83s/it]                                                    20%|██        | 170/847 [34:11<2:36:04, 13.83s/it] 20%|██        | 171/847 [34:24<2:34:56, 13.75s/it] 20%|██        | 172/847 [34:33<2:19:07, 12.37s/it] 20%|██        | 173/847 [34:42<2:06:52, 11.29s/it] 21%|██        | 174/847 [34:52<2:00:51, 10.77s/it] 21%|██        | 175/847 [35:04<2:07:42, 11.40s/it] 21%|██        | 176/847 [35:15<2:03:26, 11.04s/it] 21%|██        | 177/847 [35:26<2:04:43, 11.17s/it] 21%|██        | 178/847 [35:39<2:11:33, 11.80s/it] 21%|██        | 179/847 [35:51<2:11:47, 11.84s/it] 21%|██▏       | 180/847 [36:04<2:13:22, 12.00s/it]                                                    21%|██▏       | 180/847 [36:04<2:13:22, 12.00s/it] 21%|██▏       | 181/847 [36:13<2:04:40, 11.23s/it] 21%|██▏       | 182/847 [36:29<2:18:31, 12.50s/it] 22%|██▏       | 183/847 [36:41<2:19:02, 12.56s/it] 22%|██▏       | 184/847 [36:52<2:13:21, 12.07s/it] 22%|██▏       | 185/847 [37:03<2:08:38, 11.66s/it] 22%|██▏       | 186/847 [37:18<2:20:29, 12.75s/it] 22%|██▏       | 187/847 [37:28<2:10:40, 11.88s/it] 22%|██▏       | 188/847 [37:41<2:12:51, 12.10s/it] 22%|██▏       | 189/847 [37:50<2:01:57, 11.12s/it] 22%|██▏       | 190/847 [38:03<2:10:08, 11.89s/it]                                                    22%|██▏       | 190/847 [38:03<2:10:08, 11.89s/it] 23%|██▎       | 191/847 [38:16<2:14:02, 12.26s/it] 23%|██▎       | 192/847 [38:28<2:12:13, 12.11s/it] 23%|██▎       | 193/847 [38:40<2:10:33, 11.98s/it] 23%|██▎       | 194/847 [38:50<2:06:10, 11.59s/it] 23%|██▎       | 195/847 [39:01<2:03:49, 11.39s/it] 23%|██▎       | 196/847 [39:16<2:12:47, 12.24s/it] 23%|██▎       | 197/847 [39:26<2:05:10, 11.55s/it] 23%|██▎       | 198/847 [39:37<2:05:47, 11.63s/it] 23%|██▎       | 199/847 [39:51<2:12:28, 12.27s/it] 24%|██▎       | 200/847 [40:02<2:06:41, 11.75s/it]                                                    24%|██▎       | 200/847 [40:02<2:06:41, 11.75s/it] 24%|██▎       | 201/847 [40:11<1:58:42, 11.03s/it] 24%|██▍       | 202/847 [40:22<1:57:28, 10.93s/it] 24%|██▍       | 203/847 [40:31<1:52:03, 10.44s/it] 24%|██▍       | 204/847 [40:41<1:51:06, 10.37s/it] 24%|██▍       | 205/847 [40:54<1:59:42, 11.19s/it] 24%|██▍       | 206/847 [41:04<1:53:47, 10.65s/it] 24%|██▍       | 207/847 [41:21<2:14:25, 12.60s/it] 25%|██▍       | 208/847 [41:30<2:02:36, 11.51s/it] 25%|██▍       | 209/847 [41:42<2:03:23, 11.60s/it] 25%|██▍       | 210/847 [41:55<2:08:16, 12.08s/it]                                                    25%|██▍       | 210/847 [41:55<2:08:16, 12.08s/it] 25%|██▍       | 211/847 [42:07<2:08:01, 12.08s/it] 25%|██▌       | 212/847 [42:18<2:04:27, 11.76s/it] 25%|██▌       | 213/847 [42:27<1:54:18, 10.82s/it] 25%|██▌       | 214/847 [42:41<2:06:04, 11.95s/it] 25%|██▌       | 215/847 [42:53<2:04:53, 11.86s/it] 26%|██▌       | 216/847 [43:03<1:59:42, 11.38s/it] 26%|██▌       | 217/847 [43:14<1:59:00, 11.33s/it] 26%|██▌       | 218/847 [43:26<2:00:39, 11.51s/it] 26%|██▌       | 219/847 [43:37<1:58:55, 11.36s/it] 26%|██▌       | 220/847 [43:50<2:02:50, 11.76s/it]                                                    26%|██▌       | 220/847 [43:50<2:02:50, 11.76s/it] 26%|██▌       | 221/847 [44:01<2:01:12, 11.62s/it] 26%|██▌       | 222/847 [44:11<1:55:45, 11.11s/it] 26%|██▋       | 223/847 [44:21<1:53:00, 10.87s/it] 26%|██▋       | 224/847 [44:31<1:49:32, 10.55s/it] 27%|██▋       | 225/847 [44:43<1:53:40, 10.96s/it] 27%|██▋       | 226/847 [44:58<2:05:40, 12.14s/it] 27%|██▋       | 227/847 [45:10<2:04:15, 12.03s/it] 27%|██▋       | 228/847 [45:21<2:00:21, 11.67s/it] 27%|██▋       | 229/847 [45:38<2:17:59, 13.40s/it] 27%|██▋       | 230/847 [45:52<2:20:31, 13.66s/it]                                                    27%|██▋       | 230/847 [45:52<2:20:31, 13.66s/it] 27%|██▋       | 231/847 [46:02<2:07:58, 12.46s/it] 27%|██▋       | 232/847 [46:16<2:12:17, 12.91s/it] 28%|██▊       | 233/847 [46:27<2:05:08, 12.23s/it] 28%|██▊       | 234/847 [46:36<1:57:07, 11.46s/it] 28%|██▊       | 235/847 [46:51<2:05:44, 12.33s/it] 28%|██▊       | 236/847 [47:00<1:57:07, 11.50s/it] 28%|██▊       | 237/847 [47:13<2:00:12, 11.82s/it] 28%|██▊       | 238/847 [47:28<2:11:24, 12.95s/it] 28%|██▊       | 239/847 [47:38<2:02:42, 12.11s/it] 28%|██▊       | 240/847 [47:50<1:59:20, 11.80s/it]                                                    28%|██▊       | 240/847 [47:50<1:59:20, 11.80s/it] 28%|██▊       | 241/847 [48:00<1:56:15, 11.51s/it] 29%|██▊       | 242/847 [48:14<2:03:38, 12.26s/it]{'eval_loss': 1.0788893699645996, 'eval_runtime': 49.9771, 'eval_samples_per_second': 4.862, 'eval_steps_per_second': 1.221, 'epoch': 1.0}
{'loss': 1.0629, 'grad_norm': 0.19991758465766907, 'learning_rate': 8.742473336728736e-05, 'epoch': 1.07}
{'loss': 1.0477, 'grad_norm': 0.1864193230867386, 'learning_rate': 8.680619626724974e-05, 'epoch': 1.15}
{'loss': 1.0146, 'grad_norm': 0.20969648659229279, 'learning_rate': 8.612383677994835e-05, 'epoch': 1.24}
{'loss': 1.0414, 'grad_norm': 0.2081344574689865, 'learning_rate': 8.537869661248262e-05, 'epoch': 1.32}
{'loss': 1.0684, 'grad_norm': 0.201167494058609, 'learning_rate': 8.457191331451215e-05, 'epoch': 1.4}
{'loss': 1.0275, 'grad_norm': 0.19918550550937653, 'learning_rate': 8.370471854164494e-05, 'epoch': 1.48}
{'loss': 1.0428, 'grad_norm': 0.20229043066501617, 'learning_rate': 8.2778436175161e-05, 'epoch': 1.57}
{'loss': 1.0659, 'grad_norm': 0.2247467041015625, 'learning_rate': 8.179448030094204e-05, 'epoch': 1.65}
{'loss': 1.0037, 'grad_norm': 0.21221768856048584, 'learning_rate': 8.07543530506925e-05, 'epoch': 1.73}
{'loss': 1.0405, 'grad_norm': 0.19244422018527985, 'learning_rate': 7.965964230874762e-05, 'epoch': 1.81}
{'loss': 1.049, 'grad_norm': 0.2127271592617035, 'learning_rate': 7.851201928796942e-05, 'epoch': 1.9}
{'loss': 1.0555, 'grad_norm': 0.22168101370334625, 'learning_rate': 7.731323597843126e-05, 'epoch': 1.98}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:22,  2.67it/s][A
  5%|▍         | 3/61 [00:01<00:41,  1.38it/s][A
  7%|▋         | 4/61 [00:02<00:47,  1.21it/s][A
  8%|▊         | 5/61 [00:03<00:43,  1.28it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.31it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:37,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:13<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.44it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.54it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.39it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.10it/s][A
 92%|█████████▏| 56/61 [00:45<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A 29%|██▊       | 242/847 [49:13<2:03:38, 12.26s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 29%|██▊       | 243/847 [49:24<4:55:36, 29.36s/it] 29%|██▉       | 244/847 [49:37<4:06:00, 24.48s/it] 29%|██▉       | 245/847 [49:48<3:25:26, 20.48s/it] 29%|██▉       | 246/847 [49:59<2:57:08, 17.68s/it] 29%|██▉       | 247/847 [50:09<2:33:21, 15.34s/it] 29%|██▉       | 248/847 [50:17<2:12:35, 13.28s/it] 29%|██▉       | 249/847 [50:30<2:10:21, 13.08s/it] 30%|██▉       | 250/847 [50:40<2:01:55, 12.25s/it]                                                    30%|██▉       | 250/847 [50:40<2:01:55, 12.25s/it] 30%|██▉       | 251/847 [50:51<1:56:41, 11.75s/it] 30%|██▉       | 252/847 [50:59<1:45:05, 10.60s/it] 30%|██▉       | 253/847 [51:13<1:55:05, 11.63s/it] 30%|██▉       | 254/847 [51:28<2:04:07, 12.56s/it] 30%|███       | 255/847 [51:39<2:00:50, 12.25s/it] 30%|███       | 256/847 [51:48<1:51:04, 11.28s/it] 30%|███       | 257/847 [52:00<1:51:47, 11.37s/it] 30%|███       | 258/847 [52:12<1:54:48, 11.70s/it] 31%|███       | 259/847 [52:19<1:41:22, 10.34s/it] 31%|███       | 260/847 [52:33<1:50:17, 11.27s/it]                                                    31%|███       | 260/847 [52:33<1:50:17, 11.27s/it] 31%|███       | 261/847 [52:42<1:44:58, 10.75s/it] 31%|███       | 262/847 [52:54<1:47:21, 11.01s/it] 31%|███       | 263/847 [53:04<1:44:05, 10.70s/it] 31%|███       | 264/847 [53:15<1:46:24, 10.95s/it] 31%|███▏      | 265/847 [53:30<1:58:04, 12.17s/it] 31%|███▏      | 266/847 [53:39<1:46:57, 11.05s/it] 32%|███▏      | 267/847 [53:50<1:47:12, 11.09s/it] 32%|███▏      | 268/847 [54:02<1:50:54, 11.49s/it] 32%|███▏      | 269/847 [54:17<1:59:46, 12.43s/it] 32%|███▏      | 270/847 [54:30<2:01:45, 12.66s/it]                                                    32%|███▏      | 270/847 [54:30<2:01:45, 12.66s/it] 32%|███▏      | 271/847 [54:40<1:52:22, 11.71s/it] 32%|███▏      | 272/847 [54:56<2:04:46, 13.02s/it] 32%|███▏      | 273/847 [55:12<2:12:54, 13.89s/it] 32%|███▏      | 274/847 [55:23<2:04:56, 13.08s/it] 32%|███▏      | 275/847 [55:35<2:01:20, 12.73s/it] 33%|███▎      | 276/847 [55:45<1:53:52, 11.97s/it] 33%|███▎      | 277/847 [56:01<2:05:57, 13.26s/it] 33%|███▎      | 278/847 [56:12<1:58:31, 12.50s/it] 33%|███▎      | 279/847 [56:25<1:59:21, 12.61s/it] 33%|███▎      | 280/847 [56:35<1:53:16, 11.99s/it]                                                    33%|███▎      | 280/847 [56:35<1:53:16, 11.99s/it] 33%|███▎      | 281/847 [56:46<1:48:10, 11.47s/it] 33%|███▎      | 282/847 [56:55<1:40:38, 10.69s/it] 33%|███▎      | 283/847 [57:04<1:35:35, 10.17s/it] 34%|███▎      | 284/847 [57:16<1:41:22, 10.80s/it] 34%|███▎      | 285/847 [57:33<1:58:26, 12.64s/it] 34%|███▍      | 286/847 [57:45<1:56:25, 12.45s/it] 34%|███▍      | 287/847 [57:54<1:46:32, 11.41s/it] 34%|███▍      | 288/847 [58:05<1:46:08, 11.39s/it] 34%|███▍      | 289/847 [58:23<2:04:51, 13.43s/it] 34%|███▍      | 290/847 [58:36<2:01:48, 13.12s/it]                                                    34%|███▍      | 290/847 [58:36<2:01:48, 13.12s/it] 34%|███▍      | 291/847 [58:48<1:59:08, 12.86s/it] 34%|███▍      | 292/847 [58:59<1:55:11, 12.45s/it] 35%|███▍      | 293/847 [59:09<1:46:32, 11.54s/it] 35%|███▍      | 294/847 [59:22<1:51:11, 12.06s/it] 35%|███▍      | 295/847 [59:35<1:52:24, 12.22s/it] 35%|███▍      | 296/847 [59:53<2:10:06, 14.17s/it] 35%|███▌      | 297/847 [1:00:07<2:07:00, 13.85s/it] 35%|███▌      | 298/847 [1:00:21<2:08:10, 14.01s/it] 35%|███▌      | 299/847 [1:00:35<2:07:08, 13.92s/it] 35%|███▌      | 300/847 [1:00:48<2:06:11, 13.84s/it]                                                      35%|███▌      | 300/847 [1:00:48<2:06:11, 13.84s/it] 36%|███▌      | 301/847 [1:00:57<1:52:57, 12.41s/it] 36%|███▌      | 302/847 [1:01:07<1:45:09, 11.58s/it] 36%|███▌      | 303/847 [1:01:21<1:50:56, 12.24s/it] 36%|███▌      | 304/847 [1:01:32<1:47:25, 11.87s/it] 36%|███▌      | 305/847 [1:01:41<1:38:38, 10.92s/it] 36%|███▌      | 306/847 [1:01:50<1:34:57, 10.53s/it] 36%|███▌      | 307/847 [1:02:00<1:33:44, 10.42s/it] 36%|███▋      | 308/847 [1:02:12<1:38:22, 10.95s/it] 36%|███▋      | 309/847 [1:02:26<1:45:12, 11.73s/it] 37%|███▋      | 310/847 [1:02:36<1:38:54, 11.05s/it]                                                      37%|███▋      | 310/847 [1:02:36<1:38:54, 11.05s/it] 37%|███▋      | 311/847 [1:02:54<1:57:53, 13.20s/it] 37%|███▋      | 312/847 [1:03:03<1:48:20, 12.15s/it] 37%|███▋      | 313/847 [1:03:14<1:44:16, 11.72s/it] 37%|███▋      | 314/847 [1:03:26<1:44:18, 11.74s/it] 37%|███▋      | 315/847 [1:03:39<1:46:28, 12.01s/it] 37%|███▋      | 316/847 [1:03:48<1:38:22, 11.11s/it] 37%|███▋      | 317/847 [1:03:57<1:32:32, 10.48s/it] 38%|███▊      | 318/847 [1:04:11<1:42:34, 11.63s/it] 38%|███▊      | 319/847 [1:04:23<1:42:59, 11.70s/it] 38%|███▊      | 320/847 [1:04:33<1:38:07, 11.17s/it]                                                      38%|███▊      | 320/847 [1:04:33<1:38:07, 11.17s/it] 38%|███▊      | 321/847 [1:04:43<1:36:50, 11.05s/it] 38%|███▊      | 322/847 [1:04:58<1:44:56, 11.99s/it] 38%|███▊      | 323/847 [1:05:09<1:42:07, 11.69s/it] 38%|███▊      | 324/847 [1:05:24<1:50:19, 12.66s/it] 38%|███▊      | 325/847 [1:05:40<1:59:57, 13.79s/it] 38%|███▊      | 326/847 [1:05:51<1:51:24, 12.83s/it] 39%|███▊      | 327/847 [1:06:02<1:48:00, 12.46s/it] 39%|███▊      | 328/847 [1:06:17<1:53:19, 13.10s/it] 39%|███▉      | 329/847 [1:06:29<1:52:09, 12.99s/it] 39%|███▉      | 330/847 [1:06:42<1:49:23, 12.69s/it]                                                      39%|███▉      | 330/847 [1:06:42<1:49:23, 12.69s/it] 39%|███▉      | 331/847 [1:06:52<1:43:58, 12.09s/it] 39%|███▉      | 332/847 [1:07:04<1:41:55, 11.88s/it] 39%|███▉      | 333/847 [1:07:15<1:39:22, 11.60s/it] 39%|███▉      | 334/847 [1:07:27<1:42:11, 11.95s/it] 40%|███▉      | 335/847 [1:07:36<1:33:16, 10.93s/it] 40%|███▉      | 336/847 [1:07:45<1:29:11, 10.47s/it] 40%|███▉      | 337/847 [1:07:57<1:33:16, 10.97s/it] 40%|███▉      | 338/847 [1:08:06<1:27:49, 10.35s/it] 40%|████      | 339/847 [1:08:15<1:24:39, 10.00s/it] 40%|████      | 340/847 [1:08:27<1:28:06, 10.43s/it]                                                      40%|████      | 340/847 [1:08:27<1:28:06, 10.43s/it] 40%|████      | 341/847 [1:08:37<1:26:34, 10.27s/it] 40%|████      | 342/847 [1:08:48<1:27:56, 10.45s/it] 40%|████      | 343/847 [1:08:56<1:23:37,  9.96s/it] 41%|████      | 344/847 [1:09:08<1:27:13, 10.41s/it] 41%|████      | 345/847 [1:09:20<1:30:40, 10.84s/it] 41%|████      | 346/847 [1:09:33<1:35:45, 11.47s/it] 41%|████      | 347/847 [1:09:42<1:30:32, 10.86s/it] 41%|████      | 348/847 [1:09:52<1:28:49, 10.68s/it] 41%|████      | 349/847 [1:10:00<1:22:09,  9.90s/it] 41%|████▏     | 350/847 [1:10:14<1:29:52, 10.85s/it]                                                      41%|████▏     | 350/847 [1:10:14<1:29:52, 10.85s/it] 41%|████▏     | 351/847 [1:10:24<1:29:15, 10.80s/it] 42%|████▏     | 352/847 [1:10:38<1:35:54, 11.62s/it] 42%|████▏     | 353/847 [1:10:47<1:29:33, 10.88s/it] 42%|████▏     | 354/847 [1:10:56<1:25:38, 10.42s/it] 42%|████▏     | 355/847 [1:11:10<1:34:16, 11.50s/it] 42%|████▏     | 356/847 [1:11:23<1:36:21, 11.77s/it] 42%|████▏     | 357/847 [1:11:32<1:30:48, 11.12s/it] 42%|████▏     | 358/847 [1:11:45<1:35:14, 11.69s/it] 42%|████▏     | 359/847 [1:11:58<1:37:26, 11.98s/it] 43%|████▎     | 360/847 [1:12:06<1:28:48, 10.94s/it]                                                      43%|████▎     | 360/847 [1:12:06<1:28:48, 10.94s/it] 43%|████▎     | 361/847 [1:12:24<1:44:02, 12.84s/it] 43%|████▎     | 362/847 [1:12:38<1:47:26, 13.29s/it] 43%|████▎     | 363/847 [1:12:50<1:42:58, 12.77s/it]{'eval_loss': 1.0672343969345093, 'eval_runtime': 50.0003, 'eval_samples_per_second': 4.86, 'eval_steps_per_second': 1.22, 'epoch': 2.0}
{'loss': 1.0166, 'grad_norm': 0.23018914461135864, 'learning_rate': 7.606512247278587e-05, 'epoch': 2.06}
{'loss': 0.9433, 'grad_norm': 0.21816305816173553, 'learning_rate': 7.47695841724e-05, 'epoch': 2.14}
{'loss': 0.9563, 'grad_norm': 0.27408576011657715, 'learning_rate': 7.342859887852093e-05, 'epoch': 2.23}
{'loss': 0.9734, 'grad_norm': 0.27525368332862854, 'learning_rate': 7.204421377291556e-05, 'epoch': 2.31}
{'loss': 0.9867, 'grad_norm': 0.26698604226112366, 'learning_rate': 7.061854229259135e-05, 'epoch': 2.39}
{'loss': 0.9937, 'grad_norm': 0.2767586410045624, 'learning_rate': 6.915376090337039e-05, 'epoch': 2.47}
{'loss': 0.9925, 'grad_norm': 0.3246718645095825, 'learning_rate': 6.765210577724219e-05, 'epoch': 2.56}
{'loss': 0.9507, 'grad_norm': 0.31208691000938416, 'learning_rate': 6.611586937856736e-05, 'epoch': 2.64}
{'loss': 0.9823, 'grad_norm': 0.29548701643943787, 'learning_rate': 6.454739696434414e-05, 'epoch': 2.72}
{'loss': 0.939, 'grad_norm': 0.2858433127403259, 'learning_rate': 6.294908300388023e-05, 'epoch': 2.8}
{'loss': 0.9934, 'grad_norm': 0.29510945081710815, 'learning_rate': 6.132336752333588e-05, 'epoch': 2.89}
{'loss': 0.997, 'grad_norm': 0.2904970347881317, 'learning_rate': 5.967273238071886e-05, 'epoch': 2.97}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.26it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.29it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.29it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:41<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                     
                                               [A 43%|████▎     | 363/847 [1:13:46<1:42:58, 12.77s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 43%|████▎     | 364/847 [1:13:51<3:40:56, 27.45s/it] 43%|████▎     | 365/847 [1:14:03<3:02:14, 22.69s/it] 43%|████▎     | 366/847 [1:14:14<2:34:22, 19.26s/it] 43%|████▎     | 367/847 [1:14:25<2:14:05, 16.76s/it] 43%|████▎     | 368/847 [1:14:37<2:03:14, 15.44s/it] 44%|████▎     | 369/847 [1:14:52<2:01:26, 15.24s/it] 44%|████▎     | 370/847 [1:15:03<1:51:37, 14.04s/it]                                                      44%|████▎     | 370/847 [1:15:03<1:51:37, 14.04s/it] 44%|████▍     | 371/847 [1:15:15<1:44:49, 13.21s/it] 44%|████▍     | 372/847 [1:15:26<1:39:29, 12.57s/it] 44%|████▍     | 373/847 [1:15:43<1:49:07, 13.81s/it] 44%|████▍     | 374/847 [1:15:55<1:45:05, 13.33s/it] 44%|████▍     | 375/847 [1:16:05<1:38:05, 12.47s/it] 44%|████▍     | 376/847 [1:16:21<1:44:37, 13.33s/it] 45%|████▍     | 377/847 [1:16:34<1:45:38, 13.49s/it] 45%|████▍     | 378/847 [1:16:45<1:38:44, 12.63s/it] 45%|████▍     | 379/847 [1:16:57<1:35:52, 12.29s/it] 45%|████▍     | 380/847 [1:17:05<1:26:47, 11.15s/it]                                                      45%|████▍     | 380/847 [1:17:05<1:26:47, 11.15s/it] 45%|████▍     | 381/847 [1:17:21<1:37:08, 12.51s/it] 45%|████▌     | 382/847 [1:17:34<1:38:16, 12.68s/it] 45%|████▌     | 383/847 [1:17:44<1:32:14, 11.93s/it] 45%|████▌     | 384/847 [1:17:54<1:27:50, 11.38s/it] 45%|████▌     | 385/847 [1:18:03<1:23:08, 10.80s/it] 46%|████▌     | 386/847 [1:18:15<1:25:15, 11.10s/it] 46%|████▌     | 387/847 [1:18:29<1:31:25, 11.92s/it] 46%|████▌     | 388/847 [1:18:39<1:26:49, 11.35s/it] 46%|████▌     | 389/847 [1:18:49<1:22:31, 10.81s/it] 46%|████▌     | 390/847 [1:19:04<1:32:45, 12.18s/it]                                                      46%|████▌     | 390/847 [1:19:04<1:32:45, 12.18s/it] 46%|████▌     | 391/847 [1:19:13<1:25:18, 11.22s/it] 46%|████▋     | 392/847 [1:19:23<1:22:56, 10.94s/it] 46%|████▋     | 393/847 [1:19:42<1:39:49, 13.19s/it] 47%|████▋     | 394/847 [1:19:50<1:28:16, 11.69s/it] 47%|████▋     | 395/847 [1:20:01<1:26:27, 11.48s/it] 47%|████▋     | 396/847 [1:20:15<1:31:45, 12.21s/it] 47%|████▋     | 397/847 [1:20:28<1:33:07, 12.42s/it] 47%|████▋     | 398/847 [1:20:37<1:24:41, 11.32s/it] 47%|████▋     | 399/847 [1:20:50<1:28:51, 11.90s/it] 47%|████▋     | 400/847 [1:21:01<1:27:11, 11.70s/it]                                                      47%|████▋     | 400/847 [1:21:01<1:27:11, 11.70s/it] 47%|████▋     | 401/847 [1:21:12<1:24:23, 11.35s/it] 47%|████▋     | 402/847 [1:21:22<1:23:05, 11.20s/it] 48%|████▊     | 403/847 [1:21:35<1:25:06, 11.50s/it] 48%|████▊     | 404/847 [1:21:45<1:22:50, 11.22s/it] 48%|████▊     | 405/847 [1:21:57<1:24:49, 11.52s/it] 48%|████▊     | 406/847 [1:22:06<1:18:57, 10.74s/it] 48%|████▊     | 407/847 [1:22:15<1:14:31, 10.16s/it] 48%|████▊     | 408/847 [1:22:30<1:23:34, 11.42s/it] 48%|████▊     | 409/847 [1:22:40<1:22:05, 11.24s/it] 48%|████▊     | 410/847 [1:22:52<1:23:47, 11.50s/it]                                                      48%|████▊     | 410/847 [1:22:52<1:23:47, 11.50s/it] 49%|████▊     | 411/847 [1:23:04<1:22:47, 11.39s/it] 49%|████▊     | 412/847 [1:23:14<1:20:21, 11.08s/it] 49%|████▉     | 413/847 [1:23:22<1:14:08, 10.25s/it] 49%|████▉     | 414/847 [1:23:33<1:15:28, 10.46s/it] 49%|████▉     | 415/847 [1:23:46<1:20:16, 11.15s/it] 49%|████▉     | 416/847 [1:23:56<1:17:49, 10.83s/it] 49%|████▉     | 417/847 [1:24:10<1:24:11, 11.75s/it] 49%|████▉     | 418/847 [1:24:20<1:20:40, 11.28s/it] 49%|████▉     | 419/847 [1:24:33<1:24:24, 11.83s/it] 50%|████▉     | 420/847 [1:24:44<1:22:03, 11.53s/it]                                                      50%|████▉     | 420/847 [1:24:44<1:22:03, 11.53s/it] 50%|████▉     | 421/847 [1:24:56<1:22:03, 11.56s/it] 50%|████▉     | 422/847 [1:25:06<1:19:45, 11.26s/it] 50%|████▉     | 423/847 [1:25:18<1:21:12, 11.49s/it] 50%|█████     | 424/847 [1:25:28<1:16:19, 10.83s/it] 50%|█████     | 425/847 [1:25:37<1:13:35, 10.46s/it] 50%|█████     | 426/847 [1:25:50<1:19:07, 11.28s/it] 50%|█████     | 427/847 [1:26:04<1:23:23, 11.91s/it] 51%|█████     | 428/847 [1:26:14<1:19:03, 11.32s/it] 51%|█████     | 429/847 [1:26:21<1:10:01, 10.05s/it] 51%|█████     | 430/847 [1:26:30<1:08:27,  9.85s/it]                                                      51%|█████     | 430/847 [1:26:30<1:08:27,  9.85s/it] 51%|█████     | 431/847 [1:26:44<1:17:19, 11.15s/it] 51%|█████     | 432/847 [1:27:04<1:33:47, 13.56s/it] 51%|█████     | 433/847 [1:27:14<1:26:08, 12.48s/it] 51%|█████     | 434/847 [1:27:25<1:24:28, 12.27s/it] 51%|█████▏    | 435/847 [1:27:39<1:27:17, 12.71s/it] 51%|█████▏    | 436/847 [1:27:51<1:26:26, 12.62s/it] 52%|█████▏    | 437/847 [1:28:03<1:23:45, 12.26s/it] 52%|█████▏    | 438/847 [1:28:14<1:21:53, 12.01s/it] 52%|█████▏    | 439/847 [1:28:27<1:24:00, 12.36s/it] 52%|█████▏    | 440/847 [1:28:42<1:28:48, 13.09s/it]                                                      52%|█████▏    | 440/847 [1:28:42<1:28:48, 13.09s/it] 52%|█████▏    | 441/847 [1:28:52<1:22:33, 12.20s/it] 52%|█████▏    | 442/847 [1:29:07<1:27:18, 12.93s/it] 52%|█████▏    | 443/847 [1:29:21<1:28:47, 13.19s/it] 52%|█████▏    | 444/847 [1:29:33<1:26:08, 12.83s/it] 53%|█████▎    | 445/847 [1:29:48<1:31:36, 13.67s/it] 53%|█████▎    | 446/847 [1:29:59<1:25:17, 12.76s/it] 53%|█████▎    | 447/847 [1:30:09<1:19:30, 11.93s/it] 53%|█████▎    | 448/847 [1:30:20<1:18:06, 11.75s/it] 53%|█████▎    | 449/847 [1:30:31<1:14:49, 11.28s/it] 53%|█████▎    | 450/847 [1:30:41<1:12:51, 11.01s/it]                                                      53%|█████▎    | 450/847 [1:30:41<1:12:51, 11.01s/it] 53%|█████▎    | 451/847 [1:30:50<1:09:40, 10.56s/it] 53%|█████▎    | 452/847 [1:31:02<1:11:29, 10.86s/it] 53%|█████▎    | 453/847 [1:31:12<1:10:18, 10.71s/it] 54%|█████▎    | 454/847 [1:31:25<1:13:18, 11.19s/it] 54%|█████▎    | 455/847 [1:31:37<1:15:51, 11.61s/it] 54%|█████▍    | 456/847 [1:31:51<1:19:07, 12.14s/it] 54%|█████▍    | 457/847 [1:32:01<1:15:31, 11.62s/it] 54%|█████▍    | 458/847 [1:32:11<1:13:02, 11.27s/it] 54%|█████▍    | 459/847 [1:32:23<1:13:25, 11.35s/it] 54%|█████▍    | 460/847 [1:32:35<1:13:59, 11.47s/it]                                                      54%|█████▍    | 460/847 [1:32:35<1:13:59, 11.47s/it] 54%|█████▍    | 461/847 [1:32:48<1:17:15, 12.01s/it] 55%|█████▍    | 462/847 [1:33:00<1:17:32, 12.08s/it] 55%|█████▍    | 463/847 [1:33:12<1:16:26, 11.95s/it] 55%|█████▍    | 464/847 [1:33:23<1:15:00, 11.75s/it] 55%|█████▍    | 465/847 [1:33:37<1:18:20, 12.30s/it] 55%|█████▌    | 466/847 [1:33:49<1:17:38, 12.23s/it] 55%|█████▌    | 467/847 [1:34:00<1:14:57, 11.84s/it] 55%|█████▌    | 468/847 [1:34:13<1:17:51, 12.33s/it] 55%|█████▌    | 469/847 [1:34:25<1:17:24, 12.29s/it] 55%|█████▌    | 470/847 [1:34:37<1:14:56, 11.93s/it]                                                      55%|█████▌    | 470/847 [1:34:37<1:14:56, 11.93s/it] 56%|█████▌    | 471/847 [1:34:49<1:15:50, 12.10s/it] 56%|█████▌    | 472/847 [1:35:02<1:18:08, 12.50s/it] 56%|█████▌    | 473/847 [1:35:12<1:11:35, 11.48s/it] 56%|█████▌    | 474/847 [1:35:24<1:12:19, 11.63s/it] 56%|█████▌    | 475/847 [1:35:32<1:06:36, 10.74s/it] 56%|█████▌    | 476/847 [1:35:44<1:08:10, 11.03s/it] 56%|█████▋    | 477/847 [1:35:54<1:06:47, 10.83s/it] 56%|█████▋    | 478/847 [1:36:07<1:10:48, 11.51s/it] 57%|█████▋    | 479/847 [1:36:18<1:08:03, 11.10s/it] 57%|█████▋    | 480/847 [1:36:27<1:04:35, 10.56s/it]                                                      57%|█████▋    | 480/847 [1:36:27<1:04:35, 10.56s/it] 57%|█████▋    | 481/847 [1:36:42<1:13:14, 12.01s/it] 57%|█████▋    | 482/847 [1:36:52<1:08:22, 11.24s/it] 57%|█████▋    | 483/847 [1:37:02<1:06:50, 11.02s/it] 57%|█████▋    | 484/847 [1:37:16<1:11:51, 11.88s/it] 57%|█████▋    | 485/847 [1:37:28<1:11:00, 11.77s/it]{'eval_loss': 1.078343391418457, 'eval_runtime': 50.002, 'eval_samples_per_second': 4.86, 'eval_steps_per_second': 1.22, 'epoch': 2.99}
{'loss': 0.9498, 'grad_norm': 0.33432111144065857, 'learning_rate': 5.799969747701778e-05, 'epoch': 3.05}
{'loss': 0.8776, 'grad_norm': 0.3604939579963684, 'learning_rate': 5.630681690925804e-05, 'epoch': 3.13}
{'loss': 0.8995, 'grad_norm': 0.3624360263347626, 'learning_rate': 5.4596675071353314e-05, 'epoch': 3.22}
{'loss': 0.8557, 'grad_norm': 0.3554617166519165, 'learning_rate': 5.2871882708705e-05, 'epoch': 3.3}
{'loss': 0.9279, 'grad_norm': 0.4157909154891968, 'learning_rate': 5.113507293257286e-05, 'epoch': 3.38}
{'loss': 0.9237, 'grad_norm': 0.3666176497936249, 'learning_rate': 4.9388897200301306e-05, 'epoch': 3.46}
{'loss': 0.8742, 'grad_norm': 0.36338576674461365, 'learning_rate': 4.763602126753824e-05, 'epoch': 3.55}
{'loss': 0.9128, 'grad_norm': 0.40650779008865356, 'learning_rate': 4.5879121118625565e-05, 'epoch': 3.63}
{'loss': 0.9191, 'grad_norm': 0.36742275953292847, 'learning_rate': 4.412087888137445e-05, 'epoch': 3.71}
{'loss': 0.9047, 'grad_norm': 0.3590952455997467, 'learning_rate': 4.236397873246176e-05, 'epoch': 3.79}
{'loss': 0.8631, 'grad_norm': 0.3730195164680481, 'learning_rate': 4.06111027996987e-05, 'epoch': 3.88}
{'loss': 0.9212, 'grad_norm': 0.4117502272129059, 'learning_rate': 3.8864927067427145e-05, 'epoch': 3.96}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:45<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                     
                                               [A 57%|█████▋    | 485/847 [1:38:18<1:11:00, 11.77s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 57%|█████▋    | 486/847 [1:38:29<2:39:49, 26.56s/it] 57%|█████▋    | 487/847 [1:38:40<2:12:43, 22.12s/it] 58%|█████▊    | 488/847 [1:38:50<1:49:50, 18.36s/it] 58%|█████▊    | 489/847 [1:39:04<1:41:01, 16.93s/it] 58%|█████▊    | 490/847 [1:39:14<1:28:51, 14.93s/it]                                                      58%|█████▊    | 490/847 [1:39:14<1:28:51, 14.93s/it] 58%|█████▊    | 491/847 [1:39:24<1:20:36, 13.58s/it] 58%|█████▊    | 492/847 [1:39:35<1:16:00, 12.85s/it] 58%|█████▊    | 493/847 [1:39:48<1:14:37, 12.65s/it] 58%|█████▊    | 494/847 [1:39:58<1:10:02, 11.90s/it] 58%|█████▊    | 495/847 [1:40:10<1:09:48, 11.90s/it] 59%|█████▊    | 496/847 [1:40:22<1:09:45, 11.93s/it] 59%|█████▊    | 497/847 [1:40:31<1:04:14, 11.01s/it] 59%|█████▉    | 498/847 [1:40:45<1:09:23, 11.93s/it] 59%|█████▉    | 499/847 [1:40:56<1:08:37, 11.83s/it] 59%|█████▉    | 500/847 [1:41:05<1:03:24, 10.97s/it]                                                      59%|█████▉    | 500/847 [1:41:05<1:03:24, 10.97s/it] 59%|█████▉    | 501/847 [1:41:17<1:04:23, 11.17s/it] 59%|█████▉    | 502/847 [1:41:28<1:05:04, 11.32s/it] 59%|█████▉    | 503/847 [1:41:40<1:05:56, 11.50s/it] 60%|█████▉    | 504/847 [1:41:54<1:08:43, 12.02s/it] 60%|█████▉    | 505/847 [1:42:06<1:09:07, 12.13s/it] 60%|█████▉    | 506/847 [1:42:15<1:04:09, 11.29s/it] 60%|█████▉    | 507/847 [1:42:24<59:30, 10.50s/it]   60%|█████▉    | 508/847 [1:42:38<1:05:41, 11.63s/it] 60%|██████    | 509/847 [1:42:52<1:08:16, 12.12s/it] 60%|██████    | 510/847 [1:43:03<1:07:32, 12.02s/it]                                                      60%|██████    | 510/847 [1:43:03<1:07:32, 12.02s/it] 60%|██████    | 511/847 [1:43:13<1:02:39, 11.19s/it] 60%|██████    | 512/847 [1:43:21<58:25, 10.47s/it]   61%|██████    | 513/847 [1:43:39<1:10:17, 12.63s/it] 61%|██████    | 514/847 [1:43:51<1:09:36, 12.54s/it] 61%|██████    | 515/847 [1:44:03<1:08:38, 12.41s/it] 61%|██████    | 516/847 [1:44:14<1:04:37, 11.72s/it] 61%|██████    | 517/847 [1:44:23<59:56, 10.90s/it]   61%|██████    | 518/847 [1:44:32<57:27, 10.48s/it] 61%|██████▏   | 519/847 [1:44:47<1:05:22, 11.96s/it] 61%|██████▏   | 520/847 [1:45:03<1:11:08, 13.05s/it]                                                      61%|██████▏   | 520/847 [1:45:03<1:11:08, 13.05s/it] 62%|██████▏   | 521/847 [1:45:15<1:08:30, 12.61s/it] 62%|██████▏   | 522/847 [1:45:25<1:05:07, 12.02s/it] 62%|██████▏   | 523/847 [1:45:38<1:06:11, 12.26s/it] 62%|██████▏   | 524/847 [1:45:45<58:08, 10.80s/it]   62%|██████▏   | 525/847 [1:45:59<1:01:33, 11.47s/it] 62%|██████▏   | 526/847 [1:46:09<59:38, 11.15s/it]   62%|██████▏   | 527/847 [1:46:20<59:41, 11.19s/it] 62%|██████▏   | 528/847 [1:46:28<53:27, 10.06s/it] 62%|██████▏   | 529/847 [1:46:41<58:07, 10.97s/it] 63%|██████▎   | 530/847 [1:46:53<1:00:32, 11.46s/it]                                                      63%|██████▎   | 530/847 [1:46:53<1:00:32, 11.46s/it] 63%|██████▎   | 531/847 [1:47:02<56:00, 10.64s/it]   63%|██████▎   | 532/847 [1:47:15<59:45, 11.38s/it] 63%|██████▎   | 533/847 [1:47:26<58:33, 11.19s/it] 63%|██████▎   | 534/847 [1:47:36<57:02, 10.93s/it] 63%|██████▎   | 535/847 [1:47:48<58:00, 11.15s/it] 63%|██████▎   | 536/847 [1:47:57<54:12, 10.46s/it] 63%|██████▎   | 537/847 [1:48:05<50:56,  9.86s/it] 64%|██████▎   | 538/847 [1:48:21<1:00:04, 11.66s/it] 64%|██████▎   | 539/847 [1:48:32<59:10, 11.53s/it]   64%|██████▍   | 540/847 [1:48:42<55:42, 10.89s/it]                                                    64%|██████▍   | 540/847 [1:48:42<55:42, 10.89s/it] 64%|██████▍   | 541/847 [1:48:51<52:27, 10.29s/it] 64%|██████▍   | 542/847 [1:49:03<55:11, 10.86s/it] 64%|██████▍   | 543/847 [1:49:17<59:40, 11.78s/it] 64%|██████▍   | 544/847 [1:49:29<59:37, 11.81s/it] 64%|██████▍   | 545/847 [1:49:39<57:32, 11.43s/it] 64%|██████▍   | 546/847 [1:49:52<59:05, 11.78s/it] 65%|██████▍   | 547/847 [1:50:01<54:50, 10.97s/it] 65%|██████▍   | 548/847 [1:50:12<54:52, 11.01s/it] 65%|██████▍   | 549/847 [1:50:25<58:07, 11.70s/it] 65%|██████▍   | 550/847 [1:50:37<57:28, 11.61s/it]                                                    65%|██████▍   | 550/847 [1:50:37<57:28, 11.61s/it] 65%|██████▌   | 551/847 [1:50:48<57:20, 11.62s/it] 65%|██████▌   | 552/847 [1:50:56<51:52, 10.55s/it] 65%|██████▌   | 553/847 [1:51:09<55:01, 11.23s/it] 65%|██████▌   | 554/847 [1:51:29<1:07:36, 13.84s/it] 66%|██████▌   | 555/847 [1:51:39<1:01:13, 12.58s/it] 66%|██████▌   | 556/847 [1:51:48<56:44, 11.70s/it]   66%|██████▌   | 557/847 [1:51:59<55:40, 11.52s/it] 66%|██████▌   | 558/847 [1:52:14<59:29, 12.35s/it] 66%|██████▌   | 559/847 [1:52:28<1:01:23, 12.79s/it] 66%|██████▌   | 560/847 [1:52:38<57:35, 12.04s/it]                                                      66%|██████▌   | 560/847 [1:52:38<57:35, 12.04s/it] 66%|██████▌   | 561/847 [1:52:47<53:14, 11.17s/it] 66%|██████▋   | 562/847 [1:52:59<53:57, 11.36s/it] 66%|██████▋   | 563/847 [1:53:10<52:59, 11.20s/it] 67%|██████▋   | 564/847 [1:53:23<56:26, 11.97s/it] 67%|██████▋   | 565/847 [1:53:36<57:01, 12.13s/it] 67%|██████▋   | 566/847 [1:53:49<58:46, 12.55s/it] 67%|██████▋   | 567/847 [1:54:03<59:54, 12.84s/it] 67%|██████▋   | 568/847 [1:54:13<56:06, 12.07s/it] 67%|██████▋   | 569/847 [1:54:27<58:31, 12.63s/it] 67%|██████▋   | 570/847 [1:54:36<53:19, 11.55s/it]                                                    67%|██████▋   | 570/847 [1:54:36<53:19, 11.55s/it] 67%|██████▋   | 571/847 [1:54:49<54:24, 11.83s/it] 68%|██████▊   | 572/847 [1:54:58<51:18, 11.19s/it] 68%|██████▊   | 573/847 [1:55:10<51:37, 11.31s/it] 68%|██████▊   | 574/847 [1:55:26<58:31, 12.86s/it] 68%|██████▊   | 575/847 [1:55:39<58:17, 12.86s/it] 68%|██████▊   | 576/847 [1:55:53<59:09, 13.10s/it] 68%|██████▊   | 577/847 [1:56:03<54:57, 12.21s/it] 68%|██████▊   | 578/847 [1:56:13<51:19, 11.45s/it] 68%|██████▊   | 579/847 [1:56:23<49:07, 11.00s/it] 68%|██████▊   | 580/847 [1:56:35<50:25, 11.33s/it]                                                    68%|██████▊   | 580/847 [1:56:35<50:25, 11.33s/it] 69%|██████▊   | 581/847 [1:56:44<46:50, 10.57s/it] 69%|██████▊   | 582/847 [1:56:57<50:14, 11.37s/it] 69%|██████▉   | 583/847 [1:57:08<49:22, 11.22s/it] 69%|██████▉   | 584/847 [1:57:23<55:04, 12.57s/it] 69%|██████▉   | 585/847 [1:57:32<49:34, 11.35s/it] 69%|██████▉   | 586/847 [1:57:42<47:20, 10.88s/it] 69%|██████▉   | 587/847 [1:57:52<46:13, 10.67s/it] 69%|██████▉   | 588/847 [1:58:07<51:15, 11.88s/it] 70%|██████▉   | 589/847 [1:58:16<48:22, 11.25s/it] 70%|██████▉   | 590/847 [1:58:26<46:39, 10.89s/it]                                                    70%|██████▉   | 590/847 [1:58:26<46:39, 10.89s/it] 70%|██████▉   | 591/847 [1:58:41<51:42, 12.12s/it] 70%|██████▉   | 592/847 [1:58:56<54:18, 12.78s/it] 70%|███████   | 593/847 [1:59:05<49:03, 11.59s/it] 70%|███████   | 594/847 [1:59:15<47:44, 11.32s/it] 70%|███████   | 595/847 [1:59:27<48:36, 11.57s/it] 70%|███████   | 596/847 [1:59:37<46:04, 11.01s/it] 70%|███████   | 597/847 [1:59:48<46:16, 11.10s/it] 71%|███████   | 598/847 [2:00:03<49:53, 12.02s/it] 71%|███████   | 599/847 [2:00:15<49:37, 12.01s/it] 71%|███████   | 600/847 [2:00:25<47:48, 11.61s/it]                                                    71%|███████   | 600/847 [2:00:25<47:48, 11.61s/it] 71%|███████   | 601/847 [2:00:39<50:43, 12.37s/it] 71%|███████   | 602/847 [2:00:53<51:55, 12.72s/it] 71%|███████   | 603/847 [2:01:02<47:27, 11.67s/it] 71%|███████▏  | 604/847 [2:01:13<45:42, 11.28s/it] 71%|███████▏  | 605/847 [2:01:22<43:29, 10.78s/it] 72%|███████▏  | 606/847 [2:01:40<51:25, 12.80s/it]{'eval_loss': 1.1086751222610474, 'eval_runtime': 49.9599, 'eval_samples_per_second': 4.864, 'eval_steps_per_second': 1.221, 'epoch': 4.0}
{'loss': 0.867, 'grad_norm': 0.39150112867355347, 'learning_rate': 3.7128117291295004e-05, 'epoch': 4.04}
{'loss': 0.8215, 'grad_norm': 0.43174099922180176, 'learning_rate': 3.540332492864669e-05, 'epoch': 4.12}
{'loss': 0.8521, 'grad_norm': 0.39566147327423096, 'learning_rate': 3.3693183090741974e-05, 'epoch': 4.21}
{'loss': 0.8043, 'grad_norm': 0.40040019154548645, 'learning_rate': 3.200030252298223e-05, 'epoch': 4.29}
{'loss': 0.8361, 'grad_norm': 0.4092531204223633, 'learning_rate': 3.0327267619281156e-05, 'epoch': 4.37}
{'loss': 0.8559, 'grad_norm': 0.45900779962539673, 'learning_rate': 2.8676632476664135e-05, 'epoch': 4.45}
{'loss': 0.7985, 'grad_norm': 0.5053562521934509, 'learning_rate': 2.705091699611979e-05, 'epoch': 4.54}
{'loss': 0.8416, 'grad_norm': 0.45395711064338684, 'learning_rate': 2.5452603035655868e-05, 'epoch': 4.62}
{'loss': 0.8589, 'grad_norm': 0.4522627294063568, 'learning_rate': 2.3884130621432636e-05, 'epoch': 4.7}
{'loss': 0.8264, 'grad_norm': 0.4447222650051117, 'learning_rate': 2.234789422275782e-05, 'epoch': 4.78}
{'loss': 0.8557, 'grad_norm': 0.4526456594467163, 'learning_rate': 2.0846239096629617e-05, 'epoch': 4.87}
{'loss': 0.8065, 'grad_norm': 0.5323467254638672, 'learning_rate': 1.938145770740867e-05, 'epoch': 4.95}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:41<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.10it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A                                                   
                                               [A 72%|███████▏  | 606/847 [2:02:31<51:25, 12.80s/it]
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 72%|███████▏  | 607/847 [2:02:41<1:49:49, 27.45s/it] 72%|███████▏  | 608/847 [2:02:51<1:27:51, 22.06s/it] 72%|███████▏  | 609/847 [2:03:02<1:14:10, 18.70s/it] 72%|███████▏  | 610/847 [2:03:13<1:05:31, 16.59s/it]                                                      72%|███████▏  | 610/847 [2:03:13<1:05:31, 16.59s/it] 72%|███████▏  | 611/847 [2:03:24<58:18, 14.82s/it]   72%|███████▏  | 612/847 [2:03:31<49:18, 12.59s/it] 72%|███████▏  | 613/847 [2:03:44<49:05, 12.59s/it] 72%|███████▏  | 614/847 [2:03:57<49:52, 12.84s/it] 73%|███████▎  | 615/847 [2:04:08<47:31, 12.29s/it] 73%|███████▎  | 616/847 [2:04:20<46:30, 12.08s/it] 73%|███████▎  | 617/847 [2:04:33<47:07, 12.29s/it] 73%|███████▎  | 618/847 [2:04:45<46:39, 12.22s/it] 73%|███████▎  | 619/847 [2:04:59<48:13, 12.69s/it] 73%|███████▎  | 620/847 [2:05:11<47:26, 12.54s/it]                                                    73%|███████▎  | 620/847 [2:05:11<47:26, 12.54s/it] 73%|███████▎  | 621/847 [2:05:24<48:26, 12.86s/it] 73%|███████▎  | 622/847 [2:05:35<46:14, 12.33s/it] 74%|███████▎  | 623/847 [2:05:52<50:41, 13.58s/it] 74%|███████▎  | 624/847 [2:06:07<52:23, 14.10s/it] 74%|███████▍  | 625/847 [2:06:19<49:21, 13.34s/it] 74%|███████▍  | 626/847 [2:06:33<49:45, 13.51s/it] 74%|███████▍  | 627/847 [2:06:43<46:01, 12.55s/it] 74%|███████▍  | 628/847 [2:06:58<48:34, 13.31s/it] 74%|███████▍  | 629/847 [2:07:12<48:40, 13.40s/it] 74%|███████▍  | 630/847 [2:07:25<48:29, 13.41s/it]                                                    74%|███████▍  | 630/847 [2:07:25<48:29, 13.41s/it] 74%|███████▍  | 631/847 [2:07:37<46:22, 12.88s/it] 75%|███████▍  | 632/847 [2:07:48<44:33, 12.43s/it] 75%|███████▍  | 633/847 [2:07:57<40:52, 11.46s/it] 75%|███████▍  | 634/847 [2:08:10<42:10, 11.88s/it] 75%|███████▍  | 635/847 [2:08:21<41:13, 11.67s/it] 75%|███████▌  | 636/847 [2:08:34<42:00, 11.95s/it] 75%|███████▌  | 637/847 [2:08:43<38:30, 11.00s/it] 75%|███████▌  | 638/847 [2:08:56<40:40, 11.68s/it] 75%|███████▌  | 639/847 [2:09:08<40:29, 11.68s/it] 76%|███████▌  | 640/847 [2:09:16<36:21, 10.54s/it]                                                    76%|███████▌  | 640/847 [2:09:16<36:21, 10.54s/it] 76%|███████▌  | 641/847 [2:09:27<36:40, 10.68s/it] 76%|███████▌  | 642/847 [2:09:39<38:34, 11.29s/it] 76%|███████▌  | 643/847 [2:09:50<37:57, 11.17s/it] 76%|███████▌  | 644/847 [2:10:03<38:53, 11.50s/it] 76%|███████▌  | 645/847 [2:10:14<38:23, 11.40s/it] 76%|███████▋  | 646/847 [2:10:26<39:21, 11.75s/it] 76%|███████▋  | 647/847 [2:10:40<41:05, 12.33s/it] 77%|███████▋  | 648/847 [2:10:50<38:17, 11.55s/it] 77%|███████▋  | 649/847 [2:10:59<36:14, 10.98s/it] 77%|███████▋  | 650/847 [2:11:10<36:12, 11.03s/it]                                                    77%|███████▋  | 650/847 [2:11:10<36:12, 11.03s/it] 77%|███████▋  | 651/847 [2:11:24<38:54, 11.91s/it] 77%|███████▋  | 652/847 [2:11:35<37:37, 11.58s/it] 77%|███████▋  | 653/847 [2:11:44<35:09, 10.87s/it] 77%|███████▋  | 654/847 [2:11:53<32:59, 10.26s/it] 77%|███████▋  | 655/847 [2:12:07<35:57, 11.24s/it] 77%|███████▋  | 656/847 [2:12:15<33:03, 10.39s/it] 78%|███████▊  | 657/847 [2:12:27<34:06, 10.77s/it] 78%|███████▊  | 658/847 [2:12:39<35:11, 11.17s/it] 78%|███████▊  | 659/847 [2:12:51<35:23, 11.29s/it] 78%|███████▊  | 660/847 [2:13:02<35:29, 11.39s/it]                                                    78%|███████▊  | 660/847 [2:13:02<35:29, 11.39s/it] 78%|███████▊  | 661/847 [2:13:12<34:04, 10.99s/it] 78%|███████▊  | 662/847 [2:13:25<35:36, 11.55s/it] 78%|███████▊  | 663/847 [2:13:35<34:08, 11.13s/it] 78%|███████▊  | 664/847 [2:13:50<37:28, 12.29s/it] 79%|███████▊  | 665/847 [2:14:04<38:54, 12.83s/it] 79%|███████▊  | 666/847 [2:14:15<36:46, 12.19s/it] 79%|███████▊  | 667/847 [2:14:26<35:15, 11.75s/it] 79%|███████▉  | 668/847 [2:14:39<36:30, 12.24s/it] 79%|███████▉  | 669/847 [2:14:49<34:04, 11.48s/it] 79%|███████▉  | 670/847 [2:14:58<31:25, 10.65s/it]                                                    79%|███████▉  | 670/847 [2:14:58<31:25, 10.65s/it] 79%|███████▉  | 671/847 [2:15:09<31:40, 10.80s/it] 79%|███████▉  | 672/847 [2:15:20<31:51, 10.92s/it] 79%|███████▉  | 673/847 [2:15:29<30:22, 10.47s/it] 80%|███████▉  | 674/847 [2:15:43<32:41, 11.34s/it] 80%|███████▉  | 675/847 [2:15:54<32:36, 11.38s/it] 80%|███████▉  | 676/847 [2:16:01<28:13,  9.90s/it] 80%|███████▉  | 677/847 [2:16:13<30:11, 10.66s/it] 80%|████████  | 678/847 [2:16:22<28:22, 10.07s/it] 80%|████████  | 679/847 [2:16:33<28:55, 10.33s/it] 80%|████████  | 680/847 [2:16:44<29:24, 10.57s/it]                                                    80%|████████  | 680/847 [2:16:44<29:24, 10.57s/it] 80%|████████  | 681/847 [2:16:56<30:40, 11.08s/it] 81%|████████  | 682/847 [2:17:08<31:26, 11.43s/it] 81%|████████  | 683/847 [2:17:19<30:45, 11.25s/it] 81%|████████  | 684/847 [2:17:32<31:40, 11.66s/it] 81%|████████  | 685/847 [2:17:41<29:26, 10.91s/it] 81%|████████  | 686/847 [2:17:53<29:58, 11.17s/it] 81%|████████  | 687/847 [2:18:09<34:02, 12.77s/it] 81%|████████  | 688/847 [2:18:20<32:00, 12.08s/it] 81%|████████▏ | 689/847 [2:18:31<31:12, 11.85s/it] 81%|████████▏ | 690/847 [2:18:42<30:30, 11.66s/it]                                                    81%|████████▏ | 690/847 [2:18:42<30:30, 11.66s/it] 82%|████████▏ | 691/847 [2:18:56<31:59, 12.30s/it] 82%|████████▏ | 692/847 [2:19:06<29:58, 11.60s/it] 82%|████████▏ | 693/847 [2:19:17<29:37, 11.54s/it] 82%|████████▏ | 694/847 [2:19:33<32:41, 12.82s/it] 82%|████████▏ | 695/847 [2:19:46<32:40, 12.90s/it] 82%|████████▏ | 696/847 [2:19:58<31:46, 12.62s/it] 82%|████████▏ | 697/847 [2:20:14<34:08, 13.66s/it] 82%|████████▏ | 698/847 [2:20:27<33:15, 13.39s/it] 83%|████████▎ | 699/847 [2:20:41<33:28, 13.57s/it] 83%|████████▎ | 700/847 [2:20:54<32:47, 13.38s/it]                                                    83%|████████▎ | 700/847 [2:20:54<32:47, 13.38s/it] 83%|████████▎ | 701/847 [2:21:02<28:53, 11.87s/it] 83%|████████▎ | 702/847 [2:21:15<29:00, 12.00s/it] 83%|████████▎ | 703/847 [2:21:24<26:47, 11.16s/it] 83%|████████▎ | 704/847 [2:21:32<24:31, 10.29s/it] 83%|████████▎ | 705/847 [2:21:46<27:03, 11.43s/it] 83%|████████▎ | 706/847 [2:21:56<25:38, 10.91s/it] 83%|████████▎ | 707/847 [2:22:11<28:36, 12.26s/it] 84%|████████▎ | 708/847 [2:22:23<27:39, 11.94s/it] 84%|████████▎ | 709/847 [2:22:35<28:08, 12.23s/it] 84%|████████▍ | 710/847 [2:22:50<29:15, 12.81s/it]                                                    84%|████████▍ | 710/847 [2:22:50<29:15, 12.81s/it] 84%|████████▍ | 711/847 [2:23:01<27:48, 12.27s/it] 84%|████████▍ | 712/847 [2:23:15<29:12, 12.98s/it] 84%|████████▍ | 713/847 [2:23:28<28:58, 12.98s/it] 84%|████████▍ | 714/847 [2:23:41<28:41, 12.94s/it] 84%|████████▍ | 715/847 [2:23:53<27:45, 12.62s/it] 85%|████████▍ | 716/847 [2:24:03<25:36, 11.73s/it] 85%|████████▍ | 717/847 [2:24:12<23:53, 11.02s/it] 85%|████████▍ | 718/847 [2:24:24<24:22, 11.34s/it] 85%|████████▍ | 719/847 [2:24:34<23:34, 11.05s/it] 85%|████████▌ | 720/847 [2:24:49<25:45, 12.17s/it]                                                    85%|████████▌ | 720/847 [2:24:49<25:45, 12.17s/it] 85%|████████▌ | 721/847 [2:25:01<25:00, 11.91s/it] 85%|████████▌ | 722/847 [2:25:11<24:09, 11.60s/it] 85%|████████▌ | 723/847 [2:25:23<24:06, 11.66s/it] 85%|████████▌ | 724/847 [2:25:35<23:42, 11.56s/it] 86%|████████▌ | 725/847 [2:25:45<22:40, 11.15s/it] 86%|████████▌ | 726/847 [2:26:00<25:08, 12.47s/it] 86%|████████▌ | 727/847 [2:26:09<22:45, 11.38s/it]{'eval_loss': 1.151015281677246, 'eval_runtime': 50.0022, 'eval_samples_per_second': 4.86, 'eval_steps_per_second': 1.22, 'epoch': 5.0}
{'loss': 0.819, 'grad_norm': 0.40319308638572693, 'learning_rate': 1.7955786227084444e-05, 'epoch': 5.03}
{'loss': 0.8084, 'grad_norm': 0.5138112306594849, 'learning_rate': 1.657140112147908e-05, 'epoch': 5.11}
{'loss': 0.8263, 'grad_norm': 0.5185319185256958, 'learning_rate': 1.523041582760002e-05, 'epoch': 5.2}
{'loss': 0.7876, 'grad_norm': 0.5384809970855713, 'learning_rate': 1.3934877527214141e-05, 'epoch': 5.28}
{'loss': 0.767, 'grad_norm': 0.4521509110927582, 'learning_rate': 1.2686764021568742e-05, 'epoch': 5.36}
{'loss': 0.7924, 'grad_norm': 0.49134519696235657, 'learning_rate': 1.1487980712030594e-05, 'epoch': 5.44}
{'loss': 0.7675, 'grad_norm': 0.5332245230674744, 'learning_rate': 1.0340357691252401e-05, 'epoch': 5.53}
{'loss': 0.7634, 'grad_norm': 0.45332959294319153, 'learning_rate': 9.245646949307511e-06, 'epoch': 5.61}
{'loss': 0.7686, 'grad_norm': 0.5148327946662903, 'learning_rate': 8.205519699057968e-06, 'epoch': 5.69}
{'loss': 0.7988, 'grad_norm': 0.4704629182815552, 'learning_rate': 7.221563824839012e-06, 'epoch': 5.77}
{'loss': 0.7616, 'grad_norm': 0.4887169301509857, 'learning_rate': 6.295281458355075e-06, 'epoch': 5.86}
{'loss': 0.7745, 'grad_norm': 0.46761903166770935, 'learning_rate': 5.428086685487857e-06, 'epoch': 5.94}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:37,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:36,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.44it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.54it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:41<00:07,  1.40it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A 86%|████████▌ | 727/847 [2:27:03<22:45, 11.38s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 86%|████████▌ | 728/847 [2:27:11<52:31, 26.48s/it] 86%|████████▌ | 729/847 [2:27:23<43:40, 22.20s/it] 86%|████████▌ | 730/847 [2:27:33<36:04, 18.50s/it]                                                    86%|████████▌ | 730/847 [2:27:33<36:04, 18.50s/it] 86%|████████▋ | 731/847 [2:27:45<32:14, 16.68s/it] 86%|████████▋ | 732/847 [2:27:58<29:44, 15.52s/it] 87%|████████▋ | 733/847 [2:28:11<28:12, 14.84s/it] 87%|████████▋ | 734/847 [2:28:27<28:15, 15.00s/it] 87%|████████▋ | 735/847 [2:28:38<25:59, 13.93s/it] 87%|████████▋ | 736/847 [2:28:49<24:08, 13.05s/it] 87%|████████▋ | 737/847 [2:29:01<23:28, 12.81s/it] 87%|████████▋ | 738/847 [2:29:15<23:26, 12.90s/it] 87%|████████▋ | 739/847 [2:29:27<22:44, 12.63s/it] 87%|████████▋ | 740/847 [2:29:37<21:10, 11.87s/it]                                                    87%|████████▋ | 740/847 [2:29:37<21:10, 11.87s/it] 87%|████████▋ | 741/847 [2:29:49<21:26, 12.14s/it] 88%|████████▊ | 742/847 [2:30:00<20:28, 11.70s/it] 88%|████████▊ | 743/847 [2:30:11<19:40, 11.35s/it] 88%|████████▊ | 744/847 [2:30:20<18:15, 10.64s/it] 88%|████████▊ | 745/847 [2:30:28<17:10, 10.10s/it] 88%|████████▊ | 746/847 [2:30:37<16:25,  9.76s/it] 88%|████████▊ | 747/847 [2:30:48<16:36,  9.96s/it] 88%|████████▊ | 748/847 [2:30:58<16:31, 10.02s/it] 88%|████████▊ | 749/847 [2:31:07<15:46,  9.65s/it] 89%|████████▊ | 750/847 [2:31:20<17:06, 10.58s/it]                                                    89%|████████▊ | 750/847 [2:31:20<17:06, 10.58s/it] 89%|████████▊ | 751/847 [2:31:27<15:34,  9.74s/it] 89%|████████▉ | 752/847 [2:31:39<16:26, 10.39s/it] 89%|████████▉ | 753/847 [2:31:50<16:39, 10.63s/it] 89%|████████▉ | 754/847 [2:32:03<17:21, 11.20s/it] 89%|████████▉ | 755/847 [2:32:15<17:46, 11.59s/it] 89%|████████▉ | 756/847 [2:32:31<19:25, 12.81s/it] 89%|████████▉ | 757/847 [2:32:45<19:40, 13.11s/it] 89%|████████▉ | 758/847 [2:32:57<18:50, 12.70s/it] 90%|████████▉ | 759/847 [2:33:11<19:30, 13.30s/it] 90%|████████▉ | 760/847 [2:33:21<17:49, 12.29s/it]                                                    90%|████████▉ | 760/847 [2:33:21<17:49, 12.29s/it] 90%|████████▉ | 761/847 [2:33:34<17:59, 12.56s/it] 90%|████████▉ | 762/847 [2:33:48<18:21, 12.96s/it] 90%|█████████ | 763/847 [2:34:01<17:51, 12.76s/it] 90%|█████████ | 764/847 [2:34:13<17:29, 12.64s/it] 90%|█████████ | 765/847 [2:34:25<16:50, 12.32s/it] 90%|█████████ | 766/847 [2:34:33<15:13, 11.27s/it] 91%|█████████ | 767/847 [2:34:45<15:11, 11.40s/it] 91%|█████████ | 768/847 [2:34:57<15:18, 11.62s/it] 91%|█████████ | 769/847 [2:35:07<14:17, 10.99s/it] 91%|█████████ | 770/847 [2:35:22<15:50, 12.35s/it]                                                    91%|█████████ | 770/847 [2:35:22<15:50, 12.35s/it] 91%|█████████ | 771/847 [2:35:35<15:43, 12.41s/it] 91%|█████████ | 772/847 [2:35:47<15:25, 12.34s/it] 91%|█████████▏| 773/847 [2:35:58<14:41, 11.92s/it] 91%|█████████▏| 774/847 [2:36:11<14:47, 12.15s/it] 91%|█████████▏| 775/847 [2:36:25<15:22, 12.82s/it] 92%|█████████▏| 776/847 [2:36:41<16:10, 13.68s/it] 92%|█████████▏| 777/847 [2:36:50<14:20, 12.29s/it] 92%|█████████▏| 778/847 [2:36:59<13:07, 11.41s/it] 92%|█████████▏| 779/847 [2:37:11<12:57, 11.43s/it] 92%|█████████▏| 780/847 [2:37:22<12:39, 11.34s/it]                                                    92%|█████████▏| 780/847 [2:37:22<12:39, 11.34s/it] 92%|█████████▏| 781/847 [2:37:33<12:36, 11.46s/it] 92%|█████████▏| 782/847 [2:37:46<12:39, 11.69s/it] 92%|█████████▏| 783/847 [2:38:00<13:13, 12.40s/it] 93%|█████████▎| 784/847 [2:38:10<12:25, 11.83s/it] 93%|█████████▎| 785/847 [2:38:20<11:29, 11.12s/it] 93%|█████████▎| 786/847 [2:38:32<11:44, 11.55s/it] 93%|█████████▎| 787/847 [2:38:44<11:36, 11.60s/it] 93%|█████████▎| 788/847 [2:38:56<11:33, 11.75s/it] 93%|█████████▎| 789/847 [2:39:09<11:35, 11.99s/it] 93%|█████████▎| 790/847 [2:39:20<11:12, 11.80s/it]                                                    93%|█████████▎| 790/847 [2:39:20<11:12, 11.80s/it] 93%|█████████▎| 791/847 [2:39:28<10:00, 10.72s/it] 94%|█████████▎| 792/847 [2:39:41<10:26, 11.39s/it] 94%|█████████▎| 793/847 [2:39:53<10:15, 11.40s/it] 94%|█████████▎| 794/847 [2:40:02<09:39, 10.94s/it] 94%|█████████▍| 795/847 [2:40:16<10:06, 11.66s/it] 94%|█████████▍| 796/847 [2:40:26<09:35, 11.28s/it] 94%|█████████▍| 797/847 [2:40:42<10:26, 12.53s/it] 94%|█████████▍| 798/847 [2:40:53<09:55, 12.15s/it] 94%|█████████▍| 799/847 [2:41:05<09:37, 12.02s/it] 94%|█████████▍| 800/847 [2:41:19<09:57, 12.71s/it]                                                    94%|█████████▍| 800/847 [2:41:19<09:57, 12.71s/it] 95%|█████████▍| 801/847 [2:41:30<09:22, 12.23s/it] 95%|█████████▍| 802/847 [2:41:39<08:26, 11.26s/it] 95%|█████████▍| 803/847 [2:41:52<08:36, 11.74s/it] 95%|█████████▍| 804/847 [2:42:05<08:42, 12.15s/it] 95%|█████████▌| 805/847 [2:42:16<08:18, 11.86s/it] 95%|█████████▌| 806/847 [2:42:30<08:24, 12.30s/it] 95%|█████████▌| 807/847 [2:42:41<08:06, 12.16s/it] 95%|█████████▌| 808/847 [2:42:54<08:05, 12.44s/it] 96%|█████████▌| 809/847 [2:43:03<07:12, 11.38s/it] 96%|█████████▌| 810/847 [2:43:15<06:59, 11.33s/it]                                                    96%|█████████▌| 810/847 [2:43:15<06:59, 11.33s/it] 96%|█████████▌| 811/847 [2:43:25<06:33, 10.92s/it] 96%|█████████▌| 812/847 [2:43:39<07:01, 12.04s/it] 96%|█████████▌| 813/847 [2:43:51<06:45, 11.94s/it] 96%|█████████▌| 814/847 [2:44:02<06:27, 11.74s/it] 96%|█████████▌| 815/847 [2:44:17<06:47, 12.73s/it] 96%|█████████▋| 816/847 [2:44:28<06:16, 12.14s/it] 96%|█████████▋| 817/847 [2:44:40<06:02, 12.08s/it] 97%|█████████▋| 818/847 [2:44:52<05:54, 12.23s/it] 97%|█████████▋| 819/847 [2:45:03<05:25, 11.63s/it] 97%|█████████▋| 820/847 [2:45:12<04:53, 10.88s/it]                                                    97%|█████████▋| 820/847 [2:45:12<04:53, 10.88s/it] 97%|█████████▋| 821/847 [2:45:24<04:52, 11.26s/it] 97%|█████████▋| 822/847 [2:45:37<04:51, 11.67s/it] 97%|█████████▋| 823/847 [2:45:45<04:16, 10.68s/it] 97%|█████████▋| 824/847 [2:45:58<04:19, 11.26s/it] 97%|█████████▋| 825/847 [2:46:10<04:12, 11.49s/it] 98%|█████████▊| 826/847 [2:46:21<04:02, 11.55s/it] 98%|█████████▊| 827/847 [2:46:32<03:43, 11.18s/it] 98%|█████████▊| 828/847 [2:46:44<03:36, 11.41s/it] 98%|█████████▊| 829/847 [2:46:53<03:12, 10.68s/it] 98%|█████████▊| 830/847 [2:47:05<03:12, 11.33s/it]                                                    98%|█████████▊| 830/847 [2:47:05<03:12, 11.33s/it] 98%|█████████▊| 831/847 [2:47:18<03:09, 11.82s/it] 98%|█████████▊| 832/847 [2:47:31<02:59, 11.99s/it] 98%|█████████▊| 833/847 [2:47:43<02:49, 12.14s/it] 98%|█████████▊| 834/847 [2:47:53<02:27, 11.31s/it] 99%|█████████▊| 835/847 [2:48:02<02:08, 10.71s/it] 99%|█████████▊| 836/847 [2:48:11<01:52, 10.27s/it] 99%|█████████▉| 837/847 [2:48:23<01:46, 10.69s/it] 99%|█████████▉| 838/847 [2:48:35<01:41, 11.25s/it] 99%|█████████▉| 839/847 [2:48:44<01:22, 10.34s/it] 99%|█████████▉| 840/847 [2:48:58<01:21, 11.61s/it]                                                    99%|█████████▉| 840/847 [2:48:58<01:21, 11.61s/it] 99%|█████████▉| 841/847 [2:49:11<01:11, 11.87s/it] 99%|█████████▉| 842/847 [2:49:22<00:58, 11.71s/it]100%|█████████▉| 843/847 [2:49:34<00:46, 11.67s/it]100%|█████████▉| 844/847 [2:49:47<00:36, 12.15s/it]100%|█████████▉| 845/847 [2:49:53<00:20, 10.47s/it]100%|█████████▉| 846/847 [2:50:10<00:12, 12.24s/it]100%|██████████| 847/847 [2:50:22<00:00, 12.13s/it]{'eval_loss': 1.1857248544692993, 'eval_runtime': 49.9833, 'eval_samples_per_second': 4.862, 'eval_steps_per_second': 1.22, 'epoch': 6.0}
{'loss': 0.7898, 'grad_norm': 0.49227845668792725, 'learning_rate': 4.621303387517396e-06, 'epoch': 6.02}
{'loss': 0.7889, 'grad_norm': 0.5060963034629822, 'learning_rate': 3.876163220051657e-06, 'epoch': 6.1}
{'loss': 0.7185, 'grad_norm': 0.4965413808822632, 'learning_rate': 3.193803732750274e-06, 'epoch': 6.19}
{'loss': 0.7443, 'grad_norm': 0.5528455972671509, 'learning_rate': 2.575266632712657e-06, 'epoch': 6.27}
{'loss': 0.7551, 'grad_norm': 0.4821628928184509, 'learning_rate': 2.021496194181893e-06, 'epoch': 6.35}
{'loss': 0.7758, 'grad_norm': 0.4977218210697174, 'learning_rate': 1.533337816991931e-06, 'epoch': 6.43}
{'loss': 0.7783, 'grad_norm': 0.49439436197280884, 'learning_rate': 1.1115367359590673e-06, 'epoch': 6.52}
{'loss': 0.7755, 'grad_norm': 0.45051103830337524, 'learning_rate': 7.567368831877652e-07, 'epoch': 6.6}
{'loss': 0.78, 'grad_norm': 0.5444273352622986, 'learning_rate': 4.694799050277671e-07, 'epoch': 6.68}
{'loss': 0.7358, 'grad_norm': 0.5073983073234558, 'learning_rate': 2.502043351831979e-07, 'epoch': 6.76}
{'loss': 0.7607, 'grad_norm': 0.47185105085372925, 'learning_rate': 9.92449252360067e-08, 'epoch': 6.85}
{'loss': 0.7606, 'grad_norm': 0.4497314393520355, 'learning_rate': 1.6832133605836352e-08, 'epoch': 6.93}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.26it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:37,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.45it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A100%|██████████| 847/847 [2:51:12<00:00, 12.13s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                   100%|██████████| 847/847 [2:51:14<00:00, 12.13s/it]100%|██████████| 847/847 [2:51:14<00:00, 12.13s/it]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 1.2016056776046753, 'eval_runtime': 49.9698, 'eval_samples_per_second': 4.863, 'eval_steps_per_second': 1.221, 'epoch': 6.99}
{'train_runtime': 10294.986, 'train_samples_per_second': 1.318, 'train_steps_per_second': 0.082, 'train_loss': 0.920968619259921, 'epoch': 6.99}
wandb: - 0.371 MB of 0.371 MB uploadedwandb: \ 0.371 MB of 0.398 MB uploadedwandb: | 0.398 MB of 0.398 MB uploadedwandb: 
wandb: Run history:
wandb:               eval/loss ▂▁▂▃▅▇█
wandb:            eval/runtime ▄██▁█▅▃
wandb: eval/samples_per_second ▅▁▁█▁▅▆
wandb:   eval/steps_per_second █▁▁█▁▁█
wandb:             train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:         train/grad_norm ▅▂▁█▁▁▁▂▁▂▁▂▂▃▃▃▃▃▄▅▄▄▄▄▄▅▅▅▆▆▆▆▆▆▆▆▆▆▇▅
wandb:     train/learning_rate ▃▆███████▇▇▇▇▇▆▆▆▆▅▅▅▄▄▄▃▃▃▃▃▂▂▂▂▁▁▁▁▁▁▁
wandb:              train/loss █▅▅▅▅▅▄▄▄▄▄▄▃▄▄▃▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▂▂▁
wandb: 
wandb: Run summary:
wandb:                eval/loss 1.20161
wandb:             eval/runtime 49.9698
wandb:  eval/samples_per_second 4.863
wandb:    eval/steps_per_second 1.221
wandb:               total_flos 3.1984191548072755e+17
wandb:              train/epoch 6.98557
wandb:        train/global_step 847
wandb:          train/grad_norm 0.44973
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.7606
wandb:               train_loss 0.92097
wandb:            train_runtime 10294.986
wandb: train_samples_per_second 1.318
wandb:   train_steps_per_second 0.082
wandb: 
wandb: 🚀 View run sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-9e-05_ep-7_bz-4-acc-4_lora-r-32-ap-64 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/1w3w1on4
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240525_135003-1w3w1on4/logs
