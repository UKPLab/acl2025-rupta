{'eval_loss': 1.079256296157837, 'eval_runtime': 50.0435, 'eval_samples_per_second': 4.856, 'eval_steps_per_second': 1.219, 'epoch': 4.0}
{'loss': 0.9465, 'grad_norm': 0.24032364785671234, 'learning_rate': 3.464144038411719e-05, 'epoch': 4.12}
{'loss': 0.9293, 'grad_norm': 0.246614471077919, 'learning_rate': 3.1229093417804215e-05, 'epoch': 4.28}
{'loss': 0.9367, 'grad_norm': 0.2589534521102905, 'learning_rate': 2.7902074558033807e-05, 'epoch': 4.44}
{'loss': 0.9212, 'grad_norm': 0.2530025243759155, 'learning_rate': 2.468099887600999e-05, 'epoch': 4.61}
{'loss': 0.9399, 'grad_norm': 0.27811238169670105, 'learning_rate': 2.1585824991547415e-05, 'epoch': 4.77}
{'loss': 0.9329, 'grad_norm': 0.25439706444740295, 'learning_rate': 1.8635731404289893e-05, 'epoch': 4.94}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.40it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.26it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.29it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.29it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.44it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:41<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.45it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A                                                   
                                               [A 72%|███████▏  | 303/420 [2:25:25<54:51, 28.13s/it]
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 72%|███████▏  | 304/420 [2:25:33<1:23:33, 43.22s/it]`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:15<00:15, 15.10s/it] 73%|███████▎  | 305/420 [2:25:56<1:10:56, 37.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 10.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 11.19s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Found max lenth: 4096
trainable params: 50331648 || all params: 2059471872 || trainables%: 2.4439104356944577
Map:   0%|          | 0/1938 [00:00<?, ? examples/s]Map:  52%|█████▏    | 1000/1938 [00:01<00:01, 747.40 examples/s]Map: 100%|██████████| 1938/1938 [00:02<00:00, 876.53 examples/s]Map: 100%|██████████| 1938/1938 [00:02<00:00, 849.53 examples/s]
Map:   0%|          | 0/243 [00:00<?, ? examples/s]Map: 100%|██████████| 243/243 [00:00<00:00, 966.38 examples/s]Map: 100%|██████████| 243/243 [00:00<00:00, 952.55 examples/s]
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 73%|███████▎  | 306/420 [2:26:24<1:05:06, 34.27s/it]wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240525_162629-vu2p6a16
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0004_ep-7_bz-8-acc-4_lora-r-32-ap-64
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/vu2p6a16
  0%|          | 0/420 [00:00<?, ?it/s]/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
You are not running the flash-attention implementation, expect numerical differences.
 73%|███████▎  | 307/420 [2:26:45<57:28, 30.51s/it]    0%|          | 1/420 [00:25<2:57:15, 25.38s/it] 73%|███████▎  | 308/420 [2:27:17<57:49, 30.98s/it]  0%|          | 2/420 [00:48<2:45:44, 23.79s/it] 74%|███████▎  | 309/420 [2:27:43<54:31, 29.48s/it]  1%|          | 3/420 [01:17<3:02:00, 26.19s/it] 74%|███████▍  | 310/420 [2:28:14<54:38, 29.80s/it]                                                    74%|███████▍  | 310/420 [2:28:14<54:38, 29.80s/it]  1%|          | 4/420 [01:46<3:11:30, 27.62s/it]  1%|          | 5/420 [02:12<3:05:48, 26.86s/it] 74%|███████▍  | 311/420 [2:28:52<58:34, 32.25s/it]  1%|▏         | 6/420 [02:41<3:10:45, 27.65s/it] 74%|███████▍  | 312/420 [2:29:24<57:43, 32.07s/it]  2%|▏         | 7/420 [03:10<3:12:42, 28.00s/it] 75%|███████▍  | 313/420 [2:29:58<58:16, 32.68s/it]  2%|▏         | 8/420 [03:50<3:37:57, 31.74s/it] 75%|███████▍  | 314/420 [2:30:28<56:36, 32.04s/it]  2%|▏         | 9/420 [04:12<3:17:12, 28.79s/it] 75%|███████▌  | 315/420 [2:31:01<56:24, 32.23s/it]  2%|▏         | 10/420 [04:41<3:17:54, 28.96s/it]                                                    2%|▏         | 10/420 [04:41<3:17:54, 28.96s/it] 75%|███████▌  | 316/420 [2:31:33<55:57, 32.29s/it]  3%|▎         | 11/420 [05:09<3:14:21, 28.51s/it] 75%|███████▌  | 317/420 [2:31:59<52:10, 30.39s/it]  3%|▎         | 12/420 [05:30<2:58:23, 26.24s/it] 76%|███████▌  | 318/420 [2:32:28<50:58, 29.99s/it]  3%|▎         | 13/420 [05:56<2:57:53, 26.22s/it]  3%|▎         | 14/420 [06:19<2:50:24, 25.18s/it] 76%|███████▌  | 319/420 [2:32:55<48:47, 28.98s/it]  4%|▎         | 15/420 [06:41<2:44:43, 24.40s/it] 76%|███████▌  | 320/420 [2:33:23<48:00, 28.81s/it]                                                    76%|███████▌  | 320/420 [2:33:23<48:00, 28.81s/it]  4%|▍         | 16/420 [07:06<2:44:09, 24.38s/it] 76%|███████▋  | 321/420 [2:33:45<44:06, 26.73s/it]  4%|▍         | 17/420 [07:33<2:48:48, 25.13s/it] 77%|███████▋  | 322/420 [2:34:17<45:59, 28.16s/it]  4%|▍         | 18/420 [07:54<2:40:19, 23.93s/it] 77%|███████▋  | 323/420 [2:34:44<45:19, 28.04s/it]  5%|▍         | 19/420 [08:26<2:56:20, 26.39s/it] 77%|███████▋  | 324/420 [2:35:13<45:19, 28.32s/it]  5%|▍         | 20/420 [09:00<3:10:47, 28.62s/it]                                                    5%|▍         | 20/420 [09:00<3:10:47, 28.62s/it] 77%|███████▋  | 325/420 [2:35:42<45:10, 28.54s/it]  5%|▌         | 21/420 [09:22<2:58:43, 26.88s/it] 78%|███████▊  | 326/420 [2:36:10<44:25, 28.36s/it]  5%|▌         | 22/420 [09:46<2:52:02, 25.94s/it] 78%|███████▊  | 327/420 [2:36:34<41:48, 26.97s/it]  5%|▌         | 23/420 [10:15<2:57:36, 26.84s/it] 78%|███████▊  | 328/420 [2:36:59<40:32, 26.44s/it]  6%|▌         | 24/420 [10:42<2:57:12, 26.85s/it] 78%|███████▊  | 329/420 [2:37:25<39:51, 26.28s/it] 79%|███████▊  | 330/420 [2:37:51<38:57, 25.97s/it]                                                    79%|███████▊  | 330/420 [2:37:51<38:57, 25.97s/it]  6%|▌         | 25/420 [11:18<3:15:08, 29.64s/it] 79%|███████▉  | 331/420 [2:38:16<38:24, 25.90s/it]  6%|▌         | 26/420 [11:46<3:12:05, 29.25s/it] 79%|███████▉  | 332/420 [2:38:43<38:09, 26.01s/it]  6%|▋         | 27/420 [12:17<3:14:37, 29.71s/it] 79%|███████▉  | 333/420 [2:39:17<41:12, 28.42s/it]  7%|▋         | 28/420 [12:49<3:17:33, 30.24s/it] 80%|███████▉  | 334/420 [2:39:47<41:41, 29.08s/it]  7%|▋         | 29/420 [13:21<3:20:27, 30.76s/it] 80%|███████▉  | 335/420 [2:40:16<40:54, 28.88s/it]  7%|▋         | 30/420 [13:57<3:30:37, 32.40s/it]                                                    7%|▋         | 30/420 [13:57<3:30:37, 32.40s/it] 80%|████████  | 336/420 [2:40:38<37:50, 27.03s/it]  7%|▋         | 31/420 [14:23<3:17:50, 30.52s/it] 80%|████████  | 337/420 [2:41:02<35:58, 26.00s/it]  8%|▊         | 32/420 [14:45<3:01:36, 28.08s/it] 80%|████████  | 338/420 [2:41:33<37:26, 27.40s/it]  8%|▊         | 33/420 [15:10<2:54:16, 27.02s/it] 81%|████████  | 339/420 [2:41:55<35:03, 25.97s/it]  8%|▊         | 34/420 [15:37<2:54:37, 27.14s/it] 81%|████████  | 340/420 [2:42:20<34:02, 25.53s/it]                                                    81%|████████  | 340/420 [2:42:20<34:02, 25.53s/it]  8%|▊         | 35/420 [16:03<2:51:59, 26.80s/it] 81%|████████  | 341/420 [2:42:45<33:38, 25.55s/it]  9%|▊         | 36/420 [16:32<2:54:00, 27.19s/it] 81%|████████▏ | 342/420 [2:43:15<34:52, 26.83s/it]  9%|▉         | 37/420 [16:51<2:39:19, 24.96s/it] 82%|████████▏ | 343/420 [2:43:43<34:50, 27.16s/it]  9%|▉         | 38/420 [17:20<2:45:18, 25.96s/it] 82%|████████▏ | 344/420 [2:44:19<37:44, 29.79s/it]  9%|▉         | 39/420 [17:52<2:58:05, 28.05s/it] 82%|████████▏ | 345/420 [2:44:42<34:50, 27.87s/it] 10%|▉         | 40/420 [18:24<3:03:54, 29.04s/it]                                                   10%|▉         | 40/420 [18:24<3:03:54, 29.04s/it] 82%|████████▏ | 346/420 [2:45:15<36:00, 29.20s/it] 10%|▉         | 41/420 [18:56<3:09:30, 30.00s/it] 83%|████████▎ | 347/420 [2:45:40<34:16, 28.16s/it] 10%|█         | 42/420 [19:27<3:10:40, 30.27s/it] 83%|████████▎ | 348/420 [2:46:16<36:26, 30.37s/it] 10%|█         | 43/420 [19:55<3:05:00, 29.44s/it] 83%|████████▎ | 349/420 [2:46:45<35:22, 29.90s/it] 10%|█         | 44/420 [20:18<2:53:17, 27.65s/it] 83%|████████▎ | 350/420 [2:47:23<37:49, 32.42s/it]                                                    83%|████████▎ | 350/420 [2:47:23<37:49, 32.42s/it] 11%|█         | 45/420 [20:52<3:05:11, 29.63s/it] 84%|████████▎ | 351/420 [2:47:47<34:15, 29.79s/it] 11%|█         | 46/420 [21:17<2:55:26, 28.15s/it] 84%|████████▍ | 352/420 [2:48:11<31:53, 28.15s/it] 11%|█         | 47/420 [21:45<2:55:14, 28.19s/it] 84%|████████▍ | 353/420 [2:48:37<30:48, 27.58s/it] 11%|█▏        | 48/420 [22:13<2:54:11, 28.09s/it] 84%|████████▍ | 354/420 [2:49:08<31:18, 28.46s/it] 12%|█▏        | 49/420 [22:42<2:55:23, 28.37s/it] 85%|████████▍ | 355/420 [2:49:33<29:55, 27.62s/it] 12%|█▏        | 50/420 [23:06<2:46:22, 26.98s/it]                                                   12%|█▏        | 50/420 [23:06<2:46:22, 26.98s/it] 85%|████████▍ | 356/420 [2:50:06<31:02, 29.10s/it] 12%|█▏        | 51/420 [23:32<2:44:21, 26.72s/it] 12%|█▏        | 52/420 [23:58<2:42:29, 26.49s/it] 85%|████████▌ | 357/420 [2:50:41<32:34, 31.03s/it] 13%|█▎        | 53/420 [24:24<2:41:53, 26.47s/it] 85%|████████▌ | 358/420 [2:51:13<32:11, 31.15s/it] 13%|█▎        | 54/420 [24:58<2:53:48, 28.49s/it] 85%|████████▌ | 359/420 [2:51:37<29:23, 28.91s/it] 86%|████████▌ | 360/420 [2:52:05<28:43, 28.73s/it]                                                    86%|████████▌ | 360/420 [2:52:05<28:43, 28.73s/it] 13%|█▎        | 55/420 [25:33<3:05:56, 30.57s/it] 13%|█▎        | 56/420 [26:01<3:01:11, 29.87s/it] 86%|████████▌ | 361/420 [2:52:40<29:59, 30.50s/it] 14%|█▎        | 57/420 [26:34<3:05:52, 30.72s/it] 86%|████████▌ | 362/420 [2:53:10<29:36, 30.63s/it] 86%|████████▋ | 363/420 [2:53:36<27:46, 29.24s/it] 14%|█▍        | 58/420 [27:02<3:00:51, 29.98s/it] 14%|█▍        | 59/420 [27:21<2:40:05, 26.61s/it] 87%|████████▋ | 364/420 [2:54:08<28:00, 30.00s/it]{'eval_loss': 1.0974682569503784, 'eval_runtime': 50.0173, 'eval_samples_per_second': 4.858, 'eval_steps_per_second': 1.22, 'epoch': 4.99}
{'loss': 0.9131, 'grad_norm': 0.2719956040382385, 'learning_rate': 1.5848997658755516e-05, 'epoch': 5.1}
{'loss': 0.9276, 'grad_norm': 0.2790302634239197, 'learning_rate': 1.3242891079540946e-05, 'epoch': 5.27}
{'loss': 0.8867, 'grad_norm': 0.2930561602115631, 'learning_rate': 1.0833559778502519e-05, 'epoch': 5.43}
{'loss': 0.8837, 'grad_norm': 0.28219717741012573, 'learning_rate': 8.635932596869675e-06, 'epoch': 5.6}
{'loss': 0.8926, 'grad_norm': 0.24973616003990173, 'learning_rate': 6.663626602275287e-06, 'epoch': 5.76}
{'loss': 0.885, 'grad_norm': 0.307819664478302, 'learning_rate': 4.928862713874994e-06, 'epoch': 5.93}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A 14%|█▍        | 60/420 [27:45<2:35:21, 25.89s/it]                                                   14%|█▍        | 60/420 [27:45<2:35:21, 25.89s/it]
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.24it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A{'loss': 1.3114, 'grad_norm': 0.2002204805612564, 'learning_rate': 0.00019047619047619048, 'epoch': 0.16}
{'loss': 1.128, 'grad_norm': 0.12026216834783554, 'learning_rate': 0.00038095238095238096, 'epoch': 0.33}
{'loss': 1.0967, 'grad_norm': 0.10894837975502014, 'learning_rate': 0.00039949805373285115, 'epoch': 0.49}
{'loss': 1.1057, 'grad_norm': 0.10877090692520142, 'learning_rate': 0.0003977661652450257, 'epoch': 0.66}
{'loss': 1.11, 'grad_norm': 0.1051168218255043, 'learning_rate': 0.00039480886633720935, 'epoch': 0.82}
{'loss': 1.05, 'grad_norm': 0.10401942580938339, 'learning_rate': 0.00039064448119995385, 'epoch': 0.99}

  0%|          | 0/61 [00:00<?, ?it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 48%|████▊     | 29/61 [00:24<00:34,  1.06s/it][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 21%|██▏       | 13/61 [00:10<00:36,  1.30it/s][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.44it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 82%|████████▏ | 50/61 [00:41<00:07,  1.41it/s][A

 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s] 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A[A
 85%|████████▌ | 52/61 [00:42<00:06,  1.39it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A                                                   
                                               [A 87%|████████▋ | 364/420 [2:55:04<28:00, 30.00s/it]
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(

 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(

 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.27it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.30it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.45it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A 87%|████████▋ | 365/420 [2:55:19<38:43, 42.25s/it]
 92%|█████████▏| 56/61 [00:45<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A                                                  
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A 14%|█▍        | 60/420 [28:47<2:35:21, 25.89s/it]
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 15%|█▍        | 61/420 [28:54<3:51:34, 38.70s/it] 87%|████████▋ | 366/420 [2:55:52<35:34, 39.53s/it] 15%|█▍        | 62/420 [29:23<3:34:51, 36.01s/it] 87%|████████▋ | 367/420 [2:56:22<32:17, 36.55s/it] 15%|█▌        | 63/420 [29:53<3:22:51, 34.09s/it] 88%|████████▊ | 368/420 [2:56:53<30:10, 34.83s/it] 15%|█▌        | 64/420 [30:24<3:16:00, 33.04s/it] 88%|████████▊ | 369/420 [2:57:20<27:39, 32.55s/it] 15%|█▌        | 65/420 [30:49<3:01:36, 30.70s/it] 88%|████████▊ | 370/420 [2:57:48<26:04, 31.29s/it]                                                    88%|████████▊ | 370/420 [2:57:48<26:04, 31.29s/it] 16%|█▌        | 66/420 [31:19<3:00:55, 30.67s/it] 88%|████████▊ | 371/420 [2:58:14<24:18, 29.76s/it] 16%|█▌        | 67/420 [31:43<2:47:32, 28.48s/it] 89%|████████▊ | 372/420 [2:58:45<23:59, 29.98s/it] 16%|█▌        | 68/420 [32:17<2:57:16, 30.22s/it] 89%|████████▉ | 373/420 [2:59:06<21:26, 27.36s/it] 16%|█▋        | 69/420 [32:50<3:00:57, 30.93s/it] 89%|████████▉ | 374/420 [2:59:26<19:09, 24.99s/it] 17%|█▋        | 70/420 [33:11<2:42:43, 27.90s/it]                                                   17%|█▋        | 70/420 [33:11<2:42:43, 27.90s/it] 89%|████████▉ | 375/420 [2:59:48<18:14, 24.31s/it] 90%|████████▉ | 376/420 [3:00:12<17:42, 24.16s/it] 17%|█▋        | 71/420 [33:38<2:41:18, 27.73s/it] 17%|█▋        | 72/420 [34:01<2:33:29, 26.46s/it] 90%|████████▉ | 377/420 [3:00:40<18:10, 25.36s/it] 17%|█▋        | 73/420 [34:28<2:33:44, 26.58s/it] 90%|█████████ | 378/420 [3:01:07<18:02, 25.77s/it] 18%|█▊        | 74/420 [34:55<2:34:11, 26.74s/it] 90%|█████████ | 379/420 [3:01:46<20:20, 29.76s/it] 18%|█▊        | 75/420 [35:20<2:30:55, 26.25s/it] 90%|█████████ | 380/420 [3:02:18<20:21, 30.53s/it]                                                    90%|█████████ | 380/420 [3:02:18<20:21, 30.53s/it] 18%|█▊        | 76/420 [35:56<2:46:23, 29.02s/it] 91%|█████████ | 381/420 [3:02:48<19:40, 30.28s/it] 18%|█▊        | 77/420 [36:32<2:57:32, 31.06s/it] 91%|█████████ | 382/420 [3:03:24<20:13, 31.94s/it] 19%|█▊        | 78/420 [36:57<2:47:46, 29.43s/it] 91%|█████████ | 383/420 [3:03:53<19:09, 31.06s/it] 19%|█▉        | 79/420 [37:27<2:47:42, 29.51s/it] 91%|█████████▏| 384/420 [3:04:16<17:08, 28.57s/it] 19%|█▉        | 80/420 [37:53<2:41:11, 28.45s/it]                                                   19%|█▉        | 80/420 [37:53<2:41:11, 28.45s/it] 92%|█████████▏| 385/420 [3:04:42<16:19, 28.00s/it] 19%|█▉        | 81/420 [38:20<2:37:42, 27.91s/it] 92%|█████████▏| 386/420 [3:05:19<17:18, 30.55s/it] 20%|█▉        | 82/420 [38:53<2:45:56, 29.46s/it] 92%|█████████▏| 387/420 [3:05:47<16:21, 29.76s/it] 20%|█▉        | 83/420 [39:28<2:54:52, 31.14s/it] 92%|█████████▏| 388/420 [3:06:19<16:14, 30.45s/it] 20%|██        | 84/420 [39:54<2:45:21, 29.53s/it] 93%|█████████▎| 389/420 [3:06:51<16:03, 31.09s/it] 20%|██        | 85/420 [40:25<2:48:17, 30.14s/it] 93%|█████████▎| 390/420 [3:07:19<15:03, 30.12s/it]                                                    93%|█████████▎| 390/420 [3:07:19<15:03, 30.12s/it] 20%|██        | 86/420 [40:56<2:49:22, 30.43s/it] 93%|█████████▎| 391/420 [3:07:43<13:41, 28.33s/it] 21%|██        | 87/420 [41:18<2:33:43, 27.70s/it] 93%|█████████▎| 392/420 [3:08:11<13:07, 28.12s/it] 21%|██        | 88/420 [41:46<2:33:50, 27.80s/it] 94%|█████████▎| 393/420 [3:08:36<12:13, 27.18s/it] 21%|██        | 89/420 [42:15<2:36:28, 28.36s/it] 94%|█████████▍| 394/420 [3:09:04<11:49, 27.29s/it] 21%|██▏       | 90/420 [42:42<2:33:48, 27.97s/it]                                                   21%|██▏       | 90/420 [42:42<2:33:48, 27.97s/it] 94%|█████████▍| 395/420 [3:09:33<11:39, 27.99s/it] 22%|██▏       | 91/420 [43:06<2:26:38, 26.74s/it] 94%|█████████▍| 396/420 [3:10:00<11:04, 27.69s/it] 22%|██▏       | 92/420 [43:43<2:42:17, 29.69s/it] 95%|█████████▍| 397/420 [3:10:30<10:48, 28.18s/it] 22%|██▏       | 93/420 [44:11<2:38:42, 29.12s/it] 95%|█████████▍| 398/420 [3:10:55<10:04, 27.47s/it] 22%|██▏       | 94/420 [44:37<2:33:41, 28.29s/it] 95%|█████████▌| 399/420 [3:11:20<09:17, 26.53s/it] 23%|██▎       | 95/420 [45:00<2:24:14, 26.63s/it] 95%|█████████▌| 400/420 [3:11:54<09:39, 28.99s/it]                                                    95%|█████████▌| 400/420 [3:11:54<09:39, 28.99s/it] 23%|██▎       | 96/420 [45:30<2:29:07, 27.62s/it] 95%|█████████▌| 401/420 [3:12:22<09:02, 28.54s/it] 23%|██▎       | 97/420 [45:54<2:23:54, 26.73s/it] 96%|█████████▌| 402/420 [3:12:50<08:30, 28.37s/it] 23%|██▎       | 98/420 [46:17<2:17:20, 25.59s/it] 96%|█████████▌| 403/420 [3:13:17<07:53, 27.84s/it] 24%|██▎       | 99/420 [46:50<2:29:02, 27.86s/it] 96%|█████████▌| 404/420 [3:13:47<07:37, 28.58s/it] 24%|██▍       | 100/420 [47:18<2:28:07, 27.77s/it]                                                    24%|██▍       | 100/420 [47:18<2:28:07, 27.77s/it] 24%|██▍       | 101/420 [47:39<2:16:44, 25.72s/it] 96%|█████████▋| 405/420 [3:14:15<07:06, 28.44s/it] 97%|█████████▋| 406/420 [3:14:39<06:18, 27.07s/it] 24%|██▍       | 102/420 [48:05<2:16:12, 25.70s/it] 25%|██▍       | 103/420 [48:28<2:12:50, 25.14s/it] 97%|█████████▋| 407/420 [3:15:12<06:14, 28.79s/it] 97%|█████████▋| 408/420 [3:15:35<05:25, 27.15s/it] 25%|██▍       | 104/420 [49:03<2:27:48, 28.07s/it] 25%|██▌       | 105/420 [49:30<2:25:17, 27.67s/it] 97%|█████████▋| 409/420 [3:16:09<05:20, 29.09s/it] 25%|██▌       | 106/420 [49:56<2:22:48, 27.29s/it] 98%|█████████▊| 410/420 [3:16:37<04:48, 28.85s/it]                                                    98%|█████████▊| 410/420 [3:16:37<04:48, 28.85s/it] 25%|██▌       | 107/420 [50:20<2:16:06, 26.09s/it] 98%|█████████▊| 411/420 [3:17:02<04:08, 27.66s/it] 26%|██▌       | 108/420 [50:47<2:17:16, 26.40s/it] 98%|█████████▊| 412/420 [3:17:28<03:38, 27.34s/it] 26%|██▌       | 109/420 [51:12<2:14:44, 26.00s/it] 98%|█████████▊| 413/420 [3:17:55<03:10, 27.15s/it] 26%|██▌       | 110/420 [51:40<2:17:00, 26.52s/it]                                                    26%|██▌       | 110/420 [51:40<2:17:00, 26.52s/it] 99%|█████████▊| 414/420 [3:18:23<02:43, 27.26s/it] 26%|██▋       | 111/420 [52:05<2:15:28, 26.31s/it] 99%|█████████▉| 415/420 [3:18:52<02:19, 27.85s/it] 27%|██▋       | 112/420 [52:30<2:11:51, 25.69s/it] 99%|█████████▉| 416/420 [3:19:17<01:48, 27.08s/it] 27%|██▋       | 113/420 [53:02<2:21:15, 27.61s/it] 99%|█████████▉| 417/420 [3:19:48<01:24, 28.21s/it] 27%|██▋       | 114/420 [53:28<2:19:26, 27.34s/it]100%|█████████▉| 418/420 [3:20:11<00:53, 26.61s/it]100%|█████████▉| 419/420 [3:20:33<00:25, 25.15s/it] 27%|██▋       | 115/420 [54:06<2:34:09, 30.33s/it]100%|██████████| 420/420 [3:20:58<00:00, 25.35s/it]                                                   100%|██████████| 420/420 [3:20:58<00:00, 25.35s/it]{'eval_loss': 1.108503818511963, 'eval_runtime': 50.0197, 'eval_samples_per_second': 4.858, 'eval_steps_per_second': 1.22, 'epoch': 5.99}
{'loss': 0.901, 'grad_norm': 0.2671872079372406, 'learning_rate': 3.4423899783646288e-06, 'epoch': 6.09}
{'loss': 0.8506, 'grad_norm': 0.29465651512145996, 'learning_rate': 2.213418966100692e-06, 'epoch': 6.26}
{'loss': 0.885, 'grad_norm': 0.30181989073753357, 'learning_rate': 1.2495647000191247e-06, 'epoch': 6.42}
{'loss': 0.9064, 'grad_norm': 0.26818737387657166, 'learning_rate': 5.567994709794283e-07, 'epoch': 6.58}
{'loss': 0.8898, 'grad_norm': 0.2833694815635681, 'learning_rate': 1.3941583190246798e-07, 'epoch': 6.75}
{'loss': 0.8728, 'grad_norm': 0.29091477394104004, 'learning_rate': 0.0, 'epoch': 6.91}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.41it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.26it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.29it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A 28%|██▊       | 116/420 [54:36<2:33:20, 30.26s/it]
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A 28%|██▊       | 117/420 [54:59<2:22:05, 28.14s/it]
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.44it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.54it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:41<00:07,  1.40it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.39it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.10it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A100%|██████████| 420/420 [3:21:48<00:00, 25.35s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                   100%|██████████| 420/420 [3:21:51<00:00, 25.35s/it]100%|██████████| 420/420 [3:21:51<00:00, 28.84s/it]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 1.113760232925415, 'eval_runtime': 50.0306, 'eval_samples_per_second': 4.857, 'eval_steps_per_second': 1.219, 'epoch': 6.91}
{'train_runtime': 12127.8284, 'train_samples_per_second': 1.119, 'train_steps_per_second': 0.035, 'train_loss': 0.9927180244809105, 'epoch': 6.91}
wandb: - 0.371 MB of 0.371 MB uploadedwandb: \ 0.371 MB of 0.396 MB uploadedwandb: | 0.396 MB of 0.396 MB uploadedwandb: 
wandb: Run history:
wandb:               eval/loss ▄▁▁▂▅▇█
wandb:            eval/runtime ▁▇▆█▃▄▆
wandb: eval/samples_per_second █▁▃▁▄▄▃
wandb:   eval/steps_per_second █▁▁▁██▁
wandb:             train/epoch ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       train/global_step ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:         train/grad_norm ▆▄▂▁▂▂▂▂▂▂▂▃▂▂▃▃▄▄▅▅▄▅▆▆▆▆▆▇▆▇▇▇▇▆█▇██▇▇
wandb:     train/learning_rate ▄████████▇▇▇▇▇▆▆▆▆▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁
wandb:              train/loss █▆▅▅▅▄▄▄▄▄▄▄▃▃▄▃▃▃▃▂▃▃▂▂▂▂▂▂▂▂▂▁▁▂▁▂▁▁▂▁
wandb: 
wandb: Run summary:
wandb:                eval/loss 1.11376
wandb:             eval/runtime 50.0306
wandb:  eval/samples_per_second 4.857
wandb:    eval/steps_per_second 1.219
wandb:               total_flos 3.663650723249848e+17
wandb:              train/epoch 6.91358
wandb:        train/global_step 420
wandb:          train/grad_norm 0.29091
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.8728
wandb:               train_loss 0.99272
wandb:            train_runtime 12127.8284
wandb: train_samples_per_second 1.119
wandb:   train_steps_per_second 0.035
wandb: 
wandb: 🚀 View run sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-9e-05_ep-7_bz-8-acc-4_lora-r-32-ap-64 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/272soam9
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240525_135959-272soam9/logs
 28%|██▊       | 118/420 [55:25<2:18:19, 27.48s/it] 28%|██▊       | 119/420 [56:02<2:31:57, 30.29s/it] 29%|██▊       | 120/420 [56:25<2:20:54, 28.18s/it]                                                    29%|██▊       | 120/420 [56:25<2:20:54, 28.18s/it] 29%|██▉       | 121/420 [56:56<2:24:13, 28.94s/it]{'eval_loss': 1.0718070268630981, 'eval_runtime': 49.9285, 'eval_samples_per_second': 4.867, 'eval_steps_per_second': 1.222, 'epoch': 0.99}
{'loss': 1.0167, 'grad_norm': 0.1350070685148239, 'learning_rate': 0.00038529881344296035, 'epoch': 1.15}
{'loss': 0.9707, 'grad_norm': 0.12132781744003296, 'learning_rate': 0.00037880498620922507, 'epoch': 1.32}
{'loss': 0.9918, 'grad_norm': 0.13699743151664734, 'learning_rate': 0.00037120323693546004, 'epoch': 1.48}
{'loss': 0.9969, 'grad_norm': 0.1452120989561081, 'learning_rate': 0.00036254066803050603, 'epoch': 1.65}
{'loss': 0.966, 'grad_norm': 0.1313781887292862, 'learning_rate': 0.00035287095501659844, 'epoch': 1.81}
{'loss': 0.9969, 'grad_norm': 0.14015918970108032, 'learning_rate': 0.0003422540139419191, 'epoch': 1.98}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:37,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:36,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.30it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:45<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A 29%|██▉       | 121/420 [58:03<2:24:13, 28.94s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 29%|██▉       | 122/420 [58:22<3:49:44, 46.26s/it] 29%|██▉       | 123/420 [58:52<3:24:17, 41.27s/it] 30%|██▉       | 124/420 [59:15<2:56:34, 35.79s/it] 30%|██▉       | 125/420 [59:41<2:40:46, 32.70s/it] 30%|███       | 126/420 [1:00:03<2:25:29, 29.69s/it] 30%|███       | 127/420 [1:00:36<2:30:05, 30.73s/it] 30%|███       | 128/420 [1:01:04<2:24:28, 29.69s/it] 31%|███       | 129/420 [1:01:29<2:17:29, 28.35s/it] 31%|███       | 130/420 [1:01:52<2:08:55, 26.67s/it]                                                      31%|███       | 130/420 [1:01:52<2:08:55, 26.67s/it] 31%|███       | 131/420 [1:02:17<2:06:39, 26.30s/it] 31%|███▏      | 132/420 [1:02:41<2:02:35, 25.54s/it] 32%|███▏      | 133/420 [1:03:11<2:08:47, 26.92s/it] 32%|███▏      | 134/420 [1:03:34<2:02:32, 25.71s/it] 32%|███▏      | 135/420 [1:04:07<2:12:31, 27.90s/it] 32%|███▏      | 136/420 [1:04:39<2:18:16, 29.21s/it] 33%|███▎      | 137/420 [1:05:14<2:25:03, 30.76s/it] 33%|███▎      | 138/420 [1:05:42<2:21:42, 30.15s/it] 33%|███▎      | 139/420 [1:06:14<2:23:49, 30.71s/it] 33%|███▎      | 140/420 [1:06:44<2:21:19, 30.28s/it]                                                      33%|███▎      | 140/420 [1:06:44<2:21:19, 30.28s/it] 34%|███▎      | 141/420 [1:07:07<2:11:26, 28.27s/it] 34%|███▍      | 142/420 [1:07:30<2:03:25, 26.64s/it] 34%|███▍      | 143/420 [1:08:00<2:08:15, 27.78s/it] 34%|███▍      | 144/420 [1:08:27<2:05:37, 27.31s/it] 35%|███▍      | 145/420 [1:08:58<2:10:41, 28.52s/it] 35%|███▍      | 146/420 [1:09:27<2:10:38, 28.61s/it] 35%|███▌      | 147/420 [1:09:51<2:03:52, 27.23s/it] 35%|███▌      | 148/420 [1:10:29<2:18:16, 30.50s/it] 35%|███▌      | 149/420 [1:10:59<2:16:39, 30.26s/it] 36%|███▌      | 150/420 [1:11:31<2:19:00, 30.89s/it]                                                      36%|███▌      | 150/420 [1:11:31<2:19:00, 30.89s/it] 36%|███▌      | 151/420 [1:11:55<2:09:23, 28.86s/it] 36%|███▌      | 152/420 [1:12:28<2:14:17, 30.07s/it] 36%|███▋      | 153/420 [1:12:50<2:02:28, 27.52s/it] 37%|███▋      | 154/420 [1:13:16<2:00:54, 27.27s/it] 37%|███▋      | 155/420 [1:13:45<2:01:47, 27.58s/it] 37%|███▋      | 156/420 [1:14:17<2:08:12, 29.14s/it] 37%|███▋      | 157/420 [1:14:42<2:02:26, 27.94s/it] 38%|███▊      | 158/420 [1:15:12<2:04:14, 28.45s/it] 38%|███▊      | 159/420 [1:15:35<1:56:45, 26.84s/it] 38%|███▊      | 160/420 [1:16:08<2:04:07, 28.65s/it]                                                      38%|███▊      | 160/420 [1:16:08<2:04:07, 28.65s/it] 38%|███▊      | 161/420 [1:16:35<2:00:56, 28.02s/it] 39%|███▊      | 162/420 [1:17:05<2:04:02, 28.85s/it] 39%|███▉      | 163/420 [1:17:36<2:05:13, 29.23s/it] 39%|███▉      | 164/420 [1:18:02<2:01:45, 28.54s/it] 39%|███▉      | 165/420 [1:18:40<2:13:07, 31.32s/it] 40%|███▉      | 166/420 [1:19:09<2:09:01, 30.48s/it] 40%|███▉      | 167/420 [1:19:33<2:01:12, 28.75s/it] 40%|████      | 168/420 [1:19:59<1:56:03, 27.63s/it] 40%|████      | 169/420 [1:20:23<1:51:27, 26.65s/it] 40%|████      | 170/420 [1:20:46<1:46:47, 25.63s/it]                                                      40%|████      | 170/420 [1:20:46<1:46:47, 25.63s/it] 41%|████      | 171/420 [1:21:11<1:45:21, 25.39s/it] 41%|████      | 172/420 [1:21:33<1:41:16, 24.50s/it] 41%|████      | 173/420 [1:22:01<1:45:03, 25.52s/it] 41%|████▏     | 174/420 [1:22:21<1:37:45, 23.84s/it] 42%|████▏     | 175/420 [1:22:45<1:36:45, 23.69s/it] 42%|████▏     | 176/420 [1:23:17<1:47:03, 26.33s/it] 42%|████▏     | 177/420 [1:23:41<1:44:01, 25.69s/it] 42%|████▏     | 178/420 [1:24:10<1:47:28, 26.64s/it] 43%|████▎     | 179/420 [1:24:36<1:46:33, 26.53s/it] 43%|████▎     | 180/420 [1:25:00<1:42:30, 25.63s/it]                                                      43%|████▎     | 180/420 [1:25:00<1:42:30, 25.63s/it] 43%|████▎     | 181/420 [1:25:32<1:50:08, 27.65s/it] 43%|████▎     | 182/420 [1:26:07<1:58:12, 29.80s/it]{'eval_loss': 1.0741212368011475, 'eval_runtime': 49.9443, 'eval_samples_per_second': 4.865, 'eval_steps_per_second': 1.221, 'epoch': 1.99}
{'loss': 0.856, 'grad_norm': 0.2034778892993927, 'learning_rate': 0.00033075563012523174, 'epoch': 2.14}
{'loss': 0.8171, 'grad_norm': 0.1787181943655014, 'learning_rate': 0.00031844705053299605, 'epoch': 2.3}
{'loss': 0.8432, 'grad_norm': 0.18003109097480774, 'learning_rate': 0.0003054045423146958, 'epoch': 2.47}
{'loss': 0.8155, 'grad_norm': 0.1851329356431961, 'learning_rate': 0.0002917089202318132, 'epoch': 2.63}
{'loss': 0.8173, 'grad_norm': 0.20111334323883057, 'learning_rate': 0.00027744504590861976, 'epoch': 2.8}
{'loss': 0.8417, 'grad_norm': 0.19816912710666656, 'learning_rate': 0.0002627013020075563, 'epoch': 2.96}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.39it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.10it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A                                                     
                                               [A 43%|████▎     | 182/420 [1:26:58<1:58:12, 29.80s/it]
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 44%|████▎     | 183/420 [1:27:20<2:48:28, 42.65s/it] 44%|████▍     | 184/420 [1:27:47<2:30:08, 38.17s/it] 44%|████▍     | 185/420 [1:28:17<2:19:11, 35.54s/it] 44%|████▍     | 186/420 [1:28:45<2:09:45, 33.27s/it] 45%|████▍     | 187/420 [1:29:22<2:13:18, 34.33s/it] 45%|████▍     | 188/420 [1:29:52<2:08:37, 33.26s/it] 45%|████▌     | 189/420 [1:30:28<2:10:40, 33.94s/it] 45%|████▌     | 190/420 [1:30:52<1:58:17, 30.86s/it]                                                      45%|████▌     | 190/420 [1:30:52<1:58:17, 30.86s/it] 45%|████▌     | 191/420 [1:31:24<1:59:25, 31.29s/it] 46%|████▌     | 192/420 [1:31:51<1:53:52, 29.97s/it] 46%|████▌     | 193/420 [1:32:14<1:45:12, 27.81s/it] 46%|████▌     | 194/420 [1:32:42<1:45:14, 27.94s/it] 46%|████▋     | 195/420 [1:33:10<1:44:40, 27.91s/it] 47%|████▋     | 196/420 [1:33:35<1:41:01, 27.06s/it] 47%|████▋     | 197/420 [1:34:11<1:50:32, 29.74s/it] 47%|████▋     | 198/420 [1:34:37<1:46:01, 28.65s/it] 47%|████▋     | 199/420 [1:35:05<1:45:14, 28.57s/it] 48%|████▊     | 200/420 [1:35:32<1:42:42, 28.01s/it]                                                      48%|████▊     | 200/420 [1:35:32<1:42:42, 28.01s/it] 48%|████▊     | 201/420 [1:35:57<1:38:49, 27.07s/it] 48%|████▊     | 202/420 [1:36:24<1:38:39, 27.15s/it] 48%|████▊     | 203/420 [1:36:53<1:40:00, 27.65s/it] 49%|████▊     | 204/420 [1:37:17<1:36:13, 26.73s/it] 49%|████▉     | 205/420 [1:37:43<1:34:57, 26.50s/it] 49%|████▉     | 206/420 [1:38:15<1:39:43, 27.96s/it] 49%|████▉     | 207/420 [1:38:34<1:30:21, 25.45s/it] 50%|████▉     | 208/420 [1:39:03<1:33:40, 26.51s/it] 50%|████▉     | 209/420 [1:39:33<1:36:53, 27.55s/it] 50%|█████     | 210/420 [1:40:01<1:36:18, 27.52s/it]                                                      50%|█████     | 210/420 [1:40:01<1:36:18, 27.52s/it] 50%|█████     | 211/420 [1:40:27<1:34:47, 27.21s/it] 50%|█████     | 212/420 [1:40:56<1:35:50, 27.65s/it] 51%|█████     | 213/420 [1:41:19<1:30:39, 26.28s/it] 51%|█████     | 214/420 [1:41:50<1:34:30, 27.53s/it] 51%|█████     | 215/420 [1:42:09<1:25:35, 25.05s/it] 51%|█████▏    | 216/420 [1:42:37<1:28:14, 25.95s/it] 52%|█████▏    | 217/420 [1:43:18<1:42:53, 30.41s/it] 52%|█████▏    | 218/420 [1:43:45<1:39:39, 29.60s/it] 52%|█████▏    | 219/420 [1:44:13<1:36:52, 28.92s/it] 52%|█████▏    | 220/420 [1:44:40<1:34:31, 28.36s/it]                                                      52%|█████▏    | 220/420 [1:44:40<1:34:31, 28.36s/it] 53%|█████▎    | 221/420 [1:45:15<1:41:23, 30.57s/it] 53%|█████▎    | 222/420 [1:45:46<1:40:32, 30.47s/it] 53%|█████▎    | 223/420 [1:46:16<1:40:09, 30.51s/it] 53%|█████▎    | 224/420 [1:46:41<1:33:43, 28.69s/it] 54%|█████▎    | 225/420 [1:47:10<1:33:23, 28.73s/it] 54%|█████▍    | 226/420 [1:47:32<1:26:32, 26.76s/it] 54%|█████▍    | 227/420 [1:47:56<1:24:06, 26.15s/it] 54%|█████▍    | 228/420 [1:48:33<1:33:55, 29.35s/it] 55%|█████▍    | 229/420 [1:49:00<1:30:33, 28.45s/it] 55%|█████▍    | 230/420 [1:49:26<1:27:57, 27.78s/it]                                                      55%|█████▍    | 230/420 [1:49:26<1:27:57, 27.78s/it] 55%|█████▌    | 231/420 [1:49:54<1:27:33, 27.80s/it] 55%|█████▌    | 232/420 [1:50:21<1:26:38, 27.65s/it] 55%|█████▌    | 233/420 [1:50:52<1:29:42, 28.78s/it] 56%|█████▌    | 234/420 [1:51:18<1:25:59, 27.74s/it] 56%|█████▌    | 235/420 [1:51:48<1:28:18, 28.64s/it] 56%|█████▌    | 236/420 [1:52:15<1:25:42, 27.95s/it] 56%|█████▋    | 237/420 [1:52:42<1:24:26, 27.68s/it] 57%|█████▋    | 238/420 [1:53:06<1:20:37, 26.58s/it] 57%|█████▋    | 239/420 [1:53:36<1:23:41, 27.75s/it] 57%|█████▋    | 240/420 [1:54:02<1:21:32, 27.18s/it]                                                      57%|█████▋    | 240/420 [1:54:02<1:21:32, 27.18s/it] 57%|█████▋    | 241/420 [1:54:33<1:24:20, 28.27s/it] 58%|█████▊    | 242/420 [1:54:55<1:18:16, 26.39s/it] 58%|█████▊    | 243/420 [1:55:24<1:20:00, 27.12s/it]{'eval_loss': 1.1344273090362549, 'eval_runtime': 49.9874, 'eval_samples_per_second': 4.861, 'eval_steps_per_second': 1.22, 'epoch': 3.0}
{'loss': 0.694, 'grad_norm': 0.2696628272533417, 'learning_rate': 0.0002475690445873483, 'epoch': 3.13}
{'loss': 0.6195, 'grad_norm': 0.28004419803619385, 'learning_rate': 0.00023214203703718692, 'epoch': 3.29}
{'loss': 0.6584, 'grad_norm': 0.2537378966808319, 'learning_rate': 0.0002165158690944665, 'epoch': 3.46}
{'loss': 0.6297, 'grad_norm': 0.242627814412117, 'learning_rate': 0.0002007873645459951, 'epoch': 3.62}
{'loss': 0.6486, 'grad_norm': 0.25080275535583496, 'learning_rate': 0.00018505398128271515, 'epoch': 3.79}
{'loss': 0.6318, 'grad_norm': 0.24758358299732208, 'learning_rate': 0.0001694132074253508, 'epoch': 3.95}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:37,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:36,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.27it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.30it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.54it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.39it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:45<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                     
                                               [A 58%|█████▊    | 243/420 [1:56:14<1:20:00, 27.12s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 58%|█████▊    | 244/420 [1:56:42<2:04:19, 42.39s/it] 58%|█████▊    | 245/420 [1:57:14<1:54:19, 39.20s/it] 59%|█████▊    | 246/420 [1:57:38<1:41:03, 34.85s/it] 59%|█████▉    | 247/420 [1:58:06<1:33:56, 32.58s/it] 59%|█████▉    | 248/420 [1:58:31<1:27:12, 30.42s/it] 59%|█████▉    | 249/420 [1:58:57<1:22:36, 28.99s/it] 60%|█████▉    | 250/420 [1:59:28<1:24:20, 29.77s/it]                                                      60%|█████▉    | 250/420 [1:59:28<1:24:20, 29.77s/it] 60%|█████▉    | 251/420 [1:59:52<1:18:58, 28.04s/it] 60%|██████    | 252/420 [2:00:19<1:17:23, 27.64s/it] 60%|██████    | 253/420 [2:00:49<1:19:08, 28.43s/it] 60%|██████    | 254/420 [2:01:09<1:11:44, 25.93s/it] 61%|██████    | 255/420 [2:01:44<1:18:55, 28.70s/it] 61%|██████    | 256/420 [2:02:09<1:15:02, 27.45s/it] 61%|██████    | 257/420 [2:02:42<1:19:23, 29.23s/it] 61%|██████▏   | 258/420 [2:03:10<1:17:46, 28.81s/it] 62%|██████▏   | 259/420 [2:03:32<1:11:27, 26.63s/it] 62%|██████▏   | 260/420 [2:04:00<1:12:00, 27.00s/it]                                                      62%|██████▏   | 260/420 [2:04:00<1:12:00, 27.00s/it] 62%|██████▏   | 261/420 [2:04:31<1:15:17, 28.41s/it] 62%|██████▏   | 262/420 [2:04:59<1:14:09, 28.16s/it] 63%|██████▎   | 263/420 [2:05:26<1:12:43, 27.79s/it] 63%|██████▎   | 264/420 [2:05:52<1:10:50, 27.25s/it] 63%|██████▎   | 265/420 [2:06:19<1:10:30, 27.29s/it] 63%|██████▎   | 266/420 [2:06:44<1:08:02, 26.51s/it] 64%|██████▎   | 267/420 [2:07:13<1:09:28, 27.25s/it] 64%|██████▍   | 268/420 [2:07:40<1:08:35, 27.08s/it] 64%|██████▍   | 269/420 [2:07:59<1:02:18, 24.76s/it] 64%|██████▍   | 270/420 [2:08:30<1:06:30, 26.60s/it]                                                      64%|██████▍   | 270/420 [2:08:30<1:06:30, 26.60s/it] 65%|██████▍   | 271/420 [2:08:51<1:02:11, 25.04s/it] 65%|██████▍   | 272/420 [2:09:26<1:08:39, 27.83s/it] 65%|██████▌   | 273/420 [2:09:50<1:06:03, 26.97s/it] 65%|██████▌   | 274/420 [2:10:16<1:04:55, 26.68s/it] 65%|██████▌   | 275/420 [2:10:45<1:05:35, 27.14s/it] 66%|██████▌   | 276/420 [2:11:12<1:05:18, 27.21s/it] 66%|██████▌   | 277/420 [2:11:37<1:03:32, 26.66s/it] 66%|██████▌   | 278/420 [2:12:13<1:09:35, 29.41s/it] 66%|██████▋   | 279/420 [2:12:39<1:06:11, 28.17s/it] 67%|██████▋   | 280/420 [2:13:14<1:11:06, 30.47s/it]                                                      67%|██████▋   | 280/420 [2:13:14<1:11:06, 30.47s/it] 67%|██████▋   | 281/420 [2:13:36<1:04:24, 27.80s/it] 67%|██████▋   | 282/420 [2:14:01<1:01:42, 26.83s/it] 67%|██████▋   | 283/420 [2:14:32<1:04:06, 28.08s/it] 68%|██████▊   | 284/420 [2:15:03<1:06:02, 29.14s/it] 68%|██████▊   | 285/420 [2:15:35<1:07:23, 29.95s/it] 68%|██████▊   | 286/420 [2:16:00<1:03:44, 28.54s/it] 68%|██████▊   | 287/420 [2:16:26<1:01:39, 27.81s/it] 69%|██████▊   | 288/420 [2:17:03<1:07:08, 30.52s/it] 69%|██████▉   | 289/420 [2:17:34<1:06:44, 30.57s/it] 69%|██████▉   | 290/420 [2:17:57<1:01:12, 28.25s/it]                                                      69%|██████▉   | 290/420 [2:17:57<1:01:12, 28.25s/it] 69%|██████▉   | 291/420 [2:18:23<59:26, 27.65s/it]   70%|██████▉   | 292/420 [2:18:52<59:48, 28.04s/it] 70%|██████▉   | 293/420 [2:19:19<58:58, 27.86s/it] 70%|███████   | 294/420 [2:19:45<56:58, 27.13s/it] 70%|███████   | 295/420 [2:20:14<58:00, 27.85s/it] 70%|███████   | 296/420 [2:20:45<59:14, 28.66s/it] 71%|███████   | 297/420 [2:21:13<58:09, 28.37s/it] 71%|███████   | 298/420 [2:21:42<58:13, 28.63s/it] 71%|███████   | 299/420 [2:22:08<56:00, 27.77s/it] 71%|███████▏  | 300/420 [2:22:41<59:06, 29.55s/it]                                                    71%|███████▏  | 300/420 [2:22:41<59:06, 29.55s/it] 72%|███████▏  | 301/420 [2:23:11<58:39, 29.58s/it] 72%|███████▏  | 302/420 [2:23:39<57:01, 29.00s/it] 72%|███████▏  | 303/420 [2:24:05<54:48, 28.11s/it]{'eval_loss': 1.2842003107070923, 'eval_runtime': 49.9398, 'eval_samples_per_second': 4.866, 'eval_steps_per_second': 1.221, 'epoch': 4.0}
{'loss': 0.5276, 'grad_norm': 0.38789522647857666, 'learning_rate': 0.00015396195726274304, 'epoch': 4.12}
{'loss': 0.4566, 'grad_norm': 0.2793537974357605, 'learning_rate': 0.0001387959707457965, 'epoch': 4.28}
{'loss': 0.4606, 'grad_norm': 0.2764081060886383, 'learning_rate': 0.00012400922025792804, 'epoch': 4.44}
{'loss': 0.4494, 'grad_norm': 0.285722941160202, 'learning_rate': 0.00010969332833782218, 'epoch': 4.61}
{'loss': 0.4591, 'grad_norm': 0.2903258800506592, 'learning_rate': 9.593699996243295e-05, 'epoch': 4.77}
{'loss': 0.4484, 'grad_norm': 0.2783387303352356, 'learning_rate': 8.282547290795509e-05, 'epoch': 4.94}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.30it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.45it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:45<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A                                                   
                                               [A 72%|███████▏  | 303/420 [2:25:14<54:48, 28.11s/it]
100%|██████████| 61/61 [00:49<00:00,  1.46it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 72%|███████▏  | 304/420 [2:25:23<1:23:24, 43.14s/it] 73%|███████▎  | 305/420 [2:25:45<1:10:48, 36.94s/it] 73%|███████▎  | 306/420 [2:26:13<1:05:00, 34.21s/it] 73%|███████▎  | 307/420 [2:26:35<57:22, 30.47s/it]   73%|███████▎  | 308/420 [2:27:07<57:45, 30.94s/it] 74%|███████▎  | 309/420 [2:27:33<54:28, 29.45s/it] 74%|███████▍  | 310/420 [2:28:03<54:33, 29.76s/it]                                                    74%|███████▍  | 310/420 [2:28:03<54:33, 29.76s/it] 74%|███████▍  | 311/420 [2:28:41<58:29, 32.20s/it] 74%|███████▍  | 312/420 [2:29:13<57:34, 31.99s/it] 75%|███████▍  | 313/420 [2:29:47<58:11, 32.63s/it] 75%|███████▍  | 314/420 [2:30:17<56:31, 32.00s/it] 75%|███████▌  | 315/420 [2:30:50<56:20, 32.19s/it] 75%|███████▌  | 316/420 [2:31:22<55:52, 32.23s/it] 75%|███████▌  | 317/420 [2:31:48<52:06, 30.35s/it] 76%|███████▌  | 318/420 [2:32:17<50:55, 29.95s/it] 76%|███████▌  | 319/420 [2:32:44<48:43, 28.95s/it] 76%|███████▌  | 320/420 [2:33:12<47:57, 28.77s/it]                                                    76%|███████▌  | 320/420 [2:33:12<47:57, 28.77s/it] 76%|███████▋  | 321/420 [2:33:34<44:03, 26.70s/it] 77%|███████▋  | 322/420 [2:34:06<45:55, 28.12s/it] 77%|███████▋  | 323/420 [2:34:33<45:16, 28.00s/it] 77%|███████▋  | 324/420 [2:35:02<45:14, 28.28s/it] 77%|███████▋  | 325/420 [2:35:31<45:06, 28.49s/it] 78%|███████▊  | 326/420 [2:35:59<44:21, 28.31s/it] 78%|███████▊  | 327/420 [2:36:23<41:44, 26.93s/it] 78%|███████▊  | 328/420 [2:36:48<40:30, 26.42s/it] 78%|███████▊  | 329/420 [2:37:14<39:48, 26.25s/it] 79%|███████▊  | 330/420 [2:37:39<38:55, 25.94s/it]                                                    79%|███████▊  | 330/420 [2:37:39<38:55, 25.94s/it] 79%|███████▉  | 331/420 [2:38:05<38:23, 25.88s/it] 79%|███████▉  | 332/420 [2:38:31<38:07, 26.00s/it] 79%|███████▉  | 333/420 [2:39:05<41:10, 28.39s/it] 80%|███████▉  | 334/420 [2:39:36<41:39, 29.06s/it] 80%|███████▉  | 335/420 [2:40:04<40:51, 28.84s/it] 80%|████████  | 336/420 [2:40:27<37:48, 27.01s/it] 80%|████████  | 337/420 [2:40:50<35:55, 25.97s/it] 80%|████████  | 338/420 [2:41:21<37:24, 27.38s/it] 81%|████████  | 339/420 [2:41:44<35:03, 25.97s/it] 81%|████████  | 340/420 [2:42:08<34:01, 25.52s/it]                                                    81%|████████  | 340/420 [2:42:08<34:01, 25.52s/it] 81%|████████  | 341/420 [2:42:34<33:36, 25.53s/it] 81%|████████▏ | 342/420 [2:43:04<34:51, 26.82s/it] 82%|████████▏ | 343/420 [2:43:31<34:49, 27.14s/it] 82%|████████▏ | 344/420 [2:44:07<37:43, 29.78s/it] 82%|████████▏ | 345/420 [2:44:31<34:50, 27.87s/it] 82%|████████▏ | 346/420 [2:45:03<35:59, 29.19s/it] 83%|████████▎ | 347/420 [2:45:29<34:15, 28.16s/it] 83%|████████▎ | 348/420 [2:46:04<36:26, 30.36s/it] 83%|████████▎ | 349/420 [2:46:33<35:21, 29.88s/it] 83%|████████▎ | 350/420 [2:47:11<37:47, 32.40s/it]                                                    83%|████████▎ | 350/420 [2:47:11<37:47, 32.40s/it] 84%|████████▎ | 351/420 [2:47:35<34:14, 29.77s/it] 84%|████████▍ | 352/420 [2:47:59<31:53, 28.14s/it] 84%|████████▍ | 353/420 [2:48:26<30:47, 27.58s/it] 84%|████████▍ | 354/420 [2:48:56<31:17, 28.45s/it] 85%|████████▍ | 355/420 [2:49:22<29:53, 27.60s/it] 85%|████████▍ | 356/420 [2:49:54<30:59, 29.05s/it] 85%|████████▌ | 357/420 [2:50:30<32:30, 30.96s/it] 85%|████████▌ | 358/420 [2:51:01<32:07, 31.09s/it] 85%|████████▌ | 359/420 [2:51:24<29:16, 28.79s/it] 86%|████████▌ | 360/420 [2:51:53<28:38, 28.64s/it]                                                    86%|████████▌ | 360/420 [2:51:53<28:38, 28.64s/it] 86%|████████▌ | 361/420 [2:52:27<29:54, 30.41s/it] 86%|████████▌ | 362/420 [2:52:58<29:32, 30.57s/it] 86%|████████▋ | 363/420 [2:53:24<27:43, 29.19s/it] 87%|████████▋ | 364/420 [2:53:56<27:57, 29.96s/it]{'eval_loss': 1.4923981428146362, 'eval_runtime': 49.9441, 'eval_samples_per_second': 4.865, 'eval_steps_per_second': 1.221, 'epoch': 4.99}
{'loss': 0.3703, 'grad_norm': 0.3091667890548706, 'learning_rate': 7.043998959446896e-05, 'epoch': 5.1}
{'loss': 0.342, 'grad_norm': 0.26948994398117065, 'learning_rate': 5.8857293686848646e-05, 'epoch': 5.27}
{'loss': 0.3212, 'grad_norm': 0.2878732979297638, 'learning_rate': 4.81491545711223e-05, 'epoch': 5.43}
{'loss': 0.313, 'grad_norm': 0.2799321711063385, 'learning_rate': 3.838192265275411e-05, 'epoch': 5.6}
{'loss': 0.3262, 'grad_norm': 0.26631608605384827, 'learning_rate': 2.961611823233461e-05, 'epoch': 5.76}
{'loss': 0.317, 'grad_norm': 0.2897348701953888, 'learning_rate': 2.1906056506111083e-05, 'epoch': 5.93}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.41it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.26it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.26it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.30it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A                                                   
                                               [A 87%|████████▋ | 364/420 [2:54:52<27:57, 29.96s/it]
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 87%|████████▋ | 365/420 [2:55:07<38:41, 42.21s/it] 87%|████████▋ | 366/420 [2:55:40<35:32, 39.50s/it] 87%|████████▋ | 367/420 [2:56:09<32:15, 36.52s/it] 88%|████████▊ | 368/420 [2:56:40<30:09, 34.79s/it] 88%|████████▊ | 369/420 [2:57:07<27:38, 32.52s/it] 88%|████████▊ | 370/420 [2:57:36<26:03, 31.27s/it]                                                    88%|████████▊ | 370/420 [2:57:36<26:03, 31.27s/it] 88%|████████▊ | 371/420 [2:58:02<24:16, 29.73s/it] 89%|████████▊ | 372/420 [2:58:32<23:58, 29.96s/it] 89%|████████▉ | 373/420 [2:58:54<21:24, 27.34s/it] 89%|████████▉ | 374/420 [2:59:13<19:08, 24.96s/it] 89%|████████▉ | 375/420 [2:59:36<18:12, 24.29s/it] 90%|████████▉ | 376/420 [2:59:59<17:41, 24.13s/it] 90%|████████▉ | 377/420 [3:00:28<18:09, 25.34s/it] 90%|█████████ | 378/420 [3:00:54<18:01, 25.75s/it] 90%|█████████ | 379/420 [3:01:33<20:18, 29.73s/it] 90%|█████████ | 380/420 [3:02:06<20:20, 30.50s/it]                                                    90%|█████████ | 380/420 [3:02:06<20:20, 30.50s/it] 91%|█████████ | 381/420 [3:02:35<19:39, 30.25s/it] 91%|█████████ | 382/420 [3:03:11<20:12, 31.91s/it] 91%|█████████ | 383/420 [3:03:40<19:08, 31.04s/it] 91%|█████████▏| 384/420 [3:04:03<17:07, 28.53s/it] 92%|█████████▏| 385/420 [3:04:29<16:18, 27.97s/it] 92%|█████████▏| 386/420 [3:05:06<17:17, 30.52s/it] 92%|█████████▏| 387/420 [3:05:34<16:21, 29.74s/it] 92%|█████████▏| 388/420 [3:06:06<16:13, 30.43s/it] 93%|█████████▎| 389/420 [3:06:39<16:04, 31.11s/it] 93%|█████████▎| 390/420 [3:07:06<15:03, 30.11s/it]                                                    93%|█████████▎| 390/420 [3:07:06<15:03, 30.11s/it] 93%|█████████▎| 391/420 [3:07:31<13:41, 28.32s/it] 93%|█████████▎| 392/420 [3:07:58<13:06, 28.09s/it] 94%|█████████▎| 393/420 [3:08:23<12:13, 27.16s/it] 94%|█████████▍| 394/420 [3:08:51<11:48, 27.26s/it] 94%|█████████▍| 395/420 [3:09:20<11:39, 27.97s/it] 94%|█████████▍| 396/420 [3:09:47<11:04, 27.67s/it] 95%|█████████▍| 397/420 [3:10:16<10:47, 28.16s/it] 95%|█████████▍| 398/420 [3:10:42<10:04, 27.46s/it] 95%|█████████▌| 399/420 [3:11:07<09:16, 26.50s/it] 95%|█████████▌| 400/420 [3:11:41<09:39, 28.96s/it]                                                    95%|█████████▌| 400/420 [3:11:41<09:39, 28.96s/it] 95%|█████████▌| 401/420 [3:12:09<09:01, 28.50s/it] 96%|█████████▌| 402/420 [3:12:37<08:30, 28.34s/it] 96%|█████████▌| 403/420 [3:13:03<07:52, 27.81s/it] 96%|█████████▌| 404/420 [3:13:33<07:36, 28.55s/it] 96%|█████████▋| 405/420 [3:14:02<07:06, 28.41s/it] 97%|█████████▋| 406/420 [3:14:25<06:18, 27.04s/it] 97%|█████████▋| 407/420 [3:14:58<06:13, 28.77s/it] 97%|█████████▋| 408/420 [3:15:21<05:25, 27.12s/it] 97%|█████████▋| 409/420 [3:15:55<05:19, 29.07s/it] 98%|█████████▊| 410/420 [3:16:23<04:48, 28.83s/it]                                                    98%|█████████▊| 410/420 [3:16:23<04:48, 28.83s/it] 98%|█████████▊| 411/420 [3:16:48<04:08, 27.63s/it] 98%|█████████▊| 412/420 [3:17:15<03:38, 27.31s/it] 98%|█████████▊| 413/420 [3:17:41<03:09, 27.13s/it] 99%|█████████▊| 414/420 [3:18:09<02:43, 27.24s/it] 99%|█████████▉| 415/420 [3:18:38<02:19, 27.81s/it] 99%|█████████▉| 416/420 [3:19:03<01:48, 27.05s/it] 99%|█████████▉| 417/420 [3:19:34<01:24, 28.18s/it]100%|█████████▉| 418/420 [3:19:57<00:53, 26.58s/it]100%|█████████▉| 419/420 [3:20:19<00:25, 25.12s/it]100%|██████████| 420/420 [3:20:45<00:00, 25.33s/it]                                                   100%|██████████| 420/420 [3:20:45<00:00, 25.33s/it]{'eval_loss': 1.6757667064666748, 'eval_runtime': 49.9835, 'eval_samples_per_second': 4.862, 'eval_steps_per_second': 1.22, 'epoch': 5.99}
{'loss': 0.2986, 'grad_norm': 0.24675306677818298, 'learning_rate': 1.5299511014953904e-05, 'epoch': 6.09}
{'loss': 0.2598, 'grad_norm': 0.29419782757759094, 'learning_rate': 9.837417627114187e-06, 'epoch': 6.26}
{'loss': 0.2664, 'grad_norm': 0.29479193687438965, 'learning_rate': 5.553620888973887e-06, 'epoch': 6.42}
{'loss': 0.2727, 'grad_norm': 0.2599032521247864, 'learning_rate': 2.474664315464126e-06, 'epoch': 6.58}
{'loss': 0.2714, 'grad_norm': 0.2797080874443054, 'learning_rate': 6.196259195665244e-07, 'epoch': 6.75}
{'loss': 0.2619, 'grad_norm': 0.30285370349884033, 'learning_rate': 0.0, 'epoch': 6.91}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:24,  2.42it/s][A
  5%|▍         | 3/61 [00:02<00:43,  1.34it/s][A
  7%|▋         | 4/61 [00:03<00:47,  1.19it/s][A
  8%|▊         | 5/61 [00:03<00:44,  1.27it/s][A
 10%|▉         | 6/61 [00:04<00:42,  1.30it/s][A
 11%|█▏        | 7/61 [00:05<00:51,  1.05it/s][A
 13%|█▎        | 8/61 [00:06<00:48,  1.09it/s][A
 15%|█▍        | 9/61 [00:07<00:40,  1.27it/s][A
 16%|█▋        | 10/61 [00:07<00:39,  1.30it/s][A
 18%|█▊        | 11/61 [00:08<00:38,  1.29it/s][A
 20%|█▉        | 12/61 [00:09<00:38,  1.29it/s][A
 21%|██▏       | 13/61 [00:10<00:37,  1.30it/s][A
 23%|██▎       | 14/61 [00:10<00:33,  1.40it/s][A
 25%|██▍       | 15/61 [00:11<00:34,  1.32it/s][A
 26%|██▌       | 16/61 [00:12<00:34,  1.32it/s][A
 28%|██▊       | 17/61 [00:13<00:33,  1.30it/s][A
 30%|██▉       | 18/61 [00:14<00:34,  1.25it/s][A
 31%|███       | 19/61 [00:14<00:31,  1.33it/s][A
 33%|███▎      | 20/61 [00:15<00:32,  1.25it/s][A
 34%|███▍      | 21/61 [00:16<00:36,  1.10it/s][A
 36%|███▌      | 22/61 [00:17<00:35,  1.11it/s][A
 38%|███▊      | 23/61 [00:18<00:36,  1.03it/s][A
 39%|███▉      | 24/61 [00:19<00:35,  1.04it/s][A
 41%|████      | 25/61 [00:20<00:34,  1.04it/s][A
 43%|████▎     | 26/61 [00:21<00:33,  1.05it/s][A
 44%|████▍     | 27/61 [00:22<00:29,  1.14it/s][A
 46%|████▌     | 28/61 [00:23<00:31,  1.04it/s][A
 48%|████▊     | 29/61 [00:24<00:33,  1.06s/it][A
 49%|████▉     | 30/61 [00:25<00:30,  1.01it/s][A
 51%|█████     | 31/61 [00:26<00:32,  1.07s/it][A
 52%|█████▏    | 32/61 [00:27<00:29,  1.00s/it][A
 54%|█████▍    | 33/61 [00:28<00:27,  1.01it/s][A
 56%|█████▌    | 34/61 [00:29<00:25,  1.04it/s][A
 57%|█████▋    | 35/61 [00:30<00:22,  1.17it/s][A
 59%|█████▉    | 36/61 [00:30<00:19,  1.26it/s][A
 61%|██████    | 37/61 [00:31<00:18,  1.29it/s][A
 62%|██████▏   | 38/61 [00:32<00:18,  1.23it/s][A
 64%|██████▍   | 39/61 [00:33<00:17,  1.27it/s][A
 66%|██████▌   | 40/61 [00:33<00:15,  1.36it/s][A
 67%|██████▋   | 41/61 [00:34<00:15,  1.29it/s][A
 69%|██████▉   | 42/61 [00:35<00:15,  1.21it/s][A
 70%|███████   | 43/61 [00:36<00:14,  1.25it/s][A
 72%|███████▏  | 44/61 [00:37<00:13,  1.29it/s][A
 74%|███████▍  | 45/61 [00:37<00:11,  1.36it/s][A
 75%|███████▌  | 46/61 [00:38<00:10,  1.45it/s][A
 77%|███████▋  | 47/61 [00:38<00:09,  1.50it/s][A
 79%|███████▊  | 48/61 [00:39<00:08,  1.55it/s][A
 80%|████████  | 49/61 [00:40<00:07,  1.60it/s][A
 82%|████████▏ | 50/61 [00:40<00:07,  1.41it/s][A
 84%|████████▎ | 51/61 [00:41<00:07,  1.39it/s][A
 85%|████████▌ | 52/61 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 53/61 [00:43<00:05,  1.44it/s][A
 89%|████████▊ | 54/61 [00:44<00:06,  1.16it/s][A
 90%|█████████ | 55/61 [00:45<00:05,  1.11it/s][A
 92%|█████████▏| 56/61 [00:46<00:04,  1.20it/s][A
 93%|█████████▎| 57/61 [00:46<00:03,  1.33it/s][A
 95%|█████████▌| 58/61 [00:47<00:02,  1.41it/s][A
 97%|█████████▋| 59/61 [00:47<00:01,  1.53it/s][A
 98%|█████████▊| 60/61 [00:48<00:00,  1.50it/s][A
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A                                                   
                                               [A100%|██████████| 420/420 [3:21:35<00:00, 25.33s/it]
100%|██████████| 61/61 [00:49<00:00,  1.45it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                   100%|██████████| 420/420 [3:21:37<00:00, 25.33s/it]100%|██████████| 420/420 [3:21:37<00:00, 28.80s/it]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--microsoft--phi-3/mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 1.7801793813705444, 'eval_runtime': 49.9748, 'eval_samples_per_second': 4.862, 'eval_steps_per_second': 1.221, 'epoch': 6.91}
{'train_runtime': 12118.6325, 'train_samples_per_second': 1.119, 'train_steps_per_second': 0.035, 'train_loss': 0.667517073949178, 'epoch': 6.91}
wandb: - 0.371 MB of 0.371 MB uploadedwandb: \ 0.371 MB of 0.371 MB uploadedwandb: | 0.395 MB of 0.395 MB uploadedwandb: 
wandb: Run history:
wandb:               eval/loss ▁▁▂▃▅▇█
wandb:            eval/runtime ▁▃█▂▃█▇
wandb: eval/samples_per_second █▆▁▇▆▂▂
wandb:   eval/steps_per_second █▄▁▄▄▁▄
wandb:             train/epoch ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       train/global_step ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:         train/grad_norm ▃▁▁▁▁▁▂▁▂▂▂▂▃▃▃▃▃▃▅▅▄▅▅█▅▅▅▆▅▆▅▆▅▅▆▅▆▆▅▆
wandb:     train/learning_rate ▄████████▇▇▇▇▇▆▆▆▆▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁
wandb:              train/loss █▇▇▇▇▆▆▆▆▆▆▆▅▅▅▅▅▅▄▃▃▄▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:                eval/loss 1.78018
wandb:             eval/runtime 49.9748
wandb:  eval/samples_per_second 4.862
wandb:    eval/steps_per_second 1.221
wandb:               total_flos 3.663650723249848e+17
wandb:              train/epoch 6.91358
wandb:        train/global_step 420
wandb:          train/grad_norm 0.30285
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.2619
wandb:               train_loss 0.66752
wandb:            train_runtime 12118.6325
wandb: train_samples_per_second 1.119
wandb:   train_steps_per_second 0.035
wandb: 
wandb: 🚀 View run sft_microsoft--phi-3-mini-4k-instruct_Dialog_lr-0.0004_ep-7_bz-8-acc-4_lora-r-32-ap-64 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/vu2p6a16
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240525_162629-vu2p6a16/logs
