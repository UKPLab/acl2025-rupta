`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:14<00:44, 14.99s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:30<00:30, 15.45s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:44<00:14, 14.71s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 10.72s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 12.30s/it]
`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.42s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:28<00:28, 14.32s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:43<00:14, 14.43s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:47<00:00, 10.50s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:47<00:00, 12.00s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Found max lenth: 8192
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map:  50%|█████     | 1000/1984 [00:00<00:00, 2460.55 examples/s]Map: 100%|██████████| 1984/1984 [00:00<00:00, 4349.55 examples/s]Map: 100%|██████████| 1984/1984 [00:00<00:00, 3832.03 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 9500.94 examples/s]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Parameter 'function'=<bound method DPOTrainer.tokenize_row of <trl.trainer.dpo_trainer.DPOTrainer object at 0x7ffa4ce83100>> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
trainable params: 83886080 || all params: 4624486400 || trainables%: 1.813954518279046
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map:   1%|          | 22/1984 [00:00<00:10, 194.19 examples/s]Map:   2%|▏         | 47/1984 [00:00<00:11, 173.77 examples/s]Map:   4%|▍         | 78/1984 [00:00<00:10, 183.05 examples/s]Map:   5%|▌         | 103/1984 [00:00<00:09, 200.70 examples/s]Map:   7%|▋         | 130/1984 [00:00<00:09, 187.11 examples/s]Map:   8%|▊         | 157/1984 [00:00<00:10, 180.62 examples/s]Map:   9%|▉         | 179/1984 [00:00<00:09, 189.15 examples/s]Map:  10%|█         | 206/1984 [00:01<00:09, 185.06 examples/s]Map:  11%|█▏        | 228/1984 [00:01<00:09, 192.51 examples/s]Map:  13%|█▎        | 259/1984 [00:01<00:08, 194.37 examples/s]Map:  14%|█▍        | 280/1984 [00:01<00:08, 197.16 examples/s]Map:  16%|█▌        | 310/1984 [00:01<00:08, 191.57 examples/s]Map:  17%|█▋        | 333/1984 [00:01<00:08, 198.96 examples/s]Map:  18%|█▊        | 357/1984 [00:01<00:07, 206.36 examples/s]Map:  19%|█▉        | 380/1984 [00:01<00:07, 212.17 examples/s]Map:  20%|██        | 404/1984 [00:02<00:07, 218.45 examples/s]Map:  22%|██▏       | 427/1984 [00:02<00:07, 216.53 examples/s]Map:  23%|██▎       | 449/1984 [00:02<00:07, 213.93 examples/s]Map:  24%|██▍       | 479/1984 [00:02<00:07, 205.93 examples/s]Map:  25%|██▌       | 500/1984 [00:02<00:07, 203.82 examples/s]Map:  26%|██▋       | 522/1984 [00:02<00:07, 205.94 examples/s]Map:  28%|██▊       | 546/1984 [00:02<00:06, 211.52 examples/s]Map:  29%|██▉       | 571/1984 [00:02<00:06, 218.44 examples/s]Map:  30%|██▉       | 595/1984 [00:02<00:06, 219.87 examples/s]Map:  31%|███▏      | 621/1984 [00:03<00:06, 200.75 examples/s]Map:  33%|███▎      | 645/1984 [00:03<00:06, 209.10 examples/s]Map:  34%|███▍      | 672/1984 [00:03<00:06, 195.77 examples/s]Map:  35%|███▌      | 695/1984 [00:03<00:06, 202.42 examples/s]Map:  36%|███▌      | 716/1984 [00:03<00:06, 196.55 examples/s]Map:  37%|███▋      | 736/1984 [00:03<00:06, 193.06 examples/s]Map:  38%|███▊      | 760/1984 [00:03<00:05, 204.47 examples/s]Map:  39%|███▉      | 783/1984 [00:03<00:05, 207.41 examples/s]Map:  41%|████      | 805/1984 [00:04<00:05, 208.60 examples/s]Map:  42%|████▏     | 838/1984 [00:04<00:05, 208.40 examples/s]Map:  44%|████▍     | 868/1984 [00:04<00:05, 201.35 examples/s]Map:  45%|████▌     | 897/1984 [00:04<00:05, 196.30 examples/s]Map:  46%|████▋     | 918/1984 [00:04<00:05, 198.10 examples/s]Map:  48%|████▊     | 943/1984 [00:04<00:04, 209.60 examples/s]Map:  49%|████▉     | 975/1984 [00:04<00:04, 208.60 examples/s]Map:  50%|█████     | 1000/1984 [00:05<00:11, 83.78 examples/s]Map:  52%|█████▏    | 1024/1984 [00:05<00:09, 102.02 examples/s]Map:  53%|█████▎    | 1049/1984 [00:05<00:07, 122.68 examples/s]Map:  54%|█████▍    | 1073/1984 [00:05<00:06, 141.29 examples/s]Map:  56%|█████▌    | 1102/1984 [00:06<00:05, 152.30 examples/s]Map:  57%|█████▋    | 1125/1984 [00:06<00:05, 165.06 examples/s]Map:  58%|█████▊    | 1147/1984 [00:06<00:04, 175.15 examples/s]Map:  59%|█████▉    | 1177/1984 [00:06<00:04, 178.68 examples/s]Map:  60%|██████    | 1199/1984 [00:06<00:04, 185.89 examples/s]Map:  62%|██████▏   | 1229/1984 [00:06<00:04, 188.72 examples/s]Map:  63%|██████▎   | 1252/1984 [00:06<00:03, 195.41 examples/s]Map:  64%|██████▍   | 1273/1984 [00:06<00:03, 197.38 examples/s]Map:  65%|██████▌   | 1297/1984 [00:07<00:03, 201.20 examples/s]Map:  66%|██████▋   | 1318/1984 [00:07<00:03, 200.77 examples/s]Map:  68%|██████▊   | 1342/1984 [00:07<00:03, 208.13 examples/s]Map:  69%|██████▉   | 1365/1984 [00:07<00:03, 183.07 examples/s]Map:  70%|███████   | 1391/1984 [00:07<00:02, 198.83 examples/s]Map:  71%|███████   | 1412/1984 [00:07<00:02, 200.04 examples/s]Map:  72%|███████▏  | 1433/1984 [00:07<00:02, 199.06 examples/s]Map:  74%|███████▎  | 1459/1984 [00:07<00:02, 214.55 examples/s]Map:  75%|███████▌  | 1488/1984 [00:07<00:02, 203.25 examples/s]Map:  76%|███████▌  | 1509/1984 [00:08<00:02, 199.86 examples/s]Map:  77%|███████▋  | 1534/1984 [00:08<00:02, 211.14 examples/s]Map:  79%|███████▉  | 1563/1984 [00:08<00:02, 203.51 examples/s]Map:  80%|████████  | 1590/1984 [00:08<00:02, 192.21 examples/s]Map:  81%|████████▏ | 1614/1984 [00:08<00:01, 199.70 examples/s]Map:  82%|████████▏ | 1636/1984 [00:08<00:01, 203.78 examples/s]Map:  84%|████████▎ | 1658/1984 [00:08<00:01, 205.35 examples/s]Map:  85%|████████▍ | 1683/1984 [00:08<00:01, 214.46 examples/s]Map:  86%|████████▌ | 1707/1984 [00:09<00:01, 216.89 examples/s]Map:  87%|████████▋ | 1732/1984 [00:09<00:01, 223.24 examples/s]Map:  89%|████████▊ | 1756/1984 [00:09<00:01, 195.36 examples/s]Map:  90%|████████▉ | 1778/1984 [00:09<00:01, 199.55 examples/s]Map:  91%|█████████ | 1809/1984 [00:09<00:00, 200.55 examples/s]Map:  93%|█████████▎| 1837/1984 [00:09<00:00, 192.68 examples/s]Map:  94%|█████████▍| 1861/1984 [00:09<00:00, 201.00 examples/s]Map:  95%|█████████▌| 1887/1984 [00:09<00:00, 213.19 examples/s]Map:  96%|█████████▋| 1914/1984 [00:10<00:00, 198.40 examples/s]Map:  98%|█████████▊| 1938/1984 [00:10<00:00, 207.49 examples/s]Map:  99%|█████████▉| 1962/1984 [00:10<00:00, 213.85 examples/s]Map: 100%|██████████| 1984/1984 [00:10<00:00, 84.62 examples/s] Map: 100%|██████████| 1984/1984 [00:10<00:00, 181.07 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map:   8%|▊         | 19/249 [00:00<00:01, 177.55 examples/s]Map:  16%|█▌        | 39/249 [00:00<00:01, 183.92 examples/s]Map:  27%|██▋       | 66/249 [00:00<00:01, 178.62 examples/s]Map:  35%|███▍      | 86/249 [00:00<00:00, 183.09 examples/s]Map:  44%|████▍     | 109/249 [00:00<00:00, 165.53 examples/s]Map:  53%|█████▎    | 132/249 [00:00<00:00, 182.34 examples/s]Map:  62%|██████▏   | 154/249 [00:00<00:00, 187.66 examples/s]Map:  73%|███████▎  | 183/249 [00:00<00:00, 188.81 examples/s]Map:  82%|████████▏ | 204/249 [00:01<00:00, 190.95 examples/s]Map:  91%|█████████ | 227/249 [00:01<00:00, 197.23 examples/s]Map: 100%|█████████▉| 248/249 [00:01<00:00, 199.16 examples/s]Map: 100%|██████████| 249/249 [00:01<00:00, 168.60 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240526_232459-k5rctu5t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dpo_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/k5rctu5t
  0%|          | 0/868 [00:00<?, ?it/s]/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/868 [00:18<4:24:02, 18.27s/it]  0%|          | 2/868 [00:39<4:50:16, 20.11s/it]  0%|          | 3/868 [00:55<4:18:57, 17.96s/it]  0%|          | 4/868 [01:11<4:12:18, 17.52s/it]  1%|          | 5/868 [01:35<4:41:39, 19.58s/it]  1%|          | 6/868 [01:55<4:42:49, 19.69s/it]  1%|          | 7/868 [02:13<4:35:37, 19.21s/it]  1%|          | 8/868 [02:33<4:38:07, 19.40s/it]  1%|          | 9/868 [02:53<4:40:20, 19.58s/it]  1%|          | 10/868 [03:08<4:22:36, 18.36s/it]                                                    1%|          | 10/868 [03:08<4:22:36, 18.36s/it]  1%|▏         | 11/868 [03:24<4:12:42, 17.69s/it]  1%|▏         | 12/868 [03:39<3:58:54, 16.75s/it]  1%|▏         | 13/868 [04:01<4:21:19, 18.34s/it]  2%|▏         | 14/868 [04:23<4:35:03, 19.32s/it]  2%|▏         | 15/868 [04:41<4:31:37, 19.11s/it]  2%|▏         | 16/868 [04:56<4:12:42, 17.80s/it]  2%|▏         | 17/868 [05:12<4:04:58, 17.27s/it]  2%|▏         | 18/868 [05:31<4:12:36, 17.83s/it]  2%|▏         | 19/868 [05:43<3:46:20, 16.00s/it]  2%|▏         | 20/868 [06:02<4:01:08, 17.06s/it]                                                    2%|▏         | 20/868 [06:02<4:01:08, 17.06s/it]  2%|▏         | 21/868 [06:18<3:55:53, 16.71s/it]  3%|▎         | 22/868 [06:33<3:47:54, 16.16s/it]  3%|▎         | 23/868 [06:53<4:04:07, 17.33s/it]  3%|▎         | 24/868 [07:16<4:27:14, 19.00s/it]  3%|▎         | 25/868 [07:30<4:07:22, 17.61s/it]  3%|▎         | 26/868 [07:46<3:57:47, 16.94s/it]  3%|▎         | 27/868 [08:05<4:08:22, 17.72s/it]  3%|▎         | 28/868 [08:20<3:53:12, 16.66s/it]  3%|▎         | 29/868 [08:35<3:48:50, 16.36s/it]  3%|▎         | 30/868 [08:53<3:52:38, 16.66s/it]                                                    3%|▎         | 30/868 [08:53<3:52:38, 16.66s/it]  4%|▎         | 31/868 [09:07<3:43:52, 16.05s/it]  4%|▎         | 32/868 [09:20<3:31:34, 15.18s/it]  4%|▍         | 33/868 [09:41<3:55:12, 16.90s/it]  4%|▍         | 34/868 [10:04<4:17:08, 18.50s/it]  4%|▍         | 35/868 [10:19<4:05:10, 17.66s/it]  4%|▍         | 36/868 [10:39<4:13:35, 18.29s/it]  4%|▍         | 37/868 [11:00<4:26:09, 19.22s/it]  4%|▍         | 38/868 [11:20<4:26:07, 19.24s/it]  4%|▍         | 39/868 [11:38<4:22:19, 18.99s/it]  5%|▍         | 40/868 [11:59<4:32:10, 19.72s/it]                                                    5%|▍         | 40/868 [11:59<4:32:10, 19.72s/it]  5%|▍         | 41/868 [12:21<4:38:58, 20.24s/it]  5%|▍         | 42/868 [12:42<4:41:07, 20.42s/it]  5%|▍         | 43/868 [12:54<4:08:04, 18.04s/it]  5%|▌         | 44/868 [13:13<4:10:53, 18.27s/it]  5%|▌         | 45/868 [13:28<3:55:48, 17.19s/it]  5%|▌         | 46/868 [13:45<3:55:25, 17.18s/it]  5%|▌         | 47/868 [14:01<3:51:22, 16.91s/it]  6%|▌         | 48/868 [14:14<3:33:37, 15.63s/it]  6%|▌         | 49/868 [14:37<4:02:21, 17.76s/it]  6%|▌         | 50/868 [14:56<4:08:53, 18.26s/it]                                                    6%|▌         | 50/868 [14:56<4:08:53, 18.26s/it]  6%|▌         | 51/868 [15:18<4:24:15, 19.41s/it]  6%|▌         | 52/868 [15:41<4:40:21, 20.61s/it]  6%|▌         | 53/868 [15:56<4:16:04, 18.85s/it]  6%|▌         | 54/868 [16:16<4:19:22, 19.12s/it]  6%|▋         | 55/868 [16:37<4:26:03, 19.64s/it]  6%|▋         | 56/868 [16:54<4:14:34, 18.81s/it]  7%|▋         | 57/868 [17:10<4:04:42, 18.10s/it]  7%|▋         | 58/868 [17:25<3:53:08, 17.27s/it]  7%|▋         | 59/868 [17:40<3:41:59, 16.46s/it]  7%|▋         | 60/868 [17:56<3:37:42, 16.17s/it]                                                    7%|▋         | 60/868 [17:56<3:37:42, 16.17s/it]  7%|▋         | 61/868 [18:15<3:50:36, 17.15s/it]  7%|▋         | 62/868 [18:34<3:59:23, 17.82s/it]  7%|▋         | 63/868 [18:55<4:10:34, 18.68s/it]  7%|▋         | 64/868 [19:15<4:16:46, 19.16s/it]  7%|▋         | 65/868 [19:30<3:57:38, 17.76s/it]  8%|▊         | 66/868 [19:50<4:09:00, 18.63s/it]  8%|▊         | 67/868 [20:04<3:49:01, 17.15s/it]  8%|▊         | 68/868 [20:22<3:53:04, 17.48s/it]  8%|▊         | 69/868 [20:42<3:59:58, 18.02s/it]  8%|▊         | 70/868 [20:59<3:56:35, 17.79s/it]                                                    8%|▊         | 70/868 [20:59<3:56:35, 17.79s/it]  8%|▊         | 71/868 [21:18<3:59:49, 18.05s/it]  8%|▊         | 72/868 [21:38<4:09:22, 18.80s/it]  8%|▊         | 73/868 [22:01<4:23:18, 19.87s/it]  9%|▊         | 74/868 [22:16<4:05:47, 18.57s/it]  9%|▊         | 75/868 [22:35<4:08:16, 18.78s/it]  9%|▉         | 76/868 [22:51<3:55:55, 17.87s/it]  9%|▉         | 77/868 [23:04<3:35:02, 16.31s/it]  9%|▉         | 78/868 [23:28<4:05:20, 18.63s/it]  9%|▉         | 79/868 [23:42<3:46:28, 17.22s/it]  9%|▉         | 80/868 [23:59<3:46:10, 17.22s/it]                                                    9%|▉         | 80/868 [23:59<3:46:10, 17.22s/it]  9%|▉         | 81/868 [24:14<3:35:40, 16.44s/it]  9%|▉         | 82/868 [24:30<3:34:27, 16.37s/it] 10%|▉         | 83/868 [24:47<3:38:55, 16.73s/it] 10%|▉         | 84/868 [25:01<3:27:43, 15.90s/it] 10%|▉         | 85/868 [25:22<3:46:42, 17.37s/it] 10%|▉         | 86/868 [25:42<3:56:25, 18.14s/it] 10%|█         | 87/868 [25:56<3:40:41, 16.95s/it] 10%|█         | 88/868 [26:11<3:31:49, 16.29s/it] 10%|█         | 89/868 [26:28<3:34:31, 16.52s/it] 10%|█         | 90/868 [26:44<3:31:56, 16.35s/it]                                                   10%|█         | 90/868 [26:44<3:31:56, 16.35s/it] 10%|█         | 91/868 [27:01<3:33:25, 16.48s/it] 11%|█         | 92/868 [27:24<3:58:08, 18.41s/it] 11%|█         | 93/868 [27:41<3:51:34, 17.93s/it] 11%|█         | 94/868 [28:02<4:06:22, 19.10s/it] 11%|█         | 95/868 [28:27<4:29:22, 20.91s/it] 11%|█         | 96/868 [28:46<4:18:30, 20.09s/it] 11%|█         | 97/868 [29:06<4:18:09, 20.09s/it] 11%|█▏        | 98/868 [29:22<4:04:34, 19.06s/it] 11%|█▏        | 99/868 [29:40<4:00:10, 18.74s/it] 12%|█▏        | 100/868 [30:00<4:02:56, 18.98s/it]                                                    12%|█▏        | 100/868 [30:00<4:02:56, 18.98s/it] 12%|█▏        | 101/868 [30:19<4:03:16, 19.03s/it] 12%|█▏        | 102/868 [30:48<4:42:33, 22.13s/it] 12%|█▏        | 103/868 [31:06<4:23:20, 20.65s/it] 12%|█▏        | 104/868 [31:23<4:11:58, 19.79s/it] 12%|█▏        | 105/868 [31:45<4:19:27, 20.40s/it] 12%|█▏        | 106/868 [32:07<4:24:34, 20.83s/it] 12%|█▏        | 107/868 [32:22<4:01:26, 19.04s/it] 12%|█▏        | 108/868 [32:43<4:09:47, 19.72s/it] 13%|█▎        | 109/868 [33:11<4:38:21, 22.00s/it] 13%|█▎        | 110/868 [33:32<4:34:17, 21.71s/it]                                                    13%|█▎        | 110/868 [33:32<4:34:17, 21.71s/it] 13%|█▎        | 111/868 [33:57<4:49:39, 22.96s/it] 13%|█▎        | 112/868 [34:11<4:12:02, 20.00s/it] 13%|█▎        | 113/868 [34:27<3:58:42, 18.97s/it] 13%|█▎        | 114/868 [34:42<3:44:21, 17.85s/it] 13%|█▎        | 115/868 [34:58<3:37:21, 17.32s/it] 13%|█▎        | 116/868 [35:19<3:48:03, 18.20s/it] 13%|█▎        | 117/868 [35:33<3:34:07, 17.11s/it] 14%|█▎        | 118/868 [35:55<3:52:52, 18.63s/it] 14%|█▎        | 119/868 [36:13<3:47:18, 18.21s/it] 14%|█▍        | 120/868 [36:26<3:26:52, 16.59s/it]                                                    14%|█▍        | 120/868 [36:26<3:26:52, 16.59s/it] 14%|█▍        | 121/868 [36:43<3:28:35, 16.75s/it] 14%|█▍        | 122/868 [36:56<3:15:54, 15.76s/it] 14%|█▍        | 123/868 [37:13<3:18:28, 15.98s/it] 14%|█▍        | 124/868 [37:36<3:44:18, 18.09s/it]{'loss': 0.5413, 'grad_norm': 9.812716484069824, 'learning_rate': 2.272727272727273e-05, 'rewards/chosen': -0.06476287543773651, 'rewards/rejected': -0.6386204361915588, 'rewards/accuracies': 0.737500011920929, 'rewards/margins': 0.5738574862480164, 'logps/rejected': -243.55917358398438, 'logps/chosen': -156.68655395507812, 'logits/rejected': -0.8937848806381226, 'logits/chosen': -0.8515334129333496, 'epoch': 0.08}
{'loss': 0.2186, 'grad_norm': 5.077459335327148, 'learning_rate': 4.545454545454546e-05, 'rewards/chosen': -2.711383104324341, 'rewards/rejected': -8.349027633666992, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 5.6376447677612305, 'logps/rejected': -308.79547119140625, 'logps/chosen': -179.2078094482422, 'logits/rejected': -0.8166090250015259, 'logits/chosen': -0.7810668349266052, 'epoch': 0.16}
{'loss': 0.2192, 'grad_norm': 10.499748229980469, 'learning_rate': 6.818181818181818e-05, 'rewards/chosen': -10.481515884399414, 'rewards/rejected': -21.33859634399414, 'rewards/accuracies': 0.84375, 'rewards/margins': 10.85707950592041, 'logps/rejected': -425.0089416503906, 'logps/chosen': -250.35513305664062, 'logits/rejected': -0.6755364537239075, 'logits/chosen': -0.6450647711753845, 'epoch': 0.24}
{'loss': 0.1104, 'grad_norm': 12.642314910888672, 'learning_rate': 9.090909090909092e-05, 'rewards/chosen': -11.643424987792969, 'rewards/rejected': -26.502483367919922, 'rewards/accuracies': 0.925000011920929, 'rewards/margins': 14.85905933380127, 'logps/rejected': -489.571044921875, 'logps/chosen': -264.64080810546875, 'logits/rejected': -0.535589873790741, 'logits/chosen': -0.5000613331794739, 'epoch': 0.32}
{'loss': 0.1219, 'grad_norm': 0.4712991416454315, 'learning_rate': 9.998691815820732e-05, 'rewards/chosen': -18.42909049987793, 'rewards/rejected': -33.19430923461914, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 14.765215873718262, 'logps/rejected': -547.9411010742188, 'logps/chosen': -335.829345703125, 'logits/rejected': -0.46664175391197205, 'logits/chosen': -0.44158950448036194, 'epoch': 0.4}
{'loss': 0.4462, 'grad_norm': 31.32221031188965, 'learning_rate': 9.990699835799469e-05, 'rewards/chosen': -37.391841888427734, 'rewards/rejected': -59.4483757019043, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 22.056529998779297, 'logps/rejected': -826.4685668945312, 'logps/chosen': -530.2176513671875, 'logits/rejected': -0.26180869340896606, 'logits/chosen': -0.25030454993247986, 'epoch': 0.48}
{'loss': 0.1251, 'grad_norm': 9.196637153625488, 'learning_rate': 9.975454246405311e-05, 'rewards/chosen': -18.72636604309082, 'rewards/rejected': -37.692047119140625, 'rewards/accuracies': 0.925000011920929, 'rewards/margins': 18.965682983398438, 'logps/rejected': -607.0509033203125, 'logps/chosen': -339.92193603515625, 'logits/rejected': -0.6281259059906006, 'logits/chosen': -0.6145966053009033, 'epoch': 0.56}
{'loss': 0.1393, 'grad_norm': 28.953441619873047, 'learning_rate': 9.952977205963496e-05, 'rewards/chosen': -26.001300811767578, 'rewards/rejected': -44.6859130859375, 'rewards/accuracies': 0.918749988079071, 'rewards/margins': 18.684614181518555, 'logps/rejected': -679.486328125, 'logps/chosen': -411.96527099609375, 'logits/rejected': -0.45969653129577637, 'logits/chosen': -0.44885730743408203, 'epoch': 0.65}
{'loss': 0.114, 'grad_norm': 2.4512441158294678, 'learning_rate': 9.923301383173117e-05, 'rewards/chosen': -42.173118591308594, 'rewards/rejected': -64.94315338134766, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 22.770029067993164, 'logps/rejected': -865.5086059570312, 'logps/chosen': -572.3551635742188, 'logits/rejected': -0.2522163987159729, 'logits/chosen': -0.2544555068016052, 'epoch': 0.73}
{'loss': 0.1027, 'grad_norm': 0.7504292726516724, 'learning_rate': 9.886469909625625e-05, 'rewards/chosen': -95.84490203857422, 'rewards/rejected': -132.76516723632812, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 36.92026138305664, 'logps/rejected': -1557.4019775390625, 'logps/chosen': -1116.316650390625, 'logits/rejected': 0.014242114499211311, 'logits/chosen': 0.016106881201267242, 'epoch': 0.81}
{'loss': 0.5693, 'grad_norm': 2.6030497550964355, 'learning_rate': 9.842536317116261e-05, 'rewards/chosen': -65.10643005371094, 'rewards/rejected': -89.79243469238281, 'rewards/accuracies': 0.9125000238418579, 'rewards/margins': 24.68600082397461, 'logps/rejected': -1132.4349365234375, 'logps/chosen': -810.8865966796875, 'logits/rejected': -0.05804365873336792, 'logits/chosen': -0.05982404947280884, 'epoch': 0.89}
{'loss': 0.0781, 'grad_norm': 8.84620475769043, 'learning_rate': 9.791564459839608e-05, 'rewards/chosen': -36.15694808959961, 'rewards/rejected': -55.03209686279297, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 18.87515640258789, 'logps/rejected': -764.8870849609375, 'logps/chosen': -509.901123046875, 'logits/rejected': -0.10801074653863907, 'logits/chosen': -0.12088757753372192, 'epoch': 0.97}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:41,  1.46it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.18s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.55s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.04s/it][A
 11%|█         | 7/63 [00:11<01:54,  2.04s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.98s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  1.99s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.93s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:18,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:34<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:19,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:20,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.28s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.46s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.64s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.40s/it][A
 60%|██████    | 38/63 [01:06<00:36,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:11<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.70s/it][A
 68%|██████▊   | 43/63 [01:15<00:32,  1.63s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.50s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:21,  1.37s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.50s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:33<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.42s/it][A
 92%|█████████▏| 58/63 [01:36<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.36s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.33s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                   
                                               [A 14%|█▍        | 124/868 [39:20<3:44:18, 18.09s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 14%|█▍        | 125/868 [39:40<10:20:35, 50.12s/it] 15%|█▍        | 126/868 [40:01<8:30:05, 41.25s/it]  15%|█▍        | 127/868 [40:15<6:48:31, 33.08s/it] 15%|█▍        | 128/868 [40:37<6:07:14, 29.78s/it] 15%|█▍        | 129/868 [40:53<5:14:12, 25.51s/it] 15%|█▍        | 130/868 [41:12<4:49:38, 23.55s/it]                                                    15%|█▍        | 130/868 [41:12<4:49:38, 23.55s/it] 15%|█▌        | 131/868 [41:30<4:31:16, 22.09s/it] 15%|█▌        | 132/868 [41:44<3:59:52, 19.56s/it] 15%|█▌        | 133/868 [42:01<3:49:00, 18.70s/it] 15%|█▌        | 134/868 [42:15<3:34:34, 17.54s/it] 16%|█▌        | 135/868 [42:35<3:43:15, 18.28s/it] 16%|█▌        | 136/868 [42:51<3:34:44, 17.60s/it] 16%|█▌        | 137/868 [43:10<3:38:00, 17.89s/it] 16%|█▌        | 138/868 [43:31<3:48:17, 18.76s/it] 16%|█▌        | 139/868 [43:52<3:56:37, 19.48s/it] 16%|█▌        | 140/868 [44:07<3:39:11, 18.06s/it]                                                    16%|█▌        | 140/868 [44:07<3:39:11, 18.06s/it] 16%|█▌        | 141/868 [44:22<3:27:57, 17.16s/it] 16%|█▋        | 142/868 [44:45<3:48:37, 18.89s/it] 16%|█▋        | 143/868 [45:06<3:56:50, 19.60s/it] 17%|█▋        | 144/868 [45:24<3:49:33, 19.02s/it] 17%|█▋        | 145/868 [45:41<3:43:49, 18.57s/it] 17%|█▋        | 146/868 [45:58<3:38:29, 18.16s/it] 17%|█▋        | 147/868 [46:17<3:39:25, 18.26s/it] 17%|█▋        | 148/868 [46:34<3:35:36, 17.97s/it] 17%|█▋        | 149/868 [46:51<3:32:30, 17.73s/it] 17%|█▋        | 150/868 [47:08<3:27:52, 17.37s/it]                                                    17%|█▋        | 150/868 [47:08<3:27:52, 17.37s/it] 17%|█▋        | 151/868 [47:30<3:44:21, 18.78s/it] 18%|█▊        | 152/868 [47:45<3:30:44, 17.66s/it] 18%|█▊        | 153/868 [48:02<3:26:28, 17.33s/it] 18%|█▊        | 154/868 [48:17<3:19:59, 16.81s/it] 18%|█▊        | 155/868 [48:39<3:38:12, 18.36s/it] 18%|█▊        | 156/868 [48:59<3:42:35, 18.76s/it] 18%|█▊        | 157/868 [49:17<3:41:20, 18.68s/it] 18%|█▊        | 158/868 [49:33<3:30:36, 17.80s/it] 18%|█▊        | 159/868 [49:47<3:15:59, 16.59s/it] 18%|█▊        | 160/868 [50:02<3:12:12, 16.29s/it]                                                    18%|█▊        | 160/868 [50:02<3:12:12, 16.29s/it] 19%|█▊        | 161/868 [50:28<3:44:46, 19.08s/it] 19%|█▊        | 162/868 [50:49<3:51:32, 19.68s/it] 19%|█▉        | 163/868 [51:04<3:32:50, 18.11s/it] 19%|█▉        | 164/868 [51:26<3:48:51, 19.50s/it] 19%|█▉        | 165/868 [51:41<3:31:14, 18.03s/it] 19%|█▉        | 166/868 [52:02<3:41:41, 18.95s/it] 19%|█▉        | 167/868 [52:17<3:26:41, 17.69s/it] 19%|█▉        | 168/868 [52:34<3:24:35, 17.54s/it] 19%|█▉        | 169/868 [52:50<3:17:36, 16.96s/it] 20%|█▉        | 170/868 [53:08<3:21:14, 17.30s/it]                                                    20%|█▉        | 170/868 [53:08<3:21:14, 17.30s/it] 20%|█▉        | 171/868 [53:30<3:38:25, 18.80s/it] 20%|█▉        | 172/868 [53:47<3:31:46, 18.26s/it] 20%|█▉        | 173/868 [54:02<3:19:12, 17.20s/it] 20%|██        | 174/868 [54:19<3:18:28, 17.16s/it] 20%|██        | 175/868 [54:35<3:15:25, 16.92s/it] 20%|██        | 176/868 [54:54<3:20:51, 17.42s/it] 20%|██        | 177/868 [55:09<3:14:18, 16.87s/it] 21%|██        | 178/868 [55:32<3:36:00, 18.78s/it] 21%|██        | 179/868 [55:48<3:23:51, 17.75s/it] 21%|██        | 180/868 [56:02<3:10:41, 16.63s/it]                                                    21%|██        | 180/868 [56:02<3:10:41, 16.63s/it] 21%|██        | 181/868 [56:16<3:01:45, 15.87s/it] 21%|██        | 182/868 [56:37<3:19:31, 17.45s/it] 21%|██        | 183/868 [57:02<3:43:49, 19.61s/it] 21%|██        | 184/868 [57:25<3:56:00, 20.70s/it] 21%|██▏       | 185/868 [57:50<4:09:31, 21.92s/it] 21%|██▏       | 186/868 [58:04<3:44:40, 19.77s/it] 22%|██▏       | 187/868 [58:21<3:34:20, 18.88s/it] 22%|██▏       | 188/868 [58:38<3:25:28, 18.13s/it] 22%|██▏       | 189/868 [59:00<3:40:13, 19.46s/it] 22%|██▏       | 190/868 [59:19<3:36:25, 19.15s/it]                                                    22%|██▏       | 190/868 [59:19<3:36:25, 19.15s/it] 22%|██▏       | 191/868 [59:37<3:31:47, 18.77s/it] 22%|██▏       | 192/868 [1:00:01<3:50:20, 20.44s/it] 22%|██▏       | 193/868 [1:00:19<3:42:01, 19.74s/it] 22%|██▏       | 194/868 [1:00:34<3:25:44, 18.31s/it] 22%|██▏       | 195/868 [1:00:57<3:40:21, 19.65s/it] 23%|██▎       | 196/868 [1:01:13<3:27:01, 18.49s/it] 23%|██▎       | 197/868 [1:01:34<3:37:09, 19.42s/it] 23%|██▎       | 198/868 [1:01:52<3:32:15, 19.01s/it] 23%|██▎       | 199/868 [1:02:16<3:46:42, 20.33s/it] 23%|██▎       | 200/868 [1:02:34<3:41:23, 19.88s/it]                                                      23%|██▎       | 200/868 [1:02:34<3:41:23, 19.88s/it] 23%|██▎       | 201/868 [1:02:55<3:43:37, 20.12s/it] 23%|██▎       | 202/868 [1:03:19<3:55:49, 21.25s/it] 23%|██▎       | 203/868 [1:03:38<3:46:39, 20.45s/it] 24%|██▎       | 204/868 [1:03:52<3:28:01, 18.80s/it] 24%|██▎       | 205/868 [1:04:17<3:45:31, 20.41s/it] 24%|██▎       | 206/868 [1:04:31<3:26:04, 18.68s/it] 24%|██▍       | 207/868 [1:04:45<3:10:58, 17.33s/it] 24%|██▍       | 208/868 [1:05:02<3:07:40, 17.06s/it] 24%|██▍       | 209/868 [1:05:17<3:00:20, 16.42s/it] 24%|██▍       | 210/868 [1:05:37<3:12:49, 17.58s/it]                                                      24%|██▍       | 210/868 [1:05:37<3:12:49, 17.58s/it] 24%|██▍       | 211/868 [1:05:53<3:06:58, 17.08s/it] 24%|██▍       | 212/868 [1:06:11<3:09:03, 17.29s/it] 25%|██▍       | 213/868 [1:06:27<3:05:03, 16.95s/it] 25%|██▍       | 214/868 [1:06:42<2:58:53, 16.41s/it] 25%|██▍       | 215/868 [1:06:59<2:59:04, 16.45s/it] 25%|██▍       | 216/868 [1:07:15<2:59:30, 16.52s/it] 25%|██▌       | 217/868 [1:07:34<3:07:42, 17.30s/it] 25%|██▌       | 218/868 [1:07:54<3:16:05, 18.10s/it] 25%|██▌       | 219/868 [1:08:12<3:13:41, 17.91s/it] 25%|██▌       | 220/868 [1:08:39<3:43:17, 20.67s/it]                                                      25%|██▌       | 220/868 [1:08:39<3:43:17, 20.67s/it] 25%|██▌       | 221/868 [1:09:01<3:45:37, 20.92s/it] 26%|██▌       | 222/868 [1:09:14<3:22:14, 18.78s/it] 26%|██▌       | 223/868 [1:09:30<3:10:40, 17.74s/it] 26%|██▌       | 224/868 [1:09:45<3:03:21, 17.08s/it] 26%|██▌       | 225/868 [1:10:02<3:01:55, 16.98s/it] 26%|██▌       | 226/868 [1:10:19<3:01:09, 16.93s/it] 26%|██▌       | 227/868 [1:10:37<3:05:07, 17.33s/it] 26%|██▋       | 228/868 [1:10:56<3:09:34, 17.77s/it] 26%|██▋       | 229/868 [1:11:16<3:16:31, 18.45s/it] 26%|██▋       | 230/868 [1:11:31<3:04:49, 17.38s/it]                                                      26%|██▋       | 230/868 [1:11:31<3:04:49, 17.38s/it] 27%|██▋       | 231/868 [1:11:54<3:22:49, 19.10s/it] 27%|██▋       | 232/868 [1:12:17<3:33:48, 20.17s/it] 27%|██▋       | 233/868 [1:12:34<3:24:54, 19.36s/it] 27%|██▋       | 234/868 [1:12:51<3:16:16, 18.58s/it] 27%|██▋       | 235/868 [1:13:13<3:27:31, 19.67s/it] 27%|██▋       | 236/868 [1:13:29<3:16:20, 18.64s/it] 27%|██▋       | 237/868 [1:13:50<3:21:59, 19.21s/it] 27%|██▋       | 238/868 [1:14:06<3:12:16, 18.31s/it] 28%|██▊       | 239/868 [1:14:21<3:01:48, 17.34s/it] 28%|██▊       | 240/868 [1:14:38<2:59:49, 17.18s/it]                                                      28%|██▊       | 240/868 [1:14:38<2:59:49, 17.18s/it] 28%|██▊       | 241/868 [1:14:56<3:01:59, 17.42s/it] 28%|██▊       | 242/868 [1:15:14<3:04:27, 17.68s/it] 28%|██▊       | 243/868 [1:15:34<3:11:28, 18.38s/it] 28%|██▊       | 244/868 [1:15:50<3:02:20, 17.53s/it] 28%|██▊       | 245/868 [1:16:08<3:06:01, 17.92s/it] 28%|██▊       | 246/868 [1:16:23<2:55:58, 16.98s/it] 28%|██▊       | 247/868 [1:16:38<2:47:32, 16.19s/it] 29%|██▊       | 248/868 [1:16:53<2:44:07, 15.88s/it]{'eval_loss': 1.7160323858261108, 'eval_runtime': 104.4817, 'eval_samples_per_second': 2.383, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -89.67500305175781, 'eval_rewards/rejected': -107.1360092163086, 'eval_rewards/accuracies': 0.7142857313156128, 'eval_rewards/margins': 17.461008071899414, 'eval_logps/rejected': -1403.8714599609375, 'eval_logps/chosen': -1326.549072265625, 'eval_logits/rejected': -0.2255806028842926, 'eval_logits/chosen': -0.25479206442832947, 'epoch': 1.0}
{'loss': 0.1869, 'grad_norm': 0.10449030995368958, 'learning_rate': 9.73362842158228e-05, 'rewards/chosen': -58.58101272583008, 'rewards/rejected': -97.17410278320312, 'rewards/accuracies': 0.9375, 'rewards/margins': 38.593101501464844, 'logps/rejected': -1211.2105712890625, 'logps/chosen': -743.8192138671875, 'logits/rejected': 0.061973936855793, 'logits/chosen': 0.040414098650217056, 'epoch': 1.05}
{'loss': 0.0588, 'grad_norm': 4.676255226135254, 'learning_rate': 9.668812408047679e-05, 'rewards/chosen': -93.051513671875, 'rewards/rejected': -141.43368530273438, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 48.38218688964844, 'logps/rejected': -1631.4752197265625, 'logps/chosen': -1081.6263427734375, 'logits/rejected': 0.008340030908584595, 'logits/chosen': -0.006710720248520374, 'epoch': 1.13}
{'loss': 0.1242, 'grad_norm': 0.12099964916706085, 'learning_rate': 9.597210624469288e-05, 'rewards/chosen': -73.88616180419922, 'rewards/rejected': -114.0447998046875, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 40.15862274169922, 'logps/rejected': -1367.479736328125, 'logps/chosen': -892.4820556640625, 'logits/rejected': -0.08678779006004333, 'logits/chosen': -0.08751078695058823, 'epoch': 1.21}
{'loss': 0.392, 'grad_norm': 1.4408200979232788, 'learning_rate': 9.51892713869041e-05, 'rewards/chosen': -40.324012756347656, 'rewards/rejected': -76.34315490722656, 'rewards/accuracies': 0.9375, 'rewards/margins': 36.019142150878906, 'logps/rejected': -979.0013427734375, 'logps/chosen': -550.208984375, 'logits/rejected': -0.19312931597232819, 'logits/chosen': -0.21080198884010315, 'epoch': 1.29}
{'loss': 0.0392, 'grad_norm': 1.2776970863342285, 'learning_rate': 9.434075729909329e-05, 'rewards/chosen': -68.2629165649414, 'rewards/rejected': -105.90950775146484, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 37.6466064453125, 'logps/rejected': -1290.3720703125, 'logps/chosen': -838.7316284179688, 'logits/rejected': 0.07048647105693817, 'logits/chosen': 0.08327498286962509, 'epoch': 1.37}
{'loss': 0.0675, 'grad_norm': 5.010801792144775, 'learning_rate': 9.342779723309745e-05, 'rewards/chosen': -74.19447326660156, 'rewards/rejected': -110.41618347167969, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 36.22172164916992, 'logps/rejected': -1327.444091796875, 'logps/chosen': -894.8450927734375, 'logits/rejected': -0.014184740372002125, 'logits/chosen': 0.007198126520961523, 'epoch': 1.45}
{'loss': 0.0345, 'grad_norm': 0.8839150071144104, 'learning_rate': 9.245171810816829e-05, 'rewards/chosen': -64.99880981445312, 'rewards/rejected': -106.9817123413086, 'rewards/accuracies': 0.96875, 'rewards/margins': 41.982906341552734, 'logps/rejected': -1298.574951171875, 'logps/chosen': -802.8173828125, 'logits/rejected': -0.2068186104297638, 'logits/chosen': -0.16833128035068512, 'epoch': 1.53}
{'loss': 0.261, 'grad_norm': 0.41300100088119507, 'learning_rate': 9.141393858239434e-05, 'rewards/chosen': -76.88771057128906, 'rewards/rejected': -137.3357391357422, 'rewards/accuracies': 0.9375, 'rewards/margins': 60.448020935058594, 'logps/rejected': -1601.056396484375, 'logps/chosen': -924.0703125, 'logits/rejected': -0.2083594799041748, 'logits/chosen': -0.19397155940532684, 'epoch': 1.61}
{'loss': 0.0399, 'grad_norm': 5.250555992126465, 'learning_rate': 9.031596699078725e-05, 'rewards/chosen': -87.23042297363281, 'rewards/rejected': -141.1089630126953, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 53.8785400390625, 'logps/rejected': -1631.399169921875, 'logps/chosen': -1023.3045654296875, 'logits/rejected': -0.26463884115219116, 'logits/chosen': -0.23570212721824646, 'epoch': 1.69}
{'loss': 0.0199, 'grad_norm': 1.4115782976150513, 'learning_rate': 8.915939915302968e-05, 'rewards/chosen': -105.2865982055664, 'rewards/rejected': -149.8071746826172, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 44.52058029174805, 'logps/rejected': -1731.067138671875, 'logps/chosen': -1205.6986083984375, 'logits/rejected': -0.11913058906793594, 'logits/chosen': -0.09941529482603073, 'epoch': 1.77}
{'loss': 0.0544, 'grad_norm': 4.687490940093994, 'learning_rate': 8.794591605407048e-05, 'rewards/chosen': -73.51614379882812, 'rewards/rejected': -111.50276947021484, 'rewards/accuracies': 0.9375, 'rewards/margins': 37.98662567138672, 'logps/rejected': -1340.882080078125, 'logps/chosen': -887.1384887695312, 'logits/rejected': -0.17119035124778748, 'logits/chosen': -0.12762503325939178, 'epoch': 1.85}
{'loss': 0.093, 'grad_norm': 4.125888824462891, 'learning_rate': 8.667728140093876e-05, 'rewards/chosen': -76.88981628417969, 'rewards/rejected': -117.58302307128906, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 40.69319534301758, 'logps/rejected': -1398.716552734375, 'logps/chosen': -918.9600830078125, 'logits/rejected': -0.005174749530851841, 'logits/chosen': 0.02815689705312252, 'epoch': 1.94}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:41,  1.46it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.17s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.55s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.04s/it][A
 11%|█         | 7/63 [00:11<01:53,  2.04s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.98s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  1.99s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.93s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:17,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:33<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:18,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:19,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.28s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.47s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.63s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.40s/it][A
 60%|██████    | 38/63 [01:06<00:36,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:11<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.70s/it][A
 68%|██████▊   | 43/63 [01:14<00:32,  1.62s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.49s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:21,  1.37s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.50s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:33<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.42s/it][A
 92%|█████████▏| 58/63 [01:36<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.36s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.33s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                     
                                               [A 29%|██▊       | 248/868 [1:18:37<2:44:07, 15.88s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 29%|██▊       | 249/868 [1:18:59<8:26:27, 49.09s/it] 29%|██▉       | 250/868 [1:19:16<6:44:45, 39.30s/it]                                                      29%|██▉       | 250/868 [1:19:16<6:44:45, 39.30s/it] 29%|██▉       | 251/868 [1:19:34<5:39:43, 33.04s/it] 29%|██▉       | 252/868 [1:19:53<4:54:38, 28.70s/it] 29%|██▉       | 253/868 [1:20:09<4:16:52, 25.06s/it] 29%|██▉       | 254/868 [1:20:28<3:58:08, 23.27s/it] 29%|██▉       | 255/868 [1:20:45<3:36:27, 21.19s/it] 29%|██▉       | 256/868 [1:21:02<3:23:54, 19.99s/it] 30%|██▉       | 257/868 [1:21:27<3:37:57, 21.40s/it] 30%|██▉       | 258/868 [1:21:42<3:18:32, 19.53s/it] 30%|██▉       | 259/868 [1:21:58<3:09:06, 18.63s/it] 30%|██▉       | 260/868 [1:22:19<3:16:17, 19.37s/it]                                                      30%|██▉       | 260/868 [1:22:19<3:16:17, 19.37s/it] 30%|███       | 261/868 [1:22:37<3:09:34, 18.74s/it] 30%|███       | 262/868 [1:22:57<3:12:55, 19.10s/it] 30%|███       | 263/868 [1:23:10<2:54:34, 17.31s/it] 30%|███       | 264/868 [1:23:28<2:56:04, 17.49s/it] 31%|███       | 265/868 [1:23:48<3:02:42, 18.18s/it] 31%|███       | 266/868 [1:24:09<3:13:26, 19.28s/it] 31%|███       | 267/868 [1:24:30<3:17:02, 19.67s/it] 31%|███       | 268/868 [1:24:48<3:10:49, 19.08s/it] 31%|███       | 269/868 [1:25:11<3:24:16, 20.46s/it] 31%|███       | 270/868 [1:25:30<3:18:44, 19.94s/it]                                                      31%|███       | 270/868 [1:25:30<3:18:44, 19.94s/it] 31%|███       | 271/868 [1:25:43<2:58:53, 17.98s/it] 31%|███▏      | 272/868 [1:26:06<3:12:10, 19.35s/it] 31%|███▏      | 273/868 [1:26:22<3:02:51, 18.44s/it] 32%|███▏      | 274/868 [1:26:42<3:06:04, 18.80s/it] 32%|███▏      | 275/868 [1:27:02<3:08:32, 19.08s/it] 32%|███▏      | 276/868 [1:27:21<3:08:05, 19.06s/it] 32%|███▏      | 277/868 [1:27:42<3:13:18, 19.62s/it] 32%|███▏      | 278/868 [1:27:57<2:59:37, 18.27s/it] 32%|███▏      | 279/868 [1:28:12<2:49:37, 17.28s/it] 32%|███▏      | 280/868 [1:28:28<2:46:41, 17.01s/it]                                                      32%|███▏      | 280/868 [1:28:28<2:46:41, 17.01s/it] 32%|███▏      | 281/868 [1:28:47<2:51:46, 17.56s/it] 32%|███▏      | 282/868 [1:29:09<3:05:20, 18.98s/it] 33%|███▎      | 283/868 [1:29:27<3:01:22, 18.60s/it] 33%|███▎      | 284/868 [1:29:43<2:54:27, 17.92s/it] 33%|███▎      | 285/868 [1:30:06<3:07:07, 19.26s/it] 33%|███▎      | 286/868 [1:30:26<3:10:19, 19.62s/it] 33%|███▎      | 287/868 [1:30:46<3:10:29, 19.67s/it] 33%|███▎      | 288/868 [1:31:00<2:55:22, 18.14s/it] 33%|███▎      | 289/868 [1:31:14<2:42:28, 16.84s/it] 33%|███▎      | 290/868 [1:31:31<2:41:03, 16.72s/it]                                                      33%|███▎      | 290/868 [1:31:31<2:41:03, 16.72s/it] 34%|███▎      | 291/868 [1:31:50<2:48:31, 17.52s/it] 34%|███▎      | 292/868 [1:32:14<3:07:43, 19.55s/it] 34%|███▍      | 293/868 [1:32:35<3:10:01, 19.83s/it] 34%|███▍      | 294/868 [1:32:52<3:03:18, 19.16s/it] 34%|███▍      | 295/868 [1:33:09<2:53:59, 18.22s/it] 34%|███▍      | 296/868 [1:33:27<2:55:40, 18.43s/it] 34%|███▍      | 297/868 [1:33:44<2:51:11, 17.99s/it] 34%|███▍      | 298/868 [1:33:57<2:36:24, 16.46s/it] 34%|███▍      | 299/868 [1:34:22<3:00:17, 19.01s/it] 35%|███▍      | 300/868 [1:34:46<3:12:56, 20.38s/it]                                                      35%|███▍      | 300/868 [1:34:46<3:12:56, 20.38s/it] 35%|███▍      | 301/868 [1:35:02<2:59:43, 19.02s/it] 35%|███▍      | 302/868 [1:35:17<2:47:47, 17.79s/it] 35%|███▍      | 303/868 [1:35:33<2:43:56, 17.41s/it] 35%|███▌      | 304/868 [1:35:51<2:44:56, 17.55s/it] 35%|███▌      | 305/868 [1:36:13<2:56:35, 18.82s/it] 35%|███▌      | 306/868 [1:36:30<2:51:53, 18.35s/it] 35%|███▌      | 307/868 [1:36:48<2:50:29, 18.23s/it] 35%|███▌      | 308/868 [1:37:04<2:44:39, 17.64s/it] 36%|███▌      | 309/868 [1:37:21<2:40:27, 17.22s/it] 36%|███▌      | 310/868 [1:37:36<2:36:41, 16.85s/it]                                                      36%|███▌      | 310/868 [1:37:36<2:36:41, 16.85s/it] 36%|███▌      | 311/868 [1:37:53<2:34:46, 16.67s/it] 36%|███▌      | 312/868 [1:38:10<2:34:54, 16.72s/it] 36%|███▌      | 313/868 [1:38:22<2:23:44, 15.54s/it] 36%|███▌      | 314/868 [1:38:41<2:31:14, 16.38s/it] 36%|███▋      | 315/868 [1:38:57<2:31:44, 16.46s/it] 36%|███▋      | 316/868 [1:39:17<2:39:13, 17.31s/it] 37%|███▋      | 317/868 [1:39:33<2:35:21, 16.92s/it] 37%|███▋      | 318/868 [1:39:54<2:47:39, 18.29s/it] 37%|███▋      | 319/868 [1:40:10<2:39:45, 17.46s/it] 37%|███▋      | 320/868 [1:40:25<2:34:48, 16.95s/it]                                                      37%|███▋      | 320/868 [1:40:25<2:34:48, 16.95s/it] 37%|███▋      | 321/868 [1:40:45<2:41:36, 17.73s/it] 37%|███▋      | 322/868 [1:41:05<2:47:18, 18.39s/it] 37%|███▋      | 323/868 [1:41:20<2:38:37, 17.46s/it] 37%|███▋      | 324/868 [1:41:36<2:32:40, 16.84s/it] 37%|███▋      | 325/868 [1:41:55<2:39:52, 17.67s/it] 38%|███▊      | 326/868 [1:42:09<2:29:30, 16.55s/it] 38%|███▊      | 327/868 [1:42:30<2:41:28, 17.91s/it] 38%|███▊      | 328/868 [1:42:46<2:35:19, 17.26s/it] 38%|███▊      | 329/868 [1:43:02<2:33:07, 17.05s/it] 38%|███▊      | 330/868 [1:43:21<2:38:05, 17.63s/it]                                                      38%|███▊      | 330/868 [1:43:21<2:38:05, 17.63s/it] 38%|███▊      | 331/868 [1:43:45<2:53:49, 19.42s/it] 38%|███▊      | 332/868 [1:44:02<2:45:48, 18.56s/it] 38%|███▊      | 333/868 [1:44:30<3:11:57, 21.53s/it] 38%|███▊      | 334/868 [1:44:45<2:54:26, 19.60s/it] 39%|███▊      | 335/868 [1:45:00<2:40:42, 18.09s/it] 39%|███▊      | 336/868 [1:45:20<2:47:28, 18.89s/it] 39%|███▉      | 337/868 [1:45:36<2:39:00, 17.97s/it] 39%|███▉      | 338/868 [1:45:59<2:51:20, 19.40s/it] 39%|███▉      | 339/868 [1:46:17<2:47:07, 18.96s/it] 39%|███▉      | 340/868 [1:46:41<2:59:31, 20.40s/it]                                                      39%|███▉      | 340/868 [1:46:41<2:59:31, 20.40s/it] 39%|███▉      | 341/868 [1:46:58<2:51:03, 19.48s/it] 39%|███▉      | 342/868 [1:47:19<2:54:51, 19.95s/it] 40%|███▉      | 343/868 [1:47:33<2:38:50, 18.15s/it] 40%|███▉      | 344/868 [1:47:48<2:29:07, 17.07s/it] 40%|███▉      | 345/868 [1:48:05<2:29:37, 17.17s/it] 40%|███▉      | 346/868 [1:48:19<2:22:17, 16.35s/it] 40%|███▉      | 347/868 [1:48:37<2:25:00, 16.70s/it] 40%|████      | 348/868 [1:48:57<2:32:25, 17.59s/it] 40%|████      | 349/868 [1:49:14<2:31:48, 17.55s/it] 40%|████      | 350/868 [1:49:31<2:29:57, 17.37s/it]                                                      40%|████      | 350/868 [1:49:31<2:29:57, 17.37s/it] 40%|████      | 351/868 [1:49:49<2:32:23, 17.69s/it] 41%|████      | 352/868 [1:50:10<2:39:25, 18.54s/it] 41%|████      | 353/868 [1:50:29<2:39:24, 18.57s/it] 41%|████      | 354/868 [1:50:47<2:38:13, 18.47s/it] 41%|████      | 355/868 [1:51:03<2:31:14, 17.69s/it] 41%|████      | 356/868 [1:51:23<2:37:11, 18.42s/it] 41%|████      | 357/868 [1:51:36<2:23:40, 16.87s/it] 41%|████      | 358/868 [1:51:51<2:17:56, 16.23s/it] 41%|████▏     | 359/868 [1:52:08<2:21:14, 16.65s/it] 41%|████▏     | 360/868 [1:52:28<2:27:36, 17.43s/it]                                                      41%|████▏     | 360/868 [1:52:28<2:27:36, 17.43s/it] 42%|████▏     | 361/868 [1:52:47<2:32:30, 18.05s/it] 42%|████▏     | 362/868 [1:53:05<2:31:13, 17.93s/it] 42%|████▏     | 363/868 [1:53:25<2:37:04, 18.66s/it] 42%|████▏     | 364/868 [1:53:48<2:46:37, 19.84s/it] 42%|████▏     | 365/868 [1:54:02<2:31:35, 18.08s/it] 42%|████▏     | 366/868 [1:54:18<2:26:24, 17.50s/it] 42%|████▏     | 367/868 [1:54:39<2:34:16, 18.48s/it] 42%|████▏     | 368/868 [1:54:57<2:34:34, 18.55s/it] 43%|████▎     | 369/868 [1:55:14<2:28:08, 17.81s/it] 43%|████▎     | 370/868 [1:55:30<2:25:09, 17.49s/it]                                                      43%|████▎     | 370/868 [1:55:30<2:25:09, 17.49s/it] 43%|████▎     | 371/868 [1:55:46<2:19:54, 16.89s/it] 43%|████▎     | 372/868 [1:56:13<2:44:50, 19.94s/it]{'eval_loss': 2.9395720958709717, 'eval_runtime': 104.4148, 'eval_samples_per_second': 2.385, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -151.2753143310547, 'eval_rewards/rejected': -169.01158142089844, 'eval_rewards/accuracies': 0.682539701461792, 'eval_rewards/margins': 17.736282348632812, 'eval_logps/rejected': -2022.6268310546875, 'eval_logps/chosen': -1942.5521240234375, 'eval_logits/rejected': 0.15380829572677612, 'eval_logits/chosen': 0.20639172196388245, 'epoch': 2.0}
{'loss': 0.0206, 'grad_norm': 0.047345053404569626, 'learning_rate': 8.535533905932738e-05, 'rewards/chosen': -95.88111114501953, 'rewards/rejected': -152.26950073242188, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 56.388397216796875, 'logps/rejected': -1759.8177490234375, 'logps/chosen': -1115.550537109375, 'logits/rejected': 0.38321951031684875, 'logits/chosen': 0.4355769753456116, 'epoch': 2.02}
{'loss': 0.0196, 'grad_norm': 3.348606586456299, 'learning_rate': 8.398201037367201e-05, 'rewards/chosen': -110.09278869628906, 'rewards/rejected': -159.0648956298828, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 48.972110748291016, 'logps/rejected': -1804.307373046875, 'logps/chosen': -1246.2684326171875, 'logits/rejected': 0.885735034942627, 'logits/chosen': 0.9175689816474915, 'epoch': 2.1}
{'loss': 0.024, 'grad_norm': 8.363318215742765e-08, 'learning_rate': 8.25592913746205e-05, 'rewards/chosen': -102.00516510009766, 'rewards/rejected': -154.81976318359375, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 52.814598083496094, 'logps/rejected': -1792.397705078125, 'logps/chosen': -1176.492919921875, 'logits/rejected': 0.5315750241279602, 'logits/chosen': 0.5374680161476135, 'epoch': 2.18}
{'loss': 0.0271, 'grad_norm': 0.6735593676567078, 'learning_rate': 8.108924987795136e-05, 'rewards/chosen': -139.8917999267578, 'rewards/rejected': -204.42420959472656, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 64.53243255615234, 'logps/rejected': -2263.568603515625, 'logps/chosen': -1548.342041015625, 'logits/rejected': 0.3320351243019104, 'logits/chosen': 0.31314563751220703, 'epoch': 2.26}
{'loss': 0.3645, 'grad_norm': 72.51058959960938, 'learning_rate': 7.957402247915818e-05, 'rewards/chosen': -147.28427124023438, 'rewards/rejected': -227.238037109375, 'rewards/accuracies': 0.9375, 'rewards/margins': 79.95377349853516, 'logps/rejected': -2505.7509765625, 'logps/chosen': -1628.487548828125, 'logits/rejected': 0.4207545816898346, 'logits/chosen': 0.39721906185150146, 'epoch': 2.34}
{'loss': 0.0312, 'grad_norm': 1.2603965997695923, 'learning_rate': 7.801581144806752e-05, 'rewards/chosen': -86.1835708618164, 'rewards/rejected': -135.02186584472656, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 48.838287353515625, 'logps/rejected': -1579.2635498046875, 'logps/chosen': -1015.6710815429688, 'logits/rejected': 0.2663821876049042, 'logits/chosen': 0.25194278359413147, 'epoch': 2.42}
{'loss': 0.0264, 'grad_norm': 0.079831063747406, 'learning_rate': 7.641688152800433e-05, 'rewards/chosen': -79.91764831542969, 'rewards/rejected': -122.74504089355469, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 42.82737350463867, 'logps/rejected': -1449.8194580078125, 'logps/chosen': -948.3475341796875, 'logits/rejected': 0.36190658807754517, 'logits/chosen': 0.36305713653564453, 'epoch': 2.5}
{'loss': 0.2377, 'grad_norm': 18.844951629638672, 'learning_rate': 7.477955664415678e-05, 'rewards/chosen': -99.87560272216797, 'rewards/rejected': -158.33465576171875, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 58.45904541015625, 'logps/rejected': -1817.470947265625, 'logps/chosen': -1150.411376953125, 'logits/rejected': 0.4424128532409668, 'logits/chosen': 0.4404257833957672, 'epoch': 2.58}
{'loss': 0.0289, 'grad_norm': 1.355271577835083, 'learning_rate': 7.310621652592448e-05, 'rewards/chosen': -88.8063735961914, 'rewards/rejected': -147.345703125, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 58.53932571411133, 'logps/rejected': -1694.544677734375, 'logps/chosen': -1041.854736328125, 'logits/rejected': 0.1735091507434845, 'logits/chosen': 0.15917547047138214, 'epoch': 2.66}
{'loss': 0.0665, 'grad_norm': 0.004474577959626913, 'learning_rate': 7.139929324815965e-05, 'rewards/chosen': -133.27505493164062, 'rewards/rejected': -199.0969696044922, 'rewards/accuracies': 0.9375, 'rewards/margins': 65.82192993164062, 'logps/rejected': -2230.97802734375, 'logps/chosen': -1494.99853515625, 'logits/rejected': 0.3092280924320221, 'logits/chosen': 0.30426639318466187, 'epoch': 2.74}
{'loss': 0.0131, 'grad_norm': 0.010630002245306969, 'learning_rate': 6.966126769632802e-05, 'rewards/chosen': -132.3507537841797, 'rewards/rejected': -209.6991729736328, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 77.34840393066406, 'logps/rejected': -2318.27880859375, 'logps/chosen': -1471.712646484375, 'logits/rejected': 0.3155727684497833, 'logits/chosen': 0.3197231590747833, 'epoch': 2.82}
{'loss': 0.0534, 'grad_norm': 1.0718605518341064, 'learning_rate': 6.78946659607271e-05, 'rewards/chosen': -116.58013916015625, 'rewards/rejected': -184.26596069335938, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 67.68580627441406, 'logps/rejected': -2053.62158203125, 'logps/chosen': -1313.76953125, 'logits/rejected': 0.4852592945098877, 'logits/chosen': 0.4859604239463806, 'epoch': 2.9}
{'loss': 0.0412, 'grad_norm': 0.387655645608902, 'learning_rate': 6.610205566500272e-05, 'rewards/chosen': -136.97569274902344, 'rewards/rejected': -216.3461456298828, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 79.37044525146484, 'logps/rejected': -2382.199462890625, 'logps/chosen': -1526.5706787109375, 'logits/rejected': 0.8029171824455261, 'logits/chosen': 0.7835661768913269, 'epoch': 2.98}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:41,  1.46it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.17s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.55s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.04s/it][A
 11%|█         | 7/63 [00:11<01:53,  2.03s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.97s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  1.99s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.93s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:18,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:34<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:19,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:20,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.28s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.47s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.64s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.41s/it][A
 60%|██████    | 38/63 [01:06<00:36,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:11<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.70s/it][A
 68%|██████▊   | 43/63 [01:14<00:32,  1.62s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.50s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:21,  1.37s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.49s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:33<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.42s/it][A
 92%|█████████▏| 58/63 [01:36<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.36s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.34s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                     
                                               [A 43%|████▎     | 372/868 [1:57:57<2:44:50, 19.94s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 43%|████▎     | 373/868 [1:58:20<7:10:13, 52.15s/it] 43%|████▎     | 374/868 [1:58:40<5:50:15, 42.54s/it] 43%|████▎     | 375/868 [1:59:00<4:52:38, 35.62s/it] 43%|████▎     | 376/868 [1:59:17<4:06:06, 30.01s/it] 43%|████▎     | 377/868 [1:59:35<3:37:23, 26.57s/it] 44%|████▎     | 378/868 [1:59:55<3:20:19, 24.53s/it] 44%|████▎     | 379/868 [2:00:14<3:07:00, 22.95s/it] 44%|████▍     | 380/868 [2:00:35<3:02:07, 22.39s/it]                                                      44%|████▍     | 380/868 [2:00:35<3:02:07, 22.39s/it] 44%|████▍     | 381/868 [2:00:49<2:41:24, 19.89s/it] 44%|████▍     | 382/868 [2:01:05<2:30:33, 18.59s/it] 44%|████▍     | 383/868 [2:01:18<2:17:04, 16.96s/it] 44%|████▍     | 384/868 [2:01:34<2:14:40, 16.69s/it] 44%|████▍     | 385/868 [2:01:51<2:15:07, 16.79s/it] 44%|████▍     | 386/868 [2:02:13<2:27:41, 18.38s/it] 45%|████▍     | 387/868 [2:02:27<2:15:13, 16.87s/it] 45%|████▍     | 388/868 [2:02:42<2:12:39, 16.58s/it] 45%|████▍     | 389/868 [2:03:07<2:30:59, 18.91s/it] 45%|████▍     | 390/868 [2:03:33<2:47:16, 21.00s/it]                                                      45%|████▍     | 390/868 [2:03:33<2:47:16, 21.00s/it] 45%|████▌     | 391/868 [2:03:58<2:56:29, 22.20s/it] 45%|████▌     | 392/868 [2:04:16<2:46:05, 20.94s/it] 45%|████▌     | 393/868 [2:04:36<2:44:29, 20.78s/it] 45%|████▌     | 394/868 [2:04:53<2:33:50, 19.47s/it] 46%|████▌     | 395/868 [2:05:06<2:20:23, 17.81s/it] 46%|████▌     | 396/868 [2:05:25<2:21:31, 17.99s/it] 46%|████▌     | 397/868 [2:05:43<2:22:36, 18.17s/it] 46%|████▌     | 398/868 [2:05:56<2:08:53, 16.45s/it] 46%|████▌     | 399/868 [2:06:18<2:21:24, 18.09s/it] 46%|████▌     | 400/868 [2:06:30<2:06:11, 16.18s/it]                                                      46%|████▌     | 400/868 [2:06:30<2:06:11, 16.18s/it] 46%|████▌     | 401/868 [2:06:50<2:15:03, 17.35s/it] 46%|████▋     | 402/868 [2:07:07<2:14:23, 17.30s/it] 46%|████▋     | 403/868 [2:07:20<2:05:29, 16.19s/it] 47%|████▋     | 404/868 [2:07:38<2:07:23, 16.47s/it] 47%|████▋     | 405/868 [2:07:56<2:12:34, 17.18s/it] 47%|████▋     | 406/868 [2:08:11<2:06:49, 16.47s/it] 47%|████▋     | 407/868 [2:08:28<2:07:07, 16.55s/it] 47%|████▋     | 408/868 [2:08:46<2:11:27, 17.15s/it] 47%|████▋     | 409/868 [2:09:01<2:05:07, 16.36s/it] 47%|████▋     | 410/868 [2:09:17<2:04:37, 16.33s/it]                                                      47%|████▋     | 410/868 [2:09:17<2:04:37, 16.33s/it] 47%|████▋     | 411/868 [2:09:37<2:12:15, 17.36s/it] 47%|████▋     | 412/868 [2:09:51<2:03:14, 16.22s/it] 48%|████▊     | 413/868 [2:10:11<2:12:00, 17.41s/it] 48%|████▊     | 414/868 [2:10:28<2:11:37, 17.40s/it] 48%|████▊     | 415/868 [2:10:43<2:06:25, 16.75s/it] 48%|████▊     | 416/868 [2:11:03<2:13:00, 17.66s/it] 48%|████▊     | 417/868 [2:11:19<2:09:03, 17.17s/it] 48%|████▊     | 418/868 [2:11:37<2:10:01, 17.34s/it] 48%|████▊     | 419/868 [2:11:56<2:13:01, 17.78s/it] 48%|████▊     | 420/868 [2:12:11<2:06:30, 16.94s/it]                                                      48%|████▊     | 420/868 [2:12:11<2:06:30, 16.94s/it] 49%|████▊     | 421/868 [2:12:32<2:15:37, 18.21s/it] 49%|████▊     | 422/868 [2:12:51<2:16:27, 18.36s/it] 49%|████▊     | 423/868 [2:13:08<2:14:42, 18.16s/it] 49%|████▉     | 424/868 [2:13:31<2:25:33, 19.67s/it] 49%|████▉     | 425/868 [2:13:47<2:17:06, 18.57s/it] 49%|████▉     | 426/868 [2:14:10<2:25:14, 19.72s/it] 49%|████▉     | 427/868 [2:14:32<2:30:51, 20.52s/it] 49%|████▉     | 428/868 [2:14:51<2:25:53, 19.90s/it] 49%|████▉     | 429/868 [2:15:06<2:15:50, 18.57s/it] 50%|████▉     | 430/868 [2:15:26<2:18:27, 18.97s/it]                                                      50%|████▉     | 430/868 [2:15:26<2:18:27, 18.97s/it] 50%|████▉     | 431/868 [2:15:42<2:11:17, 18.03s/it] 50%|████▉     | 432/868 [2:16:03<2:17:28, 18.92s/it] 50%|████▉     | 433/868 [2:16:26<2:25:17, 20.04s/it] 50%|█████     | 434/868 [2:16:46<2:25:45, 20.15s/it] 50%|█████     | 435/868 [2:17:06<2:25:22, 20.14s/it] 50%|█████     | 436/868 [2:17:26<2:24:45, 20.11s/it] 50%|█████     | 437/868 [2:17:39<2:09:43, 18.06s/it] 50%|█████     | 438/868 [2:18:02<2:19:26, 19.46s/it] 51%|█████     | 439/868 [2:18:18<2:11:16, 18.36s/it] 51%|█████     | 440/868 [2:18:35<2:07:38, 17.89s/it]                                                      51%|█████     | 440/868 [2:18:35<2:07:38, 17.89s/it] 51%|█████     | 441/868 [2:18:56<2:15:11, 19.00s/it] 51%|█████     | 442/868 [2:19:11<2:06:31, 17.82s/it] 51%|█████     | 443/868 [2:19:28<2:03:27, 17.43s/it] 51%|█████     | 444/868 [2:19:43<1:57:33, 16.64s/it] 51%|█████▏    | 445/868 [2:20:01<2:00:00, 17.02s/it] 51%|█████▏    | 446/868 [2:20:18<2:00:02, 17.07s/it] 51%|█████▏    | 447/868 [2:20:41<2:13:12, 18.99s/it] 52%|█████▏    | 448/868 [2:20:57<2:06:40, 18.10s/it] 52%|█████▏    | 449/868 [2:21:16<2:07:55, 18.32s/it] 52%|█████▏    | 450/868 [2:21:33<2:04:08, 17.82s/it]                                                      52%|█████▏    | 450/868 [2:21:33<2:04:08, 17.82s/it] 52%|█████▏    | 451/868 [2:21:54<2:11:43, 18.95s/it] 52%|█████▏    | 452/868 [2:22:11<2:07:21, 18.37s/it] 52%|█████▏    | 453/868 [2:22:30<2:06:56, 18.35s/it] 52%|█████▏    | 454/868 [2:22:54<2:18:35, 20.09s/it] 52%|█████▏    | 455/868 [2:23:08<2:05:21, 18.21s/it] 53%|█████▎    | 456/868 [2:23:26<2:05:43, 18.31s/it] 53%|█████▎    | 457/868 [2:23:41<1:58:17, 17.27s/it] 53%|█████▎    | 458/868 [2:23:57<1:55:49, 16.95s/it] 53%|█████▎    | 459/868 [2:24:14<1:55:10, 16.89s/it] 53%|█████▎    | 460/868 [2:24:29<1:51:54, 16.46s/it]                                                      53%|█████▎    | 460/868 [2:24:29<1:51:54, 16.46s/it] 53%|█████▎    | 461/868 [2:24:49<1:58:42, 17.50s/it] 53%|█████▎    | 462/868 [2:25:11<2:06:16, 18.66s/it] 53%|█████▎    | 463/868 [2:25:26<1:58:58, 17.63s/it] 53%|█████▎    | 464/868 [2:25:41<1:53:59, 16.93s/it] 54%|█████▎    | 465/868 [2:25:57<1:51:38, 16.62s/it] 54%|█████▎    | 466/868 [2:26:13<1:49:29, 16.34s/it] 54%|█████▍    | 467/868 [2:26:31<1:52:39, 16.86s/it] 54%|█████▍    | 468/868 [2:26:56<2:09:50, 19.48s/it] 54%|█████▍    | 469/868 [2:27:16<2:09:36, 19.49s/it] 54%|█████▍    | 470/868 [2:27:33<2:04:57, 18.84s/it]                                                      54%|█████▍    | 470/868 [2:27:33<2:04:57, 18.84s/it] 54%|█████▍    | 471/868 [2:27:53<2:06:51, 19.17s/it] 54%|█████▍    | 472/868 [2:28:09<1:59:22, 18.09s/it] 54%|█████▍    | 473/868 [2:28:25<1:55:52, 17.60s/it] 55%|█████▍    | 474/868 [2:28:41<1:51:56, 17.05s/it] 55%|█████▍    | 475/868 [2:29:00<1:54:42, 17.51s/it] 55%|█████▍    | 476/868 [2:29:20<1:59:29, 18.29s/it] 55%|█████▍    | 477/868 [2:29:36<1:55:57, 17.80s/it] 55%|█████▌    | 478/868 [2:29:59<2:05:36, 19.33s/it] 55%|█████▌    | 479/868 [2:30:23<2:13:17, 20.56s/it] 55%|█████▌    | 480/868 [2:30:36<1:59:43, 18.51s/it]                                                      55%|█████▌    | 480/868 [2:30:36<1:59:43, 18.51s/it] 55%|█████▌    | 481/868 [2:30:55<1:59:59, 18.60s/it] 56%|█████▌    | 482/868 [2:31:10<1:52:44, 17.53s/it] 56%|█████▌    | 483/868 [2:31:33<2:02:41, 19.12s/it] 56%|█████▌    | 484/868 [2:31:48<1:54:57, 17.96s/it] 56%|█████▌    | 485/868 [2:32:06<1:54:37, 17.96s/it] 56%|█████▌    | 486/868 [2:32:22<1:49:23, 17.18s/it] 56%|█████▌    | 487/868 [2:32:35<1:42:32, 16.15s/it] 56%|█████▌    | 488/868 [2:32:53<1:45:08, 16.60s/it] 56%|█████▋    | 489/868 [2:33:12<1:49:40, 17.36s/it] 56%|█████▋    | 490/868 [2:33:32<1:54:48, 18.22s/it]                                                      56%|█████▋    | 490/868 [2:33:32<1:54:48, 18.22s/it] 57%|█████▋    | 491/868 [2:33:46<1:45:32, 16.80s/it] 57%|█████▋    | 492/868 [2:34:05<1:50:16, 17.60s/it] 57%|█████▋    | 493/868 [2:34:23<1:50:05, 17.61s/it] 57%|█████▋    | 494/868 [2:34:40<1:48:49, 17.46s/it] 57%|█████▋    | 495/868 [2:34:57<1:46:50, 17.19s/it] 57%|█████▋    | 496/868 [2:35:13<1:44:26, 16.85s/it]{'eval_loss': 1.631042718887329, 'eval_runtime': 104.4274, 'eval_samples_per_second': 2.384, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -213.39950561523438, 'eval_rewards/rejected': -253.6262664794922, 'eval_rewards/accuracies': 0.7420634627342224, 'eval_rewards/margins': 40.2267951965332, 'eval_logps/rejected': -2868.7744140625, 'eval_logps/chosen': -2563.7939453125, 'eval_logits/rejected': 0.4450104236602783, 'eval_logits/chosen': 0.4314171075820923, 'epoch': 3.0}
{'loss': 0.0132, 'grad_norm': 0.003633387153968215, 'learning_rate': 6.42860422342998e-05, 'rewards/chosen': -179.9911346435547, 'rewards/rejected': -264.6839904785156, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 84.69285583496094, 'logps/rejected': -2872.4501953125, 'logps/chosen': -1952.7093505859375, 'logits/rejected': 0.8852368593215942, 'logits/chosen': 0.8839411735534668, 'epoch': 3.06}
{'loss': 0.0304, 'grad_norm': 0.6825215816497803, 'learning_rate': 6.24492651084716e-05, 'rewards/chosen': -165.31781005859375, 'rewards/rejected': -233.77920532226562, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 68.46141052246094, 'logps/rejected': -2552.402099609375, 'logps/chosen': -1804.805908203125, 'logits/rejected': 0.7308944463729858, 'logits/chosen': 0.7323444485664368, 'epoch': 3.15}
{'loss': 0.1124, 'grad_norm': 0.5129414200782776, 'learning_rate': 6.059439390585107e-05, 'rewards/chosen': -160.99160766601562, 'rewards/rejected': -235.30838012695312, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 74.3167724609375, 'logps/rejected': -2578.53759765625, 'logps/chosen': -1761.890869140625, 'logits/rejected': 0.6769040822982788, 'logits/chosen': 0.6718570590019226, 'epoch': 3.23}
{'loss': 0.048, 'grad_norm': 0.0026930158492177725, 'learning_rate': 5.872412454315999e-05, 'rewards/chosen': -148.09677124023438, 'rewards/rejected': -221.60195922851562, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 73.50517272949219, 'logps/rejected': -2435.073974609375, 'logps/chosen': -1629.7974853515625, 'logits/rejected': 0.27739444375038147, 'logits/chosen': 0.285310834646225, 'epoch': 3.31}
{'loss': 0.0217, 'grad_norm': 0.006164978723973036, 'learning_rate': 5.6841175317195515e-05, 'rewards/chosen': -116.81624603271484, 'rewards/rejected': -182.8591766357422, 'rewards/accuracies': 0.96875, 'rewards/margins': 66.04292297363281, 'logps/rejected': -2054.29052734375, 'logps/chosen': -1320.774169921875, 'logits/rejected': 0.15344713628292084, 'logits/chosen': 0.16532933712005615, 'epoch': 3.39}
{'loss': 0.0691, 'grad_norm': 0.3082771897315979, 'learning_rate': 5.494828295398874e-05, 'rewards/chosen': -105.75247955322266, 'rewards/rejected': -163.5243682861328, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 57.771873474121094, 'logps/rejected': -1854.431640625, 'logps/chosen': -1213.47314453125, 'logits/rejected': 0.2483537644147873, 'logits/chosen': 0.23005683720111847, 'epoch': 3.47}
{'loss': 0.0045, 'grad_norm': 0.025342075154185295, 'learning_rate': 5.304819863117796e-05, 'rewards/chosen': -95.25962829589844, 'rewards/rejected': -151.58319091796875, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 56.32355880737305, 'logps/rejected': -1749.1536865234375, 'logps/chosen': -1107.800048828125, 'logits/rejected': 0.039431266486644745, 'logits/chosen': 0.03502853587269783, 'epoch': 3.55}
{'loss': 0.0806, 'grad_norm': 0.6138486862182617, 'learning_rate': 5.1143683979377444e-05, 'rewards/chosen': -73.86358642578125, 'rewards/rejected': -127.83380126953125, 'rewards/accuracies': 0.96875, 'rewards/margins': 53.97021484375, 'logps/rejected': -1498.629638671875, 'logps/chosen': -890.11767578125, 'logits/rejected': -0.09003554284572601, 'logits/chosen': -0.09950675070285797, 'epoch': 3.63}
{'loss': 0.0218, 'grad_norm': 0.00815253984183073, 'learning_rate': 4.923750706835371e-05, 'rewards/chosen': -63.76806640625, 'rewards/rejected': -114.38134765625, 'rewards/accuracies': 0.96875, 'rewards/margins': 50.613277435302734, 'logps/rejected': -1365.166748046875, 'logps/chosen': -791.1793212890625, 'logits/rejected': -0.07726512849330902, 'logits/chosen': -0.07781429588794708, 'epoch': 3.71}
{'loss': 0.0175, 'grad_norm': 0.42745840549468994, 'learning_rate': 4.733243838384282e-05, 'rewards/chosen': -78.151611328125, 'rewards/rejected': -133.14089965820312, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 54.989288330078125, 'logps/rejected': -1578.815673828125, 'logps/chosen': -935.2159423828125, 'logits/rejected': 0.03045330010354519, 'logits/chosen': 0.029873237013816833, 'epoch': 3.79}
{'loss': 0.0434, 'grad_norm': 0.01687503792345524, 'learning_rate': 4.543124680085645e-05, 'rewards/chosen': -95.31459045410156, 'rewards/rejected': -156.5807647705078, 'rewards/accuracies': 0.9375, 'rewards/margins': 61.26616287231445, 'logps/rejected': -1797.2945556640625, 'logps/chosen': -1110.742431640625, 'logits/rejected': -0.012978916987776756, 'logits/chosen': -0.001026122597977519, 'epoch': 3.87}
{'loss': 0.044, 'grad_norm': 0.8171149492263794, 'learning_rate': 4.3536695559328814e-05, 'rewards/chosen': -121.03206634521484, 'rewards/rejected': -181.38827514648438, 'rewards/accuracies': 0.9375, 'rewards/margins': 60.3562126159668, 'logps/rejected': -2029.0657958984375, 'logps/chosen': -1354.990234375, 'logits/rejected': 0.021513240411877632, 'logits/chosen': 0.030225176364183426, 'epoch': 3.95}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:41,  1.45it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.18s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.56s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.05s/it][A
 11%|█         | 7/63 [00:11<01:54,  2.04s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.98s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  1.99s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.94s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:18,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:34<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:19,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:20,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.29s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.47s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.64s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.41s/it][A
 60%|██████    | 38/63 [01:06<00:37,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:12<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.71s/it][A
 68%|██████▊   | 43/63 [01:15<00:32,  1.63s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.50s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:21,  1.37s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.50s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:34<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.43s/it][A
 92%|█████████▏| 58/63 [01:37<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.37s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.34s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                     
                                               [A 57%|█████▋    | 496/868 [2:36:57<1:44:26, 16.85s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 57%|█████▋    | 497/868 [2:37:16<5:01:43, 48.80s/it] 57%|█████▋    | 498/868 [2:37:40<4:15:07, 41.37s/it] 57%|█████▋    | 499/868 [2:37:59<3:32:17, 34.52s/it] 58%|█████▊    | 500/868 [2:38:13<2:54:10, 28.40s/it]                                                      58%|█████▊    | 500/868 [2:38:13<2:54:10, 28.40s/it] 58%|█████▊    | 501/868 [2:38:32<2:37:08, 25.69s/it] 58%|█████▊    | 502/868 [2:38:53<2:28:11, 24.29s/it] 58%|█████▊    | 503/868 [2:39:17<2:26:59, 24.16s/it] 58%|█████▊    | 504/868 [2:39:35<2:14:31, 22.18s/it] 58%|█████▊    | 505/868 [2:39:55<2:10:57, 21.65s/it] 58%|█████▊    | 506/868 [2:40:09<1:57:43, 19.51s/it] 58%|█████▊    | 507/868 [2:40:30<1:58:23, 19.68s/it] 59%|█████▊    | 508/868 [2:40:52<2:02:32, 20.42s/it] 59%|█████▊    | 509/868 [2:41:08<1:55:38, 19.33s/it] 59%|█████▉    | 510/868 [2:41:25<1:49:54, 18.42s/it]                                                      59%|█████▉    | 510/868 [2:41:25<1:49:54, 18.42s/it] 59%|█████▉    | 511/868 [2:41:46<1:55:03, 19.34s/it] 59%|█████▉    | 512/868 [2:42:03<1:50:34, 18.64s/it] 59%|█████▉    | 513/868 [2:42:19<1:45:44, 17.87s/it] 59%|█████▉    | 514/868 [2:42:37<1:45:38, 17.91s/it] 59%|█████▉    | 515/868 [2:42:56<1:46:34, 18.11s/it] 59%|█████▉    | 516/868 [2:43:20<1:57:30, 20.03s/it] 60%|█████▉    | 517/868 [2:43:43<2:01:26, 20.76s/it] 60%|█████▉    | 518/868 [2:43:59<1:53:32, 19.47s/it] 60%|█████▉    | 519/868 [2:44:14<1:45:15, 18.10s/it] 60%|█████▉    | 520/868 [2:44:37<1:53:15, 19.53s/it]                                                      60%|█████▉    | 520/868 [2:44:37<1:53:15, 19.53s/it] 60%|██████    | 521/868 [2:44:59<1:57:32, 20.32s/it] 60%|██████    | 522/868 [2:45:16<1:50:55, 19.24s/it] 60%|██████    | 523/868 [2:45:32<1:45:31, 18.35s/it] 60%|██████    | 524/868 [2:45:51<1:46:13, 18.53s/it] 60%|██████    | 525/868 [2:46:16<1:57:04, 20.48s/it] 61%|██████    | 526/868 [2:46:30<1:44:35, 18.35s/it] 61%|██████    | 527/868 [2:46:49<1:45:21, 18.54s/it] 61%|██████    | 528/868 [2:47:04<1:38:57, 17.46s/it] 61%|██████    | 529/868 [2:47:22<1:39:49, 17.67s/it] 61%|██████    | 530/868 [2:47:39<1:39:27, 17.66s/it]                                                      61%|██████    | 530/868 [2:47:39<1:39:27, 17.66s/it] 61%|██████    | 531/868 [2:47:56<1:38:14, 17.49s/it] 61%|██████▏   | 532/868 [2:48:17<1:42:37, 18.33s/it] 61%|██████▏   | 533/868 [2:48:32<1:37:32, 17.47s/it] 62%|██████▏   | 534/868 [2:48:47<1:32:20, 16.59s/it] 62%|██████▏   | 535/868 [2:49:01<1:27:47, 15.82s/it] 62%|██████▏   | 536/868 [2:49:20<1:33:03, 16.82s/it] 62%|██████▏   | 537/868 [2:49:37<1:34:03, 17.05s/it] 62%|██████▏   | 538/868 [2:49:52<1:28:48, 16.15s/it] 62%|██████▏   | 539/868 [2:50:05<1:24:29, 15.41s/it] 62%|██████▏   | 540/868 [2:50:25<1:30:59, 16.65s/it]                                                      62%|██████▏   | 540/868 [2:50:25<1:30:59, 16.65s/it] 62%|██████▏   | 541/868 [2:50:38<1:25:14, 15.64s/it] 62%|██████▏   | 542/868 [2:51:00<1:34:58, 17.48s/it] 63%|██████▎   | 543/868 [2:51:23<1:44:17, 19.25s/it] 63%|██████▎   | 544/868 [2:51:38<1:37:06, 17.98s/it] 63%|██████▎   | 545/868 [2:51:56<1:37:06, 18.04s/it] 63%|██████▎   | 546/868 [2:52:10<1:29:50, 16.74s/it] 63%|██████▎   | 547/868 [2:52:27<1:30:01, 16.83s/it] 63%|██████▎   | 548/868 [2:52:42<1:26:39, 16.25s/it] 63%|██████▎   | 549/868 [2:53:01<1:30:15, 16.98s/it] 63%|██████▎   | 550/868 [2:53:20<1:33:14, 17.59s/it]                                                      63%|██████▎   | 550/868 [2:53:20<1:33:14, 17.59s/it] 63%|██████▎   | 551/868 [2:53:41<1:38:09, 18.58s/it] 64%|██████▎   | 552/868 [2:53:54<1:29:05, 16.92s/it] 64%|██████▎   | 553/868 [2:54:12<1:31:19, 17.40s/it] 64%|██████▍   | 554/868 [2:54:30<1:31:19, 17.45s/it] 64%|██████▍   | 555/868 [2:54:44<1:26:28, 16.58s/it] 64%|██████▍   | 556/868 [2:55:03<1:29:48, 17.27s/it] 64%|██████▍   | 557/868 [2:55:22<1:31:24, 17.63s/it] 64%|██████▍   | 558/868 [2:55:40<1:32:14, 17.85s/it] 64%|██████▍   | 559/868 [2:55:54<1:26:11, 16.74s/it] 65%|██████▍   | 560/868 [2:56:07<1:19:54, 15.57s/it]                                                      65%|██████▍   | 560/868 [2:56:07<1:19:54, 15.57s/it] 65%|██████▍   | 561/868 [2:56:30<1:30:30, 17.69s/it] 65%|██████▍   | 562/868 [2:56:53<1:38:21, 19.29s/it] 65%|██████▍   | 563/868 [2:57:06<1:29:29, 17.60s/it] 65%|██████▍   | 564/868 [2:57:25<1:30:15, 17.81s/it] 65%|██████▌   | 565/868 [2:57:39<1:25:15, 16.88s/it] 65%|██████▌   | 566/868 [2:57:53<1:19:56, 15.88s/it] 65%|██████▌   | 567/868 [2:58:18<1:32:59, 18.54s/it] 65%|██████▌   | 568/868 [2:58:41<1:39:46, 19.96s/it] 66%|██████▌   | 569/868 [2:58:55<1:31:25, 18.35s/it] 66%|██████▌   | 570/868 [2:59:14<1:30:48, 18.28s/it]                                                      66%|██████▌   | 570/868 [2:59:14<1:30:48, 18.28s/it] 66%|██████▌   | 571/868 [2:59:32<1:30:05, 18.20s/it] 66%|██████▌   | 572/868 [2:59:46<1:23:51, 17.00s/it] 66%|██████▌   | 573/868 [3:00:04<1:25:16, 17.34s/it] 66%|██████▌   | 574/868 [3:00:21<1:24:42, 17.29s/it] 66%|██████▌   | 575/868 [3:00:40<1:27:08, 17.84s/it] 66%|██████▋   | 576/868 [3:01:05<1:37:04, 19.95s/it] 66%|██████▋   | 577/868 [3:01:20<1:29:27, 18.45s/it] 67%|██████▋   | 578/868 [3:01:40<1:31:33, 18.94s/it] 67%|██████▋   | 579/868 [3:01:56<1:26:40, 18.00s/it] 67%|██████▋   | 580/868 [3:02:11<1:22:09, 17.12s/it]                                                      67%|██████▋   | 580/868 [3:02:11<1:22:09, 17.12s/it] 67%|██████▋   | 581/868 [3:02:29<1:22:25, 17.23s/it] 67%|██████▋   | 582/868 [3:02:44<1:19:56, 16.77s/it] 67%|██████▋   | 583/868 [3:03:01<1:19:13, 16.68s/it] 67%|██████▋   | 584/868 [3:03:17<1:18:29, 16.58s/it] 67%|██████▋   | 585/868 [3:03:37<1:23:07, 17.62s/it] 68%|██████▊   | 586/868 [3:03:51<1:18:10, 16.63s/it] 68%|██████▊   | 587/868 [3:04:11<1:22:39, 17.65s/it] 68%|██████▊   | 588/868 [3:04:32<1:26:34, 18.55s/it] 68%|██████▊   | 589/868 [3:04:54<1:30:48, 19.53s/it] 68%|██████▊   | 590/868 [3:05:08<1:22:18, 17.76s/it]                                                      68%|██████▊   | 590/868 [3:05:08<1:22:18, 17.76s/it] 68%|██████▊   | 591/868 [3:05:24<1:20:34, 17.45s/it] 68%|██████▊   | 592/868 [3:05:45<1:25:13, 18.53s/it] 68%|██████▊   | 593/868 [3:06:05<1:26:54, 18.96s/it] 68%|██████▊   | 594/868 [3:06:21<1:21:39, 17.88s/it] 69%|██████▊   | 595/868 [3:06:36<1:17:25, 17.02s/it] 69%|██████▊   | 596/868 [3:06:52<1:16:19, 16.84s/it] 69%|██████▉   | 597/868 [3:07:21<1:32:23, 20.46s/it] 69%|██████▉   | 598/868 [3:07:34<1:22:07, 18.25s/it] 69%|██████▉   | 599/868 [3:07:54<1:24:02, 18.74s/it] 69%|██████▉   | 600/868 [3:08:14<1:25:14, 19.08s/it]                                                      69%|██████▉   | 600/868 [3:08:14<1:25:14, 19.08s/it] 69%|██████▉   | 601/868 [3:08:29<1:19:20, 17.83s/it] 69%|██████▉   | 602/868 [3:08:44<1:16:04, 17.16s/it] 69%|██████▉   | 603/868 [3:09:00<1:13:57, 16.75s/it] 70%|██████▉   | 604/868 [3:09:16<1:12:08, 16.39s/it] 70%|██████▉   | 605/868 [3:09:39<1:20:42, 18.41s/it] 70%|██████▉   | 606/868 [3:09:59<1:22:14, 18.84s/it] 70%|██████▉   | 607/868 [3:10:18<1:22:03, 18.86s/it] 70%|███████   | 608/868 [3:10:35<1:19:51, 18.43s/it] 70%|███████   | 609/868 [3:10:52<1:17:06, 17.86s/it] 70%|███████   | 610/868 [3:11:09<1:16:46, 17.85s/it]                                                      70%|███████   | 610/868 [3:11:09<1:16:46, 17.85s/it] 70%|███████   | 611/868 [3:11:26<1:14:40, 17.43s/it] 71%|███████   | 612/868 [3:11:42<1:13:10, 17.15s/it] 71%|███████   | 613/868 [3:12:00<1:14:08, 17.44s/it] 71%|███████   | 614/868 [3:12:16<1:11:21, 16.86s/it] 71%|███████   | 615/868 [3:12:34<1:13:02, 17.32s/it] 71%|███████   | 616/868 [3:12:52<1:13:38, 17.53s/it] 71%|███████   | 617/868 [3:13:13<1:17:17, 18.48s/it] 71%|███████   | 618/868 [3:13:34<1:20:18, 19.27s/it] 71%|███████▏  | 619/868 [3:13:47<1:12:19, 17.43s/it] 71%|███████▏  | 620/868 [3:14:04<1:10:35, 17.08s/it]                                                      71%|███████▏  | 620/868 [3:14:04<1:10:35, 17.08s/it]{'eval_loss': 1.2210536003112793, 'eval_runtime': 104.5638, 'eval_samples_per_second': 2.381, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -173.29159545898438, 'eval_rewards/rejected': -217.0599822998047, 'eval_rewards/accuracies': 0.7976190447807312, 'eval_rewards/margins': 43.7684211730957, 'eval_logps/rejected': -2503.111083984375, 'eval_logps/chosen': -2162.71484375, 'eval_logits/rejected': -0.21539725363254547, 'eval_logits/chosen': -0.20015089213848114, 'epoch': 4.0}
{'loss': 0.0176, 'grad_norm': 0.001113876118324697, 'learning_rate': 4.16515382479539e-05, 'rewards/chosen': -130.0576934814453, 'rewards/rejected': -209.3325958251953, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 79.27488708496094, 'logps/rejected': -2317.940185546875, 'logps/chosen': -1454.74462890625, 'logits/rejected': 0.08235907554626465, 'logits/chosen': 0.09365235269069672, 'epoch': 4.03}
{'loss': 0.0392, 'grad_norm': 0.039526600390672684, 'learning_rate': 3.977851480205003e-05, 'rewards/chosen': -146.07896423339844, 'rewards/rejected': -219.54214477539062, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 73.46318054199219, 'logps/rejected': -2420.91259765625, 'logps/chosen': -1614.848388671875, 'logits/rejected': 0.15829549729824066, 'logits/chosen': 0.16468976438045502, 'epoch': 4.11}
{'loss': 0.0217, 'grad_norm': 0.004052536096423864, 'learning_rate': 3.792034752126851e-05, 'rewards/chosen': -129.37478637695312, 'rewards/rejected': -207.9652557373047, 'rewards/accuracies': 0.96875, 'rewards/margins': 78.59046936035156, 'logps/rejected': -2308.306640625, 'logps/chosen': -1443.122802734375, 'logits/rejected': 0.190553218126297, 'logits/chosen': 0.20819416642189026, 'epoch': 4.19}
{'loss': 0.0304, 'grad_norm': 0.09450932592153549, 'learning_rate': 3.607973711293453e-05, 'rewards/chosen': -119.740478515625, 'rewards/rejected': -183.64993286132812, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 63.90944290161133, 'logps/rejected': -2056.0693359375, 'logps/chosen': -1351.3809814453125, 'logits/rejected': 0.11862321197986603, 'logits/chosen': 0.12172943353652954, 'epoch': 4.27}
{'loss': 0.0217, 'grad_norm': 8.336779865203425e-05, 'learning_rate': 3.4259358766770766e-05, 'rewards/chosen': -114.5708999633789, 'rewards/rejected': -172.512939453125, 'rewards/accuracies': 0.96875, 'rewards/margins': 57.94202423095703, 'logps/rejected': -1959.5908203125, 'logps/chosen': -1299.9930419921875, 'logits/rejected': 0.09338703006505966, 'logits/chosen': 0.10227449238300323, 'epoch': 4.35}
{'loss': 0.0173, 'grad_norm': 0.5694701671600342, 'learning_rate': 3.246185826670902e-05, 'rewards/chosen': -119.94029235839844, 'rewards/rejected': -186.66871643066406, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 66.7284164428711, 'logps/rejected': -2097.22216796875, 'logps/chosen': -1354.744873046875, 'logits/rejected': 0.08533598482608795, 'logits/chosen': 0.08337600529193878, 'epoch': 4.44}
{'loss': 0.0261, 'grad_norm': 0.4279806315898895, 'learning_rate': 3.0689848145440866e-05, 'rewards/chosen': -113.21175384521484, 'rewards/rejected': -179.5292205810547, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 66.3174819946289, 'logps/rejected': -2035.5609130859375, 'logps/chosen': -1292.319091796875, 'logits/rejected': 0.0732794776558876, 'logits/chosen': 0.07988425344228745, 'epoch': 4.52}
{'loss': 0.0217, 'grad_norm': 0.7697165012359619, 'learning_rate': 2.8945903887296684e-05, 'rewards/chosen': -126.00361633300781, 'rewards/rejected': -185.84085083007812, 'rewards/accuracies': 0.96875, 'rewards/margins': 59.83723068237305, 'logps/rejected': -2082.685791015625, 'logps/chosen': -1409.50634765625, 'logits/rejected': 0.10706305503845215, 'logits/chosen': 0.09438090026378632, 'epoch': 4.6}
{'loss': 0.026, 'grad_norm': 0.5149087309837341, 'learning_rate': 2.7232560184971434e-05, 'rewards/chosen': -118.5060806274414, 'rewards/rejected': -188.07998657226562, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 69.57392120361328, 'logps/rejected': -2099.603759765625, 'logps/chosen': -1334.4091796875, 'logits/rejected': 0.03641032427549362, 'logits/chosen': 0.04238493740558624, 'epoch': 4.68}
{'loss': 0.026, 'grad_norm': 0.0019850810058414936, 'learning_rate': 2.5552307255538322e-05, 'rewards/chosen': -112.98448181152344, 'rewards/rejected': -182.17311096191406, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 69.18861389160156, 'logps/rejected': -2043.403076171875, 'logps/chosen': -1280.4986572265625, 'logits/rejected': 0.021829333156347275, 'logits/chosen': 0.03650736063718796, 'epoch': 4.76}
{'loss': 0.039, 'grad_norm': 1.9998034872514836e-07, 'learning_rate': 2.3907587221104177e-05, 'rewards/chosen': -119.9660873413086, 'rewards/rejected': -184.02191162109375, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 64.05583190917969, 'logps/rejected': -2061.21728515625, 'logps/chosen': -1352.163330078125, 'logits/rejected': 0.051692716777324677, 'logits/chosen': 0.03544890508055687, 'epoch': 4.84}
{'loss': 0.0174, 'grad_norm': 0.0003975716244895011, 'learning_rate': 2.2300790559367552e-05, 'rewards/chosen': -113.4203109741211, 'rewards/rejected': -180.83908081054688, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 67.41876220703125, 'logps/rejected': -2028.3861083984375, 'logps/chosen': -1283.904052734375, 'logits/rejected': 0.10257096588611603, 'logits/chosen': 0.09111783653497696, 'epoch': 4.92}
{'loss': 0.0217, 'grad_norm': 0.0069227637723088264, 'learning_rate': 2.0734252629237894e-05, 'rewards/chosen': -108.00941467285156, 'rewards/rejected': -182.94931030273438, 'rewards/accuracies': 0.96875, 'rewards/margins': 74.93990325927734, 'logps/rejected': -2061.80810546875, 'logps/chosen': -1233.870361328125, 'logits/rejected': 0.07770447432994843, 'logits/chosen': 0.07426498830318451, 'epoch': 5.0}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:41,  1.46it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.17s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.55s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.04s/it][A
 11%|█         | 7/63 [00:11<01:54,  2.04s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.98s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  1.99s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.93s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:17,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:34<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:18,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:20,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.28s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.47s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.64s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.40s/it][A
 60%|██████    | 38/63 [01:06<00:36,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:11<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.70s/it][A
 68%|██████▊   | 43/63 [01:15<00:32,  1.62s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.49s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:21,  1.37s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.49s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:33<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.42s/it][A
 92%|█████████▏| 58/63 [01:36<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.36s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.33s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                     
                                               [A 71%|███████▏  | 620/868 [3:15:48<1:10:35, 17.08s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 72%|███████▏  | 621/868 [3:16:11<3:26:38, 50.20s/it] 72%|███████▏  | 622/868 [3:16:28<2:45:32, 40.37s/it] 72%|███████▏  | 623/868 [3:16:45<2:15:22, 33.15s/it] 72%|███████▏  | 624/868 [3:17:04<1:57:27, 28.88s/it] 72%|███████▏  | 625/868 [3:17:19<1:40:54, 24.92s/it] 72%|███████▏  | 626/868 [3:17:36<1:30:54, 22.54s/it] 72%|███████▏  | 627/868 [3:17:54<1:24:38, 21.07s/it] 72%|███████▏  | 628/868 [3:18:14<1:23:17, 20.82s/it] 72%|███████▏  | 629/868 [3:18:43<1:32:00, 23.10s/it] 73%|███████▎  | 630/868 [3:18:56<1:19:50, 20.13s/it]                                                      73%|███████▎  | 630/868 [3:18:56<1:19:50, 20.13s/it] 73%|███████▎  | 631/868 [3:19:16<1:19:31, 20.13s/it] 73%|███████▎  | 632/868 [3:19:32<1:14:37, 18.97s/it] 73%|███████▎  | 633/868 [3:19:50<1:12:18, 18.46s/it] 73%|███████▎  | 634/868 [3:20:07<1:11:18, 18.29s/it] 73%|███████▎  | 635/868 [3:20:27<1:12:50, 18.76s/it] 73%|███████▎  | 636/868 [3:20:51<1:18:06, 20.20s/it] 73%|███████▎  | 637/868 [3:21:12<1:19:11, 20.57s/it] 74%|███████▎  | 638/868 [3:21:31<1:17:11, 20.14s/it] 74%|███████▎  | 639/868 [3:21:53<1:18:30, 20.57s/it] 74%|███████▎  | 640/868 [3:22:07<1:11:15, 18.75s/it]                                                      74%|███████▎  | 640/868 [3:22:07<1:11:15, 18.75s/it] 74%|███████▍  | 641/868 [3:22:24<1:07:56, 17.96s/it] 74%|███████▍  | 642/868 [3:22:45<1:11:43, 19.04s/it] 74%|███████▍  | 643/868 [3:23:01<1:07:46, 18.07s/it] 74%|███████▍  | 644/868 [3:23:15<1:02:37, 16.77s/it] 74%|███████▍  | 645/868 [3:23:33<1:03:31, 17.09s/it] 74%|███████▍  | 646/868 [3:23:51<1:05:17, 17.65s/it] 75%|███████▍  | 647/868 [3:24:08<1:03:31, 17.24s/it] 75%|███████▍  | 648/868 [3:24:22<1:00:07, 16.40s/it] 75%|███████▍  | 649/868 [3:24:36<57:10, 15.66s/it]   75%|███████▍  | 650/868 [3:24:51<56:30, 15.55s/it]                                                    75%|███████▍  | 650/868 [3:24:51<56:30, 15.55s/it] 75%|███████▌  | 651/868 [3:25:09<58:02, 16.05s/it] 75%|███████▌  | 652/868 [3:25:23<55:45, 15.49s/it] 75%|███████▌  | 653/868 [3:25:40<57:15, 15.98s/it] 75%|███████▌  | 654/868 [3:25:58<58:57, 16.53s/it] 75%|███████▌  | 655/868 [3:26:13<57:39, 16.24s/it] 76%|███████▌  | 656/868 [3:26:31<59:05, 16.73s/it] 76%|███████▌  | 657/868 [3:26:53<1:04:09, 18.24s/it] 76%|███████▌  | 658/868 [3:27:14<1:06:50, 19.10s/it] 76%|███████▌  | 659/868 [3:27:28<1:00:53, 17.48s/it] 76%|███████▌  | 660/868 [3:27:48<1:03:43, 18.38s/it]                                                      76%|███████▌  | 660/868 [3:27:48<1:03:43, 18.38s/it] 76%|███████▌  | 661/868 [3:28:03<59:21, 17.20s/it]   76%|███████▋  | 662/868 [3:28:19<58:34, 17.06s/it] 76%|███████▋  | 663/868 [3:28:36<58:08, 17.02s/it] 76%|███████▋  | 664/868 [3:28:53<57:08, 16.80s/it] 77%|███████▋  | 665/868 [3:29:12<59:32, 17.60s/it] 77%|███████▋  | 666/868 [3:29:33<1:02:22, 18.53s/it] 77%|███████▋  | 667/868 [3:29:51<1:01:33, 18.38s/it] 77%|███████▋  | 668/868 [3:30:04<56:03, 16.82s/it]   77%|███████▋  | 669/868 [3:30:20<55:02, 16.60s/it] 77%|███████▋  | 670/868 [3:30:38<56:27, 17.11s/it]                                                    77%|███████▋  | 670/868 [3:30:38<56:27, 17.11s/it] 77%|███████▋  | 671/868 [3:30:59<59:17, 18.06s/it] 77%|███████▋  | 672/868 [3:31:10<52:49, 16.17s/it] 78%|███████▊  | 673/868 [3:31:26<51:45, 15.93s/it] 78%|███████▊  | 674/868 [3:31:42<52:14, 16.16s/it] 78%|███████▊  | 675/868 [3:31:58<51:31, 16.02s/it] 78%|███████▊  | 676/868 [3:32:19<56:10, 17.56s/it] 78%|███████▊  | 677/868 [3:32:35<54:10, 17.02s/it] 78%|███████▊  | 678/868 [3:32:49<50:56, 16.09s/it] 78%|███████▊  | 679/868 [3:33:10<55:46, 17.71s/it] 78%|███████▊  | 680/868 [3:33:30<57:28, 18.34s/it]                                                    78%|███████▊  | 680/868 [3:33:30<57:28, 18.34s/it] 78%|███████▊  | 681/868 [3:33:46<54:46, 17.57s/it] 79%|███████▊  | 682/868 [3:34:02<52:33, 16.96s/it] 79%|███████▊  | 683/868 [3:34:24<57:05, 18.51s/it] 79%|███████▉  | 684/868 [3:34:43<57:12, 18.65s/it] 79%|███████▉  | 685/868 [3:34:59<54:24, 17.84s/it] 79%|███████▉  | 686/868 [3:35:19<55:59, 18.46s/it] 79%|███████▉  | 687/868 [3:35:37<55:47, 18.49s/it] 79%|███████▉  | 688/868 [3:35:56<56:14, 18.75s/it] 79%|███████▉  | 689/868 [3:36:19<59:15, 19.87s/it] 79%|███████▉  | 690/868 [3:36:35<55:29, 18.71s/it]                                                    79%|███████▉  | 690/868 [3:36:35<55:29, 18.71s/it] 80%|███████▉  | 691/868 [3:36:55<55:54, 18.95s/it] 80%|███████▉  | 692/868 [3:37:14<56:03, 19.11s/it] 80%|███████▉  | 693/868 [3:37:33<55:41, 19.09s/it] 80%|███████▉  | 694/868 [3:38:01<1:03:24, 21.87s/it] 80%|████████  | 695/868 [3:38:18<58:47, 20.39s/it]   80%|████████  | 696/868 [3:38:34<54:18, 18.94s/it] 80%|████████  | 697/868 [3:38:59<59:07, 20.74s/it] 80%|████████  | 698/868 [3:39:25<1:03:30, 22.41s/it] 81%|████████  | 699/868 [3:39:40<56:35, 20.09s/it]   81%|████████  | 700/868 [3:39:54<51:16, 18.31s/it]                                                    81%|████████  | 700/868 [3:39:54<51:16, 18.31s/it] 81%|████████  | 701/868 [3:40:14<52:32, 18.87s/it] 81%|████████  | 702/868 [3:40:31<50:45, 18.34s/it] 81%|████████  | 703/868 [3:40:51<51:46, 18.83s/it] 81%|████████  | 704/868 [3:41:07<48:33, 17.76s/it] 81%|████████  | 705/868 [3:41:20<44:45, 16.48s/it] 81%|████████▏ | 706/868 [3:41:37<45:10, 16.73s/it] 81%|████████▏ | 707/868 [3:41:53<44:09, 16.46s/it] 82%|████████▏ | 708/868 [3:42:13<46:26, 17.42s/it] 82%|████████▏ | 709/868 [3:42:30<46:14, 17.45s/it] 82%|████████▏ | 710/868 [3:42:46<44:15, 16.81s/it]                                                    82%|████████▏ | 710/868 [3:42:46<44:15, 16.81s/it] 82%|████████▏ | 711/868 [3:43:05<46:05, 17.62s/it] 82%|████████▏ | 712/868 [3:43:19<42:48, 16.47s/it] 82%|████████▏ | 713/868 [3:43:36<42:50, 16.58s/it] 82%|████████▏ | 714/868 [3:43:58<46:52, 18.26s/it] 82%|████████▏ | 715/868 [3:44:14<45:01, 17.65s/it] 82%|████████▏ | 716/868 [3:44:36<47:43, 18.84s/it] 83%|████████▎ | 717/868 [3:44:58<49:49, 19.80s/it] 83%|████████▎ | 718/868 [3:45:20<51:27, 20.58s/it] 83%|████████▎ | 719/868 [3:45:32<44:53, 18.08s/it] 83%|████████▎ | 720/868 [3:45:54<47:15, 19.16s/it]                                                    83%|████████▎ | 720/868 [3:45:54<47:15, 19.16s/it] 83%|████████▎ | 721/868 [3:46:10<44:15, 18.07s/it] 83%|████████▎ | 722/868 [3:46:30<45:26, 18.67s/it] 83%|████████▎ | 723/868 [3:46:52<47:22, 19.61s/it] 83%|████████▎ | 724/868 [3:47:07<44:14, 18.44s/it] 84%|████████▎ | 725/868 [3:47:22<41:10, 17.27s/it] 84%|████████▎ | 726/868 [3:47:46<46:05, 19.47s/it] 84%|████████▍ | 727/868 [3:48:01<42:04, 17.91s/it] 84%|████████▍ | 728/868 [3:48:21<43:12, 18.52s/it] 84%|████████▍ | 729/868 [3:48:36<40:47, 17.61s/it] 84%|████████▍ | 730/868 [3:48:54<40:57, 17.81s/it]                                                    84%|████████▍ | 730/868 [3:48:54<40:57, 17.81s/it] 84%|████████▍ | 731/868 [3:49:12<40:29, 17.73s/it] 84%|████████▍ | 732/868 [3:49:31<40:56, 18.06s/it] 84%|████████▍ | 733/868 [3:49:48<40:11, 17.86s/it] 85%|████████▍ | 734/868 [3:50:04<38:23, 17.19s/it] 85%|████████▍ | 735/868 [3:50:22<38:43, 17.47s/it] 85%|████████▍ | 736/868 [3:50:45<42:26, 19.29s/it] 85%|████████▍ | 737/868 [3:51:04<41:41, 19.10s/it] 85%|████████▌ | 738/868 [3:51:21<40:01, 18.47s/it] 85%|████████▌ | 739/868 [3:51:36<37:22, 17.39s/it] 85%|████████▌ | 740/868 [3:51:51<35:50, 16.80s/it]                                                    85%|████████▌ | 740/868 [3:51:51<35:50, 16.80s/it] 85%|████████▌ | 741/868 [3:52:11<37:24, 17.68s/it] 85%|████████▌ | 742/868 [3:52:29<37:03, 17.64s/it] 86%|████████▌ | 743/868 [3:52:45<35:52, 17.22s/it] 86%|████████▌ | 744/868 [3:53:03<36:21, 17.60s/it]{'eval_loss': 1.3501111268997192, 'eval_runtime': 104.4286, 'eval_samples_per_second': 2.384, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -153.5779266357422, 'eval_rewards/rejected': -192.4967498779297, 'eval_rewards/accuracies': 0.7976190447807312, 'eval_rewards/margins': 38.91883087158203, 'eval_logps/rejected': -2257.478759765625, 'eval_logps/chosen': -1965.578369140625, 'eval_logits/rejected': -0.2716481685638428, 'eval_logits/chosen': -0.2693864107131958, 'epoch': 5.0}
{'loss': 0.0173, 'grad_norm': 2.7761254841607297e-06, 'learning_rate': 1.921025027656587e-05, 'rewards/chosen': -110.85832214355469, 'rewards/rejected': -184.2094268798828, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 73.35111236572266, 'logps/rejected': -2061.83056640625, 'logps/chosen': -1258.02685546875, 'logits/rejected': 0.09154363721609116, 'logits/chosen': 0.09143807739019394, 'epoch': 5.08}
{'loss': 0.0477, 'grad_norm': 8.28534484753618e-06, 'learning_rate': 1.7730998524917957e-05, 'rewards/chosen': -107.1257095336914, 'rewards/rejected': -181.03175354003906, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 73.9060287475586, 'logps/rejected': -2044.5257568359375, 'logps/chosen': -1226.2860107421875, 'logits/rejected': 0.002908793045207858, 'logits/chosen': 0.012157459743320942, 'epoch': 5.16}
{'loss': 0.0217, 'grad_norm': 0.5116637945175171, 'learning_rate': 1.6298647356205254e-05, 'rewards/chosen': -101.55007934570312, 'rewards/rejected': -171.9656524658203, 'rewards/accuracies': 0.96875, 'rewards/margins': 70.41556549072266, 'logps/rejected': -1948.1263427734375, 'logps/chosen': -1167.9215087890625, 'logits/rejected': -0.013114589266479015, 'logits/chosen': -0.0015322506660595536, 'epoch': 5.24}
{'loss': 0.039, 'grad_norm': 0.001577201415784657, 'learning_rate': 1.491527858584535e-05, 'rewards/chosen': -113.40032958984375, 'rewards/rejected': -180.76657104492188, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 67.3662338256836, 'logps/rejected': -2022.948486328125, 'logps/chosen': -1283.3006591796875, 'logits/rejected': 0.03529789298772812, 'logits/chosen': 0.018430782482028008, 'epoch': 5.32}
{'loss': 0.0044, 'grad_norm': 0.006980971433222294, 'learning_rate': 1.35829028369991e-05, 'rewards/chosen': -107.87957763671875, 'rewards/rejected': -175.3100128173828, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 67.43043518066406, 'logps/rejected': -1968.634033203125, 'logps/chosen': -1227.812255859375, 'logits/rejected': -0.015428638085722923, 'logits/chosen': -0.034774087369441986, 'epoch': 5.4}
{'loss': 0.026, 'grad_norm': 3.3430814028179157e-07, 'learning_rate': 1.2303456618280141e-05, 'rewards/chosen': -105.8756103515625, 'rewards/rejected': -169.92999267578125, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 64.05439758300781, 'logps/rejected': -1952.016357421875, 'logps/chosen': -1214.2349853515625, 'logits/rejected': 0.0049421037547290325, 'logits/chosen': -0.0017230540979653597, 'epoch': 5.48}
{'loss': 0.026, 'grad_norm': 0.03840368241071701, 'learning_rate': 1.1078799509184246e-05, 'rewards/chosen': -119.7580337524414, 'rewards/rejected': -190.26272583007812, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 70.50469207763672, 'logps/rejected': -2118.61767578125, 'logps/chosen': -1352.99267578125, 'logits/rejected': 0.06086380407214165, 'logits/chosen': 0.04806669428944588, 'epoch': 5.56}
{'loss': 0.013, 'grad_norm': 0.0011572036892175674, 'learning_rate': 9.91071145732948e-06, 'rewards/chosen': -113.29425048828125, 'rewards/rejected': -188.27430725097656, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 74.98005676269531, 'logps/rejected': -2114.504150390625, 'logps/chosen': -1291.8367919921875, 'logits/rejected': 0.08226026594638824, 'logits/chosen': 0.08589659631252289, 'epoch': 5.65}
{'loss': 0.0173, 'grad_norm': 6.681525519525167e-07, 'learning_rate': 8.80089019143524e-06, 'rewards/chosen': -114.7328109741211, 'rewards/rejected': -184.67300415039062, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 69.940185546875, 'logps/rejected': -2076.30810546875, 'logps/chosen': -1299.6650390625, 'logits/rejected': -0.010436726734042168, 'logits/chosen': -0.014756882563233376, 'epoch': 5.73}
{'loss': 0.0303, 'grad_norm': 0.3921467959880829, 'learning_rate': 7.750948753800507e-06, 'rewards/chosen': -111.5093994140625, 'rewards/rejected': -184.98297119140625, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 73.47357177734375, 'logps/rejected': -2061.225830078125, 'logps/chosen': -1266.2613525390625, 'logits/rejected': 0.10596887022256851, 'logits/chosen': 0.09354397654533386, 'epoch': 5.81}
{'loss': 0.0347, 'grad_norm': 0.40723252296447754, 'learning_rate': 6.7624131558672756e-06, 'rewards/chosen': -125.34659576416016, 'rewards/rejected': -189.39456176757812, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 64.04798889160156, 'logps/rejected': -2106.140625, 'logps/chosen': -1398.926025390625, 'logits/rejected': 0.015561021864414215, 'logits/chosen': 0.021522248163819313, 'epoch': 5.89}
{'loss': 0.0217, 'grad_norm': 0.03405560553073883, 'learning_rate': 5.83672016027697e-06, 'rewards/chosen': -115.38948059082031, 'rewards/rejected': -189.29794311523438, 'rewards/accuracies': 0.96875, 'rewards/margins': 73.908447265625, 'logps/rejected': -2121.57568359375, 'logps/chosen': -1306.9444580078125, 'logits/rejected': -0.003026508493348956, 'logits/chosen': -0.009361891075968742, 'epoch': 5.97}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:42,  1.45it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.18s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.55s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.04s/it][A
 11%|█         | 7/63 [00:11<01:54,  2.04s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.98s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  2.00s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.94s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:18,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:34<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:19,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:20,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.29s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.47s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.64s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.41s/it][A
 60%|██████    | 38/63 [01:06<00:37,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:12<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.71s/it][A
 68%|██████▊   | 43/63 [01:15<00:32,  1.63s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.50s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:22,  1.38s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.50s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:34<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.42s/it][A
 92%|█████████▏| 58/63 [01:37<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.36s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.34s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                   
                                               [A 86%|████████▌ | 744/868 [3:54:48<36:21, 17.60s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 86%|████████▌ | 745/868 [3:55:06<1:40:32, 49.05s/it] 86%|████████▌ | 746/868 [3:55:25<1:21:36, 40.13s/it] 86%|████████▌ | 747/868 [3:55:39<1:05:10, 32.32s/it] 86%|████████▌ | 748/868 [3:55:58<56:16, 28.14s/it]   86%|████████▋ | 749/868 [3:56:14<49:05, 24.75s/it] 86%|████████▋ | 750/868 [3:56:36<46:31, 23.66s/it]                                                    86%|████████▋ | 750/868 [3:56:36<46:31, 23.66s/it] 87%|████████▋ | 751/868 [3:56:54<43:12, 22.15s/it] 87%|████████▋ | 752/868 [3:57:15<41:49, 21.63s/it] 87%|████████▋ | 753/868 [3:57:29<37:23, 19.51s/it] 87%|████████▋ | 754/868 [3:57:51<38:15, 20.14s/it] 87%|████████▋ | 755/868 [3:58:10<37:40, 20.01s/it] 87%|████████▋ | 756/868 [3:58:28<35:50, 19.20s/it] 87%|████████▋ | 757/868 [3:58:42<33:00, 17.84s/it] 87%|████████▋ | 758/868 [3:59:00<32:25, 17.69s/it] 87%|████████▋ | 759/868 [3:59:17<31:49, 17.52s/it] 88%|████████▊ | 760/868 [3:59:36<32:12, 17.89s/it]                                                    88%|████████▊ | 760/868 [3:59:36<32:12, 17.89s/it] 88%|████████▊ | 761/868 [3:59:52<31:05, 17.44s/it] 88%|████████▊ | 762/868 [4:00:08<29:53, 16.92s/it] 88%|████████▊ | 763/868 [4:00:25<29:51, 17.06s/it] 88%|████████▊ | 764/868 [4:00:49<32:59, 19.03s/it] 88%|████████▊ | 765/868 [4:01:07<32:14, 18.78s/it] 88%|████████▊ | 766/868 [4:01:26<31:51, 18.74s/it] 88%|████████▊ | 767/868 [4:01:41<29:58, 17.81s/it] 88%|████████▊ | 768/868 [4:02:01<30:43, 18.43s/it] 89%|████████▊ | 769/868 [4:02:16<28:27, 17.25s/it] 89%|████████▊ | 770/868 [4:02:34<28:56, 17.72s/it]                                                    89%|████████▊ | 770/868 [4:02:34<28:56, 17.72s/it] 89%|████████▉ | 771/868 [4:02:52<28:28, 17.61s/it] 89%|████████▉ | 772/868 [4:03:06<26:25, 16.51s/it] 89%|████████▉ | 773/868 [4:03:20<25:11, 15.91s/it] 89%|████████▉ | 774/868 [4:03:37<25:29, 16.27s/it] 89%|████████▉ | 775/868 [4:03:55<25:37, 16.53s/it] 89%|████████▉ | 776/868 [4:04:12<25:45, 16.80s/it] 90%|████████▉ | 777/868 [4:04:35<28:14, 18.63s/it] 90%|████████▉ | 778/868 [4:04:54<28:23, 18.93s/it] 90%|████████▉ | 779/868 [4:05:11<27:02, 18.23s/it] 90%|████████▉ | 780/868 [4:05:24<24:30, 16.71s/it]                                                    90%|████████▉ | 780/868 [4:05:24<24:30, 16.71s/it] 90%|████████▉ | 781/868 [4:05:40<23:39, 16.31s/it] 90%|█████████ | 782/868 [4:05:52<21:47, 15.20s/it] 90%|█████████ | 783/868 [4:06:07<21:08, 14.93s/it] 90%|█████████ | 784/868 [4:06:25<22:22, 15.98s/it] 90%|█████████ | 785/868 [4:06:45<24:00, 17.35s/it] 91%|█████████ | 786/868 [4:07:00<22:33, 16.50s/it] 91%|█████████ | 787/868 [4:07:20<23:51, 17.68s/it] 91%|█████████ | 788/868 [4:07:43<25:25, 19.07s/it] 91%|█████████ | 789/868 [4:07:57<23:06, 17.55s/it] 91%|█████████ | 790/868 [4:08:22<25:54, 19.93s/it]                                                    91%|█████████ | 790/868 [4:08:22<25:54, 19.93s/it] 91%|█████████ | 791/868 [4:08:39<24:13, 18.87s/it] 91%|█████████ | 792/868 [4:08:55<22:50, 18.03s/it] 91%|█████████▏| 793/868 [4:09:11<21:58, 17.58s/it] 91%|█████████▏| 794/868 [4:09:28<21:24, 17.36s/it] 92%|█████████▏| 795/868 [4:09:42<19:58, 16.42s/it] 92%|█████████▏| 796/868 [4:10:00<20:19, 16.94s/it] 92%|█████████▏| 797/868 [4:10:18<20:25, 17.26s/it] 92%|█████████▏| 798/868 [4:10:35<19:52, 17.03s/it] 92%|█████████▏| 799/868 [4:10:52<19:29, 16.95s/it] 92%|█████████▏| 800/868 [4:11:08<19:05, 16.84s/it]                                                    92%|█████████▏| 800/868 [4:11:08<19:05, 16.84s/it] 92%|█████████▏| 801/868 [4:11:27<19:23, 17.36s/it] 92%|█████████▏| 802/868 [4:11:43<18:48, 17.09s/it] 93%|█████████▎| 803/868 [4:12:00<18:24, 16.99s/it] 93%|█████████▎| 804/868 [4:12:20<19:07, 17.94s/it] 93%|█████████▎| 805/868 [4:12:35<17:57, 17.11s/it] 93%|█████████▎| 806/868 [4:12:57<19:10, 18.56s/it] 93%|█████████▎| 807/868 [4:13:12<17:31, 17.24s/it] 93%|█████████▎| 808/868 [4:13:32<18:12, 18.21s/it] 93%|█████████▎| 809/868 [4:13:49<17:29, 17.79s/it] 93%|█████████▎| 810/868 [4:14:10<18:15, 18.88s/it]                                                    93%|█████████▎| 810/868 [4:14:10<18:15, 18.88s/it] 93%|█████████▎| 811/868 [4:14:33<19:06, 20.11s/it] 94%|█████████▎| 812/868 [4:14:55<19:16, 20.66s/it] 94%|█████████▎| 813/868 [4:15:12<17:59, 19.64s/it] 94%|█████████▍| 814/868 [4:15:33<17:59, 19.99s/it] 94%|█████████▍| 815/868 [4:15:53<17:29, 19.80s/it] 94%|█████████▍| 816/868 [4:16:08<16:03, 18.53s/it] 94%|█████████▍| 817/868 [4:16:30<16:31, 19.44s/it] 94%|█████████▍| 818/868 [4:16:46<15:18, 18.37s/it] 94%|█████████▍| 819/868 [4:17:04<15:05, 18.48s/it] 94%|█████████▍| 820/868 [4:17:22<14:38, 18.30s/it]                                                    94%|█████████▍| 820/868 [4:17:22<14:38, 18.30s/it] 95%|█████████▍| 821/868 [4:17:39<13:57, 17.82s/it] 95%|█████████▍| 822/868 [4:18:00<14:20, 18.71s/it] 95%|█████████▍| 823/868 [4:18:16<13:27, 17.95s/it] 95%|█████████▍| 824/868 [4:18:38<14:04, 19.20s/it] 95%|█████████▌| 825/868 [4:18:59<14:12, 19.83s/it] 95%|█████████▌| 826/868 [4:19:16<13:15, 18.94s/it] 95%|█████████▌| 827/868 [4:19:39<13:39, 19.99s/it] 95%|█████████▌| 828/868 [4:19:55<12:32, 18.82s/it] 96%|█████████▌| 829/868 [4:20:13<12:03, 18.56s/it] 96%|█████████▌| 830/868 [4:20:37<12:57, 20.46s/it]                                                    96%|█████████▌| 830/868 [4:20:37<12:57, 20.46s/it] 96%|█████████▌| 831/868 [4:20:55<12:09, 19.71s/it] 96%|█████████▌| 832/868 [4:21:16<12:00, 20.01s/it] 96%|█████████▌| 833/868 [4:21:39<12:05, 20.72s/it] 96%|█████████▌| 834/868 [4:21:56<11:07, 19.63s/it] 96%|█████████▌| 835/868 [4:22:14<10:34, 19.24s/it] 96%|█████████▋| 836/868 [4:22:29<09:34, 17.96s/it] 96%|█████████▋| 837/868 [4:22:44<08:52, 17.16s/it] 97%|█████████▋| 838/868 [4:22:59<08:08, 16.29s/it] 97%|█████████▋| 839/868 [4:23:15<07:52, 16.30s/it] 97%|█████████▋| 840/868 [4:23:39<08:44, 18.73s/it]                                                    97%|█████████▋| 840/868 [4:23:39<08:44, 18.73s/it] 97%|█████████▋| 841/868 [4:23:59<08:35, 19.09s/it] 97%|█████████▋| 842/868 [4:24:18<08:16, 19.11s/it] 97%|█████████▋| 843/868 [4:24:31<07:06, 17.05s/it] 97%|█████████▋| 844/868 [4:24:53<07:25, 18.56s/it] 97%|█████████▋| 845/868 [4:25:09<06:50, 17.86s/it] 97%|█████████▋| 846/868 [4:25:29<06:46, 18.49s/it] 98%|█████████▊| 847/868 [4:25:46<06:17, 18.00s/it] 98%|█████████▊| 848/868 [4:26:04<06:01, 18.07s/it] 98%|█████████▊| 849/868 [4:26:25<06:02, 19.05s/it] 98%|█████████▊| 850/868 [4:26:39<05:15, 17.50s/it]                                                    98%|█████████▊| 850/868 [4:26:39<05:15, 17.50s/it] 98%|█████████▊| 851/868 [4:26:56<04:52, 17.19s/it] 98%|█████████▊| 852/868 [4:27:14<04:40, 17.56s/it] 98%|█████████▊| 853/868 [4:27:37<04:45, 19.04s/it] 98%|█████████▊| 854/868 [4:27:53<04:15, 18.24s/it] 99%|█████████▊| 855/868 [4:28:15<04:14, 19.55s/it] 99%|█████████▊| 856/868 [4:28:36<03:56, 19.75s/it] 99%|█████████▊| 857/868 [4:28:58<03:44, 20.43s/it] 99%|█████████▉| 858/868 [4:29:19<03:27, 20.70s/it] 99%|█████████▉| 859/868 [4:29:34<02:51, 19.08s/it] 99%|█████████▉| 860/868 [4:29:49<02:21, 17.70s/it]                                                    99%|█████████▉| 860/868 [4:29:49<02:21, 17.70s/it] 99%|█████████▉| 861/868 [4:30:03<01:55, 16.50s/it] 99%|█████████▉| 862/868 [4:30:20<01:41, 16.88s/it] 99%|█████████▉| 863/868 [4:30:35<01:21, 16.30s/it]100%|█████████▉| 864/868 [4:30:57<01:12, 18.07s/it]100%|█████████▉| 865/868 [4:31:13<00:51, 17.19s/it]100%|█████████▉| 866/868 [4:31:35<00:37, 18.91s/it]100%|█████████▉| 867/868 [4:31:51<00:17, 17.83s/it]100%|██████████| 868/868 [4:32:07<00:00, 17.28s/it]{'eval_loss': 1.3136684894561768, 'eval_runtime': 104.541, 'eval_samples_per_second': 2.382, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -152.6188507080078, 'eval_rewards/rejected': -192.89547729492188, 'eval_rewards/accuracies': 0.7896825671195984, 'eval_rewards/margins': 40.276641845703125, 'eval_logps/rejected': -2261.46630859375, 'eval_logps/chosen': -1955.987548828125, 'eval_logits/rejected': -0.27456459403038025, 'eval_logits/chosen': -0.27490878105163574, 'epoch': 6.0}
{'loss': 0.039, 'grad_norm': 0.5427441596984863, 'learning_rate': 4.975215192643246e-06, 'rewards/chosen': -110.2582015991211, 'rewards/rejected': -181.03439331054688, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 70.77619934082031, 'logps/rejected': -2064.91259765625, 'logps/chosen': -1263.000732421875, 'logits/rejected': 0.05255485326051712, 'logits/chosen': 0.06289275735616684, 'epoch': 6.05}
{'loss': 0.0173, 'grad_norm': 0.00018826218729373068, 'learning_rate': 4.179150386076424e-06, 'rewards/chosen': -111.88230895996094, 'rewards/rejected': -183.6613311767578, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 71.7790298461914, 'logps/rejected': -2058.97802734375, 'logps/chosen': -1270.599365234375, 'logits/rejected': 0.00685711856931448, 'logits/chosen': -0.003915312699973583, 'epoch': 6.13}
{'loss': 0.0173, 'grad_norm': 0.9204816222190857, 'learning_rate': 3.4496827613015202e-06, 'rewards/chosen': -116.98946380615234, 'rewards/rejected': -187.09959411621094, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 70.11012268066406, 'logps/rejected': -2094.04296875, 'logps/chosen': -1316.109619140625, 'logits/rejected': 0.03551542013883591, 'logits/chosen': 0.04046756774187088, 'epoch': 6.21}
{'loss': 0.013, 'grad_norm': 0.0003061836468987167, 'learning_rate': 2.787872545015069e-06, 'rewards/chosen': -104.7730712890625, 'rewards/rejected': -173.8727264404297, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 69.09965515136719, 'logps/rejected': -1970.5126953125, 'logps/chosen': -1200.207763671875, 'logits/rejected': 0.008569528348743916, 'logits/chosen': 0.021166613325476646, 'epoch': 6.29}
{'loss': 0.0347, 'grad_norm': 0.0036827954463660717, 'learning_rate': 2.194681628924816e-06, 'rewards/chosen': -112.69044494628906, 'rewards/rejected': -182.85079956054688, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 70.16036224365234, 'logps/rejected': -2059.33349609375, 'logps/chosen': -1278.7608642578125, 'logits/rejected': 0.04517127200961113, 'logits/chosen': 0.04427865892648697, 'epoch': 6.37}
{'loss': 0.0217, 'grad_norm': 0.4712863564491272, 'learning_rate': 1.6709721717120042e-06, 'rewards/chosen': -109.85430908203125, 'rewards/rejected': -183.09161376953125, 'rewards/accuracies': 0.96875, 'rewards/margins': 73.23731994628906, 'logps/rejected': -2063.99462890625, 'logps/chosen': -1252.6971435546875, 'logits/rejected': 0.036851488053798676, 'logits/chosen': 0.0325736477971077, 'epoch': 6.45}
{'loss': 0.039, 'grad_norm': 0.056000348180532455, 'learning_rate': 1.2175053459481e-06, 'rewards/chosen': -111.55693054199219, 'rewards/rejected': -178.72244262695312, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 67.16551971435547, 'logps/rejected': -2006.41015625, 'logps/chosen': -1268.865966796875, 'logits/rejected': 0.03533070161938667, 'logits/chosen': 0.02326909825205803, 'epoch': 6.53}
{'loss': 0.0477, 'grad_norm': 0.5874709486961365, 'learning_rate': 8.349402317873789e-07, 'rewards/chosen': -122.87396240234375, 'rewards/rejected': -190.24295043945312, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 67.36897277832031, 'logps/rejected': -2123.61083984375, 'logps/chosen': -1384.155517578125, 'logits/rejected': 0.043113235384225845, 'logits/chosen': 0.023034486919641495, 'epoch': 6.61}
{'loss': 0.0303, 'grad_norm': 0.599153995513916, 'learning_rate': 5.238328590431162e-07, 'rewards/chosen': -126.82469177246094, 'rewards/rejected': -186.33657836914062, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 59.51189422607422, 'logps/rejected': -2081.88671875, 'logps/chosen': -1419.029541015625, 'logits/rejected': 0.1330614984035492, 'logits/chosen': 0.1119183897972107, 'epoch': 6.69}
{'loss': 0.013, 'grad_norm': 0.6063226461410522, 'learning_rate': 2.846353990398065e-07, 'rewards/chosen': -110.9261245727539, 'rewards/rejected': -183.26084899902344, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 72.33473205566406, 'logps/rejected': -2059.40625, 'logps/chosen': -1266.6419677734375, 'logits/rejected': -0.0021169125102460384, 'logits/chosen': -0.001926422119140625, 'epoch': 6.77}
{'loss': 0.0217, 'grad_norm': 0.34180402755737305, 'learning_rate': 1.1769550741592139e-07, 'rewards/chosen': -115.95988464355469, 'rewards/rejected': -183.0562286376953, 'rewards/accuracies': 0.96875, 'rewards/margins': 67.0963363647461, 'logps/rejected': -2050.076416015625, 'logps/chosen': -1310.4178466796875, 'logits/rejected': 0.05554584413766861, 'logits/chosen': 0.05323149636387825, 'epoch': 6.85}
{'loss': 0.026, 'grad_norm': 0.3989008963108063, 'learning_rate': 2.3255818832423894e-08, 'rewards/chosen': -116.0732192993164, 'rewards/rejected': -188.6829833984375, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 72.6097412109375, 'logps/rejected': -2115.261474609375, 'logps/chosen': -1316.97705078125, 'logits/rejected': 0.08661225438117981, 'logits/chosen': 0.08475106954574585, 'epoch': 6.94}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:01<00:41,  1.46it/s][A
  5%|▍         | 3/63 [00:03<01:10,  1.18s/it][A
  6%|▋         | 4/63 [00:05<01:24,  1.43s/it][A
  8%|▊         | 5/63 [00:06<01:30,  1.55s/it][A
 10%|▉         | 6/63 [00:09<01:56,  2.04s/it][A
 11%|█         | 7/63 [00:11<01:53,  2.04s/it][A
 13%|█▎        | 8/63 [00:13<01:48,  1.98s/it][A
 14%|█▍        | 9/63 [00:15<01:34,  1.75s/it][A
 16%|█▌        | 10/63 [00:16<01:35,  1.80s/it][A
 17%|█▋        | 11/63 [00:18<01:34,  1.82s/it][A
 19%|█▉        | 12/63 [00:20<01:33,  1.84s/it][A
 21%|██        | 13/63 [00:22<01:25,  1.71s/it][A
 22%|██▏       | 14/63 [00:24<01:37,  1.99s/it][A
 24%|██▍       | 15/63 [00:26<01:32,  1.93s/it][A
 25%|██▌       | 16/63 [00:28<01:29,  1.91s/it][A
 27%|██▋       | 17/63 [00:29<01:18,  1.70s/it][A
 29%|██▊       | 18/63 [00:30<01:07,  1.50s/it][A
 30%|███       | 19/63 [00:31<01:03,  1.44s/it][A
 32%|███▏      | 20/63 [00:34<01:10,  1.63s/it][A
 33%|███▎      | 21/63 [00:35<01:10,  1.69s/it][A
 35%|███▍      | 22/63 [00:38<01:19,  1.93s/it][A
 37%|███▋      | 23/63 [00:40<01:20,  2.00s/it][A
 38%|███▊      | 24/63 [00:42<01:18,  2.01s/it][A
 40%|███▉      | 25/63 [00:44<01:16,  2.02s/it][A
 41%|████▏     | 26/63 [00:47<01:24,  2.29s/it][A
 43%|████▎     | 27/63 [00:50<01:28,  2.47s/it][A
 44%|████▍     | 28/63 [00:52<01:20,  2.30s/it][A
 46%|████▌     | 29/63 [00:53<01:05,  1.94s/it][A
 48%|████▊     | 30/63 [00:54<00:56,  1.70s/it][A
 49%|████▉     | 31/63 [00:55<00:50,  1.57s/it][A
 51%|█████     | 32/63 [00:57<00:46,  1.49s/it][A
 52%|█████▏    | 33/63 [00:58<00:43,  1.44s/it][A
 54%|█████▍    | 34/63 [01:00<00:45,  1.56s/it][A
 56%|█████▌    | 35/63 [01:02<00:45,  1.63s/it][A
 57%|█████▋    | 36/63 [01:03<00:40,  1.51s/it][A
 59%|█████▊    | 37/63 [01:04<00:36,  1.40s/it][A
 60%|██████    | 38/63 [01:06<00:36,  1.48s/it][A
 62%|██████▏   | 39/63 [01:08<00:40,  1.69s/it][A
 63%|██████▎   | 40/63 [01:10<00:42,  1.83s/it][A
 65%|██████▌   | 41/63 [01:11<00:38,  1.75s/it][A
 67%|██████▋   | 42/63 [01:13<00:35,  1.70s/it][A
 68%|██████▊   | 43/63 [01:14<00:32,  1.62s/it][A
 70%|██████▉   | 44/63 [01:16<00:28,  1.50s/it][A
 71%|███████▏  | 45/63 [01:17<00:25,  1.42s/it][A
 73%|███████▎  | 46/63 [01:18<00:23,  1.37s/it][A
 75%|███████▍  | 47/63 [01:20<00:22,  1.38s/it][A
 76%|███████▌  | 48/63 [01:21<00:21,  1.44s/it][A
 78%|███████▊  | 49/63 [01:22<00:18,  1.32s/it][A
 79%|███████▉  | 50/63 [01:24<00:19,  1.50s/it][A
 81%|████████  | 51/63 [01:26<00:17,  1.48s/it][A
 83%|████████▎ | 52/63 [01:28<00:19,  1.78s/it][A
 84%|████████▍ | 53/63 [01:29<00:15,  1.57s/it][A
 86%|████████▌ | 54/63 [01:31<00:13,  1.54s/it][A
 87%|████████▋ | 55/63 [01:32<00:12,  1.51s/it][A
 89%|████████▉ | 56/63 [01:33<00:10,  1.48s/it][A
 90%|█████████ | 57/63 [01:35<00:08,  1.42s/it][A
 92%|█████████▏| 58/63 [01:36<00:07,  1.51s/it][A
 94%|█████████▎| 59/63 [01:38<00:05,  1.49s/it][A
 95%|█████████▌| 60/63 [01:39<00:04,  1.34s/it][A
 97%|█████████▋| 61/63 [01:40<00:02,  1.36s/it][A
 98%|█████████▊| 62/63 [01:42<00:01,  1.33s/it][A
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A                                                   
                                               [A100%|██████████| 868/868 [4:33:51<00:00, 17.28s/it]
100%|██████████| 63/63 [01:42<00:00,  1.07s/it][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
                                                   100%|██████████| 868/868 [4:33:55<00:00, 17.28s/it]100%|██████████| 868/868 [4:33:55<00:00, 18.93s/it]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/root/knowledge_distillation/sft/sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64/final_merged_checkpoint - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 1.2762616872787476, 'eval_runtime': 104.4426, 'eval_samples_per_second': 2.384, 'eval_steps_per_second': 0.603, 'eval_rewards/chosen': -152.3485107421875, 'eval_rewards/rejected': -192.34320068359375, 'eval_rewards/accuracies': 0.8015872836112976, 'eval_rewards/margins': 39.99468231201172, 'eval_logps/rejected': -2255.943115234375, 'eval_logps/chosen': -1953.2843017578125, 'eval_logits/rejected': -0.2732163369655609, 'eval_logits/chosen': -0.27448904514312744, 'epoch': 7.0}
{'train_runtime': 16452.1989, 'train_samples_per_second': 0.844, 'train_steps_per_second': 0.053, 'train_loss': 0.07576570238849398, 'epoch': 7.0}
wandb: - 0.371 MB of 0.371 MB uploadedwandb: \ 0.402 MB of 0.402 MB uploadedwandb: 
wandb: Run history:
wandb:       eval/logits/chosen ▁▆█▂▁▁▁
wandb:     eval/logits/rejected ▁▅█▂▁▁▁
wandb:        eval/logps/chosen █▅▁▃▄▄▄
wandb:      eval/logps/rejected █▅▁▃▄▄▄
wandb:                eval/loss ▃█▃▁▂▁▁
wandb:  eval/rewards/accuracies ▃▁▄██▇█
wandb:      eval/rewards/chosen █▅▁▃▄▄▄
wandb:     eval/rewards/margins ▁▁▇█▇▇▇
wandb:    eval/rewards/rejected █▅▁▃▄▄▄
wandb:             eval/runtime ▄▁▂█▂▇▂
wandb:  eval/samples_per_second ▄█▆▁▆▃▆
wandb:    eval/steps_per_second ▁▁▁▁▁▁▁
wandb:              train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:        train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:          train/grad_norm ▂▂▁▂▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      train/learning_rate ▃▆███████▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁
wandb:      train/logits/chosen ▁▂▃▂▃▄▄▄▄▄▄▅▇▆▆▅▆█▇▅▅▄▄▅▅▅▅▅▅▄▅▄▅▅▅▅▅▅▅▅
wandb:    train/logits/rejected ▁▂▃▂▄▄▅▄▄▄▄▄▇▆▆▅▆█▇▅▅▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:       train/logps/chosen ██▇▇▆▅▄▆▅▅▄▅▄▂▅▅▃▁▂▃▄▆▄▂▃▃▃▄▄▄▄▄▄▄▄▃▄▄▃▄
wandb:     train/logps/rejected ██▇▇▆▆▄▆▅▄▄▅▄▂▅▄▂▁▂▃▄▅▄▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               train/loss █▄▂▂▂█▂▆▂▄▁▂▁▅▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁
wandb: train/rewards/accuracies ▁▄▅▆▇▆▇▆▆▆▇▇▇▆▇▇██▇▇█▇▆▇▇▇▇▇▇▆▇▇█▇▇▇▇▇▇▇
wandb:     train/rewards/chosen ██▇▇▆▅▄▆▅▅▄▅▄▂▅▅▃▁▂▃▄▆▄▂▃▃▃▄▄▄▄▄▄▄▄▃▄▄▃▃
wandb:    train/rewards/margins ▁▂▂▃▃▃▅▄▄▆▅▄▅█▅▆▇█▇▆▆▅▆▇▆▇▆▇▇▇▇▆▇▇▇▇▇▇▆▇
wandb:   train/rewards/rejected █▇▇▇▆▆▄▆▅▄▄▅▄▂▅▄▂▁▂▃▄▅▄▂▃▃▃▃▃▃▃▄▃▃▃▃▃▃▃▃
wandb: 
wandb: Run summary:
wandb:       eval/logits/chosen -0.27449
wandb:     eval/logits/rejected -0.27322
wandb:        eval/logps/chosen -1953.2843
wandb:      eval/logps/rejected -2255.94312
wandb:                eval/loss 1.27626
wandb:  eval/rewards/accuracies 0.80159
wandb:      eval/rewards/chosen -152.34851
wandb:     eval/rewards/margins 39.99468
wandb:    eval/rewards/rejected -192.3432
wandb:             eval/runtime 104.4426
wandb:  eval/samples_per_second 2.384
wandb:    eval/steps_per_second 0.603
wandb:               total_flos 0.0
wandb:              train/epoch 7.0
wandb:        train/global_step 868
wandb:          train/grad_norm 0.3989
wandb:      train/learning_rate 0.0
wandb:      train/logits/chosen 0.08475
wandb:    train/logits/rejected 0.08661
wandb:       train/logps/chosen -1316.97705
wandb:     train/logps/rejected -2115.26147
wandb:               train/loss 0.026
wandb: train/rewards/accuracies 0.9625
wandb:     train/rewards/chosen -116.07322
wandb:    train/rewards/margins 72.60974
wandb:   train/rewards/rejected -188.68298
wandb:               train_loss 0.07577
wandb:            train_runtime 16452.1989
wandb: train_samples_per_second 0.844
wandb:   train_steps_per_second 0.053
wandb: 
wandb: 🚀 View run dpo_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/k5rctu5t
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240526_232459-k5rctu5t/logs
