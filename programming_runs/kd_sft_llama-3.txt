`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.63s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:30<00:30, 15.15s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:46<00:15, 15.37s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 11.02s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 12.61s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Found max lenth: 8192
trainable params: 83886080 || all params: 4624486400 || trainables%: 1.813954518279046
Map:   0%|          | 0/1938 [00:00<?, ? examples/s]Map:  52%|█████▏    | 1000/1938 [00:01<00:01, 654.55 examples/s]Map: 100%|██████████| 1938/1938 [00:02<00:00, 758.38 examples/s]Map: 100%|██████████| 1938/1938 [00:02<00:00, 736.48 examples/s]
Map:   0%|          | 0/243 [00:00<?, ? examples/s]Map: 100%|██████████| 243/243 [00:00<00:00, 809.86 examples/s]Map: 100%|██████████| 243/243 [00:00<00:00, 799.07 examples/s]
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240526_145152-4akg6hvg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/4akg6hvg
  0%|          | 0/847 [00:00<?, ?it/s]/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|          | 1/847 [00:09<2:12:57,  9.43s/it]  0%|          | 2/847 [00:16<1:57:03,  8.31s/it]  0%|          | 3/847 [00:24<1:50:23,  7.85s/it]  0%|          | 4/847 [00:31<1:47:11,  7.63s/it]  1%|          | 5/847 [00:38<1:45:10,  7.49s/it]  1%|          | 6/847 [00:47<1:49:00,  7.78s/it]  1%|          | 7/847 [00:55<1:52:22,  8.03s/it]  1%|          | 8/847 [01:03<1:51:08,  7.95s/it]  1%|          | 9/847 [01:10<1:45:40,  7.57s/it]  1%|          | 10/847 [01:18<1:50:24,  7.91s/it]                                                    1%|          | 10/847 [01:18<1:50:24,  7.91s/it]  1%|▏         | 11/847 [01:26<1:50:19,  7.92s/it]  1%|▏         | 12/847 [01:36<1:58:10,  8.49s/it]  2%|▏         | 13/847 [01:45<2:00:47,  8.69s/it]  2%|▏         | 14/847 [01:53<1:58:27,  8.53s/it]  2%|▏         | 15/847 [02:02<1:58:23,  8.54s/it]  2%|▏         | 16/847 [02:14<2:13:54,  9.67s/it]  2%|▏         | 17/847 [02:21<2:03:26,  8.92s/it]  2%|▏         | 18/847 [02:29<1:58:24,  8.57s/it]  2%|▏         | 19/847 [02:37<1:54:43,  8.31s/it]  2%|▏         | 20/847 [02:46<1:56:16,  8.44s/it]                                                    2%|▏         | 20/847 [02:46<1:56:16,  8.44s/it]  2%|▏         | 21/847 [02:52<1:47:29,  7.81s/it]  3%|▎         | 22/847 [03:02<1:56:04,  8.44s/it]  3%|▎         | 23/847 [03:08<1:45:17,  7.67s/it]  3%|▎         | 24/847 [03:15<1:44:31,  7.62s/it]  3%|▎         | 25/847 [03:25<1:53:09,  8.26s/it]  3%|▎         | 26/847 [03:32<1:48:15,  7.91s/it]  3%|▎         | 27/847 [03:40<1:47:21,  7.86s/it]  3%|▎         | 28/847 [03:47<1:44:34,  7.66s/it]  3%|▎         | 29/847 [03:55<1:46:26,  7.81s/it]  4%|▎         | 30/847 [04:03<1:45:14,  7.73s/it]                                                    4%|▎         | 30/847 [04:03<1:45:14,  7.73s/it]  4%|▎         | 31/847 [04:11<1:45:49,  7.78s/it]  4%|▍         | 32/847 [04:20<1:50:47,  8.16s/it]  4%|▍         | 33/847 [04:27<1:48:29,  8.00s/it]  4%|▍         | 34/847 [04:37<1:53:23,  8.37s/it]  4%|▍         | 35/847 [04:43<1:45:14,  7.78s/it]  4%|▍         | 36/847 [04:50<1:42:23,  7.57s/it]  4%|▍         | 37/847 [04:59<1:45:54,  7.85s/it]  4%|▍         | 38/847 [05:08<1:51:21,  8.26s/it]  5%|▍         | 39/847 [05:17<1:54:15,  8.48s/it]  5%|▍         | 40/847 [05:26<1:59:05,  8.85s/it]                                                    5%|▍         | 40/847 [05:26<1:59:05,  8.85s/it]  5%|▍         | 41/847 [05:35<1:58:43,  8.84s/it]  5%|▍         | 42/847 [05:42<1:49:29,  8.16s/it]  5%|▌         | 43/847 [05:49<1:44:12,  7.78s/it]  5%|▌         | 44/847 [05:58<1:50:56,  8.29s/it]  5%|▌         | 45/847 [06:07<1:51:43,  8.36s/it]  5%|▌         | 46/847 [06:16<1:55:56,  8.68s/it]  6%|▌         | 47/847 [06:25<1:54:46,  8.61s/it]  6%|▌         | 48/847 [06:32<1:50:55,  8.33s/it]  6%|▌         | 49/847 [06:43<1:59:20,  8.97s/it]  6%|▌         | 50/847 [06:52<1:59:25,  8.99s/it]                                                    6%|▌         | 50/847 [06:52<1:59:25,  8.99s/it]  6%|▌         | 51/847 [07:01<1:59:23,  9.00s/it]  6%|▌         | 52/847 [07:08<1:53:49,  8.59s/it]  6%|▋         | 53/847 [07:17<1:53:27,  8.57s/it]  6%|▋         | 54/847 [07:26<1:53:27,  8.58s/it]  6%|▋         | 55/847 [07:34<1:54:32,  8.68s/it]  7%|▋         | 56/847 [07:43<1:51:47,  8.48s/it]  7%|▋         | 57/847 [07:51<1:53:07,  8.59s/it]  7%|▋         | 58/847 [08:00<1:52:12,  8.53s/it]  7%|▋         | 59/847 [08:10<1:59:55,  9.13s/it]  7%|▋         | 60/847 [08:19<1:56:59,  8.92s/it]                                                    7%|▋         | 60/847 [08:19<1:56:59,  8.92s/it]  7%|▋         | 61/847 [08:27<1:54:18,  8.73s/it]  7%|▋         | 62/847 [08:34<1:47:45,  8.24s/it]  7%|▋         | 63/847 [08:42<1:46:41,  8.16s/it]  8%|▊         | 64/847 [08:49<1:42:00,  7.82s/it]  8%|▊         | 65/847 [08:58<1:44:15,  8.00s/it]  8%|▊         | 66/847 [09:05<1:43:59,  7.99s/it]  8%|▊         | 67/847 [09:14<1:47:11,  8.24s/it]  8%|▊         | 68/847 [09:23<1:47:05,  8.25s/it]  8%|▊         | 69/847 [09:30<1:43:42,  8.00s/it]  8%|▊         | 70/847 [09:38<1:43:58,  8.03s/it]                                                    8%|▊         | 70/847 [09:38<1:43:58,  8.03s/it]  8%|▊         | 71/847 [09:48<1:51:22,  8.61s/it]  9%|▊         | 72/847 [09:55<1:43:03,  7.98s/it]  9%|▊         | 73/847 [10:02<1:40:50,  7.82s/it]  9%|▊         | 74/847 [10:09<1:37:09,  7.54s/it]  9%|▉         | 75/847 [10:17<1:39:41,  7.75s/it]  9%|▉         | 76/847 [10:25<1:41:50,  7.92s/it]  9%|▉         | 77/847 [10:36<1:50:10,  8.59s/it]  9%|▉         | 78/847 [10:43<1:43:34,  8.08s/it]  9%|▉         | 79/847 [10:51<1:46:20,  8.31s/it]  9%|▉         | 80/847 [11:01<1:50:45,  8.66s/it]                                                    9%|▉         | 80/847 [11:01<1:50:45,  8.66s/it] 10%|▉         | 81/847 [11:10<1:50:50,  8.68s/it] 10%|▉         | 82/847 [11:20<1:56:02,  9.10s/it] 10%|▉         | 83/847 [11:28<1:52:58,  8.87s/it] 10%|▉         | 84/847 [11:37<1:54:39,  9.02s/it] 10%|█         | 85/847 [11:44<1:46:35,  8.39s/it] 10%|█         | 86/847 [11:54<1:52:11,  8.84s/it] 10%|█         | 87/847 [12:02<1:47:44,  8.51s/it] 10%|█         | 88/847 [12:09<1:41:49,  8.05s/it] 11%|█         | 89/847 [12:17<1:40:51,  7.98s/it] 11%|█         | 90/847 [12:27<1:50:16,  8.74s/it]                                                   11%|█         | 90/847 [12:27<1:50:16,  8.74s/it] 11%|█         | 91/847 [12:36<1:49:47,  8.71s/it] 11%|█         | 92/847 [12:43<1:42:14,  8.13s/it] 11%|█         | 93/847 [12:52<1:45:01,  8.36s/it] 11%|█         | 94/847 [13:00<1:44:52,  8.36s/it] 11%|█         | 95/847 [13:09<1:47:50,  8.60s/it] 11%|█▏        | 96/847 [13:17<1:43:39,  8.28s/it] 11%|█▏        | 97/847 [13:25<1:43:14,  8.26s/it] 12%|█▏        | 98/847 [13:34<1:44:53,  8.40s/it] 12%|█▏        | 99/847 [13:41<1:41:30,  8.14s/it] 12%|█▏        | 100/847 [13:49<1:39:43,  8.01s/it]                                                    12%|█▏        | 100/847 [13:49<1:39:43,  8.01s/it] 12%|█▏        | 101/847 [13:57<1:42:10,  8.22s/it] 12%|█▏        | 102/847 [14:05<1:39:05,  7.98s/it] 12%|█▏        | 103/847 [14:13<1:39:17,  8.01s/it] 12%|█▏        | 104/847 [14:21<1:40:59,  8.16s/it] 12%|█▏        | 105/847 [14:29<1:39:43,  8.06s/it] 13%|█▎        | 106/847 [14:38<1:42:29,  8.30s/it] 13%|█▎        | 107/847 [14:47<1:42:47,  8.33s/it] 13%|█▎        | 108/847 [14:57<1:49:11,  8.87s/it] 13%|█▎        | 109/847 [15:06<1:51:26,  9.06s/it] 13%|█▎        | 110/847 [15:16<1:52:35,  9.17s/it]                                                    13%|█▎        | 110/847 [15:16<1:52:35,  9.17s/it] 13%|█▎        | 111/847 [15:25<1:53:59,  9.29s/it] 13%|█▎        | 112/847 [15:32<1:45:04,  8.58s/it] 13%|█▎        | 113/847 [15:40<1:42:49,  8.41s/it] 13%|█▎        | 114/847 [15:50<1:49:30,  8.96s/it] 14%|█▎        | 115/847 [15:58<1:46:05,  8.70s/it] 14%|█▎        | 116/847 [16:07<1:45:38,  8.67s/it] 14%|█▍        | 117/847 [16:14<1:37:57,  8.05s/it] 14%|█▍        | 118/847 [16:21<1:34:11,  7.75s/it] 14%|█▍        | 119/847 [16:28<1:30:40,  7.47s/it] 14%|█▍        | 120/847 [16:37<1:37:42,  8.06s/it]                                                    14%|█▍        | 120/847 [16:37<1:37:42,  8.06s/it] 14%|█▍        | 121/847 [16:44<1:35:32,  7.90s/it]{'loss': 1.7794, 'grad_norm': 1.12211275100708, 'learning_rate': 2.3255813953488374e-05, 'epoch': 0.08}
{'loss': 1.4083, 'grad_norm': 0.47234007716178894, 'learning_rate': 4.651162790697675e-05, 'epoch': 0.16}
{'loss': 1.2416, 'grad_norm': 0.4653474986553192, 'learning_rate': 6.976744186046513e-05, 'epoch': 0.25}
{'loss': 1.2466, 'grad_norm': 0.422316312789917, 'learning_rate': 9.30232558139535e-05, 'epoch': 0.33}
{'loss': 1.1879, 'grad_norm': 0.533633291721344, 'learning_rate': 9.998129762932685e-05, 'epoch': 0.41}
{'loss': 1.1911, 'grad_norm': 0.3959059715270996, 'learning_rate': 9.98897278608489e-05, 'epoch': 0.49}
{'loss': 1.1999, 'grad_norm': 0.44336265325546265, 'learning_rate': 9.97219951831298e-05, 'epoch': 0.58}
{'loss': 1.1682, 'grad_norm': 0.3819752037525177, 'learning_rate': 9.947835566108026e-05, 'epoch': 0.66}
{'loss': 1.1951, 'grad_norm': 0.36354708671569824, 'learning_rate': 9.915918124090248e-05, 'epoch': 0.74}
{'loss': 1.1934, 'grad_norm': 0.4165036976337433, 'learning_rate': 9.876495918226772e-05, 'epoch': 0.82}
{'loss': 1.156, 'grad_norm': 0.3258582353591919, 'learning_rate': 9.829629131445342e-05, 'epoch': 0.91}
{'loss': 1.0925, 'grad_norm': 0.36360669136047363, 'learning_rate': 9.775389311757567e-05, 'epoch': 0.99}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.19it/s][A
  5%|▍         | 3/61 [00:01<00:29,  1.94it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.72it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.75it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.74it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:33,  1.56it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.73it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:30,  1.66it/s][A
 20%|█▉        | 12/61 [00:07<00:29,  1.64it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.67it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.76it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.67it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.69it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.67it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.62it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.70it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.50it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:14<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.42it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.53it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.42it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.35it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.42it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.45it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.66it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.69it/s][A
 62%|██████▏   | 38/61 [00:24<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.65it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.73it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.60it/s][A
 70%|███████   | 43/61 [00:27<00:10,  1.64it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.84it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.87it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.92it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.75it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.75it/s][A
 85%|████████▌ | 52/61 [00:31<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.78it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.56it/s][A
 90%|█████████ | 55/61 [00:34<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:35<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.80it/s][A
 97%|█████████▋| 59/61 [00:35<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.84it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A
                                               [A                                                   
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A 14%|█▍        | 121/847 [17:23<1:35:32,  7.90s/it]
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 14%|█▍        | 122/847 [17:31<3:56:47, 19.60s/it] 15%|█▍        | 123/847 [17:42<3:22:15, 16.76s/it] 15%|█▍        | 124/847 [17:49<2:47:24, 13.89s/it] 15%|█▍        | 125/847 [17:56<2:25:00, 12.05s/it] 15%|█▍        | 126/847 [18:05<2:13:39, 11.12s/it] 15%|█▍        | 127/847 [18:14<2:05:35, 10.47s/it] 15%|█▌        | 128/847 [18:23<2:00:06, 10.02s/it] 15%|█▌        | 129/847 [18:31<1:52:42,  9.42s/it] 15%|█▌        | 130/847 [18:40<1:50:02,  9.21s/it]                                                    15%|█▌        | 130/847 [18:40<1:50:02,  9.21s/it] 15%|█▌        | 131/847 [18:49<1:49:18,  9.16s/it] 16%|█▌        | 132/847 [18:58<1:47:45,  9.04s/it] 16%|█▌        | 133/847 [19:06<1:43:27,  8.69s/it] 16%|█▌        | 134/847 [19:13<1:37:06,  8.17s/it] 16%|█▌        | 135/847 [19:23<1:44:03,  8.77s/it] 16%|█▌        | 136/847 [19:31<1:41:06,  8.53s/it] 16%|█▌        | 137/847 [19:39<1:40:41,  8.51s/it] 16%|█▋        | 138/847 [19:48<1:40:34,  8.51s/it] 16%|█▋        | 139/847 [19:56<1:38:02,  8.31s/it] 17%|█▋        | 140/847 [20:04<1:39:31,  8.45s/it]                                                    17%|█▋        | 140/847 [20:04<1:39:31,  8.45s/it] 17%|█▋        | 141/847 [20:12<1:35:18,  8.10s/it] 17%|█▋        | 142/847 [20:19<1:32:01,  7.83s/it] 17%|█▋        | 143/847 [20:28<1:34:35,  8.06s/it] 17%|█▋        | 144/847 [20:34<1:28:59,  7.59s/it] 17%|█▋        | 145/847 [20:43<1:32:32,  7.91s/it] 17%|█▋        | 146/847 [20:50<1:29:20,  7.65s/it] 17%|█▋        | 147/847 [20:58<1:30:46,  7.78s/it] 17%|█▋        | 148/847 [21:06<1:32:36,  7.95s/it] 18%|█▊        | 149/847 [21:15<1:36:36,  8.31s/it] 18%|█▊        | 150/847 [21:23<1:33:04,  8.01s/it]                                                    18%|█▊        | 150/847 [21:23<1:33:04,  8.01s/it] 18%|█▊        | 151/847 [21:30<1:32:25,  7.97s/it] 18%|█▊        | 152/847 [21:41<1:41:45,  8.78s/it] 18%|█▊        | 153/847 [21:50<1:42:00,  8.82s/it] 18%|█▊        | 154/847 [21:59<1:41:35,  8.80s/it] 18%|█▊        | 155/847 [22:08<1:41:29,  8.80s/it] 18%|█▊        | 156/847 [22:16<1:39:01,  8.60s/it] 19%|█▊        | 157/847 [22:24<1:37:06,  8.44s/it] 19%|█▊        | 158/847 [22:34<1:41:27,  8.83s/it] 19%|█▉        | 159/847 [22:41<1:35:43,  8.35s/it] 19%|█▉        | 160/847 [22:48<1:29:59,  7.86s/it]                                                    19%|█▉        | 160/847 [22:48<1:29:59,  7.86s/it] 19%|█▉        | 161/847 [22:55<1:30:13,  7.89s/it] 19%|█▉        | 162/847 [23:04<1:32:02,  8.06s/it] 19%|█▉        | 163/847 [23:15<1:42:56,  9.03s/it] 19%|█▉        | 164/847 [23:23<1:38:22,  8.64s/it] 19%|█▉        | 165/847 [23:32<1:38:53,  8.70s/it] 20%|█▉        | 166/847 [23:42<1:44:16,  9.19s/it] 20%|█▉        | 167/847 [23:49<1:37:40,  8.62s/it] 20%|█▉        | 168/847 [23:57<1:33:26,  8.26s/it] 20%|█▉        | 169/847 [24:04<1:31:13,  8.07s/it] 20%|██        | 170/847 [24:17<1:44:41,  9.28s/it]                                                    20%|██        | 170/847 [24:17<1:44:41,  9.28s/it] 20%|██        | 171/847 [24:26<1:43:48,  9.21s/it] 20%|██        | 172/847 [24:33<1:36:10,  8.55s/it] 20%|██        | 173/847 [24:39<1:30:06,  8.02s/it] 21%|██        | 174/847 [24:47<1:27:35,  7.81s/it] 21%|██        | 175/847 [24:56<1:31:18,  8.15s/it] 21%|██        | 176/847 [25:03<1:29:07,  7.97s/it] 21%|██        | 177/847 [25:11<1:29:22,  8.00s/it] 21%|██        | 178/847 [25:21<1:33:10,  8.36s/it] 21%|██        | 179/847 [25:29<1:33:28,  8.40s/it] 21%|██▏       | 180/847 [25:38<1:34:05,  8.46s/it]                                                    21%|██▏       | 180/847 [25:38<1:34:05,  8.46s/it] 21%|██▏       | 181/847 [25:45<1:29:40,  8.08s/it] 21%|██▏       | 182/847 [25:55<1:36:39,  8.72s/it] 22%|██▏       | 183/847 [26:04<1:36:43,  8.74s/it] 22%|██▏       | 184/847 [26:12<1:33:37,  8.47s/it] 22%|██▏       | 185/847 [26:20<1:31:30,  8.29s/it] 22%|██▏       | 186/847 [26:30<1:37:04,  8.81s/it] 22%|██▏       | 187/847 [26:37<1:32:23,  8.40s/it] 22%|██▏       | 188/847 [26:46<1:33:21,  8.50s/it] 22%|██▏       | 189/847 [26:53<1:28:16,  8.05s/it] 22%|██▏       | 190/847 [27:02<1:32:17,  8.43s/it]                                                    22%|██▏       | 190/847 [27:02<1:32:17,  8.43s/it] 23%|██▎       | 191/847 [27:11<1:34:16,  8.62s/it] 23%|██▎       | 192/847 [27:20<1:33:39,  8.58s/it] 23%|██▎       | 193/847 [27:28<1:33:14,  8.55s/it] 23%|██▎       | 194/847 [27:36<1:30:36,  8.33s/it] 23%|██▎       | 195/847 [27:44<1:29:04,  8.20s/it] 23%|██▎       | 196/847 [27:53<1:32:54,  8.56s/it] 23%|██▎       | 197/847 [28:01<1:29:22,  8.25s/it] 23%|██▎       | 198/847 [28:09<1:29:17,  8.26s/it] 23%|██▎       | 199/847 [28:19<1:33:18,  8.64s/it] 24%|██▎       | 200/847 [28:26<1:30:22,  8.38s/it]                                                    24%|██▎       | 200/847 [28:26<1:30:22,  8.38s/it] 24%|██▎       | 201/847 [28:34<1:26:29,  8.03s/it] 24%|██▍       | 202/847 [28:41<1:25:44,  7.98s/it] 24%|██▍       | 203/847 [28:48<1:22:56,  7.73s/it] 24%|██▍       | 204/847 [28:56<1:22:28,  7.70s/it] 24%|██▍       | 205/847 [29:05<1:26:26,  8.08s/it] 24%|██▍       | 206/847 [29:12<1:23:22,  7.80s/it] 24%|██▍       | 207/847 [29:23<1:32:43,  8.69s/it] 25%|██▍       | 208/847 [29:30<1:27:00,  8.17s/it] 25%|██▍       | 209/847 [29:38<1:27:56,  8.27s/it] 25%|██▍       | 210/847 [29:48<1:30:23,  8.51s/it]                                                    25%|██▍       | 210/847 [29:48<1:30:23,  8.51s/it] 25%|██▍       | 211/847 [29:56<1:30:47,  8.57s/it] 25%|██▌       | 212/847 [30:04<1:29:25,  8.45s/it] 25%|██▌       | 213/847 [30:11<1:24:14,  7.97s/it] 25%|██▌       | 214/847 [30:21<1:29:37,  8.49s/it] 25%|██▌       | 215/847 [30:29<1:29:02,  8.45s/it] 26%|██▌       | 216/847 [30:37<1:26:19,  8.21s/it] 26%|██▌       | 217/847 [30:45<1:26:19,  8.22s/it] 26%|██▌       | 218/847 [30:54<1:26:48,  8.28s/it] 26%|██▌       | 219/847 [31:02<1:25:47,  8.20s/it] 26%|██▌       | 220/847 [31:10<1:27:10,  8.34s/it]                                                    26%|██▌       | 220/847 [31:10<1:27:10,  8.34s/it] 26%|██▌       | 221/847 [31:19<1:26:35,  8.30s/it] 26%|██▌       | 222/847 [31:26<1:23:50,  8.05s/it] 26%|██▋       | 223/847 [31:34<1:22:39,  7.95s/it] 26%|██▋       | 224/847 [31:41<1:20:50,  7.79s/it] 27%|██▋       | 225/847 [31:50<1:22:44,  7.98s/it] 27%|██▋       | 226/847 [31:59<1:27:48,  8.48s/it] 27%|██▋       | 227/847 [32:08<1:27:14,  8.44s/it] 27%|██▋       | 228/847 [32:15<1:25:07,  8.25s/it] 27%|██▋       | 229/847 [32:26<1:33:15,  9.05s/it] 27%|██▋       | 230/847 [32:36<1:34:27,  9.19s/it]                                                    27%|██▋       | 230/847 [32:36<1:34:27,  9.19s/it] 27%|██▋       | 231/847 [32:43<1:28:41,  8.64s/it] 27%|██▋       | 232/847 [32:52<1:30:24,  8.82s/it] 28%|██▊       | 233/847 [33:00<1:27:14,  8.53s/it] 28%|██▊       | 234/847 [33:08<1:23:56,  8.22s/it] 28%|██▊       | 235/847 [33:17<1:27:54,  8.62s/it] 28%|██▊       | 236/847 [33:24<1:23:26,  8.19s/it] 28%|██▊       | 237/847 [33:33<1:25:09,  8.38s/it] 28%|██▊       | 238/847 [33:43<1:29:49,  8.85s/it] 28%|██▊       | 239/847 [33:51<1:25:23,  8.43s/it] 28%|██▊       | 240/847 [33:59<1:24:05,  8.31s/it]                                                    28%|██▊       | 240/847 [33:59<1:24:05,  8.31s/it] 28%|██▊       | 241/847 [34:07<1:22:39,  8.18s/it] 29%|██▊       | 242/847 [34:16<1:25:48,  8.51s/it]{'eval_loss': 1.1462652683258057, 'eval_runtime': 37.8121, 'eval_samples_per_second': 6.427, 'eval_steps_per_second': 1.613, 'epoch': 1.0}
{'loss': 1.0704, 'grad_norm': 0.4221394956111908, 'learning_rate': 9.713859263031928e-05, 'epoch': 1.07}
{'loss': 1.051, 'grad_norm': 0.39627698063850403, 'learning_rate': 9.645132918583304e-05, 'epoch': 1.15}
{'loss': 1.0073, 'grad_norm': 0.4518296718597412, 'learning_rate': 9.569315197772039e-05, 'epoch': 1.24}
{'loss': 1.0442, 'grad_norm': 0.45461732149124146, 'learning_rate': 9.486521845831401e-05, 'epoch': 1.32}
{'loss': 1.089, 'grad_norm': 0.43213218450546265, 'learning_rate': 9.396879257168017e-05, 'epoch': 1.4}
{'loss': 1.0235, 'grad_norm': 0.410457581281662, 'learning_rate': 9.300524282404992e-05, 'epoch': 1.48}
{'loss': 1.0378, 'grad_norm': 0.4966992139816284, 'learning_rate': 9.197604019462333e-05, 'epoch': 1.57}
{'loss': 1.078, 'grad_norm': 0.48935726284980774, 'learning_rate': 9.08827558899356e-05, 'epoch': 1.65}
{'loss': 0.997, 'grad_norm': 0.44167861342430115, 'learning_rate': 8.972705894521388e-05, 'epoch': 1.73}
{'loss': 1.0324, 'grad_norm': 0.3753310441970825, 'learning_rate': 8.851071367638624e-05, 'epoch': 1.81}
{'loss': 1.051, 'grad_norm': 0.41887110471725464, 'learning_rate': 8.72355769866327e-05, 'epoch': 1.9}
{'loss': 1.0545, 'grad_norm': 0.4182107448577881, 'learning_rate': 8.59035955315903e-05, 'epoch': 1.98}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.23it/s][A
  5%|▍         | 3/61 [00:01<00:29,  1.94it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.72it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.76it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.74it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:34,  1.56it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.72it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:30,  1.67it/s][A
 20%|█▉        | 12/61 [00:07<00:29,  1.64it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.67it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.76it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.67it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.69it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.67it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.63it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.70it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.50it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:14<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.42it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.53it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.42it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.35it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.42it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.45it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.66it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.69it/s][A
 62%|██████▏   | 38/61 [00:24<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.65it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.73it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.60it/s][A
 70%|███████   | 43/61 [00:27<00:11,  1.64it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.85it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.88it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.92it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.75it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.75it/s][A
 85%|████████▌ | 52/61 [00:31<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.78it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.56it/s][A
 90%|█████████ | 55/61 [00:34<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:35<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.80it/s][A
 97%|█████████▋| 59/61 [00:35<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.84it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A                                                   
                                               [A 29%|██▊       | 242/847 [34:59<1:25:48,  8.51s/it]
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 29%|██▊       | 243/847 [35:07<3:34:50, 21.34s/it] 29%|██▉       | 244/847 [35:16<2:57:10, 17.63s/it] 29%|██▉       | 245/847 [35:24<2:28:18, 14.78s/it] 29%|██▉       | 246/847 [35:32<2:08:04, 12.79s/it] 29%|██▉       | 247/847 [35:40<1:51:32, 11.15s/it] 29%|██▉       | 248/847 [35:46<1:38:07,  9.83s/it] 29%|██▉       | 249/847 [35:55<1:34:36,  9.49s/it] 30%|██▉       | 250/847 [36:03<1:28:56,  8.94s/it]                                                    30%|██▉       | 250/847 [36:03<1:28:56,  8.94s/it] 30%|██▉       | 251/847 [36:11<1:25:34,  8.62s/it] 30%|██▉       | 252/847 [36:17<1:19:10,  7.98s/it] 30%|██▉       | 253/847 [36:27<1:23:27,  8.43s/it] 30%|██▉       | 254/847 [36:37<1:27:32,  8.86s/it] 30%|███       | 255/847 [36:45<1:25:38,  8.68s/it] 30%|███       | 256/847 [36:52<1:20:28,  8.17s/it] 30%|███       | 257/847 [37:00<1:20:22,  8.17s/it] 30%|███       | 258/847 [37:09<1:21:46,  8.33s/it] 31%|███       | 259/847 [37:15<1:14:29,  7.60s/it] 31%|███       | 260/847 [37:24<1:19:11,  8.09s/it]                                                    31%|███       | 260/847 [37:24<1:19:11,  8.09s/it] 31%|███       | 261/847 [37:31<1:16:38,  7.85s/it] 31%|███       | 262/847 [37:39<1:17:58,  8.00s/it] 31%|███       | 263/847 [37:47<1:16:01,  7.81s/it] 31%|███       | 264/847 [37:55<1:17:03,  7.93s/it] 31%|███▏      | 265/847 [38:05<1:22:08,  8.47s/it] 31%|███▏      | 266/847 [38:11<1:16:53,  7.94s/it] 32%|███▏      | 267/847 [38:20<1:17:25,  8.01s/it] 32%|███▏      | 268/847 [38:28<1:19:12,  8.21s/it] 32%|███▏      | 269/847 [38:38<1:23:32,  8.67s/it] 32%|███▏      | 270/847 [38:47<1:23:21,  8.67s/it]                                                    32%|███▏      | 270/847 [38:47<1:23:21,  8.67s/it] 32%|███▏      | 271/847 [38:54<1:18:59,  8.23s/it] 32%|███▏      | 272/847 [39:04<1:24:27,  8.81s/it] 32%|███▏      | 273/847 [39:14<1:28:15,  9.22s/it] 32%|███▏      | 274/847 [39:23<1:25:26,  8.95s/it] 32%|███▏      | 275/847 [39:31<1:23:18,  8.74s/it] 33%|███▎      | 276/847 [39:38<1:20:03,  8.41s/it] 33%|███▎      | 277/847 [39:49<1:26:16,  9.08s/it] 33%|███▎      | 278/847 [39:57<1:22:15,  8.67s/it] 33%|███▎      | 279/847 [40:06<1:22:08,  8.68s/it] 33%|███▎      | 280/847 [40:13<1:19:59,  8.47s/it]                                                    33%|███▎      | 280/847 [40:13<1:19:59,  8.47s/it] 33%|███▎      | 281/847 [40:21<1:17:49,  8.25s/it] 33%|███▎      | 282/847 [40:28<1:13:31,  7.81s/it] 33%|███▎      | 283/847 [40:35<1:11:18,  7.59s/it] 34%|███▎      | 284/847 [40:44<1:13:43,  7.86s/it] 34%|███▎      | 285/847 [40:54<1:21:22,  8.69s/it] 34%|███▍      | 286/847 [41:03<1:20:31,  8.61s/it] 34%|███▍      | 287/847 [41:10<1:16:02,  8.15s/it] 34%|███▍      | 288/847 [41:18<1:16:28,  8.21s/it] 34%|███▍      | 289/847 [41:29<1:24:14,  9.06s/it] 34%|███▍      | 290/847 [41:38<1:23:31,  9.00s/it]                                                    34%|███▍      | 290/847 [41:38<1:23:31,  9.00s/it] 34%|███▍      | 291/847 [41:46<1:21:55,  8.84s/it] 34%|███▍      | 292/847 [41:55<1:20:39,  8.72s/it] 35%|███▍      | 293/847 [42:02<1:16:22,  8.27s/it] 35%|███▍      | 294/847 [42:11<1:17:44,  8.44s/it] 35%|███▍      | 295/847 [42:19<1:18:03,  8.48s/it] 35%|███▍      | 296/847 [42:31<1:26:35,  9.43s/it] 35%|███▌      | 297/847 [42:40<1:25:42,  9.35s/it] 35%|███▌      | 298/847 [42:50<1:26:04,  9.41s/it] 35%|███▌      | 299/847 [42:59<1:26:10,  9.43s/it] 35%|███▌      | 300/847 [43:09<1:25:41,  9.40s/it]                                                    35%|███▌      | 300/847 [43:09<1:25:41,  9.40s/it] 36%|███▌      | 301/847 [43:16<1:18:44,  8.65s/it] 36%|███▌      | 302/847 [43:23<1:14:40,  8.22s/it] 36%|███▌      | 303/847 [43:32<1:17:19,  8.53s/it] 36%|███▌      | 304/847 [43:40<1:15:37,  8.36s/it] 36%|███▌      | 305/847 [43:47<1:11:20,  7.90s/it] 36%|███▌      | 306/847 [43:54<1:09:41,  7.73s/it] 36%|███▌      | 307/847 [44:02<1:08:37,  7.62s/it] 36%|███▋      | 308/847 [44:10<1:11:14,  7.93s/it] 36%|███▋      | 309/847 [44:19<1:14:48,  8.34s/it] 37%|███▋      | 310/847 [44:27<1:12:04,  8.05s/it]                                                    37%|███▋      | 310/847 [44:27<1:12:04,  8.05s/it] 37%|███▋      | 311/847 [44:38<1:20:00,  8.96s/it] 37%|███▋      | 312/847 [44:45<1:15:47,  8.50s/it] 37%|███▋      | 313/847 [44:53<1:13:34,  8.27s/it] 37%|███▋      | 314/847 [45:01<1:13:36,  8.29s/it] 37%|███▋      | 315/847 [45:10<1:15:06,  8.47s/it] 37%|███▋      | 316/847 [45:17<1:11:20,  8.06s/it] 37%|███▋      | 317/847 [45:24<1:08:31,  7.76s/it] 38%|███▊      | 318/847 [45:34<1:13:08,  8.30s/it] 38%|███▊      | 319/847 [45:42<1:12:52,  8.28s/it] 38%|███▊      | 320/847 [45:50<1:10:29,  8.03s/it]                                                    38%|███▊      | 320/847 [45:50<1:10:29,  8.03s/it] 38%|███▊      | 321/847 [45:58<1:10:11,  8.01s/it] 38%|███▊      | 322/847 [46:07<1:13:54,  8.45s/it] 38%|███▊      | 323/847 [46:15<1:13:12,  8.38s/it] 38%|███▊      | 324/847 [46:25<1:17:01,  8.84s/it] 38%|███▊      | 325/847 [46:36<1:20:56,  9.30s/it] 38%|███▊      | 326/847 [46:43<1:16:58,  8.86s/it] 39%|███▊      | 327/847 [46:52<1:15:27,  8.71s/it] 39%|███▊      | 328/847 [47:01<1:17:15,  8.93s/it] 39%|███▉      | 329/847 [47:10<1:16:58,  8.92s/it] 39%|███▉      | 330/847 [47:18<1:15:06,  8.72s/it]                                                    39%|███▉      | 330/847 [47:18<1:15:06,  8.72s/it] 39%|███▉      | 331/847 [47:26<1:12:42,  8.45s/it] 39%|███▉      | 332/847 [47:34<1:11:18,  8.31s/it] 39%|███▉      | 333/847 [47:42<1:10:21,  8.21s/it] 39%|███▉      | 334/847 [47:51<1:12:04,  8.43s/it] 40%|███▉      | 335/847 [47:58<1:07:42,  7.93s/it] 40%|███▉      | 336/847 [48:05<1:06:01,  7.75s/it] 40%|███▉      | 337/847 [48:14<1:08:22,  8.04s/it] 40%|███▉      | 338/847 [48:21<1:05:42,  7.75s/it] 40%|████      | 339/847 [48:28<1:03:59,  7.56s/it] 40%|████      | 340/847 [48:37<1:05:59,  7.81s/it]                                                    40%|████      | 340/847 [48:37<1:05:59,  7.81s/it] 40%|████      | 341/847 [48:44<1:04:45,  7.68s/it] 40%|████      | 342/847 [48:52<1:05:52,  7.83s/it] 40%|████      | 343/847 [48:59<1:03:15,  7.53s/it] 41%|████      | 344/847 [49:07<1:05:05,  7.76s/it] 41%|████      | 345/847 [49:16<1:06:30,  7.95s/it] 41%|████      | 346/847 [49:25<1:09:03,  8.27s/it] 41%|████      | 347/847 [49:32<1:06:20,  7.96s/it] 41%|████      | 348/847 [49:39<1:05:21,  7.86s/it] 41%|████      | 349/847 [49:46<1:01:46,  7.44s/it] 41%|████▏     | 350/847 [49:55<1:05:02,  7.85s/it]                                                    41%|████▏     | 350/847 [49:55<1:05:02,  7.85s/it] 41%|████▏     | 351/847 [50:02<1:04:22,  7.79s/it] 42%|████▏     | 352/847 [50:12<1:07:36,  8.20s/it] 42%|████▏     | 353/847 [50:19<1:04:51,  7.88s/it] 42%|████▏     | 354/847 [50:26<1:03:25,  7.72s/it] 42%|████▏     | 355/847 [50:35<1:07:17,  8.21s/it] 42%|████▏     | 356/847 [50:44<1:08:22,  8.35s/it] 42%|████▏     | 357/847 [50:51<1:05:46,  8.05s/it] 42%|████▏     | 358/847 [51:01<1:08:08,  8.36s/it] 42%|████▏     | 359/847 [51:09<1:09:24,  8.53s/it] 43%|████▎     | 360/847 [51:16<1:05:06,  8.02s/it]                                                    43%|████▎     | 360/847 [51:16<1:05:06,  8.02s/it] 43%|████▎     | 361/847 [51:27<1:11:44,  8.86s/it] 43%|████▎     | 362/847 [51:37<1:13:00,  9.03s/it] 43%|████▎     | 363/847 [51:45<1:10:46,  8.77s/it]{'eval_loss': 1.1405469179153442, 'eval_runtime': 37.8125, 'eval_samples_per_second': 6.426, 'eval_steps_per_second': 1.613, 'epoch': 2.0}
{'loss': 0.9553, 'grad_norm': 0.5101050138473511, 'learning_rate': 8.451680274753986e-05, 'epoch': 2.06}
{'loss': 0.8637, 'grad_norm': 0.4672350585460663, 'learning_rate': 8.30773157471111e-05, 'epoch': 2.14}
{'loss': 0.8627, 'grad_norm': 0.6198034286499023, 'learning_rate': 8.158733208724547e-05, 'epoch': 2.23}
{'loss': 0.8606, 'grad_norm': 0.5733208060264587, 'learning_rate': 8.004912641435063e-05, 'epoch': 2.31}
{'loss': 0.8954, 'grad_norm': 0.6381333470344543, 'learning_rate': 7.846504699176817e-05, 'epoch': 2.39}
{'loss': 0.8972, 'grad_norm': 0.5399118661880493, 'learning_rate': 7.6837512114856e-05, 'epoch': 2.47}
{'loss': 0.8912, 'grad_norm': 0.6260609030723572, 'learning_rate': 7.516900641915798e-05, 'epoch': 2.56}
{'loss': 0.8643, 'grad_norm': 0.6351476907730103, 'learning_rate': 7.346207708729707e-05, 'epoch': 2.64}
{'loss': 0.896, 'grad_norm': 0.6620055437088013, 'learning_rate': 7.171932996038239e-05, 'epoch': 2.72}
{'loss': 0.8357, 'grad_norm': 0.6200257539749146, 'learning_rate': 6.994342555986692e-05, 'epoch': 2.8}
{'loss': 0.9007, 'grad_norm': 0.553808867931366, 'learning_rate': 6.813707502592875e-05, 'epoch': 2.89}
{'loss': 0.9086, 'grad_norm': 0.5815338492393494, 'learning_rate': 6.630303597857651e-05, 'epoch': 2.97}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.20it/s][A
  5%|▍         | 3/61 [00:01<00:29,  1.94it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.72it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.75it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.74it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:34,  1.56it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.72it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:30,  1.66it/s][A
 20%|█▉        | 12/61 [00:07<00:29,  1.64it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.66it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.76it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.67it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.69it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.67it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.62it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.70it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.49it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:14<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.42it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.52it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.42it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.34it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.42it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.45it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.66it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.69it/s][A
 62%|██████▏   | 38/61 [00:24<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.65it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.73it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.60it/s][A
 70%|███████   | 43/61 [00:27<00:10,  1.64it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.85it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.88it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.92it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.76it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.75it/s][A
 85%|████████▌ | 52/61 [00:31<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.78it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.56it/s][A
 90%|█████████ | 55/61 [00:34<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:35<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.80it/s][A
 97%|█████████▋| 59/61 [00:36<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.84it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.81it/s][A                                                   
                                               [A 43%|████▎     | 363/847 [52:28<1:10:46,  8.77s/it]
100%|██████████| 61/61 [00:37<00:00,  1.81it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 43%|████▎     | 364/847 [52:32<2:44:13, 20.40s/it] 43%|████▎     | 365/847 [52:40<2:14:30, 16.74s/it] 43%|████▎     | 366/847 [52:48<1:53:15, 14.13s/it] 43%|████▎     | 367/847 [52:56<1:38:00, 12.25s/it] 43%|████▎     | 368/847 [53:05<1:29:21, 11.19s/it] 44%|████▎     | 369/847 [53:15<1:25:30, 10.73s/it] 44%|████▎     | 370/847 [53:23<1:19:07,  9.95s/it]                                                    44%|████▎     | 370/847 [53:23<1:19:07,  9.95s/it] 44%|████▍     | 371/847 [53:31<1:14:57,  9.45s/it] 44%|████▍     | 372/847 [53:39<1:11:03,  8.97s/it] 44%|████▍     | 373/847 [53:50<1:14:55,  9.48s/it] 44%|████▍     | 374/847 [53:58<1:12:16,  9.17s/it] 44%|████▍     | 375/847 [54:06<1:08:56,  8.76s/it] 44%|████▍     | 376/847 [54:16<1:12:03,  9.18s/it] 45%|████▍     | 377/847 [54:25<1:12:06,  9.21s/it] 45%|████▍     | 378/847 [54:33<1:08:47,  8.80s/it] 45%|████▍     | 379/847 [54:41<1:06:56,  8.58s/it] 45%|████▍     | 380/847 [54:48<1:02:43,  8.06s/it]                                                    45%|████▍     | 380/847 [54:48<1:02:43,  8.06s/it] 45%|████▍     | 381/847 [54:58<1:06:56,  8.62s/it] 45%|████▌     | 382/847 [55:07<1:07:03,  8.65s/it] 45%|████▌     | 383/847 [55:14<1:04:30,  8.34s/it] 45%|████▌     | 384/847 [55:22<1:02:52,  8.15s/it] 45%|████▌     | 385/847 [55:29<1:00:49,  7.90s/it] 46%|████▌     | 386/847 [55:38<1:01:51,  8.05s/it] 46%|████▌     | 387/847 [55:47<1:04:42,  8.44s/it] 46%|████▌     | 388/847 [55:55<1:02:35,  8.18s/it] 46%|████▌     | 389/847 [56:02<1:00:47,  7.96s/it] 46%|████▌     | 390/847 [56:12<1:04:59,  8.53s/it]                                                    46%|████▌     | 390/847 [56:12<1:04:59,  8.53s/it] 46%|████▌     | 391/847 [56:19<1:01:08,  8.04s/it] 46%|████▋     | 392/847 [56:26<59:45,  7.88s/it]   46%|████▋     | 393/847 [56:38<1:07:32,  8.93s/it] 47%|████▋     | 394/847 [56:45<1:02:31,  8.28s/it] 47%|████▋     | 395/847 [56:53<1:02:10,  8.25s/it] 47%|████▋     | 396/847 [57:02<1:04:55,  8.64s/it] 47%|████▋     | 397/847 [57:11<1:05:10,  8.69s/it] 47%|████▋     | 398/847 [57:18<1:01:07,  8.17s/it] 47%|████▋     | 399/847 [57:27<1:02:49,  8.41s/it] 47%|████▋     | 400/847 [57:35<1:02:06,  8.34s/it]                                                    47%|████▋     | 400/847 [57:35<1:02:06,  8.34s/it] 47%|████▋     | 401/847 [57:43<1:00:44,  8.17s/it] 47%|████▋     | 402/847 [57:51<1:00:16,  8.13s/it] 48%|████▊     | 403/847 [58:00<1:01:17,  8.28s/it] 48%|████▊     | 404/847 [58:07<1:00:03,  8.13s/it] 48%|████▊     | 405/847 [58:16<1:00:27,  8.21s/it] 48%|████▊     | 406/847 [58:23<57:31,  7.83s/it]   48%|████▊     | 407/847 [58:30<55:16,  7.54s/it] 48%|████▊     | 408/847 [58:39<59:52,  8.18s/it] 48%|████▊     | 409/847 [58:47<58:56,  8.07s/it] 48%|████▊     | 410/847 [58:56<1:00:00,  8.24s/it]                                                    48%|████▊     | 410/847 [58:56<1:00:00,  8.24s/it] 49%|████▊     | 411/847 [59:04<59:04,  8.13s/it]   49%|████▊     | 412/847 [59:11<58:11,  8.03s/it] 49%|████▉     | 413/847 [59:18<55:12,  7.63s/it] 49%|████▉     | 414/847 [59:26<55:08,  7.64s/it] 49%|████▉     | 415/847 [59:35<57:20,  7.96s/it] 49%|████▉     | 416/847 [59:42<56:19,  7.84s/it] 49%|████▉     | 417/847 [59:51<58:52,  8.21s/it] 49%|████▉     | 418/847 [59:59<57:48,  8.09s/it] 49%|████▉     | 419/847 [1:00:08<59:51,  8.39s/it] 50%|████▉     | 420/847 [1:00:16<58:44,  8.26s/it]                                                    50%|████▉     | 420/847 [1:00:16<58:44,  8.26s/it] 50%|████▉     | 421/847 [1:00:24<58:38,  8.26s/it] 50%|████▉     | 422/847 [1:00:32<57:32,  8.12s/it] 50%|████▉     | 423/847 [1:00:41<58:29,  8.28s/it] 50%|█████     | 424/847 [1:00:48<55:50,  7.92s/it] 50%|█████     | 425/847 [1:00:55<54:34,  7.76s/it] 50%|█████     | 426/847 [1:01:04<57:27,  8.19s/it] 50%|█████     | 427/847 [1:01:13<59:03,  8.44s/it] 51%|█████     | 428/847 [1:01:21<56:48,  8.13s/it] 51%|█████     | 429/847 [1:01:27<52:25,  7.53s/it] 51%|█████     | 430/847 [1:01:34<51:28,  7.41s/it]                                                    51%|█████     | 430/847 [1:01:34<51:28,  7.41s/it] 51%|█████     | 431/847 [1:01:44<55:40,  8.03s/it] 51%|█████     | 432/847 [1:01:56<1:03:48,  9.22s/it] 51%|█████     | 433/847 [1:02:03<1:00:26,  8.76s/it] 51%|█████     | 434/847 [1:02:12<59:47,  8.69s/it]   51%|█████▏    | 435/847 [1:02:21<1:00:44,  8.85s/it] 51%|█████▏    | 436/847 [1:02:30<1:00:22,  8.81s/it] 52%|█████▏    | 437/847 [1:02:38<58:39,  8.59s/it]   52%|█████▏    | 438/847 [1:02:46<58:02,  8.51s/it] 52%|█████▏    | 439/847 [1:02:55<59:17,  8.72s/it] 52%|█████▏    | 440/847 [1:03:05<1:00:56,  8.99s/it]                                                      52%|█████▏    | 440/847 [1:03:05<1:00:56,  8.99s/it] 52%|█████▏    | 441/847 [1:03:12<57:56,  8.56s/it]   52%|█████▏    | 442/847 [1:03:22<59:54,  8.88s/it] 52%|█████▏    | 443/847 [1:03:31<1:00:06,  8.93s/it] 52%|█████▏    | 444/847 [1:03:40<58:58,  8.78s/it]   53%|█████▎    | 445/847 [1:03:50<1:01:58,  9.25s/it] 53%|█████▎    | 446/847 [1:03:58<58:53,  8.81s/it]   53%|█████▎    | 447/847 [1:04:05<55:56,  8.39s/it] 53%|█████▎    | 448/847 [1:04:13<55:15,  8.31s/it] 53%|█████▎    | 449/847 [1:04:21<53:44,  8.10s/it] 53%|█████▎    | 450/847 [1:04:29<52:51,  7.99s/it]                                                    53%|█████▎    | 450/847 [1:04:29<52:51,  7.99s/it] 53%|█████▎    | 451/847 [1:04:36<51:07,  7.75s/it] 53%|█████▎    | 452/847 [1:04:44<52:04,  7.91s/it] 53%|█████▎    | 453/847 [1:04:52<51:32,  7.85s/it] 54%|█████▎    | 454/847 [1:05:00<52:42,  8.05s/it] 54%|█████▎    | 455/847 [1:05:09<53:49,  8.24s/it] 54%|█████▍    | 456/847 [1:05:18<55:47,  8.56s/it] 54%|█████▍    | 457/847 [1:05:26<54:18,  8.35s/it] 54%|█████▍    | 458/847 [1:05:34<52:50,  8.15s/it] 54%|█████▍    | 459/847 [1:05:42<52:51,  8.17s/it] 54%|█████▍    | 460/847 [1:05:50<53:05,  8.23s/it]                                                    54%|█████▍    | 460/847 [1:05:50<53:05,  8.23s/it] 54%|█████▍    | 461/847 [1:05:59<54:35,  8.49s/it] 55%|█████▍    | 462/847 [1:06:08<54:43,  8.53s/it] 55%|█████▍    | 463/847 [1:06:16<53:50,  8.41s/it] 55%|█████▍    | 464/847 [1:06:24<53:01,  8.31s/it] 55%|█████▍    | 465/847 [1:06:34<54:44,  8.60s/it] 55%|█████▌    | 466/847 [1:06:42<54:41,  8.61s/it] 55%|█████▌    | 467/847 [1:06:50<53:29,  8.45s/it] 55%|█████▌    | 468/847 [1:06:59<54:34,  8.64s/it] 55%|█████▌    | 469/847 [1:07:08<53:59,  8.57s/it] 55%|█████▌    | 470/847 [1:07:16<53:01,  8.44s/it]                                                    55%|█████▌    | 470/847 [1:07:16<53:01,  8.44s/it] 56%|█████▌    | 471/847 [1:07:25<53:35,  8.55s/it] 56%|█████▌    | 472/847 [1:07:34<54:16,  8.68s/it] 56%|█████▌    | 473/847 [1:07:41<51:04,  8.19s/it] 56%|█████▌    | 474/847 [1:07:49<51:21,  8.26s/it] 56%|█████▌    | 475/847 [1:07:56<48:35,  7.84s/it] 56%|█████▌    | 476/847 [1:08:04<49:01,  7.93s/it] 56%|█████▋    | 477/847 [1:08:12<48:46,  7.91s/it] 56%|█████▋    | 478/847 [1:08:21<50:36,  8.23s/it] 57%|█████▋    | 479/847 [1:08:29<49:12,  8.02s/it] 57%|█████▋    | 480/847 [1:08:36<47:32,  7.77s/it]                                                    57%|█████▋    | 480/847 [1:08:36<47:32,  7.77s/it] 57%|█████▋    | 481/847 [1:08:46<51:23,  8.42s/it] 57%|█████▋    | 482/847 [1:08:53<49:16,  8.10s/it] 57%|█████▋    | 483/847 [1:09:01<48:39,  8.02s/it] 57%|█████▋    | 484/847 [1:09:10<50:57,  8.42s/it] 57%|█████▋    | 485/847 [1:09:18<50:09,  8.31s/it]{'eval_loss': 1.1799391508102417, 'eval_runtime': 37.8371, 'eval_samples_per_second': 6.422, 'eval_steps_per_second': 1.612, 'epoch': 2.99}
{'loss': 0.8055, 'grad_norm': 0.701201319694519, 'learning_rate': 6.444410830779754e-05, 'epoch': 3.05}
{'loss': 0.704, 'grad_norm': 0.6772772669792175, 'learning_rate': 6.25631298991756e-05, 'epoch': 3.13}
{'loss': 0.7216, 'grad_norm': 0.7397905588150024, 'learning_rate': 6.066297230150368e-05, 'epoch': 3.22}
{'loss': 0.6787, 'grad_norm': 0.7452909350395203, 'learning_rate': 5.8746536343005554e-05, 'epoch': 3.3}
{'loss': 0.729, 'grad_norm': 0.7689995169639587, 'learning_rate': 5.6816747702858734e-05, 'epoch': 3.38}
{'loss': 0.7479, 'grad_norm': 0.8978269696235657, 'learning_rate': 5.487655244477923e-05, 'epoch': 3.46}
{'loss': 0.6915, 'grad_norm': 0.744478702545166, 'learning_rate': 5.292891251948694e-05, 'epoch': 3.55}
{'loss': 0.7372, 'grad_norm': 0.7381359338760376, 'learning_rate': 5.097680124291729e-05, 'epoch': 3.63}
{'loss': 0.7457, 'grad_norm': 0.7580574154853821, 'learning_rate': 4.902319875708272e-05, 'epoch': 3.71}
{'loss': 0.7321, 'grad_norm': 0.7197450399398804, 'learning_rate': 4.707108748051307e-05, 'epoch': 3.79}
{'loss': 0.7003, 'grad_norm': 0.8005804419517517, 'learning_rate': 4.512344755522078e-05, 'epoch': 3.88}
{'loss': 0.7341, 'grad_norm': 0.7790518403053284, 'learning_rate': 4.318325229714127e-05, 'epoch': 3.96}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.23it/s][A
  5%|▍         | 3/61 [00:01<00:29,  1.94it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.73it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.76it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.75it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:33,  1.56it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.73it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:29,  1.67it/s][A
 20%|█▉        | 12/61 [00:06<00:29,  1.65it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.67it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.77it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.68it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.70it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.67it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.63it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.70it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.50it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:13<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.43it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.53it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.42it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.35it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.42it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.46it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.66it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.69it/s][A
 62%|██████▏   | 38/61 [00:23<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.65it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.74it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.60it/s][A
 70%|███████   | 43/61 [00:26<00:10,  1.64it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.85it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.88it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.93it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.76it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.76it/s][A
 85%|████████▌ | 52/61 [00:31<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.79it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.57it/s][A
 90%|█████████ | 55/61 [00:33<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:34<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.81it/s][A
 97%|█████████▋| 59/61 [00:35<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.84it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A                                                   
                                               [A 57%|█████▋    | 485/847 [1:09:56<50:09,  8.31s/it]
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 57%|█████▋    | 486/847 [1:10:06<2:00:54, 20.09s/it] 57%|█████▋    | 487/847 [1:10:14<1:39:30, 16.58s/it] 58%|█████▊    | 488/847 [1:10:22<1:22:29, 13.79s/it] 58%|█████▊    | 489/847 [1:10:31<1:14:04, 12.41s/it] 58%|█████▊    | 490/847 [1:10:39<1:05:51, 11.07s/it]                                                      58%|█████▊    | 490/847 [1:10:39<1:05:51, 11.07s/it] 58%|█████▊    | 491/847 [1:10:47<59:56, 10.10s/it]   58%|█████▊    | 492/847 [1:10:54<55:46,  9.43s/it] 58%|█████▊    | 493/847 [1:11:03<54:04,  9.16s/it] 58%|█████▊    | 494/847 [1:11:10<51:03,  8.68s/it] 58%|█████▊    | 495/847 [1:11:19<50:35,  8.62s/it] 59%|█████▊    | 496/847 [1:11:27<49:53,  8.53s/it] 59%|█████▊    | 497/847 [1:11:34<46:47,  8.02s/it] 59%|█████▉    | 498/847 [1:11:43<48:55,  8.41s/it] 59%|█████▉    | 499/847 [1:11:52<48:32,  8.37s/it] 59%|█████▉    | 500/847 [1:11:59<45:58,  7.95s/it]                                                    59%|█████▉    | 500/847 [1:11:59<45:58,  7.95s/it] 59%|█████▉    | 501/847 [1:12:07<46:30,  8.06s/it] 59%|█████▉    | 502/847 [1:12:15<46:45,  8.13s/it] 59%|█████▉    | 503/847 [1:12:24<47:10,  8.23s/it] 60%|█████▉    | 504/847 [1:12:33<48:01,  8.40s/it] 60%|█████▉    | 505/847 [1:12:41<48:21,  8.48s/it] 60%|█████▉    | 506/847 [1:12:48<45:58,  8.09s/it] 60%|█████▉    | 507/847 [1:12:55<43:51,  7.74s/it] 60%|█████▉    | 508/847 [1:13:05<46:51,  8.29s/it] 60%|██████    | 509/847 [1:13:14<48:02,  8.53s/it] 60%|██████    | 510/847 [1:13:22<47:48,  8.51s/it]                                                    60%|██████    | 510/847 [1:13:22<47:48,  8.51s/it] 60%|██████    | 511/847 [1:13:30<45:23,  8.10s/it] 60%|██████    | 512/847 [1:13:36<43:12,  7.74s/it] 61%|██████    | 513/847 [1:13:48<48:38,  8.74s/it] 61%|██████    | 514/847 [1:13:56<48:00,  8.65s/it] 61%|██████    | 515/847 [1:14:05<47:40,  8.61s/it] 61%|██████    | 516/847 [1:14:12<45:54,  8.32s/it] 61%|██████    | 517/847 [1:14:19<43:28,  7.90s/it] 61%|██████    | 518/847 [1:14:26<42:18,  7.72s/it] 61%|██████▏   | 519/847 [1:14:37<46:10,  8.45s/it] 61%|██████▏   | 520/847 [1:14:47<48:58,  8.99s/it]                                                    61%|██████▏   | 520/847 [1:14:47<48:58,  8.99s/it] 62%|██████▏   | 521/847 [1:14:55<47:35,  8.76s/it] 62%|██████▏   | 522/847 [1:15:03<46:03,  8.50s/it] 62%|██████▏   | 523/847 [1:15:12<46:24,  8.59s/it] 62%|██████▏   | 524/847 [1:15:18<42:33,  7.91s/it] 62%|██████▏   | 525/847 [1:15:27<43:47,  8.16s/it] 62%|██████▏   | 526/847 [1:15:34<42:46,  8.00s/it] 62%|██████▏   | 527/847 [1:15:42<42:43,  8.01s/it] 62%|██████▏   | 528/847 [1:15:49<39:37,  7.45s/it] 62%|██████▏   | 529/847 [1:15:57<41:40,  7.86s/it] 63%|██████▎   | 530/847 [1:16:06<43:02,  8.15s/it]                                                    63%|██████▎   | 530/847 [1:16:06<43:02,  8.15s/it] 63%|██████▎   | 531/847 [1:16:13<40:53,  7.77s/it] 63%|██████▎   | 532/847 [1:16:22<42:26,  8.08s/it] 63%|██████▎   | 533/847 [1:16:30<41:59,  8.02s/it] 63%|██████▎   | 534/847 [1:16:38<41:32,  7.96s/it] 63%|██████▎   | 535/847 [1:16:46<41:56,  8.07s/it] 63%|██████▎   | 536/847 [1:16:53<40:04,  7.73s/it] 63%|██████▎   | 537/847 [1:17:00<38:17,  7.41s/it] 64%|██████▎   | 538/847 [1:17:10<42:27,  8.25s/it] 64%|██████▎   | 539/847 [1:17:18<42:00,  8.18s/it] 64%|██████▍   | 540/847 [1:17:25<40:30,  7.92s/it]                                                    64%|██████▍   | 540/847 [1:17:25<40:30,  7.92s/it] 64%|██████▍   | 541/847 [1:17:32<38:51,  7.62s/it] 64%|██████▍   | 542/847 [1:17:40<40:03,  7.88s/it] 64%|██████▍   | 543/847 [1:17:50<42:08,  8.32s/it] 64%|██████▍   | 544/847 [1:17:58<42:00,  8.32s/it] 64%|██████▍   | 545/847 [1:18:06<41:05,  8.16s/it] 64%|██████▍   | 546/847 [1:18:15<41:55,  8.36s/it] 65%|██████▍   | 547/847 [1:18:22<39:53,  7.98s/it] 65%|██████▍   | 548/847 [1:18:30<40:12,  8.07s/it] 65%|██████▍   | 549/847 [1:18:39<41:26,  8.34s/it] 65%|██████▍   | 550/847 [1:18:47<41:08,  8.31s/it]                                                    65%|██████▍   | 550/847 [1:18:47<41:08,  8.31s/it] 65%|██████▌   | 551/847 [1:18:56<41:03,  8.32s/it] 65%|██████▌   | 552/847 [1:19:02<38:15,  7.78s/it] 65%|██████▌   | 553/847 [1:19:11<39:47,  8.12s/it] 65%|██████▌   | 554/847 [1:19:23<45:16,  9.27s/it] 66%|██████▌   | 555/847 [1:19:30<42:09,  8.66s/it] 66%|██████▌   | 556/847 [1:19:38<40:06,  8.27s/it] 66%|██████▌   | 557/847 [1:19:46<39:27,  8.16s/it] 66%|██████▌   | 558/847 [1:19:55<40:56,  8.50s/it] 66%|██████▌   | 559/847 [1:20:04<42:00,  8.75s/it] 66%|██████▌   | 560/847 [1:20:12<40:20,  8.43s/it]                                                    66%|██████▌   | 560/847 [1:20:12<40:20,  8.43s/it] 66%|██████▌   | 561/847 [1:20:19<38:20,  8.05s/it] 66%|██████▋   | 562/847 [1:20:27<38:37,  8.13s/it] 66%|██████▋   | 563/847 [1:20:35<37:57,  8.02s/it] 67%|██████▋   | 564/847 [1:20:45<39:46,  8.43s/it] 67%|██████▋   | 565/847 [1:20:53<40:02,  8.52s/it] 67%|██████▋   | 566/847 [1:21:02<40:51,  8.73s/it] 67%|██████▋   | 567/847 [1:21:11<41:08,  8.82s/it] 67%|██████▋   | 568/847 [1:21:19<39:21,  8.46s/it] 67%|██████▋   | 569/847 [1:21:28<40:12,  8.68s/it] 67%|██████▋   | 570/847 [1:21:35<37:45,  8.18s/it]                                                    67%|██████▋   | 570/847 [1:21:35<37:45,  8.18s/it] 67%|██████▋   | 571/847 [1:21:44<38:08,  8.29s/it] 68%|██████▊   | 572/847 [1:21:51<36:55,  8.05s/it] 68%|██████▊   | 573/847 [1:21:59<36:43,  8.04s/it] 68%|██████▊   | 574/847 [1:22:10<40:04,  8.81s/it] 68%|██████▊   | 575/847 [1:22:19<39:57,  8.81s/it] 68%|██████▊   | 576/847 [1:22:28<40:17,  8.92s/it] 68%|██████▊   | 577/847 [1:22:36<38:16,  8.51s/it] 68%|██████▊   | 578/847 [1:22:43<36:38,  8.17s/it] 68%|██████▊   | 579/847 [1:22:51<35:48,  8.02s/it] 68%|██████▊   | 580/847 [1:22:59<36:18,  8.16s/it]                                                    68%|██████▊   | 580/847 [1:22:59<36:18,  8.16s/it] 69%|██████▊   | 581/847 [1:23:06<34:28,  7.78s/it] 69%|██████▊   | 582/847 [1:23:15<36:16,  8.21s/it] 69%|██████▉   | 583/847 [1:23:23<35:36,  8.09s/it] 69%|██████▉   | 584/847 [1:23:33<38:15,  8.73s/it] 69%|██████▉   | 585/847 [1:23:40<35:39,  8.17s/it] 69%|██████▉   | 586/847 [1:23:47<34:35,  7.95s/it] 69%|██████▉   | 587/847 [1:23:55<33:55,  7.83s/it] 69%|██████▉   | 588/847 [1:24:05<36:13,  8.39s/it] 70%|██████▉   | 589/847 [1:24:12<34:52,  8.11s/it] 70%|██████▉   | 590/847 [1:24:20<34:14,  8.00s/it]                                                    70%|██████▉   | 590/847 [1:24:20<34:14,  8.00s/it] 70%|██████▉   | 591/847 [1:24:30<36:39,  8.59s/it] 70%|██████▉   | 592/847 [1:24:39<37:43,  8.88s/it] 70%|███████   | 593/847 [1:24:46<34:51,  8.23s/it] 70%|███████   | 594/847 [1:24:54<34:20,  8.14s/it] 70%|███████   | 595/847 [1:25:03<34:33,  8.23s/it] 70%|███████   | 596/847 [1:25:10<33:15,  7.95s/it] 70%|███████   | 597/847 [1:25:18<33:25,  8.02s/it] 71%|███████   | 598/847 [1:25:27<35:00,  8.43s/it] 71%|███████   | 599/847 [1:25:36<34:44,  8.41s/it] 71%|███████   | 600/847 [1:25:44<33:55,  8.24s/it]                                                    71%|███████   | 600/847 [1:25:44<33:55,  8.24s/it] 71%|███████   | 601/847 [1:25:53<35:16,  8.60s/it] 71%|███████   | 602/847 [1:26:02<35:48,  8.77s/it] 71%|███████   | 603/847 [1:26:09<33:43,  8.29s/it] 71%|███████▏  | 604/847 [1:26:17<32:52,  8.12s/it] 71%|███████▏  | 605/847 [1:26:24<31:49,  7.89s/it] 72%|███████▏  | 606/847 [1:26:35<35:20,  8.80s/it]{'eval_loss': 1.2671644687652588, 'eval_runtime': 37.7567, 'eval_samples_per_second': 6.436, 'eval_steps_per_second': 1.616, 'epoch': 4.0}
{'loss': 0.6692, 'grad_norm': 0.7203040719032288, 'learning_rate': 4.125346365699445e-05, 'epoch': 4.04}
{'loss': 0.5814, 'grad_norm': 0.8376997709274292, 'learning_rate': 3.933702769849633e-05, 'epoch': 4.12}
{'loss': 0.5868, 'grad_norm': 0.8252605199813843, 'learning_rate': 3.743687010082442e-05, 'epoch': 4.21}
{'loss': 0.5524, 'grad_norm': 0.7740548849105835, 'learning_rate': 3.555589169220248e-05, 'epoch': 4.29}
{'loss': 0.5931, 'grad_norm': 0.862697958946228, 'learning_rate': 3.3696964021423504e-05, 'epoch': 4.37}
{'loss': 0.6016, 'grad_norm': 0.9453670382499695, 'learning_rate': 3.186292497407126e-05, 'epoch': 4.45}
{'loss': 0.5507, 'grad_norm': 0.8929241299629211, 'learning_rate': 3.00565744401331e-05, 'epoch': 4.54}
{'loss': 0.5973, 'grad_norm': 0.9143601059913635, 'learning_rate': 2.8280670039617628e-05, 'epoch': 4.62}
{'loss': 0.5997, 'grad_norm': 0.9465951323509216, 'learning_rate': 2.653792291270293e-05, 'epoch': 4.7}
{'loss': 0.5806, 'grad_norm': 0.8138393759727478, 'learning_rate': 2.4830993580842023e-05, 'epoch': 4.78}
{'loss': 0.59, 'grad_norm': 0.9141271114349365, 'learning_rate': 2.3162487885144017e-05, 'epoch': 4.87}
{'loss': 0.5487, 'grad_norm': 0.9422024488449097, 'learning_rate': 2.1534953008231857e-05, 'epoch': 4.95}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.21it/s][A
  5%|▍         | 3/61 [00:01<00:29,  1.94it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.72it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.76it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.74it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:33,  1.56it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.73it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:30,  1.67it/s][A
 20%|█▉        | 12/61 [00:06<00:29,  1.65it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.67it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.77it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.68it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.69it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.67it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.63it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.70it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.50it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:14<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.42it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.53it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.43it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.35it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.43it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.46it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.66it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.69it/s][A
 62%|██████▏   | 38/61 [00:23<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.65it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.73it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.60it/s][A
 70%|███████   | 43/61 [00:26<00:10,  1.64it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.85it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.88it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.93it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.76it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.76it/s][A
 85%|████████▌ | 52/61 [00:31<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.79it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.57it/s][A
 90%|█████████ | 55/61 [00:33<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:34<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.81it/s][A
 97%|█████████▋| 59/61 [00:35<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.85it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A                                                   
                                               [A 72%|███████▏  | 606/847 [1:27:14<35:20,  8.80s/it]
100%|██████████| 61/61 [00:37<00:00,  1.82it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 72%|███████▏  | 607/847 [1:27:23<1:22:06, 20.53s/it] 72%|███████▏  | 608/847 [1:27:30<1:05:49, 16.52s/it] 72%|███████▏  | 609/847 [1:27:38<55:23, 13.97s/it]   72%|███████▏  | 610/847 [1:27:47<48:32, 12.29s/it]                                                    72%|███████▏  | 610/847 [1:27:47<48:32, 12.29s/it] 72%|███████▏  | 611/847 [1:27:55<43:16, 11.00s/it] 72%|███████▏  | 612/847 [1:28:01<37:21,  9.54s/it] 72%|███████▏  | 613/847 [1:28:10<36:12,  9.28s/it] 72%|███████▏  | 614/847 [1:28:19<35:58,  9.26s/it] 73%|███████▎  | 615/847 [1:28:27<34:15,  8.86s/it] 73%|███████▎  | 616/847 [1:28:35<33:23,  8.67s/it] 73%|███████▎  | 617/847 [1:28:44<33:27,  8.73s/it] 73%|███████▎  | 618/847 [1:28:52<33:02,  8.66s/it] 73%|███████▎  | 619/847 [1:29:02<33:40,  8.86s/it] 73%|███████▎  | 620/847 [1:29:10<33:19,  8.81s/it]                                                    73%|███████▎  | 620/847 [1:29:10<33:19,  8.81s/it] 73%|███████▎  | 621/847 [1:29:19<33:22,  8.86s/it] 73%|███████▎  | 622/847 [1:29:28<32:22,  8.63s/it] 74%|███████▎  | 623/847 [1:29:38<34:09,  9.15s/it] 74%|███████▎  | 624/847 [1:29:48<34:50,  9.37s/it] 74%|███████▍  | 625/847 [1:29:56<33:27,  9.04s/it] 74%|███████▍  | 626/847 [1:30:05<33:46,  9.17s/it] 74%|███████▍  | 627/847 [1:30:13<31:56,  8.71s/it] 74%|███████▍  | 628/847 [1:30:23<32:46,  8.98s/it] 74%|███████▍  | 629/847 [1:30:32<32:41,  9.00s/it] 74%|███████▍  | 630/847 [1:30:41<32:50,  9.08s/it]                                                    74%|███████▍  | 630/847 [1:30:41<32:50,  9.08s/it] 74%|███████▍  | 631/847 [1:30:49<31:32,  8.76s/it] 75%|███████▍  | 632/847 [1:30:57<30:39,  8.56s/it] 75%|███████▍  | 633/847 [1:31:04<29:01,  8.14s/it] 75%|███████▍  | 634/847 [1:31:13<29:41,  8.36s/it] 75%|███████▍  | 635/847 [1:31:21<29:03,  8.22s/it] 75%|███████▌  | 636/847 [1:31:30<29:18,  8.33s/it] 75%|███████▌  | 637/847 [1:31:37<27:44,  7.93s/it] 75%|███████▌  | 638/847 [1:31:46<28:50,  8.28s/it] 75%|███████▌  | 639/847 [1:31:54<28:48,  8.31s/it] 76%|███████▌  | 640/847 [1:32:01<26:44,  7.75s/it]                                                    76%|███████▌  | 640/847 [1:32:01<26:44,  7.75s/it] 76%|███████▌  | 641/847 [1:32:09<26:59,  7.86s/it] 76%|███████▌  | 642/847 [1:32:17<27:47,  8.13s/it] 76%|███████▌  | 643/847 [1:32:25<27:25,  8.07s/it] 76%|███████▌  | 644/847 [1:32:34<27:46,  8.21s/it] 76%|███████▌  | 645/847 [1:32:42<27:26,  8.15s/it] 76%|███████▋  | 646/847 [1:32:51<27:59,  8.36s/it] 76%|███████▋  | 647/847 [1:33:00<28:48,  8.64s/it] 77%|███████▋  | 648/847 [1:33:08<27:29,  8.29s/it] 77%|███████▋  | 649/847 [1:33:15<26:27,  8.02s/it] 77%|███████▋  | 650/847 [1:33:23<26:26,  8.05s/it]                                                    77%|███████▋  | 650/847 [1:33:23<26:26,  8.05s/it] 77%|███████▋  | 651/847 [1:33:32<27:36,  8.45s/it] 77%|███████▋  | 652/847 [1:33:40<26:54,  8.28s/it] 77%|███████▋  | 653/847 [1:33:48<25:48,  7.98s/it] 77%|███████▋  | 654/847 [1:33:55<24:42,  7.68s/it] 77%|███████▋  | 655/847 [1:34:04<26:03,  8.14s/it] 77%|███████▋  | 656/847 [1:34:11<24:40,  7.75s/it] 78%|███████▊  | 657/847 [1:34:19<24:53,  7.86s/it] 78%|███████▊  | 658/847 [1:34:27<25:18,  8.04s/it] 78%|███████▊  | 659/847 [1:34:36<25:38,  8.18s/it] 78%|███████▊  | 660/847 [1:34:44<25:38,  8.23s/it]                                                    78%|███████▊  | 660/847 [1:34:44<25:38,  8.23s/it] 78%|███████▊  | 661/847 [1:34:52<24:58,  8.06s/it] 78%|███████▊  | 662/847 [1:35:01<25:44,  8.35s/it] 78%|███████▊  | 663/847 [1:35:09<25:06,  8.19s/it] 78%|███████▊  | 664/847 [1:35:18<26:32,  8.70s/it] 79%|███████▊  | 665/847 [1:35:28<27:06,  8.94s/it] 79%|███████▊  | 666/847 [1:35:36<26:00,  8.62s/it] 79%|███████▊  | 667/847 [1:35:44<25:15,  8.42s/it] 79%|███████▉  | 668/847 [1:35:53<25:35,  8.58s/it] 79%|███████▉  | 669/847 [1:36:00<24:25,  8.23s/it] 79%|███████▉  | 670/847 [1:36:07<23:09,  7.85s/it]                                                    79%|███████▉  | 670/847 [1:36:07<23:09,  7.85s/it] 79%|███████▉  | 671/847 [1:36:15<23:04,  7.87s/it] 79%|███████▉  | 672/847 [1:36:23<23:01,  7.89s/it] 79%|███████▉  | 673/847 [1:36:30<22:18,  7.69s/it] 80%|███████▉  | 674/847 [1:36:39<23:25,  8.12s/it] 80%|███████▉  | 675/847 [1:36:48<23:27,  8.18s/it] 80%|███████▉  | 676/847 [1:36:53<21:10,  7.43s/it] 80%|███████▉  | 677/847 [1:37:02<22:07,  7.81s/it] 80%|████████  | 678/847 [1:37:09<21:01,  7.46s/it] 80%|████████  | 679/847 [1:37:17<21:18,  7.61s/it] 80%|████████  | 680/847 [1:37:25<21:26,  7.70s/it]                                                    80%|████████  | 680/847 [1:37:25<21:26,  7.70s/it] 80%|████████  | 681/847 [1:37:33<22:01,  7.96s/it] 81%|████████  | 682/847 [1:37:42<22:23,  8.14s/it] 81%|████████  | 683/847 [1:37:50<22:01,  8.06s/it] 81%|████████  | 684/847 [1:37:58<22:29,  8.28s/it] 81%|████████  | 685/847 [1:38:05<21:19,  7.90s/it] 81%|████████  | 686/847 [1:38:14<21:30,  8.01s/it] 81%|████████  | 687/847 [1:38:24<23:26,  8.79s/it] 81%|████████  | 688/847 [1:38:32<22:25,  8.46s/it] 81%|████████▏ | 689/847 [1:38:40<22:01,  8.36s/it] 81%|████████▏ | 690/847 [1:38:48<21:31,  8.23s/it]                                                    81%|████████▏ | 690/847 [1:38:48<21:31,  8.23s/it] 82%|████████▏ | 691/847 [1:38:57<22:02,  8.48s/it] 82%|████████▏ | 692/847 [1:39:05<21:06,  8.17s/it] 82%|████████▏ | 693/847 [1:39:13<20:54,  8.15s/it] 82%|████████▏ | 694/847 [1:39:23<22:09,  8.69s/it] 82%|████████▏ | 695/847 [1:39:32<22:25,  8.85s/it] 82%|████████▏ | 696/847 [1:39:40<22:02,  8.76s/it] 82%|████████▏ | 697/847 [1:39:51<22:59,  9.20s/it] 82%|████████▏ | 698/847 [1:39:59<22:38,  9.12s/it] 83%|████████▎ | 699/847 [1:40:09<22:41,  9.20s/it] 83%|████████▎ | 700/847 [1:40:18<22:31,  9.19s/it]                                                    83%|████████▎ | 700/847 [1:40:18<22:31,  9.19s/it] 83%|████████▎ | 701/847 [1:40:25<20:33,  8.45s/it] 83%|████████▎ | 702/847 [1:40:33<20:28,  8.47s/it] 83%|████████▎ | 703/847 [1:40:41<19:25,  8.10s/it] 83%|████████▎ | 704/847 [1:40:47<18:19,  7.69s/it] 83%|████████▎ | 705/847 [1:40:57<19:25,  8.21s/it] 83%|████████▎ | 706/847 [1:41:04<18:46,  7.99s/it] 83%|████████▎ | 707/847 [1:41:14<20:06,  8.62s/it] 84%|████████▎ | 708/847 [1:41:22<19:35,  8.46s/it] 84%|████████▎ | 709/847 [1:41:31<19:50,  8.63s/it] 84%|████████▍ | 710/847 [1:41:41<20:05,  8.80s/it]                                                    84%|████████▍ | 710/847 [1:41:41<20:05,  8.80s/it] 84%|████████▍ | 711/847 [1:41:48<19:19,  8.52s/it] 84%|████████▍ | 712/847 [1:41:58<20:00,  8.89s/it] 84%|████████▍ | 713/847 [1:42:07<19:43,  8.83s/it] 84%|████████▍ | 714/847 [1:42:16<19:42,  8.89s/it] 84%|████████▍ | 715/847 [1:42:24<19:08,  8.70s/it] 85%|████████▍ | 716/847 [1:42:32<18:06,  8.30s/it] 85%|████████▍ | 717/847 [1:42:39<17:13,  7.95s/it] 85%|████████▍ | 718/847 [1:42:47<17:35,  8.18s/it] 85%|████████▍ | 719/847 [1:42:55<17:05,  8.01s/it] 85%|████████▌ | 720/847 [1:43:05<18:05,  8.54s/it]                                                    85%|████████▌ | 720/847 [1:43:05<18:05,  8.54s/it] 85%|████████▌ | 721/847 [1:43:13<17:36,  8.38s/it] 85%|████████▌ | 722/847 [1:43:21<17:06,  8.21s/it] 85%|████████▌ | 723/847 [1:43:29<17:05,  8.27s/it] 85%|████████▌ | 724/847 [1:43:37<16:48,  8.20s/it] 86%|████████▌ | 725/847 [1:43:45<16:24,  8.07s/it] 86%|████████▌ | 726/847 [1:43:55<17:30,  8.69s/it] 86%|████████▌ | 727/847 [1:44:02<16:20,  8.17s/it]{'eval_loss': 1.372969388961792, 'eval_runtime': 37.7615, 'eval_samples_per_second': 6.435, 'eval_steps_per_second': 1.615, 'epoch': 5.0}
{'loss': 0.5437, 'grad_norm': 0.819573700428009, 'learning_rate': 1.9950873585649383e-05, 'epoch': 5.03}
{'loss': 0.4856, 'grad_norm': 1.0481706857681274, 'learning_rate': 1.8412667912754532e-05, 'epoch': 5.11}
{'loss': 0.5063, 'grad_norm': 0.9452289938926697, 'learning_rate': 1.692268425288891e-05, 'epoch': 5.2}
{'loss': 0.4728, 'grad_norm': 1.0766780376434326, 'learning_rate': 1.5483197252460158e-05, 'epoch': 5.28}
{'loss': 0.4761, 'grad_norm': 0.9071425795555115, 'learning_rate': 1.4096404468409713e-05, 'epoch': 5.36}
{'loss': 0.473, 'grad_norm': 0.9024500250816345, 'learning_rate': 1.2764423013367327e-05, 'epoch': 5.44}
{'loss': 0.4607, 'grad_norm': 0.9336279630661011, 'learning_rate': 1.148928632361378e-05, 'epoch': 5.53}
{'loss': 0.4535, 'grad_norm': 0.9108033776283264, 'learning_rate': 1.0272941054786123e-05, 'epoch': 5.61}
{'loss': 0.4684, 'grad_norm': 0.9172302484512329, 'learning_rate': 9.11724411006441e-06, 'epoch': 5.69}
{'loss': 0.5071, 'grad_norm': 0.8747246265411377, 'learning_rate': 8.02395980537668e-06, 'epoch': 5.77}
{'loss': 0.4618, 'grad_norm': 0.9351525902748108, 'learning_rate': 6.994757175950084e-06, 'epoch': 5.86}
{'loss': 0.4691, 'grad_norm': 0.8983185291290283, 'learning_rate': 6.031207428319841e-06, 'epoch': 5.94}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.21it/s][A
  5%|▍         | 3/61 [00:01<00:29,  1.94it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.72it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.75it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.74it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:34,  1.56it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.73it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:30,  1.67it/s][A
 20%|█▉        | 12/61 [00:07<00:29,  1.65it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.67it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.77it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.67it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.69it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.66it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.62it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.69it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.49it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:14<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.42it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.53it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.42it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.35it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.42it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.45it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.66it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.69it/s][A
 62%|██████▏   | 38/61 [00:24<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.65it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.73it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.59it/s][A
 70%|███████   | 43/61 [00:27<00:11,  1.63it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.84it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.88it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.93it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.75it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.75it/s][A
 85%|████████▌ | 52/61 [00:31<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.79it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.56it/s][A
 90%|█████████ | 55/61 [00:34<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:35<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.80it/s][A
 97%|█████████▋| 59/61 [00:35<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.84it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.81it/s][A                                                   
                                               [A 86%|████████▌ | 727/847 [1:44:43<16:20,  8.17s/it]
100%|██████████| 61/61 [00:37<00:00,  1.81it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 86%|████████▌ | 728/847 [1:44:50<39:44, 20.03s/it] 86%|████████▌ | 729/847 [1:44:58<32:31, 16.53s/it] 86%|████████▌ | 730/847 [1:45:06<27:01, 13.86s/it]                                                    86%|████████▌ | 730/847 [1:45:06<27:01, 13.86s/it] 86%|████████▋ | 731/847 [1:45:14<23:46, 12.30s/it] 86%|████████▋ | 732/847 [1:45:23<21:37, 11.28s/it] 87%|████████▋ | 733/847 [1:45:32<20:08, 10.60s/it] 87%|████████▋ | 734/847 [1:45:42<19:41, 10.46s/it] 87%|████████▋ | 735/847 [1:45:50<18:11,  9.75s/it] 87%|████████▋ | 736/847 [1:45:58<17:02,  9.21s/it] 87%|████████▋ | 737/847 [1:46:07<16:34,  9.04s/it] 87%|████████▋ | 738/847 [1:46:16<16:19,  8.99s/it] 87%|████████▋ | 739/847 [1:46:24<15:57,  8.86s/it] 87%|████████▋ | 740/847 [1:46:32<15:07,  8.48s/it]                                                    87%|████████▋ | 740/847 [1:46:32<15:07,  8.48s/it] 87%|████████▋ | 741/847 [1:46:41<15:16,  8.64s/it] 88%|████████▊ | 742/847 [1:46:49<14:42,  8.41s/it] 88%|████████▊ | 743/847 [1:46:57<14:16,  8.24s/it] 88%|████████▊ | 744/847 [1:47:04<13:29,  7.86s/it] 88%|████████▊ | 745/847 [1:47:11<12:51,  7.56s/it] 88%|████████▊ | 746/847 [1:47:18<12:26,  7.39s/it] 88%|████████▊ | 747/847 [1:47:25<12:25,  7.46s/it] 88%|████████▊ | 748/847 [1:47:33<12:18,  7.46s/it] 88%|████████▊ | 749/847 [1:47:40<11:54,  7.30s/it] 89%|████████▊ | 750/847 [1:47:48<12:29,  7.72s/it]                                                    89%|████████▊ | 750/847 [1:47:48<12:29,  7.72s/it] 89%|████████▊ | 751/847 [1:47:55<11:41,  7.31s/it] 89%|████████▉ | 752/847 [1:48:03<12:02,  7.60s/it] 89%|████████▉ | 753/847 [1:48:11<12:06,  7.73s/it] 89%|████████▉ | 754/847 [1:48:20<12:26,  8.03s/it] 89%|████████▉ | 755/847 [1:48:28<12:38,  8.24s/it] 89%|████████▉ | 756/847 [1:48:38<13:17,  8.76s/it] 89%|████████▉ | 757/847 [1:48:47<13:18,  8.87s/it] 89%|████████▉ | 758/847 [1:48:56<12:50,  8.66s/it] 90%|████████▉ | 759/847 [1:49:06<13:13,  9.01s/it] 90%|████████▉ | 760/847 [1:49:13<12:27,  8.59s/it]                                                    90%|████████▉ | 760/847 [1:49:13<12:27,  8.59s/it] 90%|████████▉ | 761/847 [1:49:22<12:26,  8.68s/it] 90%|████████▉ | 762/847 [1:49:31<12:35,  8.89s/it] 90%|█████████ | 763/847 [1:49:40<12:20,  8.81s/it] 90%|█████████ | 764/847 [1:49:49<12:10,  8.80s/it] 90%|█████████ | 765/847 [1:49:57<11:48,  8.64s/it] 90%|█████████ | 766/847 [1:50:04<10:55,  8.09s/it] 91%|█████████ | 767/847 [1:50:12<10:53,  8.17s/it] 91%|█████████ | 768/847 [1:50:21<10:51,  8.24s/it] 91%|█████████ | 769/847 [1:50:28<10:18,  7.93s/it] 91%|█████████ | 770/847 [1:50:38<11:00,  8.58s/it]                                                    91%|█████████ | 770/847 [1:50:38<11:00,  8.58s/it] 91%|█████████ | 771/847 [1:50:46<10:51,  8.58s/it] 91%|█████████ | 772/847 [1:50:55<10:38,  8.52s/it] 91%|█████████▏| 773/847 [1:51:03<10:17,  8.35s/it] 91%|█████████▏| 774/847 [1:51:12<10:18,  8.47s/it] 91%|█████████▏| 775/847 [1:51:21<10:32,  8.79s/it] 92%|█████████▏| 776/847 [1:51:31<10:56,  9.25s/it] 92%|█████████▏| 777/847 [1:51:39<10:04,  8.63s/it] 92%|█████████▏| 778/847 [1:51:46<09:24,  8.19s/it] 92%|█████████▏| 779/847 [1:51:54<09:17,  8.20s/it] 92%|█████████▏| 780/847 [1:52:02<09:07,  8.17s/it]                                                    92%|█████████▏| 780/847 [1:52:02<09:07,  8.17s/it] 92%|█████████▏| 781/847 [1:52:11<09:07,  8.30s/it] 92%|█████████▏| 782/847 [1:52:19<09:08,  8.43s/it] 92%|█████████▏| 783/847 [1:52:29<09:21,  8.77s/it] 93%|█████████▎| 784/847 [1:52:37<08:55,  8.50s/it] 93%|█████████▎| 785/847 [1:52:44<08:23,  8.12s/it] 93%|█████████▎| 786/847 [1:52:53<08:23,  8.26s/it] 93%|█████████▎| 787/847 [1:53:01<08:18,  8.30s/it] 93%|█████████▎| 788/847 [1:53:10<08:15,  8.39s/it] 93%|█████████▎| 789/847 [1:53:18<08:10,  8.45s/it] 93%|█████████▎| 790/847 [1:53:26<07:57,  8.37s/it]                                                    93%|█████████▎| 790/847 [1:53:26<07:57,  8.37s/it] 93%|█████████▎| 791/847 [1:53:33<07:18,  7.83s/it] 94%|█████████▎| 792/847 [1:53:42<07:27,  8.14s/it] 94%|█████████▎| 793/847 [1:53:50<07:22,  8.19s/it] 94%|█████████▎| 794/847 [1:53:58<07:03,  7.98s/it] 94%|█████████▍| 795/847 [1:54:07<07:08,  8.25s/it] 94%|█████████▍| 796/847 [1:54:14<06:50,  8.04s/it] 94%|█████████▍| 797/847 [1:54:24<07:15,  8.71s/it] 94%|█████████▍| 798/847 [1:54:33<06:59,  8.55s/it] 94%|█████████▍| 799/847 [1:54:41<06:46,  8.47s/it] 94%|█████████▍| 800/847 [1:54:51<06:55,  8.84s/it]                                                    94%|█████████▍| 800/847 [1:54:51<06:55,  8.84s/it] 95%|█████████▍| 801/847 [1:54:59<06:37,  8.63s/it] 95%|█████████▍| 802/847 [1:55:06<06:09,  8.21s/it] 95%|█████████▍| 803/847 [1:55:15<06:11,  8.45s/it] 95%|█████████▍| 804/847 [1:55:24<06:12,  8.65s/it] 95%|█████████▌| 805/847 [1:55:32<05:57,  8.52s/it] 95%|█████████▌| 806/847 [1:55:41<05:56,  8.70s/it] 95%|█████████▌| 807/847 [1:55:50<05:44,  8.62s/it] 95%|█████████▌| 808/847 [1:55:59<05:38,  8.67s/it] 96%|█████████▌| 809/847 [1:56:06<05:10,  8.17s/it] 96%|█████████▌| 810/847 [1:56:14<05:01,  8.15s/it]                                                    96%|█████████▌| 810/847 [1:56:14<05:01,  8.15s/it] 96%|█████████▌| 811/847 [1:56:21<04:46,  7.96s/it] 96%|█████████▌| 812/847 [1:56:31<04:56,  8.47s/it] 96%|█████████▌| 813/847 [1:56:39<04:46,  8.42s/it] 96%|█████████▌| 814/847 [1:56:48<04:36,  8.39s/it] 96%|█████████▌| 815/847 [1:56:57<04:41,  8.81s/it] 96%|█████████▋| 816/847 [1:57:05<04:23,  8.50s/it] 96%|█████████▋| 817/847 [1:57:14<04:15,  8.52s/it] 97%|█████████▋| 818/847 [1:57:22<04:07,  8.54s/it] 97%|█████████▋| 819/847 [1:57:30<03:52,  8.29s/it] 97%|█████████▋| 820/847 [1:57:37<03:32,  7.86s/it]                                                    97%|█████████▋| 820/847 [1:57:37<03:32,  7.86s/it] 97%|█████████▋| 821/847 [1:57:46<03:30,  8.11s/it] 97%|█████████▋| 822/847 [1:57:54<03:26,  8.26s/it] 97%|█████████▋| 823/847 [1:58:01<03:07,  7.81s/it] 97%|█████████▋| 824/847 [1:58:10<03:05,  8.07s/it] 97%|█████████▋| 825/847 [1:58:18<03:00,  8.20s/it] 98%|█████████▊| 826/847 [1:58:26<02:52,  8.22s/it] 98%|█████████▊| 827/847 [1:58:34<02:41,  8.09s/it] 98%|█████████▊| 828/847 [1:58:43<02:35,  8.21s/it] 98%|█████████▊| 829/847 [1:58:50<02:20,  7.83s/it] 98%|█████████▊| 830/847 [1:58:58<02:18,  8.15s/it]                                                    98%|█████████▊| 830/847 [1:58:58<02:18,  8.15s/it] 98%|█████████▊| 831/847 [1:59:07<02:13,  8.36s/it] 98%|█████████▊| 832/847 [1:59:16<02:06,  8.44s/it] 98%|█████████▊| 833/847 [1:59:25<01:58,  8.50s/it] 98%|█████████▊| 834/847 [1:59:32<01:45,  8.10s/it] 99%|█████████▊| 835/847 [1:59:39<01:33,  7.83s/it] 99%|█████████▊| 836/847 [1:59:46<01:24,  7.68s/it] 99%|█████████▉| 837/847 [1:59:55<01:19,  7.91s/it] 99%|█████████▉| 838/847 [2:00:04<01:13,  8.18s/it] 99%|█████████▉| 839/847 [2:00:10<01:01,  7.74s/it] 99%|█████████▉| 840/847 [2:00:20<00:58,  8.35s/it]                                                    99%|█████████▉| 840/847 [2:00:20<00:58,  8.35s/it] 99%|█████████▉| 841/847 [2:00:29<00:50,  8.42s/it] 99%|█████████▉| 842/847 [2:00:37<00:41,  8.27s/it]100%|█████████▉| 843/847 [2:00:45<00:33,  8.26s/it]100%|█████████▉| 844/847 [2:00:54<00:25,  8.49s/it]100%|█████████▉| 845/847 [2:01:00<00:15,  7.67s/it]100%|█████████▉| 846/847 [2:01:10<00:08,  8.50s/it]100%|██████████| 847/847 [2:01:18<00:00,  8.50s/it]{'eval_loss': 1.4787393808364868, 'eval_runtime': 37.8278, 'eval_samples_per_second': 6.424, 'eval_steps_per_second': 1.613, 'epoch': 6.0}
{'loss': 0.4791, 'grad_norm': 0.8877142667770386, 'learning_rate': 5.134781541685995e-06, 'epoch': 6.02}
{'loss': 0.448, 'grad_norm': 1.0405058860778809, 'learning_rate': 4.306848022279619e-06, 'epoch': 6.1}
{'loss': 0.3851, 'grad_norm': 1.4280259609222412, 'learning_rate': 3.548670814166971e-06, 'epoch': 6.19}
{'loss': 0.4169, 'grad_norm': 1.0289891958236694, 'learning_rate': 2.8614073696807297e-06, 'epoch': 6.27}
{'loss': 0.4198, 'grad_norm': 0.8549163937568665, 'learning_rate': 2.246106882424326e-06, 'epoch': 6.35}
{'loss': 0.4232, 'grad_norm': 0.9592973589897156, 'learning_rate': 1.70370868554659e-06, 'epoch': 6.43}
{'loss': 0.4366, 'grad_norm': 0.9219844937324524, 'learning_rate': 1.235040817732297e-06, 'epoch': 6.52}
{'loss': 0.4353, 'grad_norm': 0.8627781867980957, 'learning_rate': 8.408187590975169e-07, 'epoch': 6.6}
{'loss': 0.4482, 'grad_norm': 0.9407931566238403, 'learning_rate': 5.216443389197412e-07, 'epoch': 6.68}
{'loss': 0.4105, 'grad_norm': 0.8814008235931396, 'learning_rate': 2.7800481687021987e-07, 'epoch': 6.76}
{'loss': 0.4338, 'grad_norm': 0.8910788297653198, 'learning_rate': 1.1027213915111856e-07, 'epoch': 6.85}
{'loss': 0.4334, 'grad_norm': 0.8914215564727783, 'learning_rate': 1.8702370673151502e-08, 'epoch': 6.93}

  0%|          | 0/61 [00:00<?, ?it/s][A
  3%|▎         | 2/61 [00:00<00:18,  3.18it/s][A
  5%|▍         | 3/61 [00:01<00:30,  1.93it/s][A
  7%|▋         | 4/61 [00:02<00:33,  1.72it/s][A
  8%|▊         | 5/61 [00:02<00:31,  1.75it/s][A
 10%|▉         | 6/61 [00:03<00:31,  1.74it/s][A
 11%|█▏        | 7/61 [00:04<00:36,  1.49it/s][A
 13%|█▎        | 8/61 [00:04<00:34,  1.55it/s][A
 15%|█▍        | 9/61 [00:05<00:30,  1.72it/s][A
 16%|█▋        | 10/61 [00:05<00:29,  1.70it/s][A
 18%|█▊        | 11/61 [00:06<00:30,  1.66it/s][A
 20%|█▉        | 12/61 [00:07<00:29,  1.64it/s][A
 21%|██▏       | 13/61 [00:07<00:28,  1.67it/s][A
 23%|██▎       | 14/61 [00:08<00:26,  1.76it/s][A
 25%|██▍       | 15/61 [00:08<00:27,  1.67it/s][A
 26%|██▌       | 16/61 [00:09<00:26,  1.69it/s][A
 28%|██▊       | 17/61 [00:09<00:26,  1.66it/s][A
 30%|██▉       | 18/61 [00:10<00:26,  1.62it/s][A
 31%|███       | 19/61 [00:11<00:24,  1.70it/s][A
 33%|███▎      | 20/61 [00:11<00:25,  1.61it/s][A
 34%|███▍      | 21/61 [00:12<00:26,  1.49it/s][A
 36%|███▌      | 22/61 [00:13<00:25,  1.52it/s][A
 38%|███▊      | 23/61 [00:14<00:26,  1.43it/s][A
 39%|███▉      | 24/61 [00:14<00:25,  1.43it/s][A
 41%|████      | 25/61 [00:15<00:25,  1.42it/s][A
 43%|████▎     | 26/61 [00:16<00:24,  1.44it/s][A
 44%|████▍     | 27/61 [00:16<00:22,  1.52it/s][A
 46%|████▌     | 28/61 [00:17<00:23,  1.42it/s][A
 48%|████▊     | 29/61 [00:18<00:23,  1.34it/s][A
 49%|████▉     | 30/61 [00:18<00:21,  1.42it/s][A
 51%|█████     | 31/61 [00:19<00:22,  1.34it/s][A
 52%|█████▏    | 32/61 [00:20<00:20,  1.43it/s][A
 54%|█████▍    | 33/61 [00:21<00:19,  1.43it/s][A
 56%|█████▌    | 34/61 [00:21<00:18,  1.45it/s][A
 57%|█████▋    | 35/61 [00:22<00:16,  1.58it/s][A
 59%|█████▉    | 36/61 [00:22<00:15,  1.65it/s][A
 61%|██████    | 37/61 [00:23<00:14,  1.68it/s][A
 62%|██████▏   | 38/61 [00:24<00:14,  1.61it/s][A
 64%|██████▍   | 39/61 [00:24<00:13,  1.64it/s][A
 66%|██████▌   | 40/61 [00:25<00:12,  1.73it/s][A
 67%|██████▋   | 41/61 [00:25<00:12,  1.66it/s][A
 69%|██████▉   | 42/61 [00:26<00:11,  1.60it/s][A
 70%|███████   | 43/61 [00:27<00:11,  1.64it/s][A
 72%|███████▏  | 44/61 [00:27<00:10,  1.67it/s][A
 74%|███████▍  | 45/61 [00:28<00:09,  1.73it/s][A
 75%|███████▌  | 46/61 [00:28<00:08,  1.81it/s][A
 77%|███████▋  | 47/61 [00:29<00:07,  1.84it/s][A
 79%|███████▊  | 48/61 [00:29<00:06,  1.88it/s][A
 80%|████████  | 49/61 [00:30<00:06,  1.92it/s][A
 82%|████████▏ | 50/61 [00:30<00:06,  1.75it/s][A
 84%|████████▎ | 51/61 [00:31<00:05,  1.75it/s][A
 85%|████████▌ | 52/61 [00:32<00:05,  1.75it/s][A
 87%|████████▋ | 53/61 [00:32<00:04,  1.78it/s][A
 89%|████████▊ | 54/61 [00:33<00:04,  1.56it/s][A
 90%|█████████ | 55/61 [00:34<00:03,  1.54it/s][A
 92%|█████████▏| 56/61 [00:34<00:03,  1.62it/s][A
 93%|█████████▎| 57/61 [00:35<00:02,  1.74it/s][A
 95%|█████████▌| 58/61 [00:35<00:01,  1.80it/s][A
 97%|█████████▋| 59/61 [00:36<00:01,  1.90it/s][A
 98%|█████████▊| 60/61 [00:36<00:00,  1.84it/s][A
100%|██████████| 61/61 [00:37<00:00,  1.81it/s][A                                                   
                                               [A100%|██████████| 847/847 [2:01:56<00:00,  8.50s/it]
100%|██████████| 61/61 [00:37<00:00,  1.81it/s][A
                                               [A/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                   100%|██████████| 847/847 [2:02:00<00:00,  8.50s/it]100%|██████████| 847/847 [2:02:00<00:00,  8.64s/it]
/mnt/beegfs/work/yang/dpo_h/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--llama-3/8B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 1.5375066995620728, 'eval_runtime': 37.8612, 'eval_samples_per_second': 6.418, 'eval_steps_per_second': 1.611, 'epoch': 6.99}
{'train_runtime': 7342.4695, 'train_samples_per_second': 1.848, 'train_steps_per_second': 0.115, 'train_loss': 0.7705480312090697, 'epoch': 6.99}
wandb: - 0.371 MB of 0.371 MB uploadedwandb: \ 0.371 MB of 0.398 MB uploadedwandb: | 0.398 MB of 0.398 MB uploadedwandb: 
wandb: Run history:
wandb:               eval/loss ▁▁▂▃▅▇█
wandb:            eval/runtime ▅▅▆▁▁▆█
wandb: eval/samples_per_second ▅▄▃██▃▁
wandb:   eval/steps_per_second ▄▄▂█▇▄▁
wandb:             train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:         train/grad_norm ▆▂▂▂▁▁▂▂▂▂▁▂▂▃▂▃▂▃▄▄▄▄▄▄▄▅▅▄▅▆▆▅▅▅▅█▄▅▅▅
wandb:     train/learning_rate ▃▆███████▇▇▇▇▇▆▆▆▆▅▅▅▄▄▄▃▃▃▃▃▂▂▂▂▁▁▁▁▁▁▁
wandb:              train/loss █▅▅▅▅▅▄▄▄▄▄▄▃▃▄▃▄▃▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:                eval/loss 1.53751
wandb:             eval/runtime 37.8612
wandb:  eval/samples_per_second 6.418
wandb:    eval/steps_per_second 1.611
wandb:               total_flos 5.6833083334567526e+17
wandb:              train/epoch 6.98557
wandb:        train/global_step 847
wandb:          train/grad_norm 0.89142
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.4334
wandb:               train_loss 0.77055
wandb:            train_runtime 7342.4695
wandb: train_samples_per_second 1.848
wandb:   train_steps_per_second 0.115
wandb: 
wandb: 🚀 View run sft_llama-3-8B-Instruct_Dialog_lr-0.0001_ep-7_bz-4-acc-4_lora-r-32-ap-64 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/4akg6hvg
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240526_145152-4akg6hvg/logs
