/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/requests/__init__.py:109: RequestsDependencyWarning: urllib3 (2.2.1) or chardet (None)/charset_normalizer (2.1.1) doesn't match a supported version!
  warnings.warn(
`low_cpu_mem_usage` was None, now set to True since model is quantized.
`low_cpu_mem_usage` was None, now set to True since model is quantized.
Found max lenth: 512
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map: 100%|██████████| 1984/1984 [00:00<00:00, 68029.46 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 63596.50 examples/s]
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Parameter 'function'=<bound method DPOTrainer.tokenize_row of <trl.trainer.dpo_trainer.DPOTrainer object at 0x7f66dbf555e0>> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
trainable params: 245366784 || all params: 739109888 || trainables%: 33.197605387739046
Map:   0%|          | 0/1984 [00:00<?, ? examples/s]Map:   2%|▏         | 41/1984 [00:00<00:04, 404.13 examples/s]Map:   6%|▌         | 111/1984 [00:00<00:03, 569.98 examples/s]Map:   9%|▉         | 176/1984 [00:00<00:02, 602.99 examples/s]Map:  12%|█▏        | 241/1984 [00:00<00:02, 617.68 examples/s]Map:  17%|█▋        | 336/1984 [00:00<00:02, 613.88 examples/s]Map:  21%|██        | 412/1984 [00:00<00:02, 654.85 examples/s]Map:  25%|██▌       | 505/1984 [00:00<00:02, 632.92 examples/s]Map:  29%|██▉       | 575/1984 [00:00<00:02, 649.49 examples/s]Map:  33%|███▎      | 661/1984 [00:01<00:02, 615.37 examples/s]Map:  38%|███▊      | 753/1984 [00:01<00:02, 613.15 examples/s]Map:  41%|████      | 818/1984 [00:01<00:01, 618.66 examples/s]Map:  46%|████▌     | 909/1984 [00:01<00:01, 610.77 examples/s]Map:  49%|████▉     | 979/1984 [00:01<00:01, 628.77 examples/s]Map:  54%|█████▍    | 1073/1984 [00:01<00:01, 513.96 examples/s]Map:  57%|█████▋    | 1135/1984 [00:01<00:01, 534.26 examples/s]Map:  60%|██████    | 1200/1984 [00:02<00:01, 559.04 examples/s]Map:  64%|██████▍   | 1268/1984 [00:02<00:01, 586.43 examples/s]Map:  67%|██████▋   | 1333/1984 [00:02<00:01, 599.35 examples/s]Map:  72%|███████▏  | 1423/1984 [00:02<00:00, 596.43 examples/s]Map:  75%|███████▌  | 1492/1984 [00:02<00:00, 618.23 examples/s]Map:  78%|███████▊  | 1557/1984 [00:02<00:00, 621.71 examples/s]Map:  83%|████████▎ | 1653/1984 [00:02<00:00, 625.79 examples/s]Map:  87%|████████▋ | 1728/1984 [00:02<00:00, 653.97 examples/s]Map:  92%|█████████▏| 1818/1984 [00:03<00:00, 629.86 examples/s]Map:  95%|█████████▌| 1887/1984 [00:03<00:00, 643.56 examples/s]Map:  98%|█████████▊| 1953/1984 [00:03<00:00, 646.49 examples/s]Map: 100%|██████████| 1984/1984 [00:03<00:00, 589.24 examples/s]
Map:   0%|          | 0/249 [00:00<?, ? examples/s]Map:  24%|██▍       | 60/249 [00:00<00:00, 587.58 examples/s]Map:  48%|████▊     | 119/249 [00:00<00:00, 581.44 examples/s]Map:  75%|███████▍  | 186/249 [00:00<00:00, 615.14 examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 581.73 examples/s]Map: 100%|██████████| 249/249 [00:00<00:00, 583.81 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/requests/__init__.py:109: RequestsDependencyWarning: urllib3 (2.2.1) or chardet (None)/charset_normalizer (2.1.1) doesn't match a supported version!
  warnings.warn(
wandb: Currently logged in as: skyfishq (ukp-conv). Use `wandb login --relogin` to force relogin
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /mnt/beegfs/work/yang/LLM_Anonymization/programming_runs/wandb/run-20240523_115056-c5cdtal7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dpo_google--flan-t5-large--hf-_None_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256
wandb: ⭐️ View project at https://wandb.ai/ukp-conv/Privacy-NLP
wandb: 🚀 View run at https://wandb.ai/ukp-conv/Privacy-NLP/runs/c5cdtal7
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--google--flan-t5-large--hf/ - will assume that the vocabulary was not modified.
  warnings.warn(
  0%|          | 0/930 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/930 [00:22<5:46:57, 22.41s/it]  0%|          | 2/930 [00:40<5:06:37, 19.83s/it]  0%|          | 3/930 [01:00<5:07:05, 19.88s/it]  0%|          | 4/930 [01:20<5:05:40, 19.81s/it]  1%|          | 5/930 [01:38<5:00:19, 19.48s/it]  1%|          | 6/930 [01:57<4:54:32, 19.13s/it]  1%|          | 7/930 [02:17<4:58:41, 19.42s/it]  1%|          | 8/930 [02:35<4:53:52, 19.12s/it]  1%|          | 9/930 [02:54<4:49:39, 18.87s/it]  1%|          | 10/930 [03:10<4:35:18, 17.95s/it]                                                    1%|          | 10/930 [03:10<4:35:18, 17.95s/it]  1%|          | 11/930 [03:26<4:26:40, 17.41s/it]  1%|▏         | 12/930 [03:45<4:36:48, 18.09s/it]  1%|▏         | 13/930 [04:03<4:33:12, 17.88s/it]  2%|▏         | 14/930 [04:21<4:33:29, 17.91s/it]  2%|▏         | 15/930 [04:39<4:36:18, 18.12s/it]  2%|▏         | 16/930 [04:55<4:23:23, 17.29s/it]  2%|▏         | 17/930 [05:14<4:30:45, 17.79s/it]  2%|▏         | 18/930 [05:32<4:32:41, 17.94s/it]  2%|▏         | 19/930 [05:52<4:40:17, 18.46s/it]  2%|▏         | 20/930 [06:12<4:46:42, 18.90s/it]                                                    2%|▏         | 20/930 [06:12<4:46:42, 18.90s/it]  2%|▏         | 21/930 [06:31<4:48:20, 19.03s/it]  2%|▏         | 22/930 [06:48<4:38:29, 18.40s/it]  2%|▏         | 23/930 [07:06<4:34:45, 18.18s/it]  3%|▎         | 24/930 [07:21<4:21:37, 17.33s/it]  3%|▎         | 25/930 [07:40<4:31:10, 17.98s/it]  3%|▎         | 26/930 [07:59<4:33:46, 18.17s/it]  3%|▎         | 27/930 [08:16<4:26:54, 17.74s/it]  3%|▎         | 28/930 [08:35<4:32:13, 18.11s/it]  3%|▎         | 29/930 [08:51<4:25:35, 17.69s/it]  3%|▎         | 30/930 [09:08<4:19:39, 17.31s/it]                                                    3%|▎         | 30/930 [09:08<4:19:39, 17.31s/it]  3%|▎         | 31/930 [09:26<4:22:59, 17.55s/it]  3%|▎         | 32/930 [09:46<4:34:27, 18.34s/it]  4%|▎         | 33/930 [10:03<4:28:19, 17.95s/it]  4%|▎         | 34/930 [10:21<4:26:56, 17.88s/it]  4%|▍         | 35/930 [10:40<4:33:32, 18.34s/it]  4%|▍         | 36/930 [11:00<4:37:10, 18.60s/it]  4%|▍         | 37/930 [11:18<4:37:57, 18.68s/it]  4%|▍         | 38/930 [11:36<4:32:16, 18.31s/it]  4%|▍         | 39/930 [11:53<4:27:08, 17.99s/it]  4%|▍         | 40/930 [12:09<4:16:48, 17.31s/it]                                                    4%|▍         | 40/930 [12:09<4:16:48, 17.31s/it]  4%|▍         | 41/930 [12:25<4:13:30, 17.11s/it]  5%|▍         | 42/930 [12:43<4:16:51, 17.36s/it]  5%|▍         | 43/930 [13:04<4:29:59, 18.26s/it]  5%|▍         | 44/930 [13:21<4:24:07, 17.89s/it]  5%|▍         | 45/930 [13:39<4:24:41, 17.95s/it]  5%|▍         | 46/930 [13:58<4:29:23, 18.28s/it]  5%|▌         | 47/930 [14:17<4:33:52, 18.61s/it]  5%|▌         | 48/930 [14:38<4:40:41, 19.09s/it]  5%|▌         | 49/930 [14:57<4:41:55, 19.20s/it]  5%|▌         | 50/930 [15:16<4:41:59, 19.23s/it]                                                    5%|▌         | 50/930 [15:16<4:41:59, 19.23s/it]  5%|▌         | 51/930 [15:36<4:44:37, 19.43s/it]  6%|▌         | 52/930 [15:55<4:43:27, 19.37s/it]  6%|▌         | 53/930 [16:16<4:46:30, 19.60s/it]  6%|▌         | 54/930 [16:34<4:42:19, 19.34s/it]  6%|▌         | 55/930 [16:54<4:45:36, 19.58s/it]  6%|▌         | 56/930 [17:11<4:33:00, 18.74s/it]  6%|▌         | 57/930 [17:29<4:27:20, 18.37s/it]  6%|▌         | 58/930 [17:48<4:29:57, 18.57s/it]  6%|▋         | 59/930 [18:06<4:28:51, 18.52s/it]  6%|▋         | 60/930 [18:23<4:20:36, 17.97s/it]                                                    6%|▋         | 60/930 [18:23<4:20:36, 17.97s/it]  7%|▋         | 61/930 [18:40<4:17:58, 17.81s/it]  7%|▋         | 62/930 [19:00<4:25:06, 18.33s/it]  7%|▋         | 63/930 [19:19<4:27:56, 18.54s/it]  7%|▋         | 64/930 [19:38<4:28:35, 18.61s/it]  7%|▋         | 65/930 [19:57<4:30:00, 18.73s/it]  7%|▋         | 66/930 [20:15<4:27:00, 18.54s/it]  7%|▋         | 67/930 [20:32<4:23:06, 18.29s/it]  7%|▋         | 68/930 [20:51<4:23:47, 18.36s/it]  7%|▋         | 69/930 [21:10<4:25:02, 18.47s/it]  8%|▊         | 70/930 [21:28<4:22:00, 18.28s/it]                                                    8%|▊         | 70/930 [21:28<4:22:00, 18.28s/it]  8%|▊         | 71/930 [21:45<4:18:59, 18.09s/it]  8%|▊         | 72/930 [22:05<4:24:58, 18.53s/it]  8%|▊         | 73/930 [22:21<4:16:47, 17.98s/it]  8%|▊         | 74/930 [22:41<4:24:33, 18.54s/it]  8%|▊         | 75/930 [22:59<4:20:06, 18.25s/it]  8%|▊         | 76/930 [23:18<4:21:45, 18.39s/it]  8%|▊         | 77/930 [23:36<4:20:50, 18.35s/it]  8%|▊         | 78/930 [23:55<4:25:20, 18.69s/it]  8%|▊         | 79/930 [24:14<4:23:07, 18.55s/it]  9%|▊         | 80/930 [24:30<4:15:26, 18.03s/it]                                                    9%|▊         | 80/930 [24:30<4:15:26, 18.03s/it]  9%|▊         | 81/930 [24:49<4:18:50, 18.29s/it]  9%|▉         | 82/930 [25:08<4:19:52, 18.39s/it]  9%|▉         | 83/930 [25:25<4:15:17, 18.08s/it]  9%|▉         | 84/930 [25:43<4:12:47, 17.93s/it]  9%|▉         | 85/930 [26:01<4:15:08, 18.12s/it]  9%|▉         | 86/930 [26:20<4:16:56, 18.27s/it]  9%|▉         | 87/930 [26:37<4:11:45, 17.92s/it]  9%|▉         | 88/930 [26:56<4:13:47, 18.09s/it] 10%|▉         | 89/930 [27:15<4:18:54, 18.47s/it] 10%|▉         | 90/930 [27:33<4:15:54, 18.28s/it]                                                   10%|▉         | 90/930 [27:33<4:15:54, 18.28s/it] 10%|▉         | 91/930 [27:51<4:16:37, 18.35s/it] 10%|▉         | 92/930 [28:11<4:23:44, 18.88s/it] 10%|█         | 93/930 [28:29<4:19:10, 18.58s/it] 10%|█         | 94/930 [28:49<4:21:46, 18.79s/it] 10%|█         | 95/930 [29:08<4:26:16, 19.13s/it] 10%|█         | 96/930 [29:29<4:30:09, 19.44s/it] 10%|█         | 97/930 [29:48<4:27:45, 19.29s/it] 11%|█         | 98/930 [30:06<4:25:17, 19.13s/it] 11%|█         | 99/930 [30:25<4:24:50, 19.12s/it] 11%|█         | 100/930 [30:44<4:22:53, 19.00s/it]                                                    11%|█         | 100/930 [30:44<4:22:53, 19.00s/it] 11%|█         | 101/930 [31:04<4:27:23, 19.35s/it] 11%|█         | 102/930 [31:22<4:21:21, 18.94s/it] 11%|█         | 103/930 [31:41<4:19:14, 18.81s/it] 11%|█         | 104/930 [31:58<4:12:36, 18.35s/it] 11%|█▏        | 105/930 [32:17<4:14:57, 18.54s/it] 11%|█▏        | 106/930 [32:36<4:14:33, 18.54s/it] 12%|█▏        | 107/930 [32:53<4:08:19, 18.10s/it] 12%|█▏        | 108/930 [33:12<4:12:46, 18.45s/it] 12%|█▏        | 109/930 [33:30<4:10:10, 18.28s/it] 12%|█▏        | 110/930 [33:49<4:14:26, 18.62s/it]                                                    12%|█▏        | 110/930 [33:49<4:14:26, 18.62s/it] 12%|█▏        | 111/930 [34:07<4:12:35, 18.50s/it] 12%|█▏        | 112/930 [34:24<4:05:22, 18.00s/it] 12%|█▏        | 113/930 [34:42<4:02:03, 17.78s/it] 12%|█▏        | 114/930 [35:01<4:06:53, 18.15s/it] 12%|█▏        | 115/930 [35:18<4:02:59, 17.89s/it] 12%|█▏        | 116/930 [35:38<4:11:50, 18.56s/it] 13%|█▎        | 117/930 [35:57<4:11:27, 18.56s/it] 13%|█▎        | 118/930 [36:16<4:13:14, 18.71s/it] 13%|█▎        | 119/930 [36:35<4:17:25, 19.04s/it] 13%|█▎        | 120/930 [36:52<4:08:27, 18.40s/it]                                                    13%|█▎        | 120/930 [36:52<4:08:27, 18.40s/it] 13%|█▎        | 121/930 [37:12<4:13:02, 18.77s/it] 13%|█▎        | 122/930 [37:31<4:12:26, 18.75s/it] 13%|█▎        | 123/930 [37:49<4:10:52, 18.65s/it] 13%|█▎        | 124/930 [38:06<4:02:58, 18.09s/it] 13%|█▎        | 125/930 [38:24<4:03:15, 18.13s/it] 14%|█▎        | 126/930 [38:44<4:08:56, 18.58s/it] 14%|█▎        | 127/930 [39:03<4:11:40, 18.80s/it] 14%|█▍        | 128/930 [39:21<4:08:13, 18.57s/it] 14%|█▍        | 129/930 [39:39<4:07:02, 18.51s/it] 14%|█▍        | 130/930 [39:57<4:04:15, 18.32s/it]                                                    14%|█▍        | 130/930 [39:57<4:04:15, 18.32s/it] 14%|█▍        | 131/930 [40:17<4:09:14, 18.72s/it] 14%|█▍        | 132/930 [40:34<4:01:42, 18.17s/it] 14%|█▍        | 133/930 [40:54<4:08:43, 18.72s/it] 14%|█▍        | 134/930 [41:12<4:06:20, 18.57s/it] 15%|█▍        | 135/930 [41:32<4:12:22, 19.05s/it] 15%|█▍        | 136/930 [41:49<4:02:24, 18.32s/it] 15%|█▍        | 137/930 [42:07<4:03:06, 18.39s/it] 15%|█▍        | 138/930 [42:28<4:09:41, 18.92s/it] 15%|█▍        | 139/930 [42:45<4:05:17, 18.61s/it] 15%|█▌        | 140/930 [43:03<4:00:26, 18.26s/it]                                                    15%|█▌        | 140/930 [43:03<4:00:26, 18.26s/it] 15%|█▌        | 141/930 [43:22<4:03:22, 18.51s/it] 15%|█▌        | 142/930 [43:40<4:02:48, 18.49s/it] 15%|█▌        | 143/930 [44:00<4:07:20, 18.86s/it] 15%|█▌        | 144/930 [44:17<4:00:40, 18.37s/it] 16%|█▌        | 145/930 [44:35<3:56:29, 18.08s/it] 16%|█▌        | 146/930 [44:55<4:04:37, 18.72s/it] 16%|█▌        | 147/930 [45:14<4:04:47, 18.76s/it] 16%|█▌        | 148/930 [45:32<4:03:09, 18.66s/it] 16%|█▌        | 149/930 [45:49<3:56:50, 18.20s/it] 16%|█▌        | 150/930 [46:10<4:04:23, 18.80s/it]                                                    16%|█▌        | 150/930 [46:10<4:04:23, 18.80s/it] 16%|█▌        | 151/930 [46:27<3:57:57, 18.33s/it] 16%|█▋        | 152/930 [46:45<3:57:40, 18.33s/it] 16%|█▋        | 153/930 [47:04<3:59:11, 18.47s/it] 17%|█▋        | 154/930 [47:23<4:00:15, 18.58s/it] 17%|█▋        | 155/930 [47:40<3:56:38, 18.32s/it] 17%|█▋        | 156/930 [47:58<3:52:13, 18.00s/it] 17%|█▋        | 157/930 [48:14<3:46:43, 17.60s/it] 17%|█▋        | 158/930 [48:34<3:53:41, 18.16s/it] 17%|█▋        | 159/930 [48:54<4:00:33, 18.72s/it] 17%|█▋        | 160/930 [49:13<4:00:45, 18.76s/it]                                                    17%|█▋        | 160/930 [49:13<4:00:45, 18.76s/it] 17%|█▋        | 161/930 [49:32<4:01:32, 18.85s/it] 17%|█▋        | 162/930 [49:48<3:52:52, 18.19s/it] 18%|█▊        | 163/930 [50:07<3:52:37, 18.20s/it] 18%|█▊        | 164/930 [50:26<3:54:46, 18.39s/it] 18%|█▊        | 165/930 [50:43<3:49:39, 18.01s/it] 18%|█▊        | 166/930 [51:03<3:57:06, 18.62s/it] 18%|█▊        | 167/930 [51:21<3:57:01, 18.64s/it] 18%|█▊        | 168/930 [51:38<3:48:58, 18.03s/it] 18%|█▊        | 169/930 [51:57<3:50:46, 18.20s/it] 18%|█▊        | 170/930 [52:16<3:53:22, 18.42s/it]                                                    18%|█▊        | 170/930 [52:16<3:53:22, 18.42s/it] 18%|█▊        | 171/930 [52:35<3:56:06, 18.66s/it] 18%|█▊        | 172/930 [52:51<3:45:27, 17.85s/it] 19%|█▊        | 173/930 [53:08<3:44:18, 17.78s/it] 19%|█▊        | 174/930 [53:27<3:46:49, 18.00s/it] 19%|█▉        | 175/930 [53:46<3:49:39, 18.25s/it] 19%|█▉        | 176/930 [54:05<3:54:11, 18.64s/it] 19%|█▉        | 177/930 [54:25<3:59:46, 19.11s/it] 19%|█▉        | 178/930 [54:44<3:59:03, 19.07s/it] 19%|█▉        | 179/930 [55:01<3:49:34, 18.34s/it] 19%|█▉        | 180/930 [55:18<3:44:13, 17.94s/it]                                                    19%|█▉        | 180/930 [55:18<3:44:13, 17.94s/it] 19%|█▉        | 181/930 [55:37<3:48:16, 18.29s/it] 20%|█▉        | 182/930 [55:57<3:54:07, 18.78s/it] 20%|█▉        | 183/930 [56:14<3:46:08, 18.16s/it] 20%|█▉        | 184/930 [56:33<3:51:16, 18.60s/it] 20%|█▉        | 185/930 [56:52<3:51:26, 18.64s/it] 20%|██        | 186/930 [57:11<3:50:23, 18.58s/it] 20%|██        | 187/930 [57:30<3:55:03, 18.98s/it] 20%|██        | 188/930 [57:50<3:56:09, 19.10s/it] 20%|██        | 189/930 [58:09<3:56:05, 19.12s/it] 20%|██        | 190/930 [58:29<3:58:19, 19.32s/it]                                                    20%|██        | 190/930 [58:29<3:58:19, 19.32s/it] 21%|██        | 191/930 [58:45<3:47:10, 18.45s/it] 21%|██        | 192/930 [59:01<3:36:17, 17.58s/it] 21%|██        | 193/930 [59:19<3:39:11, 17.85s/it] 21%|██        | 194/930 [59:35<3:31:29, 17.24s/it] 21%|██        | 195/930 [59:55<3:40:21, 17.99s/it] 21%|██        | 196/930 [1:00:15<3:47:11, 18.57s/it] 21%|██        | 197/930 [1:00:34<3:49:52, 18.82s/it] 21%|██▏       | 198/930 [1:00:52<3:44:27, 18.40s/it] 21%|██▏       | 199/930 [1:01:08<3:38:15, 17.91s/it] 22%|██▏       | 200/930 [1:01:24<3:30:59, 17.34s/it]                                                      22%|██▏       | 200/930 [1:01:24<3:30:59, 17.34s/it]{'loss': 0.7153, 'grad_norm': 4.002204418182373, 'learning_rate': 4.2553191489361704e-05, 'rewards/chosen': -0.6357643604278564, 'rewards/rejected': -0.7144858241081238, 'rewards/accuracies': 0.518750011920929, 'rewards/margins': 0.07872148603200912, 'logps/rejected': -231.5177459716797, 'logps/chosen': -289.54486083984375, 'logits/rejected': 6.414086818695068, 'logits/chosen': 11.077524185180664, 'epoch': 0.16}
{'loss': 0.4918, 'grad_norm': 3.861783504486084, 'learning_rate': 8.510638297872341e-05, 'rewards/chosen': -2.2821044921875, 'rewards/rejected': -4.444185733795166, 'rewards/accuracies': 0.765625, 'rewards/margins': 2.162081241607666, 'logps/rejected': -244.243896484375, 'logps/chosen': -283.22882080078125, 'logits/rejected': -0.23536524176597595, 'logits/chosen': 5.78510046005249, 'epoch': 0.32}
{'loss': 0.402, 'grad_norm': 3.722872495651245, 'learning_rate': 0.00012765957446808513, 'rewards/chosen': -4.417305946350098, 'rewards/rejected': -8.611968040466309, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 4.194662094116211, 'logps/rejected': -308.93133544921875, 'logps/chosen': -324.13555908203125, 'logits/rejected': -3.7283005714416504, 'logits/chosen': 1.7843294143676758, 'epoch': 0.48}
{'loss': 0.293, 'grad_norm': 4.248465538024902, 'learning_rate': 0.00017021276595744682, 'rewards/chosen': -6.422360420227051, 'rewards/rejected': -14.727951049804688, 'rewards/accuracies': 0.878125011920929, 'rewards/margins': 8.305591583251953, 'logps/rejected': -364.71234130859375, 'logps/chosen': -337.6999816894531, 'logits/rejected': -3.8163342475891113, 'logits/chosen': 2.3992319107055664, 'epoch': 0.65}
{'loss': 0.2342, 'grad_norm': 2.601824998855591, 'learning_rate': 0.00019999430378033335, 'rewards/chosen': -8.381738662719727, 'rewards/rejected': -15.563697814941406, 'rewards/accuracies': 0.903124988079071, 'rewards/margins': 7.1819610595703125, 'logps/rejected': -367.9033508300781, 'logps/chosen': -361.639404296875, 'logits/rejected': -1.1232606172561646, 'logits/chosen': 4.209721565246582, 'epoch': 0.81}
{'loss': 0.3034, 'grad_norm': 3.0390870571136475, 'learning_rate': 0.00019989305570468422, 'rewards/chosen': -8.978047370910645, 'rewards/rejected': -14.762049674987793, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 5.784003734588623, 'logps/rejected': -379.899658203125, 'logps/chosen': -375.954345703125, 'logits/rejected': -0.3019355833530426, 'logits/chosen': 3.8572471141815186, 'epoch': 0.97}
{'loss': 0.1647, 'grad_norm': 4.428741455078125, 'learning_rate': 0.00019966537248029015, 'rewards/chosen': -12.963769912719727, 'rewards/rejected': -28.42179298400879, 'rewards/accuracies': 0.921875, 'rewards/margins': 15.458023071289062, 'logps/rejected': -504.1748046875, 'logps/chosen': -407.3671875, 'logits/rejected': -3.97355318069458, 'logits/chosen': 2.3271546363830566, 'epoch': 1.13}
{'loss': 0.2308, 'grad_norm': 1.9715873003005981, 'learning_rate': 0.00019931154228696656, 'rewards/chosen': -12.178518295288086, 'rewards/rejected': -21.30335235595703, 'rewards/accuracies': 0.909375011920929, 'rewards/margins': 9.124835014343262, 'logps/rejected': -426.8692932128906, 'logps/chosen': -393.19647216796875, 'logits/rejected': -0.756615936756134, 'logits/chosen': 3.8158442974090576, 'epoch': 1.29}
{'loss': 0.1699, 'grad_norm': 2.7564237117767334, 'learning_rate': 0.0001988320129693889, 'rewards/chosen': -12.306109428405762, 'rewards/rejected': -22.11234474182129, 'rewards/accuracies': 0.934374988079071, 'rewards/margins': 9.806236267089844, 'logps/rejected': -442.728759765625, 'logps/chosen': -402.8385314941406, 'logits/rejected': -1.3327052593231201, 'logits/chosen': 3.8277339935302734, 'epoch': 1.45}
{'loss': 0.1978, 'grad_norm': 1.9185398817062378, 'learning_rate': 0.0001982273914702538, 'rewards/chosen': -21.408733367919922, 'rewards/rejected': -38.373512268066406, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 16.964778900146484, 'logps/rejected': -604.681640625, 'logps/chosen': -498.332275390625, 'logits/rejected': -6.79748010635376, 'logits/chosen': -0.2648496627807617, 'epoch': 1.61}
{'loss': 0.215, 'grad_norm': 0.775532066822052, 'learning_rate': 0.0001974984430620683, 'rewards/chosen': -12.198744773864746, 'rewards/rejected': -22.930049896240234, 'rewards/accuracies': 0.9156249761581421, 'rewards/margins': 10.731303215026855, 'logps/rejected': -450.91204833984375, 'logps/chosen': -397.06329345703125, 'logits/rejected': -2.3662467002868652, 'logits/chosen': 3.517122745513916, 'epoch': 1.77}
{'loss': 0.1504, 'grad_norm': 1.2829731702804565, 'learning_rate': 0.00019664609037854062, 'rewards/chosen': -14.36082649230957, 'rewards/rejected': -25.89546775817871, 'rewards/accuracies': 0.9468749761581421, 'rewards/margins': 11.534643173217773, 'logps/rejected': -468.2084045410156, 'logps/chosen': -413.81658935546875, 'logits/rejected': -2.898200511932373, 'logits/chosen': 3.4020752906799316, 'epoch': 1.94}
{'loss': 0.1025, 'grad_norm': 2.8554906845092773, 'learning_rate': 0.00019567141224679816, 'rewards/chosen': -20.96718978881836, 'rewards/rejected': -34.011627197265625, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 13.04443359375, 'logps/rejected': -555.383544921875, 'logps/chosen': -482.266357421875, 'logits/rejected': -2.227933406829834, 'logits/chosen': 4.104561805725098, 'epoch': 2.1}
{'loss': 0.1811, 'grad_norm': 3.348223924636841, 'learning_rate': 0.00019457564232191023, 'rewards/chosen': -25.157970428466797, 'rewards/rejected': -39.907588958740234, 'rewards/accuracies': 0.940625011920929, 'rewards/margins': 14.74962043762207, 'logps/rejected': -620.7818603515625, 'logps/chosen': -529.3784790039062, 'logits/rejected': -2.3392765522003174, 'logits/chosen': 5.4162187576293945, 'epoch': 2.26}
{'loss': 0.1332, 'grad_norm': 4.488762855529785, 'learning_rate': 0.00019336016752544483, 'rewards/chosen': -17.377546310424805, 'rewards/rejected': -28.083728790283203, 'rewards/accuracies': 0.953125, 'rewards/margins': 10.706182479858398, 'logps/rejected': -503.7310485839844, 'logps/chosen': -454.4549255371094, 'logits/rejected': 2.5044353008270264, 'logits/chosen': 9.39804458618164, 'epoch': 2.42}
{'loss': 0.1079, 'grad_norm': 1.8985177278518677, 'learning_rate': 0.0001920265262900347, 'rewards/chosen': -20.613109588623047, 'rewards/rejected': -34.01455307006836, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 13.401443481445312, 'logps/rejected': -558.2500610351562, 'logps/chosen': -474.25439453125, 'logits/rejected': -1.8892767429351807, 'logits/chosen': 4.212152481079102, 'epoch': 2.58}
{'loss': 0.1363, 'grad_norm': 2.7987210750579834, 'learning_rate': 0.00019057640661217557, 'rewards/chosen': -18.4350643157959, 'rewards/rejected': -29.781265258789062, 'rewards/accuracies': 0.9281250238418579, 'rewards/margins': 11.346202850341797, 'logps/rejected': -529.4387817382812, 'logps/chosen': -476.50677490234375, 'logits/rejected': -1.255242109298706, 'logits/chosen': 3.9055511951446533, 'epoch': 2.74}
{'loss': 0.0967, 'grad_norm': 3.777238130569458, 'learning_rate': 0.00018901164391572017, 'rewards/chosen': -23.56622314453125, 'rewards/rejected': -41.880123138427734, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 18.313899993896484, 'logps/rejected': -621.3318481445312, 'logps/chosen': -498.46148681640625, 'logits/rejected': -0.5626330375671387, 'logits/chosen': 6.37471342086792, 'epoch': 2.9}
{'loss': 0.1128, 'grad_norm': 0.8147599101066589, 'learning_rate': 0.00018733421872877312, 'rewards/chosen': -25.481456756591797, 'rewards/rejected': -41.44816589355469, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 15.966710090637207, 'logps/rejected': -635.0697021484375, 'logps/chosen': -544.8007202148438, 'logits/rejected': 4.3202223777771, 'logits/chosen': 9.868974685668945, 'epoch': 3.06}
{'loss': 0.1176, 'grad_norm': 2.489867925643921, 'learning_rate': 0.00018554625417692636, 'rewards/chosen': -27.698894500732422, 'rewards/rejected': -42.40557098388672, 'rewards/accuracies': 0.940625011920929, 'rewards/margins': 14.706670761108398, 'logps/rejected': -638.3536376953125, 'logps/chosen': -546.35986328125, 'logits/rejected': -1.8749256134033203, 'logits/chosen': 3.7414422035217285, 'epoch': 3.23}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:19,  3.15it/s][A
  5%|▍         | 3/63 [00:01<00:32,  1.83it/s][A
  6%|▋         | 4/63 [00:02<00:39,  1.50it/s][A
  8%|▊         | 5/63 [00:03<00:44,  1.31it/s][A
 10%|▉         | 6/63 [00:04<00:49,  1.16it/s][A
 11%|█         | 7/63 [00:05<00:52,  1.07it/s][A
 13%|█▎        | 8/63 [00:06<00:50,  1.08it/s][A
 14%|█▍        | 9/63 [00:06<00:43,  1.23it/s][A
 16%|█▌        | 10/63 [00:07<00:46,  1.14it/s][A
 17%|█▋        | 11/63 [00:08<00:47,  1.10it/s][A
 19%|█▉        | 12/63 [00:09<00:46,  1.11it/s][A
 21%|██        | 13/63 [00:10<00:40,  1.22it/s][A
 22%|██▏       | 14/63 [00:11<00:43,  1.12it/s][A
 24%|██▍       | 15/63 [00:12<00:43,  1.09it/s][A
 25%|██▌       | 16/63 [00:13<00:43,  1.08it/s][A
 27%|██▋       | 17/63 [00:13<00:36,  1.25it/s][A
 29%|██▊       | 18/63 [00:14<00:30,  1.46it/s][A
 30%|███       | 19/63 [00:14<00:28,  1.53it/s][A
 32%|███▏      | 20/63 [00:15<00:31,  1.35it/s][A
 33%|███▎      | 21/63 [00:16<00:31,  1.32it/s][A
 35%|███▍      | 22/63 [00:17<00:34,  1.18it/s][A
 37%|███▋      | 23/63 [00:18<00:36,  1.09it/s][A
 38%|███▊      | 24/63 [00:19<00:36,  1.06it/s][A
 40%|███▉      | 25/63 [00:20<00:36,  1.04it/s][A
 41%|████▏     | 26/63 [00:21<00:36,  1.01it/s][A
 43%|████▎     | 27/63 [00:22<00:36,  1.02s/it][A
 44%|████▍     | 28/63 [00:24<00:35,  1.03s/it][A
 46%|████▌     | 29/63 [00:24<00:29,  1.16it/s][A
 48%|████▊     | 30/63 [00:24<00:24,  1.33it/s][A
 49%|████▉     | 31/63 [00:25<00:22,  1.45it/s][A
 51%|█████     | 32/63 [00:26<00:20,  1.49it/s][A
 52%|█████▏    | 33/63 [00:26<00:19,  1.55it/s][A
 54%|█████▍    | 34/63 [00:27<00:21,  1.35it/s][A
 56%|█████▌    | 35/63 [00:28<00:21,  1.30it/s][A
 57%|█████▋    | 36/63 [00:29<00:18,  1.42it/s][A
 59%|█████▊    | 37/63 [00:29<00:16,  1.55it/s][A
 60%|██████    | 38/63 [00:30<00:17,  1.46it/s][A
 62%|██████▏   | 39/63 [00:31<00:19,  1.25it/s][A
 63%|██████▎   | 40/63 [00:32<00:20,  1.13it/s][A
 65%|██████▌   | 41/63 [00:33<00:18,  1.18it/s][A
 67%|██████▋   | 42/63 [00:34<00:17,  1.20it/s][A
 68%|██████▊   | 43/63 [00:34<00:15,  1.27it/s][A
 70%|██████▉   | 44/63 [00:35<00:13,  1.41it/s][A
 71%|███████▏  | 45/63 [00:35<00:12,  1.50it/s][A
 73%|███████▎  | 46/63 [00:36<00:10,  1.58it/s][A
 75%|███████▍  | 47/63 [00:36<00:09,  1.65it/s][A
 76%|███████▌  | 48/63 [00:37<00:09,  1.54it/s][A
 78%|███████▊  | 49/63 [00:38<00:08,  1.60it/s][A
 79%|███████▉  | 50/63 [00:39<00:09,  1.36it/s][A
 81%|████████  | 51/63 [00:40<00:09,  1.33it/s][A
 83%|████████▎ | 52/63 [00:41<00:09,  1.18it/s][A
 84%|████████▍ | 53/63 [00:41<00:07,  1.38it/s][A
 86%|████████▌ | 54/63 [00:42<00:06,  1.40it/s][A
 87%|████████▋ | 55/63 [00:42<00:05,  1.42it/s][A
 89%|████████▉ | 56/63 [00:43<00:04,  1.49it/s][A
 90%|█████████ | 57/63 [00:44<00:03,  1.55it/s][A
 92%|█████████▏| 58/63 [00:44<00:03,  1.41it/s][A
 94%|█████████▎| 59/63 [00:45<00:02,  1.44it/s][A
 95%|█████████▌| 60/63 [00:46<00:01,  1.61it/s][A
 97%|█████████▋| 61/63 [00:46<00:01,  1.59it/s][A
 98%|█████████▊| 62/63 [00:47<00:00,  1.64it/s][A
100%|██████████| 63/63 [00:47<00:00,  1.84it/s][A                                                     
                                               [A 22%|██▏       | 200/930 [1:02:13<3:30:59, 17.34s/it]
100%|██████████| 63/63 [00:47<00:00,  1.84it/s][A
                                               [A 22%|██▏       | 201/930 [1:02:42<7:10:29, 35.43s/it] 22%|██▏       | 202/930 [1:02:58<6:00:35, 29.72s/it] 22%|██▏       | 203/930 [1:03:17<5:19:06, 26.34s/it] 22%|██▏       | 204/930 [1:03:34<4:46:51, 23.71s/it] 22%|██▏       | 205/930 [1:03:53<4:28:28, 22.22s/it] 22%|██▏       | 206/930 [1:04:10<4:10:02, 20.72s/it] 22%|██▏       | 207/930 [1:04:29<4:03:37, 20.22s/it] 22%|██▏       | 208/930 [1:04:48<3:56:05, 19.62s/it] 22%|██▏       | 209/930 [1:05:07<3:53:05, 19.40s/it] 23%|██▎       | 210/930 [1:05:26<3:51:38, 19.30s/it]                                                      23%|██▎       | 210/930 [1:05:26<3:51:38, 19.30s/it] 23%|██▎       | 211/930 [1:05:43<3:44:42, 18.75s/it] 23%|██▎       | 212/930 [1:06:02<3:45:06, 18.81s/it] 23%|██▎       | 213/930 [1:06:20<3:43:05, 18.67s/it] 23%|██▎       | 214/930 [1:06:40<3:47:12, 19.04s/it] 23%|██▎       | 215/930 [1:06:58<3:40:57, 18.54s/it] 23%|██▎       | 216/930 [1:07:18<3:45:55, 18.99s/it] 23%|██▎       | 217/930 [1:07:38<3:49:58, 19.35s/it] 23%|██▎       | 218/930 [1:07:57<3:48:25, 19.25s/it] 24%|██▎       | 219/930 [1:08:14<3:40:46, 18.63s/it] 24%|██▎       | 220/930 [1:08:32<3:37:12, 18.36s/it]                                                      24%|██▎       | 220/930 [1:08:32<3:37:12, 18.36s/it] 24%|██▍       | 221/930 [1:08:50<3:37:49, 18.43s/it] 24%|██▍       | 222/930 [1:09:08<3:34:27, 18.17s/it] 24%|██▍       | 223/930 [1:09:26<3:32:48, 18.06s/it] 24%|██▍       | 224/930 [1:09:45<3:37:07, 18.45s/it] 24%|██▍       | 225/930 [1:10:04<3:37:20, 18.50s/it] 24%|██▍       | 226/930 [1:10:23<3:40:21, 18.78s/it] 24%|██▍       | 227/930 [1:10:43<3:42:19, 18.97s/it] 25%|██▍       | 228/930 [1:11:00<3:37:54, 18.62s/it] 25%|██▍       | 229/930 [1:11:18<3:33:20, 18.26s/it] 25%|██▍       | 230/930 [1:11:35<3:30:09, 18.01s/it]                                                      25%|██▍       | 230/930 [1:11:35<3:30:09, 18.01s/it] 25%|██▍       | 231/930 [1:11:55<3:36:53, 18.62s/it] 25%|██▍       | 232/930 [1:12:13<3:33:54, 18.39s/it] 25%|██▌       | 233/930 [1:12:31<3:32:04, 18.26s/it] 25%|██▌       | 234/930 [1:12:50<3:34:49, 18.52s/it] 25%|██▌       | 235/930 [1:13:08<3:33:02, 18.39s/it] 25%|██▌       | 236/930 [1:13:26<3:31:08, 18.25s/it] 25%|██▌       | 237/930 [1:13:44<3:28:40, 18.07s/it] 26%|██▌       | 238/930 [1:14:03<3:33:13, 18.49s/it] 26%|██▌       | 239/930 [1:14:23<3:35:15, 18.69s/it] 26%|██▌       | 240/930 [1:14:40<3:29:46, 18.24s/it]                                                      26%|██▌       | 240/930 [1:14:40<3:29:46, 18.24s/it] 26%|██▌       | 241/930 [1:14:58<3:31:23, 18.41s/it] 26%|██▌       | 242/930 [1:15:18<3:34:32, 18.71s/it] 26%|██▌       | 243/930 [1:15:35<3:29:15, 18.28s/it] 26%|██▌       | 244/930 [1:15:51<3:21:08, 17.59s/it] 26%|██▋       | 245/930 [1:16:10<3:25:45, 18.02s/it] 26%|██▋       | 246/930 [1:16:28<3:24:02, 17.90s/it] 27%|██▋       | 247/930 [1:16:47<3:26:49, 18.17s/it] 27%|██▋       | 248/930 [1:17:05<3:28:27, 18.34s/it] 27%|██▋       | 249/930 [1:17:25<3:32:07, 18.69s/it] 27%|██▋       | 250/930 [1:17:42<3:26:49, 18.25s/it]                                                      27%|██▋       | 250/930 [1:17:42<3:26:49, 18.25s/it] 27%|██▋       | 251/930 [1:18:02<3:30:56, 18.64s/it] 27%|██▋       | 252/930 [1:18:21<3:33:04, 18.86s/it] 27%|██▋       | 253/930 [1:18:40<3:32:17, 18.81s/it] 27%|██▋       | 254/930 [1:18:59<3:32:26, 18.86s/it] 27%|██▋       | 255/930 [1:19:17<3:29:45, 18.64s/it] 28%|██▊       | 256/930 [1:19:35<3:28:57, 18.60s/it] 28%|██▊       | 257/930 [1:19:55<3:31:26, 18.85s/it] 28%|██▊       | 258/930 [1:20:15<3:34:42, 19.17s/it] 28%|██▊       | 259/930 [1:20:34<3:34:30, 19.18s/it] 28%|██▊       | 260/930 [1:20:52<3:32:21, 19.02s/it]                                                      28%|██▊       | 260/930 [1:20:53<3:32:21, 19.02s/it] 28%|██▊       | 261/930 [1:21:11<3:30:49, 18.91s/it] 28%|██▊       | 262/930 [1:21:31<3:33:07, 19.14s/it] 28%|██▊       | 263/930 [1:21:47<3:23:55, 18.34s/it] 28%|██▊       | 264/930 [1:22:05<3:20:16, 18.04s/it] 28%|██▊       | 265/930 [1:22:23<3:21:11, 18.15s/it] 29%|██▊       | 266/930 [1:22:42<3:24:42, 18.50s/it] 29%|██▊       | 267/930 [1:23:00<3:23:00, 18.37s/it] 29%|██▉       | 268/930 [1:23:18<3:21:26, 18.26s/it] 29%|██▉       | 269/930 [1:23:37<3:20:51, 18.23s/it] 29%|██▉       | 270/930 [1:23:53<3:14:22, 17.67s/it]                                                      29%|██▉       | 270/930 [1:23:53<3:14:22, 17.67s/it] 29%|██▉       | 271/930 [1:24:10<3:11:00, 17.39s/it] 29%|██▉       | 272/930 [1:24:28<3:14:25, 17.73s/it] 29%|██▉       | 273/930 [1:24:44<3:09:06, 17.27s/it] 29%|██▉       | 274/930 [1:25:02<3:08:21, 17.23s/it] 30%|██▉       | 275/930 [1:25:20<3:11:27, 17.54s/it] 30%|██▉       | 276/930 [1:25:37<3:09:56, 17.43s/it] 30%|██▉       | 277/930 [1:25:57<3:16:32, 18.06s/it] 30%|██▉       | 278/930 [1:26:15<3:17:19, 18.16s/it] 30%|███       | 279/930 [1:26:34<3:20:38, 18.49s/it] 30%|███       | 280/930 [1:26:49<3:09:54, 17.53s/it]                                                      30%|███       | 280/930 [1:26:49<3:09:54, 17.53s/it] 30%|███       | 281/930 [1:27:10<3:18:10, 18.32s/it] 30%|███       | 282/930 [1:27:27<3:14:54, 18.05s/it] 30%|███       | 283/930 [1:27:43<3:08:53, 17.52s/it] 31%|███       | 284/930 [1:28:03<3:17:08, 18.31s/it] 31%|███       | 285/930 [1:28:22<3:17:26, 18.37s/it] 31%|███       | 286/930 [1:28:39<3:11:53, 17.88s/it] 31%|███       | 287/930 [1:28:58<3:17:39, 18.44s/it] 31%|███       | 288/930 [1:29:19<3:22:50, 18.96s/it] 31%|███       | 289/930 [1:29:37<3:21:45, 18.88s/it] 31%|███       | 290/930 [1:29:55<3:16:39, 18.44s/it]                                                      31%|███       | 290/930 [1:29:55<3:16:39, 18.44s/it] 31%|███▏      | 291/930 [1:30:12<3:14:08, 18.23s/it] 31%|███▏      | 292/930 [1:30:31<3:13:22, 18.19s/it] 32%|███▏      | 293/930 [1:30:49<3:12:19, 18.11s/it] 32%|███▏      | 294/930 [1:31:08<3:17:38, 18.64s/it] 32%|███▏      | 295/930 [1:31:25<3:10:50, 18.03s/it] 32%|███▏      | 296/930 [1:31:44<3:13:04, 18.27s/it] 32%|███▏      | 297/930 [1:32:02<3:11:27, 18.15s/it] 32%|███▏      | 298/930 [1:32:20<3:10:44, 18.11s/it] 32%|███▏      | 299/930 [1:32:37<3:08:31, 17.93s/it] 32%|███▏      | 300/930 [1:32:57<3:14:05, 18.48s/it]                                                      32%|███▏      | 300/930 [1:32:57<3:14:05, 18.48s/it] 32%|███▏      | 301/930 [1:33:13<3:06:53, 17.83s/it] 32%|███▏      | 302/930 [1:33:31<3:07:18, 17.90s/it] 33%|███▎      | 303/930 [1:33:52<3:14:07, 18.58s/it] 33%|███▎      | 304/930 [1:34:11<3:17:11, 18.90s/it] 33%|███▎      | 305/930 [1:34:30<3:17:41, 18.98s/it] 33%|███▎      | 306/930 [1:34:49<3:16:16, 18.87s/it] 33%|███▎      | 307/930 [1:35:07<3:14:17, 18.71s/it] 33%|███▎      | 308/930 [1:35:26<3:13:15, 18.64s/it] 33%|███▎      | 309/930 [1:35:46<3:16:22, 18.97s/it] 33%|███▎      | 310/930 [1:36:04<3:13:26, 18.72s/it]                                                      33%|███▎      | 310/930 [1:36:04<3:13:26, 18.72s/it] 33%|███▎      | 311/930 [1:36:23<3:15:56, 18.99s/it] 34%|███▎      | 312/930 [1:36:42<3:15:41, 19.00s/it] 34%|███▎      | 313/930 [1:37:01<3:13:25, 18.81s/it] 34%|███▍      | 314/930 [1:37:20<3:14:16, 18.92s/it] 34%|███▍      | 315/930 [1:37:37<3:08:32, 18.39s/it] 34%|███▍      | 316/930 [1:37:56<3:09:07, 18.48s/it] 34%|███▍      | 317/930 [1:38:15<3:11:01, 18.70s/it] 34%|███▍      | 318/930 [1:38:33<3:08:02, 18.44s/it] 34%|███▍      | 319/930 [1:38:51<3:07:31, 18.42s/it] 34%|███▍      | 320/930 [1:39:09<3:06:12, 18.32s/it]                                                      34%|███▍      | 320/930 [1:39:09<3:06:12, 18.32s/it] 35%|███▍      | 321/930 [1:39:28<3:07:32, 18.48s/it] 35%|███▍      | 322/930 [1:39:46<3:05:24, 18.30s/it] 35%|███▍      | 323/930 [1:40:06<3:09:30, 18.73s/it] 35%|███▍      | 324/930 [1:40:23<3:05:38, 18.38s/it] 35%|███▍      | 325/930 [1:40:41<3:03:00, 18.15s/it] 35%|███▌      | 326/930 [1:40:58<3:00:56, 17.97s/it] 35%|███▌      | 327/930 [1:41:18<3:05:15, 18.43s/it] 35%|███▌      | 328/930 [1:41:35<3:00:51, 18.03s/it] 35%|███▌      | 329/930 [1:41:55<3:07:00, 18.67s/it] 35%|███▌      | 330/930 [1:42:12<3:02:43, 18.27s/it]                                                      35%|███▌      | 330/930 [1:42:12<3:02:43, 18.27s/it] 36%|███▌      | 331/930 [1:42:30<3:00:24, 18.07s/it] 36%|███▌      | 332/930 [1:42:49<3:02:31, 18.31s/it] 36%|███▌      | 333/930 [1:43:08<3:04:02, 18.50s/it] 36%|███▌      | 334/930 [1:43:25<2:59:37, 18.08s/it] 36%|███▌      | 335/930 [1:43:42<2:56:08, 17.76s/it] 36%|███▌      | 336/930 [1:43:58<2:51:09, 17.29s/it] 36%|███▌      | 337/930 [1:44:17<2:56:19, 17.84s/it] 36%|███▋      | 338/930 [1:44:36<2:59:04, 18.15s/it] 36%|███▋      | 339/930 [1:44:55<2:59:27, 18.22s/it] 37%|███▋      | 340/930 [1:45:13<3:00:19, 18.34s/it]                                                      37%|███▋      | 340/930 [1:45:13<3:00:19, 18.34s/it] 37%|███▋      | 341/930 [1:45:32<3:01:18, 18.47s/it] 37%|███▋      | 342/930 [1:45:52<3:05:30, 18.93s/it] 37%|███▋      | 343/930 [1:46:10<3:02:14, 18.63s/it] 37%|███▋      | 344/930 [1:46:30<3:06:23, 19.08s/it] 37%|███▋      | 345/930 [1:46:49<3:04:37, 18.94s/it] 37%|███▋      | 346/930 [1:47:09<3:07:50, 19.30s/it] 37%|███▋      | 347/930 [1:47:28<3:08:24, 19.39s/it] 37%|███▋      | 348/930 [1:47:46<3:03:15, 18.89s/it] 38%|███▊      | 349/930 [1:48:05<3:02:45, 18.87s/it] 38%|███▊      | 350/930 [1:48:23<2:59:58, 18.62s/it]                                                      38%|███▊      | 350/930 [1:48:23<2:59:58, 18.62s/it] 38%|███▊      | 351/930 [1:48:42<3:00:25, 18.70s/it] 38%|███▊      | 352/930 [1:48:59<2:54:54, 18.16s/it] 38%|███▊      | 353/930 [1:49:16<2:50:41, 17.75s/it] 38%|███▊      | 354/930 [1:49:35<2:55:50, 18.32s/it] 38%|███▊      | 355/930 [1:49:53<2:54:41, 18.23s/it] 38%|███▊      | 356/930 [1:50:11<2:52:19, 18.01s/it] 38%|███▊      | 357/930 [1:50:31<2:57:45, 18.61s/it] 38%|███▊      | 358/930 [1:50:50<2:57:58, 18.67s/it] 39%|███▊      | 359/930 [1:51:10<3:01:26, 19.07s/it] 39%|███▊      | 360/930 [1:51:27<2:55:57, 18.52s/it]                                                      39%|███▊      | 360/930 [1:51:27<2:55:57, 18.52s/it] 39%|███▉      | 361/930 [1:51:46<2:56:25, 18.60s/it] 39%|███▉      | 362/930 [1:52:04<2:55:05, 18.50s/it] 39%|███▉      | 363/930 [1:52:21<2:52:19, 18.24s/it] 39%|███▉      | 364/930 [1:52:40<2:51:32, 18.18s/it] 39%|███▉      | 365/930 [1:52:59<2:53:33, 18.43s/it] 39%|███▉      | 366/930 [1:53:18<2:55:21, 18.66s/it] 39%|███▉      | 367/930 [1:53:37<2:55:52, 18.74s/it] 40%|███▉      | 368/930 [1:53:56<2:58:41, 19.08s/it] 40%|███▉      | 369/930 [1:54:15<2:57:23, 18.97s/it] 40%|███▉      | 370/930 [1:54:33<2:54:45, 18.72s/it]                                                      40%|███▉      | 370/930 [1:54:33<2:54:45, 18.72s/it] 40%|███▉      | 371/930 [1:54:53<2:56:50, 18.98s/it] 40%|████      | 372/930 [1:55:12<2:56:26, 18.97s/it] 40%|████      | 373/930 [1:55:30<2:52:49, 18.62s/it] 40%|████      | 374/930 [1:55:48<2:50:45, 18.43s/it] 40%|████      | 375/930 [1:56:07<2:53:21, 18.74s/it] 40%|████      | 376/930 [1:56:26<2:53:44, 18.82s/it] 41%|████      | 377/930 [1:56:45<2:52:21, 18.70s/it] 41%|████      | 378/930 [1:57:04<2:53:52, 18.90s/it] 41%|████      | 379/930 [1:57:21<2:47:57, 18.29s/it] 41%|████      | 380/930 [1:57:39<2:47:10, 18.24s/it]                                                      41%|████      | 380/930 [1:57:39<2:47:10, 18.24s/it] 41%|████      | 381/930 [1:57:57<2:46:04, 18.15s/it] 41%|████      | 382/930 [1:58:15<2:46:42, 18.25s/it] 41%|████      | 383/930 [1:58:32<2:42:18, 17.80s/it] 41%|████▏     | 384/930 [1:58:51<2:45:46, 18.22s/it] 41%|████▏     | 385/930 [1:59:10<2:46:19, 18.31s/it] 42%|████▏     | 386/930 [1:59:26<2:41:14, 17.78s/it] 42%|████▏     | 387/930 [1:59:44<2:40:52, 17.78s/it] 42%|████▏     | 388/930 [2:00:02<2:41:41, 17.90s/it] 42%|████▏     | 389/930 [2:00:22<2:46:29, 18.46s/it] 42%|████▏     | 390/930 [2:00:39<2:42:38, 18.07s/it]                                                      42%|████▏     | 390/930 [2:00:39<2:42:38, 18.07s/it] 42%|████▏     | 391/930 [2:00:55<2:35:31, 17.31s/it] 42%|████▏     | 392/930 [2:01:12<2:36:07, 17.41s/it] 42%|████▏     | 393/930 [2:01:31<2:38:04, 17.66s/it] 42%|████▏     | 394/930 [2:01:48<2:38:08, 17.70s/it] 42%|████▏     | 395/930 [2:02:07<2:40:16, 17.98s/it] 43%|████▎     | 396/930 [2:02:25<2:38:32, 17.81s/it] 43%|████▎     | 397/930 [2:02:44<2:41:38, 18.20s/it] 43%|████▎     | 398/930 [2:03:02<2:40:38, 18.12s/it] 43%|████▎     | 399/930 [2:03:19<2:38:45, 17.94s/it] 43%|████▎     | 400/930 [2:03:38<2:40:05, 18.12s/it]                                                      43%|████▎     | 400/930 [2:03:38<2:40:05, 18.12s/it]{'eval_loss': 0.36883386969566345, 'eval_runtime': 48.7387, 'eval_samples_per_second': 5.109, 'eval_steps_per_second': 1.293, 'eval_rewards/chosen': -34.142635345458984, 'eval_rewards/rejected': -49.05280303955078, 'eval_rewards/accuracies': 0.8095238208770752, 'eval_rewards/margins': 14.910170555114746, 'eval_logps/rejected': -735.1920166015625, 'eval_logps/chosen': -683.4979858398438, 'eval_logits/rejected': -12.603575706481934, 'eval_logits/chosen': -5.809218406677246, 'epoch': 3.23}
{'loss': 0.1308, 'grad_norm': 0.6715767979621887, 'learning_rate': 0.00018365001329600814, 'rewards/chosen': -26.715808868408203, 'rewards/rejected': -42.806671142578125, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 16.090862274169922, 'logps/rejected': -642.2938232421875, 'logps/chosen': -535.839111328125, 'logits/rejected': 0.4711238741874695, 'logits/chosen': 7.148562431335449, 'epoch': 3.39}
{'loss': 0.1289, 'grad_norm': 0.523912250995636, 'learning_rate': 0.0001816478961677474, 'rewards/chosen': -22.70255470275879, 'rewards/rejected': -36.03379440307617, 'rewards/accuracies': 0.953125, 'rewards/margins': 13.33123779296875, 'logps/rejected': -584.26025390625, 'logps/chosen': -511.8229064941406, 'logits/rejected': 4.58547306060791, 'logits/chosen': 10.248021125793457, 'epoch': 3.55}
{'loss': 0.0885, 'grad_norm': 0.4370442032814026, 'learning_rate': 0.00017954243688197782, 'rewards/chosen': -25.198604583740234, 'rewards/rejected': -50.04288101196289, 'rewards/accuracies': 0.96875, 'rewards/margins': 24.844276428222656, 'logps/rejected': -709.5578002929688, 'logps/chosen': -525.4426879882812, 'logits/rejected': 0.9940069913864136, 'logits/chosen': 9.090721130371094, 'epoch': 3.71}
{'loss': 0.0751, 'grad_norm': 2.288897752761841, 'learning_rate': 0.00017733630032922744, 'rewards/chosen': -28.435749053955078, 'rewards/rejected': -50.48784637451172, 'rewards/accuracies': 0.96875, 'rewards/margins': 22.05209732055664, 'logps/rejected': -730.8965454101562, 'logps/chosen': -568.4069213867188, 'logits/rejected': 0.3194863200187683, 'logits/chosen': 8.293538093566895, 'epoch': 3.87}
{'loss': 0.0717, 'grad_norm': 2.5425281524658203, 'learning_rate': 0.00017503227882775338, 'rewards/chosen': -30.58099365234375, 'rewards/rejected': -52.24790573120117, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 21.666912078857422, 'logps/rejected': -738.7552490234375, 'logps/chosen': -580.2623291015625, 'logits/rejected': 0.2741222381591797, 'logits/chosen': 7.335179328918457, 'epoch': 4.03}
{'loss': 0.0911, 'grad_norm': 2.9740633964538574, 'learning_rate': 0.0001726332885892902, 'rewards/chosen': -36.53565216064453, 'rewards/rejected': -57.7525634765625, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 21.216907501220703, 'logps/rejected': -795.0845947265625, 'logps/chosen': -641.5724487304688, 'logits/rejected': 1.8937606811523438, 'logits/chosen': 8.311223030090332, 'epoch': 4.19}
{'loss': 0.1147, 'grad_norm': 2.632354736328125, 'learning_rate': 0.00017014236602798608, 'rewards/chosen': -31.823017120361328, 'rewards/rejected': -49.128849029541016, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 17.305835723876953, 'logps/rejected': -710.8777465820312, 'logps/chosen': -592.2747802734375, 'logits/rejected': 3.187243938446045, 'logits/chosen': 9.608072280883789, 'epoch': 4.35}
{'loss': 0.0545, 'grad_norm': 4.331246376037598, 'learning_rate': 0.00016756266391719767, 'rewards/chosen': -28.1912899017334, 'rewards/rejected': -49.11233139038086, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 20.921039581298828, 'logps/rejected': -717.9124755859375, 'logps/chosen': -570.46875, 'logits/rejected': 0.774960994720459, 'logits/chosen': 7.411385536193848, 'epoch': 4.52}
{'loss': 0.068, 'grad_norm': 1.0896425247192383, 'learning_rate': 0.00016489744739900917, 'rewards/chosen': -36.565406799316406, 'rewards/rejected': -59.193748474121094, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 22.628337860107422, 'logps/rejected': -800.063720703125, 'logps/chosen': -631.3672485351562, 'logits/rejected': -0.28203317523002625, 'logits/chosen': 5.753451347351074, 'epoch': 4.68}
{'loss': 0.1354, 'grad_norm': 2.2685699462890625, 'learning_rate': 0.00016215008985152516, 'rewards/chosen': -28.642715454101562, 'rewards/rejected': -44.334754943847656, 'rewards/accuracies': 0.934374988079071, 'rewards/margins': 15.692036628723145, 'logps/rejected': -664.679443359375, 'logps/chosen': -568.23779296875, 'logits/rejected': 3.4171948432922363, 'logits/chosen': 9.545692443847656, 'epoch': 4.84}
{'loss': 0.0694, 'grad_norm': 3.018674612045288, 'learning_rate': 0.00015932406861916883, 'rewards/chosen': -21.722370147705078, 'rewards/rejected': -41.77997589111328, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 20.057601928710938, 'logps/rejected': -631.5977783203125, 'logps/chosen': -490.09344482421875, 'logits/rejected': 6.393529891967773, 'logits/chosen': 13.895490646362305, 'epoch': 5.0}
{'loss': 0.1258, 'grad_norm': 1.346642255783081, 'learning_rate': 0.00015642296061138948, 'rewards/chosen': -27.966800689697266, 'rewards/rejected': -61.691261291503906, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 33.724464416503906, 'logps/rejected': -833.7647705078125, 'logps/chosen': -560.944580078125, 'logits/rejected': 2.130128860473633, 'logits/chosen': 11.079130172729492, 'epoch': 5.16}
{'loss': 0.0856, 'grad_norm': 1.121934175491333, 'learning_rate': 0.00015345043777535003, 'rewards/chosen': -23.746326446533203, 'rewards/rejected': -42.83953857421875, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 19.093210220336914, 'logps/rejected': -636.2508544921875, 'logps/chosen': -510.66546630859375, 'logits/rejected': 5.9854841232299805, 'logits/chosen': 12.88911247253418, 'epoch': 5.32}
{'loss': 0.0778, 'grad_norm': 5.144729137420654, 'learning_rate': 0.00015041026244832476, 'rewards/chosen': -31.9663143157959, 'rewards/rejected': -49.842201232910156, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 17.87588882446289, 'logps/rejected': -721.792724609375, 'logps/chosen': -595.3811645507812, 'logits/rejected': 6.5017409324646, 'logits/chosen': 12.133861541748047, 'epoch': 5.48}
{'loss': 0.0709, 'grad_norm': 7.025764465332031, 'learning_rate': 0.00014730628259568995, 'rewards/chosen': -47.019962310791016, 'rewards/rejected': -70.80474090576172, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 23.78477668762207, 'logps/rejected': -930.4825439453125, 'logps/chosen': -755.2164306640625, 'logits/rejected': 1.5806918144226074, 'logits/chosen': 7.701849937438965, 'epoch': 5.65}
{'loss': 0.1155, 'grad_norm': 3.5040555000305176, 'learning_rate': 0.00014414242694053454, 'rewards/chosen': -40.05588150024414, 'rewards/rejected': -63.31599807739258, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 23.260120391845703, 'logps/rejected': -847.0709228515625, 'logps/chosen': -674.4174194335938, 'logits/rejected': 2.0280261039733887, 'logits/chosen': 8.843465805053711, 'epoch': 5.81}
{'loss': 0.0756, 'grad_norm': 1.7772666215896606, 'learning_rate': 0.0001409226999910553, 'rewards/chosen': -30.64255714416504, 'rewards/rejected': -47.68833541870117, 'rewards/accuracies': 0.96875, 'rewards/margins': 17.0457763671875, 'logps/rejected': -693.4698486328125, 'logps/chosen': -572.5724487304688, 'logits/rejected': 3.7790732383728027, 'logits/chosen': 10.110774993896484, 'epoch': 5.97}
{'loss': 0.0668, 'grad_norm': 3.115370512008667, 'learning_rate': 0.00013765117697203032, 'rewards/chosen': -27.5159969329834, 'rewards/rejected': -45.64826202392578, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 18.132265090942383, 'logps/rejected': -683.8941650390625, 'logps/chosen': -563.1012573242188, 'logits/rejected': 5.821959018707275, 'logits/chosen': 12.659807205200195, 'epoch': 6.13}
{'loss': 0.0442, 'grad_norm': 0.2242487668991089, 'learning_rate': 0.00013433199866678657, 'rewards/chosen': -29.8831844329834, 'rewards/rejected': -50.739479064941406, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 20.856290817260742, 'logps/rejected': -723.2802734375, 'logps/chosen': -569.61865234375, 'logits/rejected': 3.6439671516418457, 'logits/chosen': 10.459980964660645, 'epoch': 6.29}
{'loss': 0.059, 'grad_norm': 1.494703769683838, 'learning_rate': 0.00013096936617618905, 'rewards/chosen': -29.105432510375977, 'rewards/rejected': -47.33905792236328, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 18.233623504638672, 'logps/rejected': -688.7129516601562, 'logps/chosen': -566.4498291015625, 'logits/rejected': 3.4104599952697754, 'logits/chosen': 10.299880981445312, 'epoch': 6.45}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:19,  3.15it/s][A
  5%|▍         | 3/63 [00:01<00:32,  1.83it/s][A
  6%|▋         | 4/63 [00:02<00:39,  1.50it/s][A
  8%|▊         | 5/63 [00:03<00:44,  1.31it/s][A
 10%|▉         | 6/63 [00:04<00:49,  1.16it/s][A
 11%|█         | 7/63 [00:05<00:52,  1.08it/s][A
 13%|█▎        | 8/63 [00:06<00:50,  1.08it/s][A
 14%|█▍        | 9/63 [00:06<00:43,  1.23it/s][A
 16%|█▌        | 10/63 [00:07<00:46,  1.14it/s][A
 17%|█▋        | 11/63 [00:08<00:47,  1.10it/s][A
 19%|█▉        | 12/63 [00:09<00:46,  1.11it/s][A
 21%|██        | 13/63 [00:10<00:40,  1.22it/s][A
 22%|██▏       | 14/63 [00:11<00:43,  1.12it/s][A
 24%|██▍       | 15/63 [00:12<00:43,  1.09it/s][A
 25%|██▌       | 16/63 [00:13<00:43,  1.08it/s][A
 27%|██▋       | 17/63 [00:13<00:36,  1.25it/s][A
 29%|██▊       | 18/63 [00:14<00:30,  1.46it/s][A
 30%|███       | 19/63 [00:14<00:28,  1.53it/s][A
 32%|███▏      | 20/63 [00:15<00:31,  1.35it/s][A
 33%|███▎      | 21/63 [00:16<00:31,  1.32it/s][A
 35%|███▍      | 22/63 [00:17<00:34,  1.18it/s][A
 37%|███▋      | 23/63 [00:18<00:36,  1.09it/s][A
 38%|███▊      | 24/63 [00:19<00:36,  1.06it/s][A
 40%|███▉      | 25/63 [00:20<00:36,  1.04it/s][A
 41%|████▏     | 26/63 [00:21<00:36,  1.01it/s][A
 43%|████▎     | 27/63 [00:22<00:36,  1.02s/it][A
 44%|████▍     | 28/63 [00:24<00:35,  1.03s/it][A
 46%|████▌     | 29/63 [00:24<00:29,  1.16it/s][A
 48%|████▊     | 30/63 [00:24<00:24,  1.33it/s][A
 49%|████▉     | 31/63 [00:25<00:22,  1.44it/s][A
 51%|█████     | 32/63 [00:26<00:20,  1.49it/s][A
 52%|█████▏    | 33/63 [00:26<00:19,  1.55it/s][A
 54%|█████▍    | 34/63 [00:27<00:21,  1.35it/s][A
 56%|█████▌    | 35/63 [00:28<00:21,  1.30it/s][A
 57%|█████▋    | 36/63 [00:29<00:18,  1.42it/s][A
 59%|█████▊    | 37/63 [00:29<00:16,  1.55it/s][A
 60%|██████    | 38/63 [00:30<00:17,  1.46it/s][A
 62%|██████▏   | 39/63 [00:31<00:19,  1.25it/s][A
 63%|██████▎   | 40/63 [00:32<00:20,  1.13it/s][A
 65%|██████▌   | 41/63 [00:33<00:18,  1.18it/s][A
 67%|██████▋   | 42/63 [00:34<00:17,  1.20it/s][A
 68%|██████▊   | 43/63 [00:34<00:15,  1.27it/s][A
 70%|██████▉   | 44/63 [00:35<00:13,  1.41it/s][A
 71%|███████▏  | 45/63 [00:35<00:12,  1.50it/s][A
 73%|███████▎  | 46/63 [00:36<00:10,  1.58it/s][A
 75%|███████▍  | 47/63 [00:36<00:09,  1.64it/s][A
 76%|███████▌  | 48/63 [00:37<00:09,  1.54it/s][A
 78%|███████▊  | 49/63 [00:38<00:08,  1.70it/s][A
 79%|███████▉  | 50/63 [00:39<00:09,  1.41it/s][A
 81%|████████  | 51/63 [00:39<00:08,  1.37it/s][A
 83%|████████▎ | 52/63 [00:41<00:09,  1.20it/s][A
 84%|████████▍ | 53/63 [00:41<00:07,  1.33it/s][A
 86%|████████▌ | 54/63 [00:42<00:06,  1.36it/s][A
 87%|████████▋ | 55/63 [00:42<00:05,  1.39it/s][A
 89%|████████▉ | 56/63 [00:43<00:04,  1.47it/s][A
 90%|█████████ | 57/63 [00:44<00:03,  1.53it/s][A
 92%|█████████▏| 58/63 [00:44<00:03,  1.40it/s][A
 94%|█████████▎| 59/63 [00:45<00:02,  1.43it/s][A
 95%|█████████▌| 60/63 [00:46<00:01,  1.61it/s][A
 97%|█████████▋| 61/63 [00:46<00:01,  1.59it/s][A
 98%|█████████▊| 62/63 [00:47<00:00,  1.64it/s][A
100%|██████████| 63/63 [00:47<00:00,  1.82it/s][A                                                     
                                               [A 43%|████▎     | 400/930 [2:04:26<2:40:05, 18.12s/it]
100%|██████████| 63/63 [00:47<00:00,  1.82it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--google--flan-t5-large--hf/ - will assume that the vocabulary was not modified.
  warnings.warn(
 43%|████▎     | 401/930 [2:04:51<5:05:30, 34.65s/it] 43%|████▎     | 402/930 [2:05:10<4:24:09, 30.02s/it] 43%|████▎     | 403/930 [2:05:29<3:53:37, 26.60s/it] 43%|████▎     | 404/930 [2:05:47<3:30:59, 24.07s/it] 44%|████▎     | 405/930 [2:06:06<3:18:07, 22.64s/it] 44%|████▎     | 406/930 [2:06:26<3:11:11, 21.89s/it] 44%|████▍     | 407/930 [2:06:45<3:03:41, 21.07s/it] 44%|████▍     | 408/930 [2:07:04<2:56:37, 20.30s/it] 44%|████▍     | 409/930 [2:07:24<2:54:47, 20.13s/it] 44%|████▍     | 410/930 [2:07:42<2:49:08, 19.52s/it]                                                      44%|████▍     | 410/930 [2:07:42<2:49:08, 19.52s/it] 44%|████▍     | 411/930 [2:08:01<2:48:34, 19.49s/it] 44%|████▍     | 412/930 [2:08:20<2:46:53, 19.33s/it] 44%|████▍     | 413/930 [2:08:40<2:46:39, 19.34s/it] 45%|████▍     | 414/930 [2:08:59<2:47:35, 19.49s/it] 45%|████▍     | 415/930 [2:09:19<2:47:38, 19.53s/it] 45%|████▍     | 416/930 [2:09:38<2:45:30, 19.32s/it] 45%|████▍     | 417/930 [2:09:58<2:46:41, 19.50s/it] 45%|████▍     | 418/930 [2:10:16<2:43:11, 19.12s/it] 45%|████▌     | 419/930 [2:10:33<2:37:02, 18.44s/it] 45%|████▌     | 420/930 [2:10:52<2:39:09, 18.72s/it]                                                      45%|████▌     | 420/930 [2:10:52<2:39:09, 18.72s/it] 45%|████▌     | 421/930 [2:11:12<2:40:25, 18.91s/it] 45%|████▌     | 422/930 [2:11:28<2:34:21, 18.23s/it] 45%|████▌     | 423/930 [2:11:47<2:36:09, 18.48s/it] 46%|████▌     | 424/930 [2:12:06<2:36:51, 18.60s/it] 46%|████▌     | 425/930 [2:12:24<2:35:01, 18.42s/it] 46%|████▌     | 426/930 [2:12:43<2:36:26, 18.62s/it] 46%|████▌     | 427/930 [2:13:00<2:31:33, 18.08s/it] 46%|████▌     | 428/930 [2:13:20<2:36:54, 18.75s/it] 46%|████▌     | 429/930 [2:13:39<2:37:13, 18.83s/it] 46%|████▌     | 430/930 [2:13:57<2:33:01, 18.36s/it]                                                      46%|████▌     | 430/930 [2:13:57<2:33:01, 18.36s/it] 46%|████▋     | 431/930 [2:14:14<2:29:38, 17.99s/it] 46%|████▋     | 432/930 [2:14:33<2:32:12, 18.34s/it] 47%|████▋     | 433/930 [2:14:52<2:34:18, 18.63s/it] 47%|████▋     | 434/930 [2:15:10<2:32:09, 18.41s/it] 47%|████▋     | 435/930 [2:15:28<2:31:17, 18.34s/it] 47%|████▋     | 436/930 [2:15:47<2:32:31, 18.53s/it] 47%|████▋     | 437/930 [2:16:07<2:34:05, 18.75s/it] 47%|████▋     | 438/930 [2:16:25<2:33:15, 18.69s/it] 47%|████▋     | 439/930 [2:16:44<2:34:34, 18.89s/it] 47%|████▋     | 440/930 [2:17:05<2:37:27, 19.28s/it]                                                      47%|████▋     | 440/930 [2:17:05<2:37:27, 19.28s/it] 47%|████▋     | 441/930 [2:17:24<2:37:21, 19.31s/it] 48%|████▊     | 442/930 [2:17:42<2:34:08, 18.95s/it] 48%|████▊     | 443/930 [2:18:02<2:36:47, 19.32s/it] 48%|████▊     | 444/930 [2:18:20<2:33:27, 18.95s/it] 48%|████▊     | 445/930 [2:18:37<2:28:32, 18.38s/it] 48%|████▊     | 446/930 [2:18:56<2:29:32, 18.54s/it] 48%|████▊     | 447/930 [2:19:13<2:25:06, 18.03s/it] 48%|████▊     | 448/930 [2:19:33<2:29:05, 18.56s/it] 48%|████▊     | 449/930 [2:19:51<2:27:56, 18.45s/it] 48%|████▊     | 450/930 [2:20:09<2:26:34, 18.32s/it]                                                      48%|████▊     | 450/930 [2:20:09<2:26:34, 18.32s/it] 48%|████▊     | 451/930 [2:20:27<2:24:08, 18.05s/it] 49%|████▊     | 452/930 [2:20:43<2:20:24, 17.63s/it] 49%|████▊     | 453/930 [2:21:03<2:25:43, 18.33s/it] 49%|████▉     | 454/930 [2:21:23<2:29:25, 18.83s/it] 49%|████▉     | 455/930 [2:21:42<2:29:11, 18.84s/it] 49%|████▉     | 456/930 [2:22:01<2:29:22, 18.91s/it] 49%|████▉     | 457/930 [2:22:17<2:22:36, 18.09s/it] 49%|████▉     | 458/930 [2:22:36<2:23:24, 18.23s/it] 49%|████▉     | 459/930 [2:22:54<2:22:50, 18.20s/it] 49%|████▉     | 460/930 [2:23:13<2:25:30, 18.58s/it]                                                      49%|████▉     | 460/930 [2:23:13<2:25:30, 18.58s/it] 50%|████▉     | 461/930 [2:23:33<2:27:41, 18.89s/it] 50%|████▉     | 462/930 [2:23:51<2:25:45, 18.69s/it] 50%|████▉     | 463/930 [2:24:09<2:22:48, 18.35s/it] 50%|████▉     | 464/930 [2:24:26<2:19:26, 17.95s/it] 50%|█████     | 465/930 [2:24:43<2:16:30, 17.61s/it] 50%|█████     | 466/930 [2:24:58<2:11:50, 17.05s/it] 50%|█████     | 467/930 [2:25:18<2:16:31, 17.69s/it] 50%|█████     | 468/930 [2:25:32<2:09:31, 16.82s/it] 50%|█████     | 469/930 [2:25:51<2:14:08, 17.46s/it] 51%|█████     | 470/930 [2:26:10<2:16:17, 17.78s/it]                                                      51%|█████     | 470/930 [2:26:10<2:16:17, 17.78s/it] 51%|█████     | 471/930 [2:26:28<2:17:38, 17.99s/it] 51%|█████     | 472/930 [2:26:47<2:17:43, 18.04s/it] 51%|█████     | 473/930 [2:27:05<2:18:36, 18.20s/it] 51%|█████     | 474/930 [2:27:24<2:18:54, 18.28s/it] 51%|█████     | 475/930 [2:27:41<2:16:42, 18.03s/it] 51%|█████     | 476/930 [2:27:58<2:14:26, 17.77s/it] 51%|█████▏    | 477/930 [2:28:16<2:13:28, 17.68s/it] 51%|█████▏    | 478/930 [2:28:33<2:11:40, 17.48s/it] 52%|█████▏    | 479/930 [2:28:51<2:13:36, 17.77s/it] 52%|█████▏    | 480/930 [2:29:09<2:13:15, 17.77s/it]                                                      52%|█████▏    | 480/930 [2:29:09<2:13:15, 17.77s/it] 52%|█████▏    | 481/930 [2:29:27<2:14:03, 17.91s/it] 52%|█████▏    | 482/930 [2:29:46<2:15:14, 18.11s/it] 52%|█████▏    | 483/930 [2:30:05<2:17:48, 18.50s/it] 52%|█████▏    | 484/930 [2:30:25<2:21:09, 18.99s/it] 52%|█████▏    | 485/930 [2:30:44<2:21:09, 19.03s/it] 52%|█████▏    | 486/930 [2:31:04<2:21:30, 19.12s/it] 52%|█████▏    | 487/930 [2:31:23<2:21:19, 19.14s/it] 52%|█████▏    | 488/930 [2:31:41<2:19:17, 18.91s/it] 53%|█████▎    | 489/930 [2:31:59<2:15:38, 18.46s/it] 53%|█████▎    | 490/930 [2:32:16<2:13:43, 18.24s/it]                                                      53%|█████▎    | 490/930 [2:32:16<2:13:43, 18.24s/it] 53%|█████▎    | 491/930 [2:32:34<2:11:25, 17.96s/it] 53%|█████▎    | 492/930 [2:32:52<2:12:42, 18.18s/it] 53%|█████▎    | 493/930 [2:33:12<2:15:30, 18.61s/it] 53%|█████▎    | 494/930 [2:33:31<2:16:53, 18.84s/it] 53%|█████▎    | 495/930 [2:33:52<2:19:28, 19.24s/it] 53%|█████▎    | 496/930 [2:34:12<2:21:11, 19.52s/it] 53%|█████▎    | 497/930 [2:34:30<2:19:01, 19.26s/it] 54%|█████▎    | 498/930 [2:34:48<2:15:24, 18.81s/it] 54%|█████▎    | 499/930 [2:35:07<2:14:52, 18.78s/it] 54%|█████▍    | 500/930 [2:35:25<2:14:14, 18.73s/it]                                                      54%|█████▍    | 500/930 [2:35:25<2:14:14, 18.73s/it] 54%|█████▍    | 501/930 [2:35:42<2:08:50, 18.02s/it] 54%|█████▍    | 502/930 [2:36:00<2:09:13, 18.12s/it] 54%|█████▍    | 503/930 [2:36:17<2:06:58, 17.84s/it] 54%|█████▍    | 504/930 [2:36:36<2:08:01, 18.03s/it] 54%|█████▍    | 505/930 [2:36:55<2:10:42, 18.45s/it] 54%|█████▍    | 506/930 [2:37:13<2:08:44, 18.22s/it] 55%|█████▍    | 507/930 [2:37:32<2:09:14, 18.33s/it] 55%|█████▍    | 508/930 [2:37:51<2:10:39, 18.58s/it] 55%|█████▍    | 509/930 [2:38:06<2:03:59, 17.67s/it] 55%|█████▍    | 510/930 [2:38:26<2:08:57, 18.42s/it]                                                      55%|█████▍    | 510/930 [2:38:26<2:08:57, 18.42s/it] 55%|█████▍    | 511/930 [2:38:45<2:08:43, 18.43s/it] 55%|█████▌    | 512/930 [2:39:01<2:03:05, 17.67s/it] 55%|█████▌    | 513/930 [2:39:19<2:03:00, 17.70s/it] 55%|█████▌    | 514/930 [2:39:37<2:04:31, 17.96s/it] 55%|█████▌    | 515/930 [2:39:56<2:06:39, 18.31s/it] 55%|█████▌    | 516/930 [2:40:14<2:04:32, 18.05s/it] 56%|█████▌    | 517/930 [2:40:34<2:08:36, 18.68s/it] 56%|█████▌    | 518/930 [2:40:54<2:10:32, 19.01s/it] 56%|█████▌    | 519/930 [2:41:11<2:07:50, 18.66s/it] 56%|█████▌    | 520/930 [2:41:30<2:07:35, 18.67s/it]                                                      56%|█████▌    | 520/930 [2:41:30<2:07:35, 18.67s/it] 56%|█████▌    | 521/930 [2:41:49<2:08:19, 18.82s/it] 56%|█████▌    | 522/930 [2:42:08<2:07:20, 18.73s/it] 56%|█████▌    | 523/930 [2:42:27<2:08:52, 19.00s/it] 56%|█████▋    | 524/930 [2:42:45<2:06:00, 18.62s/it] 56%|█████▋    | 525/930 [2:43:04<2:05:40, 18.62s/it] 57%|█████▋    | 526/930 [2:43:23<2:05:46, 18.68s/it] 57%|█████▋    | 527/930 [2:43:42<2:07:02, 18.92s/it] 57%|█████▋    | 528/930 [2:44:01<2:05:53, 18.79s/it] 57%|█████▋    | 529/930 [2:44:19<2:05:41, 18.81s/it] 57%|█████▋    | 530/930 [2:44:38<2:04:42, 18.71s/it]                                                      57%|█████▋    | 530/930 [2:44:38<2:04:42, 18.71s/it] 57%|█████▋    | 531/930 [2:44:56<2:03:38, 18.59s/it] 57%|█████▋    | 532/930 [2:45:16<2:06:29, 19.07s/it] 57%|█████▋    | 533/930 [2:45:35<2:05:25, 18.96s/it] 57%|█████▋    | 534/930 [2:45:54<2:05:35, 19.03s/it] 58%|█████▊    | 535/930 [2:46:11<1:59:54, 18.21s/it] 58%|█████▊    | 536/930 [2:46:31<2:03:36, 18.82s/it] 58%|█████▊    | 537/930 [2:46:50<2:03:04, 18.79s/it] 58%|█████▊    | 538/930 [2:47:06<1:58:59, 18.21s/it] 58%|█████▊    | 539/930 [2:47:24<1:56:50, 17.93s/it] 58%|█████▊    | 540/930 [2:47:41<1:55:35, 17.78s/it]                                                      58%|█████▊    | 540/930 [2:47:41<1:55:35, 17.78s/it] 58%|█████▊    | 541/930 [2:48:01<1:59:18, 18.40s/it] 58%|█████▊    | 542/930 [2:48:21<2:02:13, 18.90s/it] 58%|█████▊    | 543/930 [2:48:40<2:01:16, 18.80s/it] 58%|█████▊    | 544/930 [2:48:59<2:02:51, 19.10s/it] 59%|█████▊    | 545/930 [2:49:17<2:00:11, 18.73s/it] 59%|█████▊    | 546/930 [2:49:37<2:01:06, 18.92s/it] 59%|█████▉    | 547/930 [2:49:56<2:01:18, 19.00s/it] 59%|█████▉    | 548/930 [2:50:16<2:02:33, 19.25s/it] 59%|█████▉    | 549/930 [2:50:33<1:58:23, 18.64s/it] 59%|█████▉    | 550/930 [2:50:53<1:59:56, 18.94s/it]                                                      59%|█████▉    | 550/930 [2:50:53<1:59:56, 18.94s/it] 59%|█████▉    | 551/930 [2:51:12<1:59:47, 18.97s/it] 59%|█████▉    | 552/930 [2:51:31<1:59:28, 18.96s/it] 59%|█████▉    | 553/930 [2:51:48<1:55:29, 18.38s/it] 60%|█████▉    | 554/930 [2:52:07<1:58:01, 18.83s/it] 60%|█████▉    | 555/930 [2:52:25<1:54:55, 18.39s/it] 60%|█████▉    | 556/930 [2:52:44<1:56:23, 18.67s/it] 60%|█████▉    | 557/930 [2:53:04<1:58:06, 19.00s/it] 60%|██████    | 558/930 [2:53:23<1:57:30, 18.95s/it] 60%|██████    | 559/930 [2:53:42<1:57:25, 18.99s/it] 60%|██████    | 560/930 [2:54:02<1:58:30, 19.22s/it]                                                      60%|██████    | 560/930 [2:54:02<1:58:30, 19.22s/it] 60%|██████    | 561/930 [2:54:18<1:53:44, 18.49s/it] 60%|██████    | 562/930 [2:54:39<1:56:29, 18.99s/it] 61%|██████    | 563/930 [2:54:57<1:55:27, 18.88s/it] 61%|██████    | 564/930 [2:55:17<1:57:02, 19.19s/it] 61%|██████    | 565/930 [2:55:36<1:56:43, 19.19s/it] 61%|██████    | 566/930 [2:55:51<1:49:09, 17.99s/it] 61%|██████    | 567/930 [2:56:09<1:48:36, 17.95s/it] 61%|██████    | 568/930 [2:56:27<1:48:21, 17.96s/it] 61%|██████    | 569/930 [2:56:46<1:48:49, 18.09s/it] 61%|██████▏   | 570/930 [2:57:05<1:50:32, 18.42s/it]                                                      61%|██████▏   | 570/930 [2:57:05<1:50:32, 18.42s/it] 61%|██████▏   | 571/930 [2:57:22<1:48:43, 18.17s/it] 62%|██████▏   | 572/930 [2:57:41<1:49:34, 18.36s/it] 62%|██████▏   | 573/930 [2:58:00<1:50:45, 18.61s/it] 62%|██████▏   | 574/930 [2:58:18<1:48:16, 18.25s/it] 62%|██████▏   | 575/930 [2:58:37<1:49:55, 18.58s/it] 62%|██████▏   | 576/930 [2:58:57<1:51:13, 18.85s/it] 62%|██████▏   | 577/930 [2:59:13<1:46:44, 18.14s/it] 62%|██████▏   | 578/930 [2:59:32<1:47:40, 18.35s/it] 62%|██████▏   | 579/930 [2:59:51<1:48:43, 18.59s/it] 62%|██████▏   | 580/930 [3:00:11<1:50:03, 18.87s/it]                                                      62%|██████▏   | 580/930 [3:00:11<1:50:03, 18.87s/it] 62%|██████▏   | 581/930 [3:00:30<1:50:28, 18.99s/it] 63%|██████▎   | 582/930 [3:00:49<1:50:31, 19.05s/it] 63%|██████▎   | 583/930 [3:01:07<1:48:21, 18.74s/it] 63%|██████▎   | 584/930 [3:01:25<1:47:04, 18.57s/it] 63%|██████▎   | 585/930 [3:01:44<1:47:28, 18.69s/it] 63%|██████▎   | 586/930 [3:02:01<1:43:28, 18.05s/it] 63%|██████▎   | 587/930 [3:02:18<1:42:04, 17.86s/it] 63%|██████▎   | 588/930 [3:02:37<1:43:27, 18.15s/it] 63%|██████▎   | 589/930 [3:02:55<1:42:40, 18.07s/it] 63%|██████▎   | 590/930 [3:03:11<1:39:07, 17.49s/it]                                                      63%|██████▎   | 590/930 [3:03:11<1:39:07, 17.49s/it] 64%|██████▎   | 591/930 [3:03:29<1:38:53, 17.50s/it] 64%|██████▎   | 592/930 [3:03:49<1:43:06, 18.30s/it] 64%|██████▍   | 593/930 [3:04:07<1:43:03, 18.35s/it] 64%|██████▍   | 594/930 [3:04:27<1:44:44, 18.70s/it] 64%|██████▍   | 595/930 [3:04:44<1:42:01, 18.27s/it] 64%|██████▍   | 596/930 [3:05:02<1:41:13, 18.19s/it] 64%|██████▍   | 597/930 [3:05:22<1:44:01, 18.74s/it] 64%|██████▍   | 598/930 [3:05:42<1:45:50, 19.13s/it] 64%|██████▍   | 599/930 [3:06:01<1:44:49, 19.00s/it] 65%|██████▍   | 600/930 [3:06:20<1:43:59, 18.91s/it]                                                      65%|██████▍   | 600/930 [3:06:20<1:43:59, 18.91s/it]{'eval_loss': 0.39044734835624695, 'eval_runtime': 48.7718, 'eval_samples_per_second': 5.105, 'eval_steps_per_second': 1.292, 'eval_rewards/chosen': -31.968700408935547, 'eval_rewards/rejected': -43.962669372558594, 'eval_rewards/accuracies': 0.8015872836112976, 'eval_rewards/margins': 11.993972778320312, 'eval_logps/rejected': -684.2907104492188, 'eval_logps/chosen': -661.758544921875, 'eval_logits/rejected': -7.557040691375732, 'eval_logits/chosen': -1.1528284549713135, 'epoch': 6.45}
{'loss': 0.0971, 'grad_norm': 1.2839620113372803, 'learning_rate': 0.00012756753560128626, 'rewards/chosen': -31.51275062561035, 'rewards/rejected': -47.17915725708008, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 15.666404724121094, 'logps/rejected': -692.5902099609375, 'logps/chosen': -593.5701904296875, 'logits/rejected': 4.125207424163818, 'logits/chosen': 9.839139938354492, 'epoch': 6.61}
{'loss': 0.0583, 'grad_norm': 2.584803581237793, 'learning_rate': 0.00012413081265634146, 'rewards/chosen': -37.5250244140625, 'rewards/rejected': -58.73344039916992, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 21.208423614501953, 'logps/rejected': -806.1849365234375, 'logps/chosen': -657.033447265625, 'logits/rejected': 2.685546636581421, 'logits/chosen': 8.741655349731445, 'epoch': 6.77}
{'loss': 0.0725, 'grad_norm': 1.5946608781814575, 'learning_rate': 0.00012066354721906803, 'rewards/chosen': -41.55954360961914, 'rewards/rejected': -67.18293762207031, 'rewards/accuracies': 0.96875, 'rewards/margins': 25.623388290405273, 'logps/rejected': -897.5758666992188, 'logps/chosen': -690.4210815429688, 'logits/rejected': 1.7020213603973389, 'logits/chosen': 7.773037910461426, 'epoch': 6.94}
{'loss': 0.0567, 'grad_norm': 2.175748348236084, 'learning_rate': 0.00011717012782496739, 'rewards/chosen': -37.2208366394043, 'rewards/rejected': -64.88865661621094, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 27.667821884155273, 'logps/rejected': -853.7626953125, 'logps/chosen': -641.87890625, 'logits/rejected': 5.159628391265869, 'logits/chosen': 12.633848190307617, 'epoch': 7.1}
{'loss': 0.0713, 'grad_norm': 3.208224296569824, 'learning_rate': 0.0001136549761127371, 'rewards/chosen': -36.1754035949707, 'rewards/rejected': -58.56621551513672, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 22.390806198120117, 'logps/rejected': -795.7157592773438, 'logps/chosen': -630.0697021484375, 'logits/rejected': 5.424631595611572, 'logits/chosen': 11.300409317016602, 'epoch': 7.26}
{'loss': 0.0699, 'grad_norm': 3.0817084312438965, 'learning_rate': 0.0001101225412277803, 'rewards/chosen': -37.77006912231445, 'rewards/rejected': -60.62822723388672, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 22.858154296875, 'logps/rejected': -824.0125122070312, 'logps/chosen': -664.0335083007812, 'logits/rejected': 4.749875068664551, 'logits/chosen': 10.823976516723633, 'epoch': 7.42}
{'loss': 0.1148, 'grad_norm': 2.251828670501709, 'learning_rate': 0.0001065772941908998, 'rewards/chosen': -33.585479736328125, 'rewards/rejected': -55.07024002075195, 'rewards/accuracies': 0.9593750238418579, 'rewards/margins': 21.484760284423828, 'logps/rejected': -771.8119506835938, 'logps/chosen': -600.1917724609375, 'logits/rejected': 3.6009507179260254, 'logits/chosen': 9.12341022491455, 'epoch': 7.58}
{'loss': 0.0675, 'grad_norm': 2.630553960800171, 'learning_rate': 0.00010302372223930427, 'rewards/chosen': -26.795547485351562, 'rewards/rejected': -42.83168411254883, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 16.036134719848633, 'logps/rejected': -649.2401733398438, 'logps/chosen': -545.0887451171875, 'logits/rejected': 6.983536720275879, 'logits/chosen': 11.897703170776367, 'epoch': 7.74}
{'loss': 0.0375, 'grad_norm': 1.3608136177062988, 'learning_rate': 9.946632314708927e-05, 'rewards/chosen': -30.0030517578125, 'rewards/rejected': -46.9453010559082, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 16.942245483398438, 'logps/rejected': -701.6141357421875, 'logps/chosen': -591.81005859375, 'logits/rejected': 7.203521728515625, 'logits/chosen': 12.609155654907227, 'epoch': 7.9}
{'loss': 0.0484, 'grad_norm': 0.10021553188562393, 'learning_rate': 9.590959953238175e-05, 'rewards/chosen': -33.85166549682617, 'rewards/rejected': -55.7945442199707, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 21.9428768157959, 'logps/rejected': -772.44677734375, 'logps/chosen': -615.2283325195312, 'logits/rejected': 6.021801471710205, 'logits/chosen': 12.835214614868164, 'epoch': 8.06}
{'loss': 0.0356, 'grad_norm': 0.6984024047851562, 'learning_rate': 9.235805315835325e-05, 'rewards/chosen': -35.1402702331543, 'rewards/rejected': -56.57085037231445, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 21.430574417114258, 'logps/rejected': -780.91845703125, 'logps/chosen': -624.3385620117188, 'logits/rejected': 5.02230167388916, 'logits/chosen': 10.980793952941895, 'epoch': 8.23}
{'loss': 0.059, 'grad_norm': 1.9198018312454224, 'learning_rate': 8.881617923531555e-05, 'rewards/chosen': -38.756019592285156, 'rewards/rejected': -63.57169723510742, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 24.815675735473633, 'logps/rejected': -847.6336059570312, 'logps/chosen': -652.8734741210938, 'logits/rejected': 4.6933746337890625, 'logits/chosen': 10.866830825805664, 'epoch': 8.39}
{'loss': 0.0343, 'grad_norm': 0.6782546639442444, 'learning_rate': 8.528846073110999e-05, 'rewards/chosen': -41.28434371948242, 'rewards/rejected': -68.6615982055664, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 27.37725257873535, 'logps/rejected': -907.0022583007812, 'logps/chosen': -695.2388916015625, 'logits/rejected': 4.394299030303955, 'logits/chosen': 10.93806266784668, 'epoch': 8.55}
{'loss': 0.0669, 'grad_norm': 3.6742422580718994, 'learning_rate': 8.177936269699222e-05, 'rewards/chosen': -42.30281066894531, 'rewards/rejected': -69.31592559814453, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 27.01311683654785, 'logps/rejected': -915.0724487304688, 'logps/chosen': -712.3568725585938, 'logits/rejected': 2.7144579887390137, 'logits/chosen': 9.077849388122559, 'epoch': 8.71}
{'loss': 0.0737, 'grad_norm': 0.3966134488582611, 'learning_rate': 7.829332661619425e-05, 'rewards/chosen': -37.77017593383789, 'rewards/rejected': -56.386451721191406, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 18.616275787353516, 'logps/rejected': -781.3038330078125, 'logps/chosen': -648.87890625, 'logits/rejected': 8.240644454956055, 'logits/chosen': 13.871110916137695, 'epoch': 8.87}
{'loss': 0.0433, 'grad_norm': 0.2296379953622818, 'learning_rate': 7.483476478231641e-05, 'rewards/chosen': -36.08283996582031, 'rewards/rejected': -54.22087478637695, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 18.13803482055664, 'logps/rejected': -758.9034423828125, 'logps/chosen': -638.7119750976562, 'logits/rejected': 7.532865047454834, 'logits/chosen': 13.423492431640625, 'epoch': 9.03}
{'loss': 0.0557, 'grad_norm': 0.7393811345100403, 'learning_rate': 7.140805471466495e-05, 'rewards/chosen': -34.735836029052734, 'rewards/rejected': -56.3785285949707, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 21.642684936523438, 'logps/rejected': -775.0216064453125, 'logps/chosen': -621.3560791015625, 'logits/rejected': 6.770271301269531, 'logits/chosen': 13.326398849487305, 'epoch': 9.19}
{'loss': 0.0269, 'grad_norm': 2.4323878288269043, 'learning_rate': 6.801753361760367e-05, 'rewards/chosen': -40.26097869873047, 'rewards/rejected': -65.01374053955078, 'rewards/accuracies': 0.984375, 'rewards/margins': 24.752758026123047, 'logps/rejected': -855.8258056640625, 'logps/chosen': -667.38818359375, 'logits/rejected': 3.4280200004577637, 'logits/chosen': 10.481025695800781, 'epoch': 9.35}
{'loss': 0.1475, 'grad_norm': 2.799133539199829, 'learning_rate': 6.466749289093214e-05, 'rewards/chosen': -39.6805305480957, 'rewards/rejected': -62.290283203125, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 22.60975456237793, 'logps/rejected': -858.2965087890625, 'logps/chosen': -686.7020263671875, 'logits/rejected': 3.257896900177002, 'logits/chosen': 9.337339401245117, 'epoch': 9.52}
{'loss': 0.0393, 'grad_norm': 0.29998141527175903, 'learning_rate': 6.136217269823916e-05, 'rewards/chosen': -36.254669189453125, 'rewards/rejected': -54.48981857299805, 'rewards/accuracies': 0.984375, 'rewards/margins': 18.235157012939453, 'logps/rejected': -771.7068481445312, 'logps/chosen': -648.7969970703125, 'logits/rejected': 6.874998569488525, 'logits/chosen': 11.999469757080078, 'epoch': 9.68}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:19,  3.15it/s][A
  5%|▍         | 3/63 [00:01<00:32,  1.82it/s][A
  6%|▋         | 4/63 [00:02<00:39,  1.50it/s][A
  8%|▊         | 5/63 [00:03<00:44,  1.31it/s][A
 10%|▉         | 6/63 [00:04<00:49,  1.16it/s][A
 11%|█         | 7/63 [00:05<00:52,  1.07it/s][A
 13%|█▎        | 8/63 [00:06<00:50,  1.08it/s][A
 14%|█▍        | 9/63 [00:06<00:43,  1.23it/s][A
 16%|█▌        | 10/63 [00:07<00:46,  1.14it/s][A
 17%|█▋        | 11/63 [00:08<00:47,  1.10it/s][A
 19%|█▉        | 12/63 [00:09<00:46,  1.11it/s][A
 21%|██        | 13/63 [00:10<00:40,  1.22it/s][A
 22%|██▏       | 14/63 [00:11<00:43,  1.12it/s][A
 24%|██▍       | 15/63 [00:12<00:43,  1.09it/s][A
 25%|██▌       | 16/63 [00:13<00:43,  1.08it/s][A
 27%|██▋       | 17/63 [00:13<00:36,  1.25it/s][A
 29%|██▊       | 18/63 [00:14<00:30,  1.46it/s][A
 30%|███       | 19/63 [00:14<00:29,  1.51it/s][A
 32%|███▏      | 20/63 [00:15<00:32,  1.33it/s][A
 33%|███▎      | 21/63 [00:16<00:31,  1.31it/s][A
 35%|███▍      | 22/63 [00:17<00:35,  1.17it/s][A
 37%|███▋      | 23/63 [00:18<00:36,  1.09it/s][A
 38%|███▊      | 24/63 [00:19<00:36,  1.06it/s][A
 40%|███▉      | 25/63 [00:20<00:36,  1.04it/s][A
 41%|████▏     | 26/63 [00:21<00:36,  1.01it/s][A
 43%|████▎     | 27/63 [00:23<00:36,  1.02s/it][A
 44%|████▍     | 28/63 [00:24<00:35,  1.03s/it][A
 46%|████▌     | 29/63 [00:24<00:29,  1.16it/s][A
 48%|████▊     | 30/63 [00:25<00:24,  1.33it/s][A
 49%|████▉     | 31/63 [00:25<00:22,  1.44it/s][A
 51%|█████     | 32/63 [00:26<00:20,  1.49it/s][A
 52%|█████▏    | 33/63 [00:26<00:19,  1.55it/s][A
 54%|█████▍    | 34/63 [00:27<00:21,  1.35it/s][A
 56%|█████▌    | 35/63 [00:28<00:21,  1.30it/s][A
 57%|█████▋    | 36/63 [00:29<00:18,  1.42it/s][A
 59%|█████▊    | 37/63 [00:29<00:16,  1.55it/s][A
 60%|██████    | 38/63 [00:30<00:17,  1.46it/s][A
 62%|██████▏   | 39/63 [00:31<00:19,  1.25it/s][A
 63%|██████▎   | 40/63 [00:32<00:20,  1.13it/s][A
 65%|██████▌   | 41/63 [00:33<00:18,  1.18it/s][A
 67%|██████▋   | 42/63 [00:34<00:17,  1.20it/s][A
 68%|██████▊   | 43/63 [00:34<00:15,  1.27it/s][A
 70%|██████▉   | 44/63 [00:35<00:13,  1.41it/s][A
 71%|███████▏  | 45/63 [00:35<00:12,  1.50it/s][A
 73%|███████▎  | 46/63 [00:36<00:10,  1.58it/s][A
 75%|███████▍  | 47/63 [00:37<00:09,  1.65it/s][A
 76%|███████▌  | 48/63 [00:37<00:09,  1.54it/s][A
 78%|███████▊  | 49/63 [00:38<00:08,  1.70it/s][A
 79%|███████▉  | 50/63 [00:39<00:09,  1.42it/s][A
 81%|████████  | 51/63 [00:39<00:08,  1.37it/s][A
 83%|████████▎ | 52/63 [00:41<00:09,  1.20it/s][A
 84%|████████▍ | 53/63 [00:41<00:07,  1.40it/s][A
 86%|████████▌ | 54/63 [00:42<00:06,  1.42it/s][A
 87%|████████▋ | 55/63 [00:42<00:05,  1.43it/s][A
 89%|████████▉ | 56/63 [00:43<00:04,  1.50it/s][A
 90%|█████████ | 57/63 [00:44<00:03,  1.56it/s][A
 92%|█████████▏| 58/63 [00:44<00:03,  1.42it/s][A
 94%|█████████▎| 59/63 [00:45<00:02,  1.43it/s][A
 95%|█████████▌| 60/63 [00:46<00:01,  1.61it/s][A
 97%|█████████▋| 61/63 [00:46<00:01,  1.59it/s][A
 98%|█████████▊| 62/63 [00:47<00:00,  1.64it/s][A
100%|██████████| 63/63 [00:47<00:00,  1.84it/s][A                                                     
                                               [A 65%|██████▍   | 600/930 [3:07:08<1:43:59, 18.91s/it]
100%|██████████| 63/63 [00:47<00:00,  1.84it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--google--flan-t5-large--hf/ - will assume that the vocabulary was not modified.
  warnings.warn(
 65%|██████▍   | 601/930 [3:07:33<3:13:20, 35.26s/it] 65%|██████▍   | 602/930 [3:07:51<2:45:16, 30.23s/it] 65%|██████▍   | 603/930 [3:08:09<2:23:19, 26.30s/it] 65%|██████▍   | 604/930 [3:08:27<2:10:27, 24.01s/it] 65%|██████▌   | 605/930 [3:08:47<2:02:20, 22.59s/it] 65%|██████▌   | 606/930 [3:09:04<1:54:14, 21.16s/it] 65%|██████▌   | 607/930 [3:09:24<1:51:11, 20.66s/it] 65%|██████▌   | 608/930 [3:09:42<1:47:12, 19.98s/it] 65%|██████▌   | 609/930 [3:09:58<1:40:35, 18.80s/it] 66%|██████▌   | 610/930 [3:10:18<1:42:27, 19.21s/it]                                                      66%|██████▌   | 610/930 [3:10:18<1:42:27, 19.21s/it] 66%|██████▌   | 611/930 [3:10:36<1:39:44, 18.76s/it] 66%|██████▌   | 612/930 [3:10:54<1:38:31, 18.59s/it] 66%|██████▌   | 613/930 [3:11:14<1:40:02, 18.94s/it] 66%|██████▌   | 614/930 [3:11:33<1:39:40, 18.93s/it] 66%|██████▌   | 615/930 [3:11:52<1:39:55, 19.03s/it] 66%|██████▌   | 616/930 [3:12:11<1:39:04, 18.93s/it] 66%|██████▋   | 617/930 [3:12:29<1:38:01, 18.79s/it] 66%|██████▋   | 618/930 [3:12:50<1:39:56, 19.22s/it] 67%|██████▋   | 619/930 [3:13:09<1:40:06, 19.31s/it] 67%|██████▋   | 620/930 [3:13:27<1:38:11, 19.01s/it]                                                      67%|██████▋   | 620/930 [3:13:27<1:38:11, 19.01s/it] 67%|██████▋   | 621/930 [3:13:47<1:38:51, 19.19s/it] 67%|██████▋   | 622/930 [3:14:07<1:40:00, 19.48s/it] 67%|██████▋   | 623/930 [3:14:27<1:39:25, 19.43s/it] 67%|██████▋   | 624/930 [3:14:46<1:38:21, 19.29s/it] 67%|██████▋   | 625/930 [3:15:04<1:36:23, 18.96s/it] 67%|██████▋   | 626/930 [3:15:23<1:36:21, 19.02s/it] 67%|██████▋   | 627/930 [3:15:42<1:36:25, 19.09s/it] 68%|██████▊   | 628/930 [3:15:59<1:32:33, 18.39s/it] 68%|██████▊   | 629/930 [3:16:19<1:34:44, 18.88s/it] 68%|██████▊   | 630/930 [3:16:39<1:35:58, 19.19s/it]                                                      68%|██████▊   | 630/930 [3:16:39<1:35:58, 19.19s/it] 68%|██████▊   | 631/930 [3:16:55<1:31:10, 18.30s/it] 68%|██████▊   | 632/930 [3:17:14<1:32:11, 18.56s/it] 68%|██████▊   | 633/930 [3:17:31<1:28:34, 17.89s/it] 68%|██████▊   | 634/930 [3:17:49<1:29:46, 18.20s/it] 68%|██████▊   | 635/930 [3:18:10<1:32:19, 18.78s/it] 68%|██████▊   | 636/930 [3:18:27<1:29:43, 18.31s/it] 68%|██████▊   | 637/930 [3:18:42<1:24:07, 17.23s/it] 69%|██████▊   | 638/930 [3:19:01<1:27:26, 17.97s/it] 69%|██████▊   | 639/930 [3:19:20<1:28:21, 18.22s/it] 69%|██████▉   | 640/930 [3:19:39<1:28:52, 18.39s/it]                                                      69%|██████▉   | 640/930 [3:19:39<1:28:52, 18.39s/it] 69%|██████▉   | 641/930 [3:19:58<1:29:06, 18.50s/it] 69%|██████▉   | 642/930 [3:20:16<1:29:19, 18.61s/it] 69%|██████▉   | 643/930 [3:20:33<1:26:03, 17.99s/it] 69%|██████▉   | 644/930 [3:20:51<1:26:04, 18.06s/it] 69%|██████▉   | 645/930 [3:21:09<1:26:04, 18.12s/it] 69%|██████▉   | 646/930 [3:21:28<1:26:10, 18.21s/it] 70%|██████▉   | 647/930 [3:21:44<1:23:26, 17.69s/it] 70%|██████▉   | 648/930 [3:22:03<1:24:52, 18.06s/it] 70%|██████▉   | 649/930 [3:22:23<1:26:54, 18.56s/it] 70%|██████▉   | 650/930 [3:22:42<1:27:24, 18.73s/it]                                                      70%|██████▉   | 650/930 [3:22:42<1:27:24, 18.73s/it] 70%|███████   | 651/930 [3:22:59<1:23:53, 18.04s/it] 70%|███████   | 652/930 [3:23:17<1:24:31, 18.24s/it] 70%|███████   | 653/930 [3:23:36<1:25:05, 18.43s/it] 70%|███████   | 654/930 [3:23:52<1:21:38, 17.75s/it] 70%|███████   | 655/930 [3:24:10<1:21:24, 17.76s/it] 71%|███████   | 656/930 [3:24:27<1:19:32, 17.42s/it] 71%|███████   | 657/930 [3:24:45<1:21:01, 17.81s/it] 71%|███████   | 658/930 [3:25:05<1:22:47, 18.26s/it] 71%|███████   | 659/930 [3:25:24<1:23:17, 18.44s/it] 71%|███████   | 660/930 [3:25:42<1:23:18, 18.51s/it]                                                      71%|███████   | 660/930 [3:25:42<1:23:18, 18.51s/it] 71%|███████   | 661/930 [3:26:02<1:25:10, 19.00s/it] 71%|███████   | 662/930 [3:26:23<1:26:25, 19.35s/it] 71%|███████▏  | 663/930 [3:26:42<1:26:49, 19.51s/it] 71%|███████▏  | 664/930 [3:26:59<1:22:24, 18.59s/it] 72%|███████▏  | 665/930 [3:27:16<1:20:39, 18.26s/it] 72%|███████▏  | 666/930 [3:27:34<1:19:55, 18.17s/it] 72%|███████▏  | 667/930 [3:27:55<1:22:15, 18.77s/it] 72%|███████▏  | 668/930 [3:28:08<1:14:48, 17.13s/it] 72%|███████▏  | 669/930 [3:28:24<1:13:15, 16.84s/it] 72%|███████▏  | 670/930 [3:28:40<1:11:23, 16.48s/it]                                                      72%|███████▏  | 670/930 [3:28:40<1:11:23, 16.48s/it] 72%|███████▏  | 671/930 [3:29:00<1:15:58, 17.60s/it] 72%|███████▏  | 672/930 [3:29:19<1:17:15, 17.97s/it] 72%|███████▏  | 673/930 [3:29:37<1:17:45, 18.15s/it] 72%|███████▏  | 674/930 [3:29:56<1:17:35, 18.19s/it] 73%|███████▎  | 675/930 [3:30:14<1:17:31, 18.24s/it] 73%|███████▎  | 676/930 [3:30:33<1:18:20, 18.51s/it] 73%|███████▎  | 677/930 [3:30:52<1:18:32, 18.63s/it] 73%|███████▎  | 678/930 [3:31:11<1:19:03, 18.82s/it] 73%|███████▎  | 679/930 [3:31:30<1:18:19, 18.72s/it] 73%|███████▎  | 680/930 [3:31:48<1:18:01, 18.73s/it]                                                      73%|███████▎  | 680/930 [3:31:48<1:18:01, 18.73s/it] 73%|███████▎  | 681/930 [3:32:07<1:17:06, 18.58s/it] 73%|███████▎  | 682/930 [3:32:26<1:18:00, 18.87s/it] 73%|███████▎  | 683/930 [3:32:46<1:19:17, 19.26s/it] 74%|███████▎  | 684/930 [3:33:05<1:17:43, 18.96s/it] 74%|███████▎  | 685/930 [3:33:22<1:15:11, 18.42s/it] 74%|███████▍  | 686/930 [3:33:40<1:14:55, 18.42s/it] 74%|███████▍  | 687/930 [3:33:59<1:15:32, 18.65s/it] 74%|███████▍  | 688/930 [3:34:19<1:16:39, 19.01s/it] 74%|███████▍  | 689/930 [3:34:36<1:13:37, 18.33s/it] 74%|███████▍  | 690/930 [3:34:56<1:14:52, 18.72s/it]                                                      74%|███████▍  | 690/930 [3:34:56<1:14:52, 18.72s/it] 74%|███████▍  | 691/930 [3:35:14<1:14:18, 18.66s/it] 74%|███████▍  | 692/930 [3:35:33<1:14:46, 18.85s/it] 75%|███████▍  | 693/930 [3:35:52<1:14:15, 18.80s/it] 75%|███████▍  | 694/930 [3:36:11<1:14:33, 18.95s/it] 75%|███████▍  | 695/930 [3:36:30<1:13:17, 18.71s/it] 75%|███████▍  | 696/930 [3:36:48<1:12:08, 18.50s/it] 75%|███████▍  | 697/930 [3:37:06<1:12:11, 18.59s/it] 75%|███████▌  | 698/930 [3:37:23<1:09:34, 17.99s/it] 75%|███████▌  | 699/930 [3:37:41<1:09:36, 18.08s/it] 75%|███████▌  | 700/930 [3:37:59<1:09:03, 18.02s/it]                                                      75%|███████▌  | 700/930 [3:37:59<1:09:03, 18.02s/it] 75%|███████▌  | 701/930 [3:38:18<1:09:48, 18.29s/it] 75%|███████▌  | 702/930 [3:38:38<1:11:04, 18.70s/it] 76%|███████▌  | 703/930 [3:38:57<1:11:13, 18.82s/it] 76%|███████▌  | 704/930 [3:39:17<1:12:22, 19.22s/it] 76%|███████▌  | 705/930 [3:39:34<1:10:07, 18.70s/it] 76%|███████▌  | 706/930 [3:39:53<1:09:18, 18.56s/it] 76%|███████▌  | 707/930 [3:40:11<1:08:56, 18.55s/it] 76%|███████▌  | 708/930 [3:40:29<1:08:15, 18.45s/it] 76%|███████▌  | 709/930 [3:40:48<1:07:33, 18.34s/it] 76%|███████▋  | 710/930 [3:41:07<1:08:07, 18.58s/it]                                                      76%|███████▋  | 710/930 [3:41:07<1:08:07, 18.58s/it] 76%|███████▋  | 711/930 [3:41:25<1:07:00, 18.36s/it] 77%|███████▋  | 712/930 [3:41:43<1:07:01, 18.45s/it] 77%|███████▋  | 713/930 [3:42:00<1:04:36, 17.86s/it] 77%|███████▋  | 714/930 [3:42:18<1:04:44, 17.98s/it] 77%|███████▋  | 715/930 [3:42:37<1:05:17, 18.22s/it] 77%|███████▋  | 716/930 [3:42:55<1:05:17, 18.31s/it] 77%|███████▋  | 717/930 [3:43:12<1:03:42, 17.95s/it] 77%|███████▋  | 718/930 [3:43:32<1:05:45, 18.61s/it] 77%|███████▋  | 719/930 [3:43:51<1:05:16, 18.56s/it] 77%|███████▋  | 720/930 [3:44:10<1:05:03, 18.59s/it]                                                      77%|███████▋  | 720/930 [3:44:10<1:05:03, 18.59s/it] 78%|███████▊  | 721/930 [3:44:29<1:05:19, 18.75s/it] 78%|███████▊  | 722/930 [3:44:46<1:03:44, 18.39s/it] 78%|███████▊  | 723/930 [3:45:04<1:02:51, 18.22s/it] 78%|███████▊  | 724/930 [3:45:22<1:02:24, 18.18s/it] 78%|███████▊  | 725/930 [3:45:41<1:03:01, 18.45s/it] 78%|███████▊  | 726/930 [3:46:00<1:02:42, 18.44s/it] 78%|███████▊  | 727/930 [3:46:20<1:03:53, 18.88s/it] 78%|███████▊  | 728/930 [3:46:38<1:02:42, 18.62s/it] 78%|███████▊  | 729/930 [3:46:57<1:02:43, 18.72s/it] 78%|███████▊  | 730/930 [3:47:15<1:02:00, 18.60s/it]                                                      78%|███████▊  | 730/930 [3:47:15<1:02:00, 18.60s/it] 79%|███████▊  | 731/930 [3:47:32<1:00:06, 18.12s/it] 79%|███████▊  | 732/930 [3:47:51<1:01:12, 18.55s/it] 79%|███████▉  | 733/930 [3:48:10<1:01:10, 18.63s/it] 79%|███████▉  | 734/930 [3:48:28<1:00:15, 18.45s/it] 79%|███████▉  | 735/930 [3:48:46<58:48, 18.09s/it]   79%|███████▉  | 736/930 [3:49:03<57:55, 17.91s/it] 79%|███████▉  | 737/930 [3:49:22<58:48, 18.28s/it] 79%|███████▉  | 738/930 [3:49:42<59:39, 18.64s/it] 79%|███████▉  | 739/930 [3:50:00<58:59, 18.53s/it] 80%|███████▉  | 740/930 [3:50:17<57:05, 18.03s/it]                                                    80%|███████▉  | 740/930 [3:50:17<57:05, 18.03s/it] 80%|███████▉  | 741/930 [3:50:32<54:27, 17.29s/it] 80%|███████▉  | 742/930 [3:50:46<50:52, 16.24s/it] 80%|███████▉  | 743/930 [3:51:06<53:46, 17.25s/it] 80%|████████  | 744/930 [3:51:24<54:25, 17.56s/it] 80%|████████  | 745/930 [3:51:43<55:14, 17.92s/it] 80%|████████  | 746/930 [3:52:01<55:12, 18.01s/it] 80%|████████  | 747/930 [3:52:20<55:31, 18.21s/it] 80%|████████  | 748/930 [3:52:40<56:47, 18.72s/it] 81%|████████  | 749/930 [3:52:59<57:05, 18.93s/it] 81%|████████  | 750/930 [3:53:17<55:41, 18.56s/it]                                                    81%|████████  | 750/930 [3:53:17<55:41, 18.56s/it] 81%|████████  | 751/930 [3:53:37<56:47, 19.04s/it] 81%|████████  | 752/930 [3:53:57<57:23, 19.35s/it] 81%|████████  | 753/930 [3:54:14<54:52, 18.60s/it] 81%|████████  | 754/930 [3:54:33<54:54, 18.72s/it] 81%|████████  | 755/930 [3:54:50<52:53, 18.13s/it] 81%|████████▏ | 756/930 [3:55:09<53:30, 18.45s/it] 81%|████████▏ | 757/930 [3:55:28<54:18, 18.83s/it] 82%|████████▏ | 758/930 [3:55:47<53:39, 18.72s/it] 82%|████████▏ | 759/930 [3:56:05<53:10, 18.66s/it] 82%|████████▏ | 760/930 [3:56:23<52:06, 18.39s/it]                                                    82%|████████▏ | 760/930 [3:56:23<52:06, 18.39s/it] 82%|████████▏ | 761/930 [3:56:41<51:23, 18.25s/it] 82%|████████▏ | 762/930 [3:57:00<51:40, 18.45s/it] 82%|████████▏ | 763/930 [3:57:18<51:03, 18.35s/it] 82%|████████▏ | 764/930 [3:57:36<50:25, 18.23s/it] 82%|████████▏ | 765/930 [3:57:56<51:44, 18.82s/it] 82%|████████▏ | 766/930 [3:58:16<51:56, 19.00s/it] 82%|████████▏ | 767/930 [3:58:34<50:59, 18.77s/it] 83%|████████▎ | 768/930 [3:58:54<51:25, 19.04s/it] 83%|████████▎ | 769/930 [3:59:11<49:50, 18.57s/it] 83%|████████▎ | 770/930 [3:59:31<50:46, 19.04s/it]                                                    83%|████████▎ | 770/930 [3:59:31<50:46, 19.04s/it] 83%|████████▎ | 771/930 [3:59:50<50:38, 19.11s/it] 83%|████████▎ | 772/930 [4:00:10<50:39, 19.24s/it] 83%|████████▎ | 773/930 [4:00:26<48:09, 18.41s/it] 83%|████████▎ | 774/930 [4:00:45<47:48, 18.38s/it] 83%|████████▎ | 775/930 [4:01:04<47:45, 18.49s/it] 83%|████████▎ | 776/930 [4:01:22<47:45, 18.61s/it] 84%|████████▎ | 777/930 [4:01:41<47:04, 18.46s/it] 84%|████████▎ | 778/930 [4:01:57<44:53, 17.72s/it] 84%|████████▍ | 779/930 [4:02:16<46:12, 18.36s/it] 84%|████████▍ | 780/930 [4:02:34<45:24, 18.16s/it]                                                    84%|████████▍ | 780/930 [4:02:34<45:24, 18.16s/it] 84%|████████▍ | 781/930 [4:02:52<44:42, 18.00s/it] 84%|████████▍ | 782/930 [4:03:10<44:33, 18.07s/it] 84%|████████▍ | 783/930 [4:03:28<43:58, 17.95s/it] 84%|████████▍ | 784/930 [4:03:46<44:20, 18.22s/it] 84%|████████▍ | 785/930 [4:04:06<44:43, 18.50s/it] 85%|████████▍ | 786/930 [4:04:22<42:57, 17.90s/it] 85%|████████▍ | 787/930 [4:04:41<43:03, 18.07s/it] 85%|████████▍ | 788/930 [4:04:57<41:15, 17.44s/it] 85%|████████▍ | 789/930 [4:05:13<39:58, 17.01s/it] 85%|████████▍ | 790/930 [4:05:31<40:24, 17.32s/it]                                                    85%|████████▍ | 790/930 [4:05:31<40:24, 17.32s/it] 85%|████████▌ | 791/930 [4:05:48<40:31, 17.49s/it] 85%|████████▌ | 792/930 [4:06:08<41:36, 18.09s/it] 85%|████████▌ | 793/930 [4:06:27<41:44, 18.28s/it] 85%|████████▌ | 794/930 [4:06:43<40:06, 17.70s/it] 85%|████████▌ | 795/930 [4:07:02<41:00, 18.22s/it] 86%|████████▌ | 796/930 [4:07:22<41:25, 18.55s/it] 86%|████████▌ | 797/930 [4:07:41<41:38, 18.79s/it] 86%|████████▌ | 798/930 [4:08:00<41:31, 18.88s/it] 86%|████████▌ | 799/930 [4:08:18<40:25, 18.51s/it] 86%|████████▌ | 800/930 [4:08:37<40:10, 18.54s/it]                                                    86%|████████▌ | 800/930 [4:08:37<40:10, 18.54s/it]{'eval_loss': 0.3762333393096924, 'eval_runtime': 48.6688, 'eval_samples_per_second': 5.116, 'eval_steps_per_second': 1.294, 'eval_rewards/chosen': -39.21601104736328, 'eval_rewards/rejected': -53.29909133911133, 'eval_rewards/accuracies': 0.841269850730896, 'eval_rewards/margins': 14.083083152770996, 'eval_logps/rejected': -777.6549682617188, 'eval_logps/chosen': -734.231689453125, 'eval_logits/rejected': -6.867902755737305, 'eval_logits/chosen': -0.5356709957122803, 'epoch': 9.68}
{'loss': 0.0626, 'grad_norm': 0.014023366384208202, 'learning_rate': 5.810575660010624e-05, 'rewards/chosen': -38.42377471923828, 'rewards/rejected': -58.713722229003906, 'rewards/accuracies': 0.96875, 'rewards/margins': 20.28993797302246, 'logps/rejected': -807.3248901367188, 'logps/chosen': -654.5638427734375, 'logits/rejected': 4.387392997741699, 'logits/chosen': 10.807369232177734, 'epoch': 9.84}
{'loss': 0.0603, 'grad_norm': 0.18464477360248566, 'learning_rate': 5.4902366258953684e-05, 'rewards/chosen': -39.29288101196289, 'rewards/rejected': -63.02557373046875, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 23.732694625854492, 'logps/rejected': -840.8865356445312, 'logps/chosen': -667.7749633789062, 'logits/rejected': 5.388238906860352, 'logits/chosen': 11.945479393005371, 'epoch': 10.0}
{'loss': 0.0668, 'grad_norm': 0.3267286419868469, 'learning_rate': 5.175605622223138e-05, 'rewards/chosen': -41.74674987792969, 'rewards/rejected': -67.46346282958984, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 25.71670913696289, 'logps/rejected': -895.7457275390625, 'logps/chosen': -694.1958618164062, 'logits/rejected': 4.049163341522217, 'logits/chosen': 10.586666107177734, 'epoch': 10.16}
{'loss': 0.0327, 'grad_norm': 0.006174568086862564, 'learning_rate': 4.8670808790557585e-05, 'rewards/chosen': -38.11611557006836, 'rewards/rejected': -63.58455276489258, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 25.46843910217285, 'logps/rejected': -843.724609375, 'logps/chosen': -649.8079223632812, 'logits/rejected': 2.1387150287628174, 'logits/chosen': 9.291952133178711, 'epoch': 10.32}
{'loss': 0.0663, 'grad_norm': 0.0008303113863803446, 'learning_rate': 4.5650528977300674e-05, 'rewards/chosen': -41.114234924316406, 'rewards/rejected': -66.69187927246094, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 25.577632904052734, 'logps/rejected': -892.4588012695312, 'logps/chosen': -698.1732177734375, 'logits/rejected': 0.7004231214523315, 'logits/chosen': 7.551081657409668, 'epoch': 10.48}
{'loss': 0.0703, 'grad_norm': 9.839032173156738, 'learning_rate': 4.269903956598399e-05, 'rewards/chosen': -40.255699157714844, 'rewards/rejected': -67.47037506103516, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 27.214672088623047, 'logps/rejected': -882.2488403320312, 'logps/chosen': -666.4029541015625, 'logits/rejected': 2.097416400909424, 'logits/chosen': 9.351895332336426, 'epoch': 10.65}
{'loss': 0.0266, 'grad_norm': 1.2437248229980469, 'learning_rate': 3.982007627176915e-05, 'rewards/chosen': -37.70508575439453, 'rewards/rejected': -64.03583526611328, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 26.33074378967285, 'logps/rejected': -858.58154296875, 'logps/chosen': -657.5274658203125, 'logits/rejected': 1.2930982112884521, 'logits/chosen': 8.410730361938477, 'epoch': 10.81}
{'loss': 0.0532, 'grad_norm': 1.6107736825942993, 'learning_rate': 3.701728301314242e-05, 'rewards/chosen': -39.28895568847656, 'rewards/rejected': -63.647972106933594, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 24.359018325805664, 'logps/rejected': -860.5218505859375, 'logps/chosen': -674.2549438476562, 'logits/rejected': 3.3033103942871094, 'logits/chosen': 10.111791610717773, 'epoch': 10.97}
{'loss': 0.0554, 'grad_norm': 1.5306437015533447, 'learning_rate': 3.429420729978867e-05, 'rewards/chosen': -37.9330940246582, 'rewards/rejected': -60.3857307434082, 'rewards/accuracies': 0.96875, 'rewards/margins': 22.45263671875, 'logps/rejected': -823.8284301757812, 'logps/chosen': -655.8663940429688, 'logits/rejected': 4.926544666290283, 'logits/chosen': 10.57386589050293, 'epoch': 11.13}
{'loss': 0.0343, 'grad_norm': 0.034935127943754196, 'learning_rate': 3.165429574249008e-05, 'rewards/chosen': -36.8421745300293, 'rewards/rejected': -60.51433563232422, 'rewards/accuracies': 0.984375, 'rewards/margins': 23.67215919494629, 'logps/rejected': -829.1453247070312, 'logps/chosen': -650.7907104492188, 'logits/rejected': 4.0566205978393555, 'logits/chosen': 10.629281997680664, 'epoch': 11.29}
{'loss': 0.0411, 'grad_norm': 1.2654508352279663, 'learning_rate': 2.9100889690733536e-05, 'rewards/chosen': -37.70536804199219, 'rewards/rejected': -60.846519470214844, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 23.141155242919922, 'logps/rejected': -835.1851806640625, 'logps/chosen': -663.3988037109375, 'logits/rejected': 3.382457733154297, 'logits/chosen': 9.654397010803223, 'epoch': 11.45}
{'loss': 0.0633, 'grad_norm': 0.2846516966819763, 'learning_rate': 2.6637221003547486e-05, 'rewards/chosen': -36.687782287597656, 'rewards/rejected': -60.41474533081055, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 23.726961135864258, 'logps/rejected': -821.6954956054688, 'logps/chosen': -654.4092407226562, 'logits/rejected': 2.4995789527893066, 'logits/chosen': 10.06493854522705, 'epoch': 11.61}
{'loss': 0.0667, 'grad_norm': 1.3879865407943726, 'learning_rate': 2.426640795892158e-05, 'rewards/chosen': -37.33269500732422, 'rewards/rejected': -57.866676330566406, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 20.53397560119629, 'logps/rejected': -794.9454345703125, 'logps/chosen': -640.2401123046875, 'logits/rejected': 4.9495038986206055, 'logits/chosen': 11.14912223815918, 'epoch': 11.77}
{'loss': 0.0639, 'grad_norm': 2.3446381092071533, 'learning_rate': 2.199145130698631e-05, 'rewards/chosen': -35.36842346191406, 'rewards/rejected': -54.561370849609375, 'rewards/accuracies': 0.965624988079071, 'rewards/margins': 19.192947387695312, 'logps/rejected': -766.8966674804688, 'logps/chosen': -626.7882080078125, 'logits/rejected': 3.98210072517395, 'logits/chosen': 9.929964065551758, 'epoch': 11.94}
{'loss': 0.0425, 'grad_norm': 0.32038408517837524, 'learning_rate': 1.981523047194841e-05, 'rewards/chosen': -37.06003952026367, 'rewards/rejected': -57.708335876464844, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 20.648296356201172, 'logps/rejected': -777.2739868164062, 'logps/chosen': -634.6387939453125, 'logits/rejected': 2.8241143226623535, 'logits/chosen': 9.249022483825684, 'epoch': 12.1}
{'loss': 0.036, 'grad_norm': 1.4144456386566162, 'learning_rate': 1.7740499907588838e-05, 'rewards/chosen': -36.128623962402344, 'rewards/rejected': -57.10014724731445, 'rewards/accuracies': 0.984375, 'rewards/margins': 20.97151756286621, 'logps/rejected': -809.520751953125, 'logps/chosen': -654.3502807617188, 'logits/rejected': 3.9272446632385254, 'logits/chosen': 10.1041898727417, 'epoch': 12.26}
{'loss': 0.0288, 'grad_norm': 1.861751914024353, 'learning_rate': 1.5769885610936718e-05, 'rewards/chosen': -35.25471878051758, 'rewards/rejected': -57.72942352294922, 'rewards/accuracies': 0.984375, 'rewards/margins': 22.474700927734375, 'logps/rejected': -803.7384033203125, 'logps/chosen': -638.75244140625, 'logits/rejected': 4.867022514343262, 'logits/chosen': 10.934465408325195, 'epoch': 12.42}
{'loss': 0.0419, 'grad_norm': 0.11105284094810486, 'learning_rate': 1.3905881798531507e-05, 'rewards/chosen': -37.91533660888672, 'rewards/rejected': -60.150726318359375, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 22.235393524169922, 'logps/rejected': -803.9793701171875, 'logps/chosen': -648.0714721679688, 'logits/rejected': 3.2010841369628906, 'logits/chosen': 9.656933784484863, 'epoch': 12.58}
{'loss': 0.0358, 'grad_norm': 1.0050528049468994, 'learning_rate': 1.2150847749480431e-05, 'rewards/chosen': -36.19125747680664, 'rewards/rejected': -57.518470764160156, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 21.32721519470215, 'logps/rejected': -784.72607421875, 'logps/chosen': -626.0214233398438, 'logits/rejected': 3.36029052734375, 'logits/chosen': 9.578672409057617, 'epoch': 12.74}
{'loss': 0.0373, 'grad_norm': 1.4435428380966187, 'learning_rate': 1.0507004819306976e-05, 'rewards/chosen': -38.330379486083984, 'rewards/rejected': -60.76923370361328, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 22.438852310180664, 'logps/rejected': -831.4227294921875, 'logps/chosen': -667.2692260742188, 'logits/rejected': 4.319270133972168, 'logits/chosen': 10.839730262756348, 'epoch': 12.9}

  0%|          | 0/63 [00:00<?, ?it/s][A
  3%|▎         | 2/63 [00:00<00:19,  3.15it/s][A
  5%|▍         | 3/63 [00:01<00:32,  1.82it/s][A
  6%|▋         | 4/63 [00:02<00:39,  1.50it/s][A
  8%|▊         | 5/63 [00:03<00:44,  1.31it/s][A
 10%|▉         | 6/63 [00:04<00:49,  1.16it/s][A
 11%|█         | 7/63 [00:05<00:52,  1.08it/s][A
 13%|█▎        | 8/63 [00:06<00:50,  1.08it/s][A
 14%|█▍        | 9/63 [00:06<00:43,  1.23it/s][A
 16%|█▌        | 10/63 [00:07<00:46,  1.14it/s][A
 17%|█▋        | 11/63 [00:08<00:47,  1.10it/s][A
 19%|█▉        | 12/63 [00:09<00:46,  1.11it/s][A
 21%|██        | 13/63 [00:10<00:40,  1.22it/s][A
 22%|██▏       | 14/63 [00:11<00:43,  1.12it/s][A
 24%|██▍       | 15/63 [00:12<00:43,  1.09it/s][A
 25%|██▌       | 16/63 [00:13<00:43,  1.08it/s][A
 27%|██▋       | 17/63 [00:13<00:36,  1.25it/s][A
 29%|██▊       | 18/63 [00:14<00:30,  1.47it/s][A
 30%|███       | 19/63 [00:14<00:29,  1.51it/s][A
 32%|███▏      | 20/63 [00:15<00:32,  1.34it/s][A
 33%|███▎      | 21/63 [00:16<00:31,  1.32it/s][A
 35%|███▍      | 22/63 [00:17<00:34,  1.17it/s][A
 37%|███▋      | 23/63 [00:18<00:36,  1.09it/s][A
 38%|███▊      | 24/63 [00:19<00:36,  1.06it/s][A
 40%|███▉      | 25/63 [00:20<00:36,  1.04it/s][A
 41%|████▏     | 26/63 [00:21<00:36,  1.01it/s][A
 43%|████▎     | 27/63 [00:22<00:36,  1.02s/it][A
 44%|████▍     | 28/63 [00:24<00:35,  1.03s/it][A
 46%|████▌     | 29/63 [00:24<00:29,  1.16it/s][A
 48%|████▊     | 30/63 [00:24<00:24,  1.33it/s][A
 49%|████▉     | 31/63 [00:25<00:22,  1.45it/s][A
 51%|█████     | 32/63 [00:26<00:20,  1.49it/s][A
 52%|█████▏    | 33/63 [00:26<00:19,  1.55it/s][A
 54%|█████▍    | 34/63 [00:27<00:21,  1.35it/s][A
 56%|█████▌    | 35/63 [00:28<00:21,  1.30it/s][A
 57%|█████▋    | 36/63 [00:29<00:18,  1.42it/s][A
 59%|█████▊    | 37/63 [00:29<00:16,  1.55it/s][A
 60%|██████    | 38/63 [00:30<00:17,  1.46it/s][A
 62%|██████▏   | 39/63 [00:31<00:19,  1.25it/s][A
 63%|██████▎   | 40/63 [00:32<00:20,  1.13it/s][A
 65%|██████▌   | 41/63 [00:33<00:18,  1.18it/s][A
 67%|██████▋   | 42/63 [00:34<00:17,  1.20it/s][A
 68%|██████▊   | 43/63 [00:34<00:15,  1.27it/s][A
 70%|██████▉   | 44/63 [00:35<00:13,  1.41it/s][A
 71%|███████▏  | 45/63 [00:35<00:11,  1.50it/s][A
 73%|███████▎  | 46/63 [00:36<00:10,  1.58it/s][A
 75%|███████▍  | 47/63 [00:36<00:09,  1.65it/s][A
 76%|███████▌  | 48/63 [00:37<00:09,  1.55it/s][A
 78%|███████▊  | 49/63 [00:38<00:08,  1.71it/s][A
 79%|███████▉  | 50/63 [00:39<00:09,  1.42it/s][A
 81%|████████  | 51/63 [00:39<00:08,  1.37it/s][A
 83%|████████▎ | 52/63 [00:40<00:09,  1.20it/s][A
 84%|████████▍ | 53/63 [00:41<00:07,  1.40it/s][A
 86%|████████▌ | 54/63 [00:42<00:06,  1.42it/s][A
 87%|████████▋ | 55/63 [00:42<00:05,  1.43it/s][A
 89%|████████▉ | 56/63 [00:43<00:04,  1.50it/s][A
 90%|█████████ | 57/63 [00:43<00:03,  1.55it/s][A
 92%|█████████▏| 58/63 [00:44<00:03,  1.42it/s][A
 94%|█████████▎| 59/63 [00:45<00:02,  1.43it/s][A
 95%|█████████▌| 60/63 [00:45<00:01,  1.61it/s][A
 97%|█████████▋| 61/63 [00:46<00:01,  1.59it/s][A
 98%|█████████▊| 62/63 [00:47<00:00,  1.64it/s][A
100%|██████████| 63/63 [00:47<00:00,  1.84it/s][A                                                   
                                               [A 86%|████████▌ | 800/930 [4:09:25<40:10, 18.54s/it]
100%|██████████| 63/63 [00:47<00:00,  1.84it/s][A
                                               [A/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--google--flan-t5-large--hf/ - will assume that the vocabulary was not modified.
  warnings.warn(
 86%|████████▌ | 801/930 [4:09:48<1:14:20, 34.58s/it] 86%|████████▌ | 802/930 [4:10:07<1:03:15, 29.65s/it] 86%|████████▋ | 803/930 [4:10:26<55:58, 26.45s/it]   86%|████████▋ | 804/930 [4:10:45<50:55, 24.25s/it] 87%|████████▋ | 805/930 [4:11:03<46:58, 22.55s/it] 87%|████████▋ | 806/930 [4:11:20<42:53, 20.75s/it] 87%|████████▋ | 807/930 [4:11:35<39:11, 19.12s/it] 87%|████████▋ | 808/930 [4:11:53<38:21, 18.87s/it] 87%|████████▋ | 809/930 [4:12:13<38:36, 19.14s/it] 87%|████████▋ | 810/930 [4:12:31<37:24, 18.71s/it]                                                    87%|████████▋ | 810/930 [4:12:31<37:24, 18.71s/it] 87%|████████▋ | 811/930 [4:12:50<37:16, 18.80s/it] 87%|████████▋ | 812/930 [4:13:09<36:56, 18.78s/it] 87%|████████▋ | 813/930 [4:13:27<36:33, 18.75s/it] 88%|████████▊ | 814/930 [4:13:46<36:09, 18.70s/it] 88%|████████▊ | 815/930 [4:14:04<35:38, 18.60s/it] 88%|████████▊ | 816/930 [4:14:22<34:52, 18.36s/it] 88%|████████▊ | 817/930 [4:14:40<34:31, 18.33s/it] 88%|████████▊ | 818/930 [4:14:57<33:18, 17.84s/it] 88%|████████▊ | 819/930 [4:15:16<33:42, 18.22s/it] 88%|████████▊ | 820/930 [4:15:35<33:35, 18.32s/it]                                                    88%|████████▊ | 820/930 [4:15:35<33:35, 18.32s/it] 88%|████████▊ | 821/930 [4:15:53<33:16, 18.31s/it] 88%|████████▊ | 822/930 [4:16:12<33:26, 18.58s/it] 88%|████████▊ | 823/930 [4:16:32<33:51, 18.99s/it] 89%|████████▊ | 824/930 [4:16:50<32:45, 18.54s/it] 89%|████████▊ | 825/930 [4:17:07<31:32, 18.02s/it] 89%|████████▉ | 826/930 [4:17:24<30:57, 17.86s/it] 89%|████████▉ | 827/930 [4:17:42<30:42, 17.89s/it] 89%|████████▉ | 828/930 [4:18:00<30:21, 17.86s/it] 89%|████████▉ | 829/930 [4:18:20<31:12, 18.54s/it] 89%|████████▉ | 830/930 [4:18:37<30:08, 18.09s/it]                                                    89%|████████▉ | 830/930 [4:18:37<30:08, 18.09s/it] 89%|████████▉ | 831/930 [4:18:57<30:52, 18.71s/it] 89%|████████▉ | 832/930 [4:19:16<30:38, 18.76s/it] 90%|████████▉ | 833/930 [4:19:33<29:43, 18.39s/it] 90%|████████▉ | 834/930 [4:19:53<30:03, 18.78s/it] 90%|████████▉ | 835/930 [4:20:13<30:23, 19.20s/it] 90%|████████▉ | 836/930 [4:20:33<30:31, 19.49s/it] 90%|█████████ | 837/930 [4:20:51<29:23, 18.96s/it] 90%|█████████ | 838/930 [4:21:11<29:17, 19.10s/it] 90%|█████████ | 839/930 [4:21:29<28:43, 18.94s/it] 90%|█████████ | 840/930 [4:21:49<28:57, 19.30s/it]                                                    90%|█████████ | 840/930 [4:21:49<28:57, 19.30s/it] 90%|█████████ | 841/930 [4:22:08<28:23, 19.14s/it] 91%|█████████ | 842/930 [4:22:27<28:09, 19.20s/it] 91%|█████████ | 843/930 [4:22:46<27:20, 18.86s/it] 91%|█████████ | 844/930 [4:23:06<27:36, 19.26s/it] 91%|█████████ | 845/930 [4:23:23<26:35, 18.77s/it] 91%|█████████ | 846/930 [4:23:42<26:14, 18.75s/it] 91%|█████████ | 847/930 [4:24:02<26:31, 19.17s/it] 91%|█████████ | 848/930 [4:24:21<26:06, 19.11s/it] 91%|█████████▏| 849/930 [4:24:41<25:54, 19.19s/it] 91%|█████████▏| 850/930 [4:24:59<25:29, 19.12s/it]                                                    91%|█████████▏| 850/930 [4:24:59<25:29, 19.12s/it] 92%|█████████▏| 851/930 [4:25:18<24:48, 18.84s/it] 92%|█████████▏| 852/930 [4:25:35<23:58, 18.44s/it] 92%|█████████▏| 853/930 [4:25:51<22:44, 17.72s/it] 92%|█████████▏| 854/930 [4:26:09<22:25, 17.70s/it] 92%|█████████▏| 855/930 [4:26:25<21:41, 17.36s/it] 92%|█████████▏| 856/930 [4:26:45<22:21, 18.13s/it] 92%|█████████▏| 857/930 [4:27:04<22:04, 18.15s/it] 92%|█████████▏| 858/930 [4:27:20<21:04, 17.56s/it] 92%|█████████▏| 859/930 [4:27:38<21:03, 17.80s/it] 92%|█████████▏| 860/930 [4:27:58<21:22, 18.32s/it]                                                    92%|█████████▏| 860/930 [4:27:58<21:22, 18.32s/it] 93%|█████████▎| 861/930 [4:28:15<20:40, 17.98s/it] 93%|█████████▎| 862/930 [4:28:32<20:02, 17.68s/it] 93%|█████████▎| 863/930 [4:28:50<19:52, 17.80s/it] 93%|█████████▎| 864/930 [4:29:09<19:57, 18.14s/it] 93%|█████████▎| 865/930 [4:29:27<19:42, 18.19s/it] 93%|█████████▎| 866/930 [4:29:45<19:21, 18.14s/it] 93%|█████████▎| 867/930 [4:30:03<18:56, 18.04s/it] 93%|█████████▎| 868/930 [4:30:19<17:59, 17.41s/it] 93%|█████████▎| 869/930 [4:30:37<17:55, 17.63s/it] 94%|█████████▎| 870/930 [4:30:55<17:47, 17.79s/it]                                                    94%|█████████▎| 870/930 [4:30:55<17:47, 17.79s/it] 94%|█████████▎| 871/930 [4:31:13<17:33, 17.85s/it] 94%|█████████▍| 872/930 [4:31:32<17:28, 18.09s/it] 94%|█████████▍| 873/930 [4:31:49<17:03, 17.96s/it] 94%|█████████▍| 874/930 [4:32:08<16:58, 18.18s/it] 94%|█████████▍| 875/930 [4:32:27<16:43, 18.25s/it] 94%|█████████▍| 876/930 [4:32:45<16:31, 18.36s/it] 94%|█████████▍| 877/930 [4:33:04<16:22, 18.54s/it] 94%|█████████▍| 878/930 [4:33:20<15:26, 17.81s/it] 95%|█████████▍| 879/930 [4:33:39<15:25, 18.15s/it] 95%|█████████▍| 880/930 [4:33:59<15:34, 18.69s/it]                                                    95%|█████████▍| 880/930 [4:33:59<15:34, 18.69s/it] 95%|█████████▍| 881/930 [4:34:19<15:31, 19.00s/it] 95%|█████████▍| 882/930 [4:34:38<15:12, 19.02s/it] 95%|█████████▍| 883/930 [4:34:56<14:46, 18.87s/it] 95%|█████████▌| 884/930 [4:35:15<14:20, 18.71s/it] 95%|█████████▌| 885/930 [4:35:34<14:04, 18.76s/it] 95%|█████████▌| 886/930 [4:35:49<13:00, 17.73s/it] 95%|█████████▌| 887/930 [4:36:09<13:07, 18.32s/it] 95%|█████████▌| 888/930 [4:36:27<12:52, 18.40s/it] 96%|█████████▌| 889/930 [4:36:46<12:34, 18.41s/it] 96%|█████████▌| 890/930 [4:37:05<12:26, 18.66s/it]                                                    96%|█████████▌| 890/930 [4:37:05<12:26, 18.66s/it] 96%|█████████▌| 891/930 [4:37:21<11:34, 17.82s/it] 96%|█████████▌| 892/930 [4:37:38<11:12, 17.70s/it] 96%|█████████▌| 893/930 [4:37:58<11:16, 18.29s/it] 96%|█████████▌| 894/930 [4:38:16<10:57, 18.28s/it] 96%|█████████▌| 895/930 [4:38:35<10:46, 18.47s/it] 96%|█████████▋| 896/930 [4:38:50<09:52, 17.44s/it] 96%|█████████▋| 897/930 [4:39:07<09:30, 17.29s/it] 97%|█████████▋| 898/930 [4:39:26<09:32, 17.88s/it] 97%|█████████▋| 899/930 [4:39:43<09:06, 17.64s/it] 97%|█████████▋| 900/930 [4:40:02<09:02, 18.07s/it]                                                    97%|█████████▋| 900/930 [4:40:02<09:02, 18.07s/it] 97%|█████████▋| 901/930 [4:40:21<08:51, 18.31s/it] 97%|█████████▋| 902/930 [4:40:40<08:33, 18.32s/it] 97%|█████████▋| 903/930 [4:40:59<08:19, 18.51s/it] 97%|█████████▋| 904/930 [4:41:19<08:14, 19.00s/it] 97%|█████████▋| 905/930 [4:41:36<07:38, 18.35s/it] 97%|█████████▋| 906/930 [4:41:55<07:27, 18.63s/it] 98%|█████████▊| 907/930 [4:42:12<06:58, 18.21s/it] 98%|█████████▊| 908/930 [4:42:29<06:30, 17.77s/it] 98%|█████████▊| 909/930 [4:42:47<06:16, 17.91s/it] 98%|█████████▊| 910/930 [4:43:05<05:57, 17.88s/it]                                                    98%|█████████▊| 910/930 [4:43:05<05:57, 17.88s/it] 98%|█████████▊| 911/930 [4:43:24<05:43, 18.09s/it] 98%|█████████▊| 912/930 [4:43:43<05:30, 18.37s/it] 98%|█████████▊| 913/930 [4:44:01<05:11, 18.32s/it] 98%|█████████▊| 914/930 [4:44:19<04:53, 18.32s/it] 98%|█████████▊| 915/930 [4:44:38<04:36, 18.47s/it] 98%|█████████▊| 916/930 [4:44:56<04:15, 18.24s/it] 99%|█████████▊| 917/930 [4:45:14<03:58, 18.37s/it] 99%|█████████▊| 918/930 [4:45:32<03:36, 18.03s/it] 99%|█████████▉| 919/930 [4:45:52<03:25, 18.68s/it] 99%|█████████▉| 920/930 [4:46:09<03:02, 18.26s/it]                                                    99%|█████████▉| 920/930 [4:46:09<03:02, 18.26s/it] 99%|█████████▉| 921/930 [4:46:25<02:37, 17.51s/it] 99%|█████████▉| 922/930 [4:46:44<02:25, 18.14s/it] 99%|█████████▉| 923/930 [4:47:04<02:09, 18.45s/it] 99%|█████████▉| 924/930 [4:47:21<01:49, 18.28s/it] 99%|█████████▉| 925/930 [4:47:40<01:31, 18.32s/it]100%|█████████▉| 926/930 [4:47:59<01:13, 18.49s/it]100%|█████████▉| 927/930 [4:48:16<00:54, 18.00s/it]100%|█████████▉| 928/930 [4:48:36<00:37, 18.64s/it]100%|█████████▉| 929/930 [4:48:56<00:19, 19.04s/it]100%|██████████| 930/930 [4:49:15<00:00, 19.00s/it]                                                   100%|██████████| 930/930 [4:49:15<00:00, 19.00s/it]                                                   100%|██████████| 930/930 [4:49:18<00:00, 19.00s/it]100%|██████████| 930/930 [4:49:18<00:00, 18.67s/it]
/mnt/beegfs/work/yang/dpo/lib64/python3.9/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /storage/ukp/shared/shared_model_weights/models--google--flan-t5-large--hf/ - will assume that the vocabulary was not modified.
  warnings.warn(
{'eval_loss': 0.333755224943161, 'eval_runtime': 48.6301, 'eval_samples_per_second': 5.12, 'eval_steps_per_second': 1.295, 'eval_rewards/chosen': -42.20976638793945, 'eval_rewards/rejected': -59.80043411254883, 'eval_rewards/accuracies': 0.8373016119003296, 'eval_rewards/margins': 17.590662002563477, 'eval_logps/rejected': -842.6683959960938, 'eval_logps/chosen': -764.1692504882812, 'eval_logits/rejected': -7.995380878448486, 'eval_logits/chosen': -1.3292567729949951, 'epoch': 12.9}
{'loss': 0.0564, 'grad_norm': 0.047306545078754425, 'learning_rate': 8.976433628369808e-06, 'rewards/chosen': -39.7596549987793, 'rewards/rejected': -62.47637939453125, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 22.716718673706055, 'logps/rejected': -827.7376098632812, 'logps/chosen': -654.0206298828125, 'logits/rejected': 3.4330291748046875, 'logits/chosen': 9.863263130187988, 'epoch': 13.06}
{'loss': 0.0221, 'grad_norm': 0.18396645784378052, 'learning_rate': 7.56107142841106e-06, 'rewards/chosen': -38.428627014160156, 'rewards/rejected': -62.40848922729492, 'rewards/accuracies': 0.9906250238418579, 'rewards/margins': 23.9798641204834, 'logps/rejected': -834.1295776367188, 'logps/chosen': -656.3175659179688, 'logits/rejected': 3.2432847023010254, 'logits/chosen': 10.289898872375488, 'epoch': 13.23}
{'loss': 0.059, 'grad_norm': 2.2980294227600098, 'learning_rate': 6.262709650566923e-06, 'rewards/chosen': -38.89768600463867, 'rewards/rejected': -64.62468719482422, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 25.726999282836914, 'logps/rejected': -849.7320556640625, 'logps/chosen': -660.826904296875, 'logits/rejected': 2.6936464309692383, 'logits/chosen': 9.62308120727539, 'epoch': 13.39}
{'loss': 0.0407, 'grad_norm': 0.15254080295562744, 'learning_rate': 5.082991637944168e-06, 'rewards/chosen': -41.31279373168945, 'rewards/rejected': -64.04136657714844, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 22.72856903076172, 'logps/rejected': -861.7547607421875, 'logps/chosen': -698.3768310546875, 'logits/rejected': 4.229569911956787, 'logits/chosen': 10.1400146484375, 'epoch': 13.55}
{'loss': 0.0535, 'grad_norm': 2.0281903743743896, 'learning_rate': 4.023410565632391e-06, 'rewards/chosen': -38.40791702270508, 'rewards/rejected': -61.591339111328125, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 23.183422088623047, 'logps/rejected': -867.6513671875, 'logps/chosen': -684.4173583984375, 'logits/rejected': 3.6959691047668457, 'logits/chosen': 10.271184921264648, 'epoch': 13.71}
{'loss': 0.0618, 'grad_norm': 2.1962225437164307, 'learning_rate': 3.0853075507847553e-06, 'rewards/chosen': -39.06404495239258, 'rewards/rejected': -60.48808670043945, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 21.424041748046875, 'logps/rejected': -818.9290771484375, 'logps/chosen': -656.1966552734375, 'logits/rejected': 3.1284422874450684, 'logits/chosen': 9.336170196533203, 'epoch': 13.87}
{'loss': 0.0477, 'grad_norm': 1.921574592590332, 'learning_rate': 2.2698699551591207e-06, 'rewards/chosen': -38.57431411743164, 'rewards/rejected': -62.36992263793945, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 23.795608520507812, 'logps/rejected': -843.5577392578125, 'logps/chosen': -663.0675048828125, 'logits/rejected': 2.207495927810669, 'logits/chosen': 9.121403694152832, 'epoch': 14.03}
{'loss': 0.0729, 'grad_norm': 1.8608824014663696, 'learning_rate': 1.5781298822682756e-06, 'rewards/chosen': -38.69384765625, 'rewards/rejected': -62.351280212402344, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 23.657428741455078, 'logps/rejected': -827.7325439453125, 'logps/chosen': -659.6495971679688, 'logits/rejected': 3.209185838699341, 'logits/chosen': 10.320746421813965, 'epoch': 14.19}
{'loss': 0.0409, 'grad_norm': 0.7456434965133667, 'learning_rate': 1.010962871041221e-06, 'rewards/chosen': -39.13536834716797, 'rewards/rejected': -62.263587951660156, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 23.128219604492188, 'logps/rejected': -853.0830078125, 'logps/chosen': -677.376953125, 'logits/rejected': 3.1960771083831787, 'logits/chosen': 9.778131484985352, 'epoch': 14.35}
{'loss': 0.0467, 'grad_norm': 1.3638083934783936, 'learning_rate': 5.690867876491646e-07, 'rewards/chosen': -38.74646759033203, 'rewards/rejected': -60.120819091796875, 'rewards/accuracies': 0.971875011920929, 'rewards/margins': 21.374353408813477, 'logps/rejected': -814.5203247070312, 'logps/chosen': -651.787109375, 'logits/rejected': 3.3727126121520996, 'logits/chosen': 9.060673713684082, 'epoch': 14.52}
{'loss': 0.0462, 'grad_norm': 1.814100980758667, 'learning_rate': 2.5306091689860646e-07, 'rewards/chosen': -37.75123977661133, 'rewards/rejected': -60.670989990234375, 'rewards/accuracies': 0.9781249761581421, 'rewards/margins': 22.919755935668945, 'logps/rejected': -819.4719848632812, 'logps/chosen': -653.271728515625, 'logits/rejected': 3.6529834270477295, 'logits/chosen': 10.267583847045898, 'epoch': 14.68}
{'loss': 0.0558, 'grad_norm': 1.7828108072280884, 'learning_rate': 6.328525434173838e-08, 'rewards/chosen': -38.279518127441406, 'rewards/rejected': -60.890419006347656, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 22.61089324951172, 'logps/rejected': -833.0863037109375, 'logps/chosen': -657.9268798828125, 'logits/rejected': 4.456696033477783, 'logits/chosen': 10.601316452026367, 'epoch': 14.84}
{'loss': 0.0344, 'grad_norm': 1.000566840171814, 'learning_rate': 0.0, 'rewards/chosen': -39.73907470703125, 'rewards/rejected': -62.524024963378906, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 22.784948348999023, 'logps/rejected': -845.744140625, 'logps/chosen': -681.2274169921875, 'logits/rejected': 2.9913480281829834, 'logits/chosen': 9.656659126281738, 'epoch': 15.0}
{'train_runtime': 17383.5153, 'train_samples_per_second': 1.712, 'train_steps_per_second': 0.053, 'train_loss': 0.09898696432831466, 'epoch': 15.0}
wandb: - 936.645 MB of 936.645 MB uploadedwandb: \ 936.645 MB of 936.645 MB uploadedwandb: | 936.671 MB of 936.671 MB uploadedwandb: 
wandb: Run history:
wandb:       eval/logits/chosen ▁▇█▇
wandb:     eval/logits/rejected ▁▇█▇
wandb:        eval/logps/chosen ▇█▃▁
wandb:      eval/logps/rejected ▆█▄▁
wandb:                eval/loss ▅█▆▁
wandb:  eval/rewards/accuracies ▂▁█▇
wandb:      eval/rewards/chosen ▇█▃▁
wandb:     eval/rewards/margins ▅▁▄█
wandb:    eval/rewards/rejected ▆█▄▁
wandb:             eval/runtime ▆█▃▁
wandb:  eval/samples_per_second ▃▁▆█
wandb:    eval/steps_per_second ▃▁▆█
wandb:              train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:        train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:          train/grad_norm ▆▆▅▄▄▃▇▅▂▂▄▅▂▅█▆▅▃▃▅▅▁▄▂▂▅▁▁▃▃▃▄▃▁▁▄▄▄▃▂
wandb:      train/learning_rate ▂▅███████▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:      train/logits/chosen ▇▂▃▃▁▃▆▃▆▆▅▅▄█▇▆▇▆▅▇▇▇▇██▆▇▆▅▆▆▆▆▆▆▆▆▆▆▆
wandb:    train/logits/rejected ▇▂▄▄▁▃▅▄▆▆▄▅▄▇▇▅▇▆▅▇▇▇▆█▇▆▇▅▅▆▆▆▆▆▆▅▆▆▆▆
wandb:       train/logps/chosen █▇▇▆▄▆▅▅▄▄▃▂▂▄▃▁▃▃▁▂▄▂▂▂▂▁▁▂▂▂▁▂▂▂▂▂▁▂▂▁
wandb:     train/logps/rejected █▇▇▆▄▆▅▅▄▄▃▂▂▄▃▂▃▃▁▂▄▂▂▂▂▁▂▂▁▂▂▂▂▂▂▂▁▂▂▂
wandb:               train/loss █▅▃▃▃▂▂▂▂▂▁▂▁▁▂▂▁▂▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: train/rewards/accuracies ▁▅▇▇▇▇▇▇▇▇███████▇██████████████████████
wandb:     train/rewards/chosen █▇▇▆▄▆▅▅▄▄▃▂▂▄▃▁▃▃▁▂▄▂▁▂▂▁▁▂▂▂▂▂▂▂▁▁▂▁▁▁
wandb:    train/rewards/margins ▁▂▃▃▆▄▄▄▅▅▇▇▇▆▆▇▆▅█▇▅▇█▆▇▇▇██▇▇▆▇▇▇█▇▇▇▇
wandb:   train/rewards/rejected █▇▆▆▄▅▅▅▄▄▃▂▂▄▃▁▃▃▁▂▄▂▁▂▂▂▁▁▁▂▂▂▂▂▁▁▂▂▂▁
wandb: 
wandb: Run summary:
wandb:       eval/logits/chosen -1.32926
wandb:     eval/logits/rejected -7.99538
wandb:        eval/logps/chosen -764.16925
wandb:      eval/logps/rejected -842.6684
wandb:                eval/loss 0.33376
wandb:  eval/rewards/accuracies 0.8373
wandb:      eval/rewards/chosen -42.20977
wandb:     eval/rewards/margins 17.59066
wandb:    eval/rewards/rejected -59.80043
wandb:             eval/runtime 48.6301
wandb:  eval/samples_per_second 5.12
wandb:    eval/steps_per_second 1.295
wandb:               total_flos 0.0
wandb:              train/epoch 15.0
wandb:        train/global_step 930
wandb:          train/grad_norm 1.00057
wandb:      train/learning_rate 0.0
wandb:      train/logits/chosen 9.65666
wandb:    train/logits/rejected 2.99135
wandb:       train/logps/chosen -681.22742
wandb:     train/logps/rejected -845.74414
wandb:               train/loss 0.0344
wandb: train/rewards/accuracies 0.98125
wandb:     train/rewards/chosen -39.73907
wandb:    train/rewards/margins 22.78495
wandb:   train/rewards/rejected -62.52402
wandb:               train_loss 0.09899
wandb:            train_runtime 17383.5153
wandb: train_samples_per_second 1.712
wandb:   train_steps_per_second 0.053
wandb: 
wandb: 🚀 View run dpo_google--flan-t5-large--hf-_None_lr-0.0002_ep-15_bz-8-acc-4_lora-r-128-ap-256 at: https://wandb.ai/ukp-conv/Privacy-NLP/runs/c5cdtal7
wandb: ⭐️ View project at: https://wandb.ai/ukp-conv/Privacy-NLP
wandb: Synced 6 W&B file(s), 0 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240523_115056-c5cdtal7/logs
